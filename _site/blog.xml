<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Bayesically Speaking</title>
<link>https://bayesically-speaking.com/blog.html</link>
<atom:link href="https://bayesically-speaking.com/blog.xml" rel="self" type="application/rss+xml"/>
<description>The place where statistics, coffee and bayes theorem come toghether</description>
<generator>quarto-1.6.43</generator>
<lastBuildDate>Sat, 19 Apr 2025 03:00:00 GMT</lastBuildDate>
<item>
  <title>HMC by Hand: Gradients, Heartbeats, PDEs and Other Tales</title>
  <dc:creator>Matías Castillo-Aguilar</dc:creator>
  <link>https://bayesically-speaking.com/posts/2025-04-19 heartbeats-pdes-and-other-tales/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1 page-columns page-full">
<h1>Introduction</h1>
<p>When we exercise, our hearts run faster, which is associated with a decrease in the time between heartbeats. This time between heartbeats is also known by R-R intervals. If you have ever seen an electrocardiogram (EKG) curve before, each time your heart pumps you’ll see a small spike in your EKG; well, those are your R-R intervals (RRi for short).</p>
<p>So, you’ll imagine that this RRi decreases during exercise (i.e., your heart run faster) but when you are resting your RRi increases (i.e., this is your heart slowing down). This is, in very simple terms, the overall dynamics of your RRi:</p>
<div style="text-align: center;">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
  a((Rest)) ---&gt;| High RRi | b((Exercise))
  b ---&gt;| RRi decreases | c((Recovery))
  c --&gt;| RRi increases | a
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<p>How ever there’s more to it than just saying that your heart run faster or slower. The curve describing its fluctuations can be described using the <a href="https://www.researchgate.net/publication/389812477_Enhancing_cardiovascular_monitoring_a_non-linear_model_for_characterizing_RR_interval_fluctuations_in_exercise_and_recovery">Castillo-Aguilar et al.&nbsp;(2025) RRi-vs-Time model</a>, that describe the exercise-induced RRi dynamics. Here’s an example RRi curve estimated using the aforementioned model:</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-04-19 heartbeats-pdes-and-other-tales/illustrative_curve.svg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Example exercise-induced RRi-vs-time dynamics and key parameters governing the overall curve behavior.</span></div></div>
<section id="a-matter-of-guessing" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="a-matter-of-guessing">A Matter of Guessing</h3>
<p>As you can see, the model parameters (e.g., decay rates, time constants) controlling the observed curve are numerous. So, as you can imagine, trying to estimate each parameter value to reproduce the observed curve, considering that the inter-individual cardiovascular response is highly heterogeneous, is for challenging (for say the least).</p>
<p>In this context, many methods exist to estimate model parameters for a given target function. However, one method above all the others allow us to quantify the uncertainty associated with each of these curve knobs. Yes, Bayesian models are what we are discussing here, but not any type of Bayesian algorithm. We are talking about Hamiltonian Monte Carlo (HMC).</p>
<p>Let’s remember that HMC uses the analogy of a particle gliding through the parameter space, visiting more frequently the areas associated with greater probability, depicting an accurate representation of the true probability distribution of model parameters. In a <a href="https://doi.org/10.59350/qfn6w-qyt38">previous post</a> we’ve discussed how to implement this very same model (i.e., the RRi-vs-time model) using HMC in R. However, we did not delved into the methodology to estimate the gradient that will guide our particle over this parameter space. In HMC, the position <img src="https://latex.codecogs.com/png.latex?q"> represents the model parameters, while momentum <img src="https://latex.codecogs.com/png.latex?p"> is an auxiliary variable that enables efficient exploration of the posterior distribution, avoiding the random-walk behavior of traditional MCMC.</p>
<div class="page-columns page-full"><p>The probability of a set of parameters is given by the likelihood function, which determines the amount of probability associated with a specific position in this space. So in order to simulate the movement of this particle through this parameter space, we need to estimate the slope that will move this particle using Hamiltonian mechanics principles. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">In Bayesian inference, each point in this <img src="https://latex.codecogs.com/png.latex?p">-dimensional space corresponds to a unique combination of the <img src="https://latex.codecogs.com/png.latex?p"> model parameters we aim to estimate.</span></div></div>
<p>Hamiltonian mechanics provides a physics-inspired framework to explore the parameter space. Let’s briefly recall its mathematical foundation</p>
</section>
<section id="hamiltonian-drama" class="level3">
<h3 class="anchored" data-anchor-id="hamiltonian-drama">Hamiltonian Drama</h3>
<p>Hamilton’s equations describe a system using position (<img src="https://latex.codecogs.com/png.latex?q">) and momentum (<img src="https://latex.codecogs.com/png.latex?p">) parameters, which are used to compute the potential (<img src="https://latex.codecogs.com/png.latex?U(q)">) and kinetic energy (<img src="https://latex.codecogs.com/png.latex?K(p)">) of a physical system. One of the key features of Hamilton mechanics is that the total energy of the system (<img src="https://latex.codecogs.com/png.latex?H(q,%20p)">) is conserved over time. This means that a change in potential energy <img src="https://latex.codecogs.com/png.latex?U(q)"> is compensated by an inversely proportional change in kinetic energy <img src="https://latex.codecogs.com/png.latex?K(p)">.</p>
<p>This is denoted in the classical form of the Hamiltonian:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AH(q,%20p)%20=%20U(q)%20+%20K(p)%0A"></p>
<p>And the set of differential equations that govern the overall dynamics of the system. Here, we say that the rate of change in the position (<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bdq%7D%7Bdt%7D">) of our imaginary particle the system is equal to the derivative of the system with respect to the momentum (<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20H%7D%7B%5Cpartial%20p%7D">):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Bdq%7D%7Bdt%7D%20=%20%5Cfrac%7B%5Cpartial%20H%7D%7B%5Cpartial%20p%7D%0A"></p>
<p>This means that we can use the momentum parameter <img src="https://latex.codecogs.com/png.latex?p"> to update the position of our particle <img src="https://latex.codecogs.com/png.latex?q"> inside our system over time.</p>
<p>However, we use the gradient information (i.e., the slope of the parameter space) of the current position <img src="https://latex.codecogs.com/png.latex?q"> to update the future momentum (<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bdp%7D%7Bdt%7D">), updating momentum in the direction of the negative gradient (<img src="https://latex.codecogs.com/png.latex?-%5Cfrac%7B%5Cpartial%20H%7D%7B%5Cpartial%20q%7D">), which is analogous to a ball rolling downhill, going faster down the steepest the surface.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Bdp%7D%7Bdt%7D%20=%20-%5Cfrac%7B%5Cpartial%20H%7D%7B%5Cpartial%20q%7D%0A"></p>
<p>Nonetheless, the challenge arrives when we need to estimate the gradient of the surface we are located, which is the gradient of the likelihood function, which usually involves at least a vector of partial derivatives of every single parameter of our target function, updating the momentum that then will update the position, where we will again estimate the gradient to update the momentum and so on.</p>
<p>To reflect this principle, the notation also can be imagined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Bdp%7D%7Bdt%7D%20=%20-%5Cnabla%20U(q)%0A"></p>
</section>
<section id="all-by-hand" class="level3">
<h3 class="anchored" data-anchor-id="all-by-hand">All by Hand</h3>
<p>Many softwares and statistical packages compute the gradient of the target likelihood function numerically or even symbolically. However, manually deriving gradients builds intuition for why HMC outperforms gradient-free MCMC methods (e.g., Metropolis-Hastings) in complex models, avoiding computational bottlenecks like random-walk behavior.</p>
<p>Even though you might think this is a monumental work (which in fact, it is), it’s also a very educational journey that will give us full intuition of what is actually happening when we call Stan or your favorite Bayesian sample software (that uses HMC behind scenes).</p>
<p>So buckle up! And let’s go for a very math and nerdy ride! Warning: the following sections are very technical and dense in terms of notation, which might be hard to follow. I’ll do my best to explain each step of the way the rationale and the manual derivations steps so you can follow along.</p>
</section>
</section>
<section id="data-generation-process" class="level1">
<h1>Data Generation Process</h1>
<p>Let’s assume that the observed RRi signal (<img src="https://latex.codecogs.com/png.latex?y_i">) comes from a Gaussian distribution (as the data generation process), centered around the true signal <img src="https://latex.codecogs.com/png.latex?M"> with variance <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2">. This can be denoted as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ay_i%20%5Csim%20%5Cmathcal%7BN%7D(M,%20%5Csigma%5E2)%0A"></p>
<p>However, we assume that this true signal <img src="https://latex.codecogs.com/png.latex?M"> comes from our model <img src="https://latex.codecogs.com/png.latex?f(t%20%5Cmid%20%5Ctheta_k)">.</p>
<p>So let <img src="https://latex.codecogs.com/png.latex?M:%20f(t%20%5Cmid%20%5Ctheta_k)">, with <img src="https://latex.codecogs.com/png.latex?k%20%5Cin%20%5C%7B%5Calpha,%20%5Cbeta,%20c,%20%5Clambda,%20%5Cphi,%20%5Ctau,%20%5Cdelta%5C%7D">, the parameters that control the output of our true signal <img src="https://latex.codecogs.com/png.latex?M">. Where:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t%20%5Cmid%20%5Ctheta_k)%20=%20%5Calpha%20+%20%5Cfrac%7B%5Cbeta%7D%7B1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%20%20-%20%5Cfrac%7Bc%5Cbeta%7D%7B1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%0A"></p>
<p>However, we need to estimate the parameters of the data generation process (<img src="https://latex.codecogs.com/png.latex?%5Ctheta_k">), in order to be able to reproduce the observed data.</p>
</section>
<section id="arriving-to-the-log-likelihood" class="level1">
<h1>Arriving to the Log Likelihood</h1>
<p>Remember that we assumed that the data generation process came from a Gaussian distribution. Thus, lets consider that the Gaussian probability function has this form:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BN%7D_%5Ctext%7Bpdf%7D(y%20%5Cmid%20M,%20%5Csigma%5E2)%20=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%5Csigma%5E2%7D%7D%20%5Ccdot%20e%5E%7B-%5Cfrac%7B(y%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%0A"></p>
<p>So, the likelihood for a set of data points would have the following form:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AL(y_i%20%5Cmid%20M,%20%5Csigma%5E2)%20=%20%5Cprod_%7Bi%20=%201%7D%5E%7BN%7D%7B%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%5Csigma%5E2%7D%7D%20%5Ccdot%20e%5E%7B-%5Cfrac%7B(y_i%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%7D%0A"></p>
<p>But for computational efficiency and stability, we work with logarithms (given the very small probabilities we are computing). Hence, the logarithm of our likelihood would look like the following:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clog%20L(y_i%20%5Cmid%20M,%20%5Csigma%5E2)%20=%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%5Clog%5Cleft(%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%5Csigma%5E2%7D%7D%5Cright)%20+%20%5Clog%5Cleft(e%5E%7B-%5Cfrac%7B(y_i%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%5Cright)%7D%0A"></p>
<p>where we can simplify the first term by the quotient rule and the second one by canceling the euler (given that <img src="https://latex.codecogs.com/png.latex?%5Clog(e%5Ex)%20=%20x">) term:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clog%20L(y_i%20%5Cmid%20M,%20%5Csigma%5E2)%20=%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%5Clog(1)%20-%20%5Clog(%5Csqrt%7B2%5Cpi%5Csigma%5E2%7D)%20-%20%5Cfrac%7B(y_i%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%0A"></p>
<p>which can be further simplified by solving <img src="https://latex.codecogs.com/png.latex?%5Clog(1)%20=%200"> and applying the power rule to the square root inside the log using <img src="https://latex.codecogs.com/png.latex?%5Clog((2%5Cpi%5Csigma%5E2)%5E%5Cfrac%7B1%7D%7B2%7D)"> which comes out of the log term:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clog%20L(y_i%20%5Cmid%20M,%20%5Csigma%5E2)%20=%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B-%5Cfrac%7B1%7D%7B2%7D%20%5Clog(2%5Cpi%5Csigma%5E2)%20-%20%5Cfrac%7B(y_i%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%0A"></p>
<p>Now we can solve the summation symbolically for the first term and leave it only on the variable term, leaving with our final log likelihood gaussian function:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clog%20L(y_i%20%5Cmid%20M,%20%5Csigma%5E2)%20=%20-%5Cfrac%7BN%7D%7B2%7D%20%5Clog(2%5Cpi%5Csigma%5E2)%20-%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%5Cfrac%7B(y_i%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%0A"></p>
<p>And like this, we reach the final form for our likelihood function</p>
</section>
<section id="estimating-the-gradient-of-the-function" class="level1">
<h1>Estimating the Gradient of the Function</h1>
<section id="with-respect-to-m" class="level3">
<h3 class="anchored" data-anchor-id="with-respect-to-m">With Respect to <img src="https://latex.codecogs.com/png.latex?M"></h3>
<p>To estimate the gradient of our log likelihood function, we need to derive it with respect to each parameter term. Let’s start by solving for <img src="https://latex.codecogs.com/png.latex?M">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20M%7D%20%5Cleft(%20-%5Cfrac%7BN%7D%7B2%7D%20%5Clog(2%5Cpi%5Csigma%5E2)%20-%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%5Cfrac%7B(y_i%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%20%5Cright)%0A"></p>
<p>Here, we see that the first term does not contain <img src="https://latex.codecogs.com/png.latex?M">, so we can drop it from our calculations, leaving this expression:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20M%7D%20%5Cleft(%20-%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%5Cfrac%7B(y_i%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%20%5Cright)%0A"></p>
<p>Here, we can remove out of the denominator the term <img src="https://latex.codecogs.com/png.latex?2%5Csigma%5E2"> like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20M%7D%20%5Cleft(%20-%20%5Cfrac%7B1%7D%7B2%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%5E2%7D%20%5Cright)%0A"></p>
<p>And now we apply the chain rule, where we derive the exponent and then the <img src="https://latex.codecogs.com/png.latex?M"> term. So it would look like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20M%7D%20=%20-%20%5Cfrac%7B1%7D%7B2%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(2)(y_i%20-%20M)(-%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Ctheta_k%7D)%7D%0A"></p>
<p>Remember that <img src="https://latex.codecogs.com/png.latex?M"> its a function with multiple parameters (<img src="https://latex.codecogs.com/png.latex?k"> parameters), so “deriving <img src="https://latex.codecogs.com/png.latex?M">” actually means taking the partial derivative of the function with respect to each parameter <img src="https://latex.codecogs.com/png.latex?%5Ctheta_k">, also preserving the sign inside the parenthesis.</p>
<p>So by passing the 2 out the summation, we can cancel the 2 in the outside denominator by <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B2%7D%7B2%5Csigma%5E2%7D%20=%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D"> and passing the negative sign in the partial derivative we can cancel the negative sign at the beginning of the function. So the whole expression would end up like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20M%7D%20=%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Ctheta_k%7D%7D%0A"></p>
</section>
<section id="with-respect-to-sigma" class="level3">
<h3 class="anchored" data-anchor-id="with-respect-to-sigma">With Respect to <img src="https://latex.codecogs.com/png.latex?sigma"></h3>
<p>Now to solve for <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%5E2%7D"> let’s remember where were we with the derived log likelihood:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D%20%5Cleft(%20-%5Cfrac%7BN%7D%7B2%7D%20%5Clog(2%5Cpi%5Csigma%5E2)%20-%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%5Cfrac%7B(y_i%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%20%5Cright)%0A"></p>
<p>Here, let’s start with the first term, and remember that the <img src="https://latex.codecogs.com/png.latex?-%5Cfrac%7BN%7D%7B2%7D"> is multiplying the log term. We need to have this present given that we want to pull the <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2"> out of the log term, but in order to do so, we need to also distribute the <img src="https://latex.codecogs.com/png.latex?-%5Cfrac%7BN%7D%7B2%7D"> term with it, leaving it this way:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D%20%5Cleft(%20-%5Cfrac%7BN%7D%7B2%7D%20%5Clog(2%5Cpi)%20-%5Cfrac%7BN%7D%7B2%7D%20%5Clog(%5Csigma%5E2)%20-%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%5Cfrac%7B(y_i%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%20%5Cright)%0A"></p>
<p>And now, we can discard the first term given it doesn’t contain our target parameter <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2">, leaving us with:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D%20%5Cleft(%20-%5Cfrac%7BN%7D%7B2%7D%20%5Clog(%5Csigma%5E2)%20-%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%5Cfrac%7B(y_i%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%20%5Cright)%0A"></p>
<p>And by applying the power rule, we can pull out of the log term the square term out of the log, leaving the term <img src="https://latex.codecogs.com/png.latex?-%5Cfrac%7B2N%7D%7B2%7D"> canceling out the 2 like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D%20%5Cleft(%20-N%20%5Clog(%5Csigma)%20-%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%5Cfrac%7B(y_i%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%20%5Cright)%0A"></p>
<p>Additionally and for convenience, let’s pull the <img src="https://latex.codecogs.com/png.latex?2%5Csigma%5E2"> out of the denominator and let’s call <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%20(y_i%20-%20M)%5E2%20=%20S"> for ease of notation. Additionally, let’s express the <img src="https://latex.codecogs.com/png.latex?sigma%5E2"> with negative exponent for clarity when we derive:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D%20%5Cleft(%20-N%20%5Clog(%5Csigma)%20-%20%5Cfrac%7B%5Csigma%5E%7B-2%7D%7D%7B2%7D%20S%20%5Cright)%0A"></p>
<p>And finally, let’s derive this bad boy. For the first term, the derivative of any log is the inverse of the term, so our <img src="https://latex.codecogs.com/png.latex?%5Clog(%5Csigma)%20%5Crightarrow%20%5Cfrac%7B1%7D%7B%5Csigma%7D">. And in our second term, we cancel out the 2 by pulling out the -2 from the exponent, leaving <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E%7B-2%7D"> as <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E%7B-3%7D">. This whole show will look like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D%20=%20-%5Cfrac%7BN%7D%7B%5Csigma%7D%20+%20%5Cfrac%7B1%7D%7B%5Csigma%5E3%7D%20S%0A"></p>
<p>Which can be expressed as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D%20=%20-%5Cfrac%7BN%7D%7B%5Csigma%7D%20+%20%5Cfrac%7B1%7D%7B%5Csigma%5E3%7D%20%5Csum_%7Bi=1%7D%5E%7BN%7D%7B(y_i%20-%20M)%5E2%7D%0A"></p>
<p>And this conclude our gradient estimation section for our log likelihood function. These functions can be further used to estimate the gradient and update the parameters when using gradient-based methods to explore the parameter space, like Hamiltonian Monte Carlo methods.</p>
<p>Up next, we’ll calculate analytically the partial derivatives of the Castillo-Aguilar RRi-vs-time model.</p>
</section>
</section>
<section id="estimation-of-rri-vs-time-gradient" class="level1">
<h1>Estimation of RRi-vs-Time Gradient</h1>
<p>Let’s recall our original target function:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t%20%5Cmid%20%5Ctheta_k)%20=%20%5Calpha%20+%20%5Cfrac%7B%5Cbeta%7D%7B1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%20%20-%20%5Cfrac%7Bc%5Cbeta%7D%7B1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%0A"></p>
<p>So the gradient of this function <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20f(t%20%5Cmid%20%5Ctheta_k)"> would be a column vector of partial derivatives with the following form:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%20f(t%20%5Cmid%20%5Ctheta_k)%20=%0A%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Calpha%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cbeta%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20c%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Clambda%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cphi%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Ctau%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cdelta%7D%0A%20%20%5Cend%7Bbmatrix%7D%0A"></p>
<p>But in order to produce this beauty, we need to derive each term separately. And you know the saying: every journey begins with a single step, let’s go!</p>
<section id="deriving-the-rri-vs-time-equations" class="level3">
<h3 class="anchored" data-anchor-id="deriving-the-rri-vs-time-equations">Deriving the RRi-vs-Time Equations</h3>
<p><strong>Deriving the alpha (<img src="https://latex.codecogs.com/png.latex?%5Calpha">) parameter</strong></p>
<p>Lucky for us, this is the easiest of the seven model parameters, given that it is a constant, it is not being transformed in any way. For this reason its derivative is just 1 (because the derivative of any constant is 1).</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Calpha%7D%20=%201%0A"></p>
<p><strong>Deriving the beta (<img src="https://latex.codecogs.com/png.latex?%5Cbeta">) parameter</strong></p>
<p>The beta parameter is present on both logistic functions. However it is on the top position, so we can derive it while mantaining the rest of the parameters constant and dropping the ones where the term <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> is not used like <img src="https://latex.codecogs.com/png.latex?%5Calpha">, like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cbeta%7D%20=%20%5Cfrac%7B1%7D%7B1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%20%20-%20%5Cfrac%7Bc%7D%7B1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%0A"></p>
<p><strong>Deriving the <img src="https://latex.codecogs.com/png.latex?c"> parameter</strong></p>
<p>The derivation of <img src="https://latex.codecogs.com/png.latex?c"> is relatively trivial given that it only appears on the numerator of the recovery logistic function. So the final derivative form would look like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20c%7D%20=%20%20-%20%5Cfrac%7B%5Cbeta%7D%7B1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%0A"></p>
<p><strong>Deriving the lambda (<img src="https://latex.codecogs.com/png.latex?%5Clambda">) parameter</strong></p>
<p>Here is where it gets more difficult. Given that <img src="https://latex.codecogs.com/png.latex?%5Clambda"> appears on the exponent we need to apply the chain rule plus some additional calculus. However, we can use a shortcut here. For any function in the form of <img src="https://latex.codecogs.com/png.latex?f(x)%20=%20%5Cfrac%7BA%7D%7Bg(x)%7D"> it’s derivative ends up being <img src="https://latex.codecogs.com/png.latex?f'(x)%20=%20-A%20%5Cfrac%7Bg'(x)%7D%7Bg(x)%5E2%7D">.</p>
<p>Let’s recall the part of the function that contains <img src="https://latex.codecogs.com/png.latex?%5Clambda">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cbeta%7D%7B1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%0A"></p>
<p>Here, we can assume that <img src="https://latex.codecogs.com/png.latex?1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D"> correspond to the <img src="https://latex.codecogs.com/png.latex?g(x)"> we previusly mentioned. With this being said, the derivative of <img src="https://latex.codecogs.com/png.latex?g(x)%20=%201%20+%20e%5E%7Bx%20(t%20-%20%5Ctau)%7D"> with respect to <img src="https://latex.codecogs.com/png.latex?x"> would be <img src="https://latex.codecogs.com/png.latex?(t%20-%20%5Ctau)%20e%5E%7Bx%20(t%20-%20%5Ctau)%7D">. Consequently, applying the aforementioned transformations to our original equation, the function would have the following form:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Clambda%7D%20=%20-%5Cbeta%20%5Cfrac%7B(t%20-%20%5Ctau)%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%7B(1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D)%5E2%7D%0A"></p>
<p>which can be further rearranged as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Clambda%7D%20=%20-%5Cbeta%20(t%20-%20%5Ctau)%20%5Cfrac%7Be%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%7B(1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D)%5E2%7D%0A"></p>
<p><strong>Deriving the phi (<img src="https://latex.codecogs.com/png.latex?%5Cphi">) parameter</strong></p>
<p>Here, we apply the same logic to the one we used earlier for <img src="https://latex.codecogs.com/png.latex?%5Clambda">. So the functional form would be:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cphi%7D%20=%20c%5Cbeta%20%5Cfrac%7B(t%20-%20%5Ctau%20-%20%5Cdelta)%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%7B(1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D)%5E2%7D%0A"></p>
<p>which can be further rearranged into:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cphi%7D%20=%20c%5Cbeta(t%20-%20%5Ctau%20-%20%5Cdelta)%20%5Cfrac%7Be%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%7B(1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D)%5E2%7D%0A"></p>
<p><strong>Deriving the tau (<img src="https://latex.codecogs.com/png.latex?%5Ctau">) parameter</strong></p>
<p>For <img src="https://latex.codecogs.com/png.latex?%5Ctau"> things gets complicated. This is because this parameter is present in both logistic components (exercise-induced decay and recovery components). So we need to apply our same trick, but instead of pulling the time-specific segment of the exponent, we need to pull the rate component in the exponent. Let’s recall the components of the function that contains the <img src="https://latex.codecogs.com/png.latex?%5Ctau"> parameters:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cunderbrace%7B%5Cfrac%7B%5Cbeta%7D%7B1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%7D_%7B%5Ctext%7BExercise%7D%7D%20-%20%5Cunderbrace%7B%5Cfrac%7Bc%5Cbeta%7D%7B1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%7D_%7B%5Ctext%7BRecovery%7D%7D%0A"></p>
<p>So the derivative form (applying our previous derivation rule) would be the following:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Ctau%7D%20=%20%5Cunderbrace%7B-%5Cbeta%20%5Cfrac%7B-%5Clambda%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%7B(1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D)%5E2%7D%7D_%7B%5Ctext%7BExercise%7D%7D%20-%20%5Cunderbrace%7B(-c%5Cbeta)%20%5Cfrac%7B-%5Cphi%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%7B(1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D)%5E2%7D%7D_%7B%5Ctext%7BRecovery%7D%7D%0A"></p>
<p>Note that the negative sign in the pulled rate parameter is propagated from the negative sign in the <img src="https://latex.codecogs.com/png.latex?%5Ctau"> parameter. Rearrenging the signs and the numerators, the final form would be:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Ctau%7D%20=%0A%5Cbeta%20%5Clambda%20%5Cfrac%7Be%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%7B(1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D)%5E2%7D%20-%20c%20%5Cbeta%20%5Cphi%20%5Cfrac%7Be%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%7B(1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D)%5E2%7D%0A"></p>
<p><strong>Deriving the delta (<img src="https://latex.codecogs.com/png.latex?%5Cdelta">) parameter</strong></p>
<p>For the <img src="https://latex.codecogs.com/png.latex?%5Cdelta"> parameter, the final product is similar for <img src="https://latex.codecogs.com/png.latex?%5Ctau">. This, in the sense that the final form is similar in the recovery function, given that its relation with the rate parameter <img src="https://latex.codecogs.com/png.latex?%5Cphi"> is conserved with respect to <img src="https://latex.codecogs.com/png.latex?%5Ctau">. That is why, we obtain the same form for that side of the equation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cdelta%7D%20=%20-c%20%5Cbeta%20%5Cphi%20%5Cfrac%7Be%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%7B(1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D)%5E2%7D%0A"></p>
<p>There we have it! Now the final gradient of our function (by taking the whole equations) would be something like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%20f(t%20%5Cmid%20%5Ctheta_k)%20=%0A%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Calpha%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cbeta%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20c%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Clambda%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cphi%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Ctau%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cdelta%7D%0A%20%20%5Cend%7Bbmatrix%7D%20=%0A%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%201%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%20%20-%20%5Cfrac%7Bc%7D%7B1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%20%5C%5C%0A%20%20%20%20-%20%5Cfrac%7B%5Cbeta%7D%7B1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%20%5C%5C%0A%20%20%20%20-%5Cbeta%20%5Cfrac%7B(t%20-%20%5Ctau)%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%7B(1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D)%5E2%7D%20%5C%5C%0A%20%20%20%20c%5Cbeta(t%20-%20%5Ctau%20-%20%5Cdelta)%20%5Cfrac%7Be%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%7B(1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D)%5E2%7D%20%5C%5C%0A%20%20%20%20%5Cbeta%20%5Clambda%20%5Cfrac%7Be%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%7B(1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D)%5E2%7D%20-%20c%20%5Cbeta%20%5Cphi%20%5Cfrac%7Be%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%7B(1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D)%5E2%7D%20%20%5C%5C%0A%20%20%20%20-c%20%5Cbeta%20%5Cphi%20%5Cfrac%7Be%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%7B(1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D)%5E2%7D%0A%20%20%5Cend%7Bbmatrix%7D%0A"></p>
<p>And this monstruosity is the whole gradient of our RRi-vs-time model, which as you can see, is a vector of partial derivatives that describe the change in the function value with respect a change in the parameter being derived (i.e., a measure of how sensitive is).</p>
</section>
</section>
<section id="expansion-of-the-gradient-of-log-l" class="level1 page-columns page-full">
<h1>Expansion of the Gradient of <img src="https://latex.codecogs.com/png.latex?%5Clog%20L"></h1>
<p>Now we have all the necessary tools to compute the gradient of the log likelihood function, which remember, involves not only the parameters of <img src="https://latex.codecogs.com/png.latex?M">, but also the <img src="https://latex.codecogs.com/png.latex?%5Csigma"> parameter. The gradient of this function will update the momentum <img src="https://latex.codecogs.com/png.latex?p"> of the imaginary particle, that then will update the position coordinates of this particle, which itself correspond to the values we’re trying to estimate.</p>
<p>To honor Hamilton’s memory, we’ll refer to the gradient of the log likelihood as <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20U(q)">, given that the “position” parameter <img src="https://latex.codecogs.com/png.latex?q"> under the Hamiltonian framework are the parameter values (which work as coordinates in the parameter space), and the gradient of the log likelihood (<img src="https://latex.codecogs.com/png.latex?%5Cnabla%20U(q)">) will give us the updated momentum <img src="https://latex.codecogs.com/png.latex?p"> to then, update our parameter coordinates <img src="https://latex.codecogs.com/png.latex?q">.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Terminology Clarification
</div>
</div>
<div class="callout-body-container callout-body">
<p>However, its important to considerate that in Hamiltonian Monte Carlo (HMC), the <strong>potential energy</strong> is defined as <img src="https://latex.codecogs.com/png.latex?U(q)%20=%20-%5Clog%20L(q)%20-%20%5Clog%20%5Ctext%7Bprior%7D(q)">. Here, we focus on the gradient of the log-likelihood <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20%5Clog%20L(q)"> for simplicity (assuming uniform priors). For non-uniform priors, <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20U(q)%20=%20-%5Cnabla%20%5Clog%20L(q)%20-%20%5Cnabla%20%5Clog%20%5Ctext%7Bprior%7D(q)">.</p>
</div>
</div>
<p>Let’s recall our derived (log) likelihood function with respect to <img src="https://latex.codecogs.com/png.latex?M"> (<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20M%7D">):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20M%7D%20=%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Ctheta_k%7D%7D%0A"></p>
<p>And with respect to <img src="https://latex.codecogs.com/png.latex?%5Csigma"> (<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D">):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D%20=%20-%5Cfrac%7BN%7D%7B%5Csigma%7D%20+%20%5Cfrac%7B1%7D%7B%5Csigma%5E3%7D%20%5Csum_%7Bi=1%7D%5E%7BN%7D%7B(y_i%20-%20M)%5E2%7D%0A"></p>
<p>So our gradient function would look like something like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%20U(q)%20=%0A-%5Cnabla%20%5Clog%20L(q)%20=%0A%20%20-%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20M%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D%0A%20%20%5Cend%7Bbmatrix%7D%20=%0A%20%20-%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Ctheta_k%7D%7D%20%5C%5C%0A%20%20%20%20-%5Cfrac%7BN%7D%7B%5Csigma%7D%20+%20%5Cfrac%7B1%7D%7B%5Csigma%5E3%7D%20%5Csum_%7Bi=1%7D%5E%7BN%7D%7B(y_i%20-%20M)%5E2%7D%0A%20%20%5Cend%7Bbmatrix%7D%0A"></p>
<div class="page-columns page-full"><p>But recall that <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Ctheta_k%7D"> is the partial derivative of the model <img src="https://latex.codecogs.com/png.latex?M"> with respecto to each parameter value <img src="https://latex.codecogs.com/png.latex?%5Ctheta_k">, so <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20M%7D"> can be expanded with respect to each parameter value using the elements of the gradient of our RRi-vs-time model <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20f(t%20%5Cmid%20%5Ctheta_k)">. By incorporating these changes into <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20U(q)"> the result is the following: </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Please note that here I use <img src="https://latex.codecogs.com/png.latex?M"> as a shorthand for <img src="https://latex.codecogs.com/png.latex?f(t%20%5Cmid%20%5Ctheta_k)"> (as indicated at the beginning of the math section). So plase consider that when I refer to <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Ctheta_k%7D"> is equivalent to <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Ctheta_k%7D"></span></div></div>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%20U(q)%20=%0A-%5Cnabla%20%5Clog%20L(q)%20=%0A%20%20-%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Calpha%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Cbeta%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20c%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Clambda%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Cphi%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Ctau%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Cdelta%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D%0A%20%20%5Cend%7Bbmatrix%7D%20=%0A%20%20-%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Calpha%7D%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Cbeta%7D%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20c%7D%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Clambda%7D%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Cphi%7D%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Ctau%7D%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Cdelta%7D%7D%20%5C%5C%0A%20%20%20%20-%5Cfrac%7BN%7D%7B%5Csigma%7D%20+%20%5Cfrac%7B1%7D%7B%5Csigma%5E3%7D%20%5Csum_%7Bi=1%7D%5E%7BN%7D%7B(y_i%20-%20M)%5E2%7D%0A%20%20%5Cend%7Bbmatrix%7D%0A"></p>
<p>This is the cherry and cream on the top of gradient-based estimation methods, because with this gradient function we can now compute the slope of this probability landscape and ride it without problems. Now the next challenge is transforming the hand-derived equations into a valid R code that will actually be useful to estimate anything.</p>
</section>
<section id="translating-math-into-code" class="level1 page-columns page-full">
<h1>Translating Math Into Code</h1>
<p>Okay, after almost igniting the latex out of my keyboard, now we’ll have to pull these fancy equations into an efficient set of functions in R that will be able to actually do something. This “something” will be estimating the gradient of the surface where this particle is in space (using <img src="https://latex.codecogs.com/png.latex?-%5Cnabla%20U(q)">) and updating its position <img src="https://latex.codecogs.com/png.latex?q"> by leveraging momentum <img src="https://latex.codecogs.com/png.latex?p"> to carry us away, sliding over higher probability landscapes.</p>
<p>We’ll start simple. First we will implement the Castillo-Aguilar Equation (the RRi-vs-Time model) in order to accept an input vector as time and a named list of parameter values. This will serve our purpose when we need to compute the predicted RRi values, to then compute the residuals for the log likelihood and bla bla bla (i.e., what we already have been discussing so far).</p>
<p>Let’s recall what is the function we’ll implement in R code:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t%20%5Cmid%20%5Ctheta_k)%20=%20%5Calpha%20+%20%5Cfrac%7B%5Cbeta%7D%7B1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%20%20-%20%5Cfrac%7Bc%5Cbeta%7D%7B1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%20%5C%5C%0A%5Ctext%7Bwhere:%7D~k%5Cin%5C%7B%5Calpha,%5Cbeta,c,%5Clambda,%5Cphi,%5Ctau,%5Cdelta%5C%7D%0A"></p>
<p>Where <img src="https://latex.codecogs.com/png.latex?t"> will be the time vector and <img src="https://latex.codecogs.com/png.latex?%5Ctheta_k"> the list of parameters. Let’s see how this turns out!</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ==============================================</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. RRi Model (Castillo-Aguilar Equation)</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ==============================================</span></span>
<span id="cb1-4">rr_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(t, params) {</span>
<span id="cb1-5">  alpha <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha</span>
<span id="cb1-6">  beta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>beta</span>
<span id="cb1-7">  c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>c</span>
<span id="cb1-8">  lambda <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lambda</span>
<span id="cb1-9">  phi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>phi</span>
<span id="cb1-10">  tau <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>tau</span>
<span id="cb1-11">  delta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>delta</span>
<span id="cb1-12">  </span>
<span id="cb1-13">  term2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (t <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> tau)))</span>
<span id="cb1-14">  term3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> beta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (t <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> tau <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> delta)))</span>
<span id="cb1-15">  alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> term2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> term3</span>
<span id="cb1-16">}</span></code></pre></div>
</details>
</div>
<p>Now let’s ensure ourselves that this code is actually working. We’ll simulate some rest-exercise-rest dynamics using our function and then visualize it using <code>ggplot2</code> package:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Time vector</span></span>
<span id="cb2-2">t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>) </span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># list with RRi parameters</span></span>
<span id="cb2-5">params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beta =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">c =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,</span>
<span id="cb2-6">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">phi =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb2-7">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tau =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># list with parameters for SD dynacmis of RRi over time</span></span>
<span id="cb2-10">params_sd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beta =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">c =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>,</span>
<span id="cb2-11">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">phi =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, </span>
<span id="cb2-12">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tau =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-13"></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate the "true" (smooth) RRi curve</span></span>
<span id="cb2-15">y_true <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rr_model</span>(t, params)</span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># And the fluctuations for RRi SD over time</span></span>
<span id="cb2-17">y_sd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rr_model</span>(t, params_sd)</span>
<span id="cb2-18"></span>
<span id="cb2-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># And simulate the observed RRi signal</span></span>
<span id="cb2-20">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y_true <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(t), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> y_sd)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(t, y), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(t, y_true), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(t, y_true <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_sd), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(t, y_true <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_sd), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rest"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">650</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exercise"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">750</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Recovery"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">650</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RRi (ms)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (min)"</span>, </span>
<span id="cb2-32">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exercise-Induced RRi Dynamics"</span>,</span>
<span id="cb2-33">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cardiac Autonomic Modulation"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-4-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://bayesically-speaking.com/posts/2025-04-19 heartbeats-pdes-and-other-tales/index_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>So as you can see, we can model not only a time-varying RRi, but also, we can simulate the variations in the standard deviation of RRi over time. See how the dispersion changes from rest, exercise and recovery around the true curve and the observed RRi curve.</p>
<p>Cool! now we have to implement the log likelihood function, which is the function that will give us the probability (in log scale) of the current parameter values on this parameter space, which will inform us if we are going into a place of greater probability (or not). Let’s recall the equation we arrived earlier:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clog%20L(y_i%20%5Cmid%20M,%20%5Csigma%5E2)%20=%20-%5Cfrac%7BN%7D%7B2%7D%20%5Clog(2%5Cpi%5Csigma%5E2)%20-%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%5Cfrac%7B(y_i%20-%20M)%5E2%7D%7B2%5Csigma%5E2%7D%7D%0A"></p>
<p>Let’s go implementing this bad boy as a function in R:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ==============================================</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Gaussian Log-Likelihood</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ==============================================</span></span>
<span id="cb3-4">log_likelihood <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(y, t, params, sigma) {</span>
<span id="cb3-5">  M <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rr_model</span>(t, params)</span>
<span id="cb3-6">  residuals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> M</span>
<span id="cb3-7">  N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(residuals)</span>
<span id="cb3-8">  sigma_squared <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sigma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-9">  </span>
<span id="cb3-10">  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>N<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma_squared) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(residuals<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma_squared)</span>
<span id="cb3-11">}</span></code></pre></div>
</details>
</div>
<p>Now let’s see if we can visualize something using this function:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Same parameters as before</span></span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Observed signal</span></span>
<span id="cb4-4">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y_true <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(t), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Input parameters</span></span>
<span id="cb4-7">param_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand.grid</span>(</span>
<span id="cb4-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">710</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">890</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>),</span>
<span id="cb4-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">c =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb4-10">)</span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute log likelihood</span></span>
<span id="cb4-13">param_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>log_likelihood <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb4-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(param_data, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb4-15">    new_params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">within</span>(params, {</span>
<span id="cb4-16">      alpha <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alpha"</span>]];</span>
<span id="cb4-17">      c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>]]</span>
<span id="cb4-18">    }) </span>
<span id="cb4-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_likelihood</span>(y, t, new_params, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb4-20">  })</span>
<span id="cb4-21"></span>
<span id="cb4-22">param_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.table</span>(param_data)</span>
<span id="cb4-23"></span>
<span id="cb4-24"></span>
<span id="cb4-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get unique alpha and c values for axes</span></span>
<span id="cb4-26">z_vals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dcast</span>(param_data, alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> c, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value.var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log_likelihood"</span>)[,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb4-27">alpha_vals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(param_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha)</span>
<span id="cb4-28">c_vals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(param_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>c)</span>
<span id="cb4-29"></span>
<span id="cb4-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the 3D surface plot</span></span>
<span id="cb4-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(plotly)</span>
<span id="cb4-32"></span>
<span id="cb4-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_ly</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_trace</span>(</span>
<span id="cb4-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> c_vals,</span>
<span id="cb4-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> alpha_vals,</span>
<span id="cb4-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z_vals,</span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"surface"</span>,</span>
<span id="cb4-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colorscale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Viridis"</span>,</span>
<span id="cb4-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showscale =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb4-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layout</span>(</span>
<span id="cb4-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scene =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb4-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xaxis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C (Recovery proportion)"</span>),</span>
<span id="cb4-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yaxis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Alpha parameter"</span>),</span>
<span id="cb4-46">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">zaxis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log-Likelihood"</span>),</span>
<span id="cb4-47">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">camera =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eye =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span>
<span id="cb4-48">    ),</span>
<span id="cb4-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log-Likelihood Landscape for alpha and c Parameters"</span></span>
<span id="cb4-50">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-e49a6ce21ae95c8ceb36" style="width:100%;height:454px;"></div>
<script type="application/json" data-for="htmlwidget-e49a6ce21ae95c8ceb36">{"x":{"visdat":{"feb0127afac8":["function () ","plotlyVisDat"]},"cur_data":"feb0127afac8","attrs":{"feb0127afac8":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0.29999999999999999,0.31212121212121213,0.32424242424242422,0.33636363636363636,0.34848484848484845,0.3606060606060606,0.37272727272727268,0.38484848484848483,0.39696969696969697,0.40909090909090906,0.4212121212121212,0.43333333333333335,0.44545454545454544,0.45757575757575752,0.46969696969696972,0.48181818181818181,0.4939393939393939,0.5060606060606061,0.51818181818181819,0.53030303030303028,0.54242424242424248,0.55454545454545445,0.56666666666666665,0.57878787878787885,0.59090909090909083,0.60303030303030303,0.61515151515151512,0.6272727272727272,0.6393939393939394,0.65151515151515149,0.66363636363636358,0.67575757575757578,0.68787878787878787,0.69999999999999996,0.71212121212121215,0.72424242424242424,0.73636363636363633,0.74848484848484853,0.76060606060606062,0.77272727272727271,0.78484848484848491,0.79696969696969688,0.80909090909090908,0.82121212121212128,0.83333333333333326,0.84545454545454546,0.85757575757575766,0.86969696969696964,0.88181818181818183,0.89393939393939403,0.90606060606060601,0.91818181818181821,0.93030303030303019,0.94242424242424239,0.95454545454545459,0.96666666666666656,0.97878787878787876,0.99090909090909096,1.0030303030303029,1.0151515151515151,1.0272727272727273,1.0393939393939393,1.0515151515151515,1.0636363636363637,1.0757575757575757,1.0878787878787879,1.1000000000000001,1.1121212121212121,1.1242424242424243,1.1363636363636362,1.1484848484848484,1.1606060606060606,1.1727272727272726,1.1848484848484848,1.196969696969697,1.209090909090909,1.2212121212121212,1.2333333333333334,1.2454545454545454,1.2575757575757576,1.2696969696969698,1.2818181818181817,1.2939393939393939,1.3060606060606061,1.3181818181818181,1.3303030303030303,1.3424242424242425,1.3545454545454545,1.3666666666666667,1.3787878787878789,1.3909090909090909,1.4030303030303031,1.4151515151515153,1.4272727272727272,1.4393939393939394,1.4515151515151516,1.4636363636363636,1.4757575757575758,1.487878787878788,1.5],"y":[710,711.81818181818187,713.63636363636363,715.4545454545455,717.27272727272725,719.09090909090912,720.90909090909088,722.72727272727275,724.5454545454545,726.36363636363637,728.18181818181813,730,731.81818181818187,733.63636363636363,735.4545454545455,737.27272727272725,739.09090909090912,740.90909090909088,742.72727272727275,744.5454545454545,746.36363636363637,748.18181818181813,750,751.81818181818187,753.63636363636363,755.4545454545455,757.27272727272725,759.09090909090912,760.90909090909088,762.72727272727275,764.5454545454545,766.36363636363637,768.18181818181813,770,771.81818181818176,773.63636363636363,775.4545454545455,777.27272727272725,779.09090909090912,780.90909090909088,782.72727272727275,784.5454545454545,786.36363636363637,788.18181818181813,790,791.81818181818176,793.63636363636363,795.4545454545455,797.27272727272725,799.09090909090912,800.90909090909088,802.72727272727275,804.5454545454545,806.36363636363637,808.18181818181813,810,811.81818181818176,813.63636363636363,815.4545454545455,817.27272727272725,819.09090909090912,820.90909090909088,822.72727272727275,824.5454545454545,826.36363636363637,828.18181818181813,830,831.81818181818176,833.63636363636363,835.4545454545455,837.27272727272725,839.09090909090912,840.90909090909088,842.72727272727275,844.5454545454545,846.36363636363637,848.18181818181824,850,851.81818181818176,853.63636363636363,855.4545454545455,857.27272727272725,859.09090909090912,860.90909090909088,862.72727272727275,864.5454545454545,866.36363636363637,868.18181818181824,870,871.81818181818176,873.63636363636363,875.4545454545455,877.27272727272725,879.09090909090912,880.90909090909088,882.72727272727275,884.5454545454545,886.36363636363637,888.18181818181824,890],"z":[[-56475.449577156316,-55340.334020657909,-54220.111174724501,-53114.781039356145,-52024.343614552825,-50948.798900314643,-49888.146896641498,-48842.387603533331,-47811.521020990287,-46795.547149012258,-45794.465987599346,-44808.27753675144,-43836.981796468572,-42880.578766750805,-41939.068447598067,-41012.450839010351,-40100.725940987693,-39203.893753530159,-38321.954276637611,-37454.907510310135,-36602.753454547696,-35765.492109350285,-34943.123474717984,-34135.647550650734,-33343.064337148513,-32565.373834211343,-31802.576041839253,-31054.670960032199,-30321.658588790182,-29603.53892811323,-28900.311978001315,-28211.977738454472,-27538.536209472688,-26879.987391055955,-26236.331283204265,-25607.56788591767,-24993.69719919606,-24394.719223039523,-23810.633957448066,-23241.44140242166,-22687.141557960276,-22147.734424063987,-21623.220000732697,-21113.598287966473,-20618.869285765337,-20139.032994129233,-19674.089413058166,-19224.038542552189,-18788.880382611242,-18368.614933235342,-17963.242194424482,-17572.762166178742,-17197.174848497994,-16836.480241382305,-16490.678344831682,-16159.769158846122,-15843.752683425584,-15542.62891857013,-15256.397864279697,-14985.059520554345,-14728.613887394033,-14487.060964798786,-14260.400752768577,-14048.633251303429,-13851.758460403329,-13669.776380068275,-13502.687010298279,-13350.490351093345,-13213.186402453492,-13090.775164378647,-12983.256636868862,-12890.63081992413,-12812.897713544469,-12750.057317729828,-12702.109632480271,-12669.05465779577,-12650.892393676295,-12647.622840121876,-12659.245997132533,-12685.76186470824,-12727.170442848988,-12783.471731554775,-12854.665730825636,-12940.752440661539,-13041.73186106251,-13157.603992028538,-13288.368833559587,-13434.026385655718,-13594.576648316886,-13770.019621543113,-13960.355305334389,-14165.583699690711,-14385.704804612111,-14620.718620098545,-14870.625146150047,-15135.424382766589,-15415.116329948192,-15709.700987694821,-16019.178356006538,-16343.54843488328],[-55581.664037372109,-54454.821244598097,-53342.871162389209,-52245.813790745233,-51163.649129666381,-50096.377179152601,-49043.997939203866,-48006.511409820181,-46983.917591001547,-45976.216482748001,-44983.408085059469,-44005.492397935952,-43042.469421377544,-42094.339155384216,-41161.101599955902,-40242.756755092574,-39339.304620794464,-38450.745197061238,-37577.07848389318,-36718.304481290143,-35874.42318925212,-35045.434607779185,-34231.338736871287,-33432.135576528432,-32647.825126750671,-31878.407387537969,-31123.882358890274,-30384.250040807638,-29659.510433290037,-28949.663536337554,-28254.709349950092,-27574.647874127666,-26909.479108870313,-26259.203054178033,-25623.819710050768,-25003.329076488546,-24397.731153491433,-23807.025941059328,-23231.213439192274,-22670.293647890277,-22124.26656715331,-21593.132196981453,-21076.890537374653,-20575.541588332839,-20089.085349856148,-19617.521821944465,-19160.851004597847,-18719.072897816302,-18292.187501599794,-17880.194815948314,-17483.094840861915,-17100.887576340559,-16733.573022384255,-16381.151178992999,-16043.622046166802,-15720.985623905673,-15413.241912209591,-15120.390911078535,-14842.432620512556,-14579.367040511637,-14331.19417107574,-14097.914012204923,-13879.526563899153,-13676.031826158438,-13487.429798982779,-13313.720482372149,-13154.903876326594,-13010.979980846096,-12881.948795930646,-12767.810321580237,-12668.564557794907,-12584.211504574596,-12514.751161919365,-12460.183529829177,-12420.508608304024,-12395.726397343962,-12385.836896948918,-12390.840107118947,-12410.736027854022,-12445.524659154145,-12495.206001019338,-12559.780053449569,-12639.246816444858,-12733.606290005202,-12842.858474130604,-12967.003368821044,-13106.040974076546,-13259.971289897085,-13428.7943162827,-13612.510053233371,-13811.118500749048,-14024.619658829826,-14253.013527475669,-14496.300106686538,-14754.479396462435,-15027.551396803414,-15315.516107709451,-15618.373529180535,-15936.123661216692,-16268.766503817858],[-54697.795852959796,-53579.225823910281,-52475.548505425708,-51386.763897506316,-50312.872000151903,-49253.872813362585,-48209.766337138208,-47180.552571478969,-46166.231516384782,-45166.803171855667,-44182.267537891545,-43212.624614492459,-42257.874401658511,-41318.016899389542,-40393.052107685682,-39482.980026546844,-38587.800655973071,-37707.513995964357,-36842.120046520686,-35991.618807642073,-35156.01027932849,-34335.294461579986,-33529.471354396512,-32738.540957778154,-31962.50327172481,-31201.358296236496,-30455.106031313218,-29723.746476955042,-29007.27963316191,-28305.705499933843,-27619.02407727082,-26947.235365172826,-26290.339363639891,-25648.336072672035,-25021.225492269201,-24409.007622431396,-23811.682463158686,-23229.250014451063,-22661.710276308397,-22109.063248730869,-21571.308931718333,-21048.447325270914,-20540.478429388546,-20047.402244071171,-19569.218769318883,-19105.928005131656,-18657.529951509419,-18224.024608452328,-17805.411975960233,-17401.692054033207,-17012.864842671243,-16638.930341874322,-16279.888551642442,-15935.739471975647,-15606.483102873854,-15292.119444337155,-14992.648496365502,-14708.070258958893,-14438.384732117347,-14183.591915840831,-13943.691810129409,-13718.684414983001,-13508.569730401676,-13313.347756385381,-13133.018492934159,-12967.581940047969,-12817.038097726829,-12681.386965970771,-12560.628544779742,-12454.76283415378,-12363.789834092851,-12287.709544596997,-12226.521965666176,-12180.227097300434,-12148.824939499726,-12132.315492264079,-12130.698755593465,-12143.974729487933,-12172.143413947433,-12215.204808971994,-12273.158914561604,-12346.005730716268,-12433.745257435996,-12536.37749472076,-12653.902442570588,-12786.320100985478,-12933.630469965403,-13095.83354951038,-13272.92933962043,-13464.917840295526,-13671.799051535654,-13893.572973340864,-14130.239605711091,-14381.798948646399,-14648.251002146764,-14929.595766212158,-15225.833240842619,-15536.963426038132,-15862.986321798715,-16203.901928124313],[-53823.845023919486,-52713.547758594294,-51618.143203834203,-50537.631359639177,-49472.012226009232,-48421.285802944309,-47385.452090444451,-46364.511088509615,-45358.462797139844,-44367.30721633511,-43391.044346095405,-42429.674186420867,-41483.1967373113,-40551.611998766799,-39634.919970787334,-38733.120653372956,-37846.214046523601,-36974.200150239267,-36117.078964520064,-35274.850489365868,-34447.514724776745,-33635.071670752688,-32837.521327293667,-32054.86369439969,-31287.098772070778,-30534.226560306881,-29796.2470591081,-29073.160268474356,-28364.966188405633,-27671.664818901969,-26993.256159963355,-26329.7402115898,-25681.116973781289,-25047.386446537843,-24428.548629859477,-23824.603523746155,-23235.551128197883,-22661.391443214605,-22102.124468796472,-21557.750204943324,-21028.268651655231,-20513.679808932218,-20013.983676774274,-19529.180255181374,-19059.269544153496,-18604.251543690705,-18164.126253792929,-17738.893674460236,-17328.553805692576,-16933.106647489985,-16552.552199852442,-16186.890462779955,-15836.121436272493,-15500.245120330139,-15179.261514952786,-14873.170620140516,-14581.972435893282,-14305.666962211115,-14044.25419909401,-13797.734146541929,-13566.106804554911,-13349.372173132961,-13147.530252276061,-12960.581041984206,-12788.524542257403,-12631.36075309564,-12489.089674498946,-12361.711306467301,-12249.225649000702,-12151.632702099183,-12068.932465762686,-12001.124939991256,-11948.210124784891,-11910.188020143574,-11887.058626067295,-11878.821942556076,-11885.477969609912,-11907.026707228801,-11943.468155412711,-11994.802314161734,-12061.029183475754,-12142.148763354864,-12238.161053799027,-12349.066054808231,-12474.863766382488,-12615.554188521786,-12771.137321226151,-12941.613164495579,-13126.981718330051,-13327.242982729565,-13542.396957694129,-13772.44364322376,-14017.383039318449,-14277.21514597818,-14551.939963202956,-14841.557490992807,-15146.067729347691,-15465.470678267646,-15799.766337752657,-16148.954707802697],[-52959.811550250983,-51857.787048650294,-50770.65525761465,-49698.416177144063,-48641.069807238477,-47598.616147898036,-46571.055199122558,-45558.386960912154,-44560.611433266837,-43577.72861618652,-42609.738509671355,-41656.641113721184,-40718.436428336012,-39795.124453515993,-38886.705189260967,-37993.178635570963,-37114.54479244606,-36250.803659886165,-35401.955237891401,-34567.999526461652,-33748.936525596939,-32944.766235297306,-32155.488655562716,-31381.103786393163,-30621.611627788683,-29877.012179749217,-29147.30544227489,-28432.491415365534,-27732.570099021228,-27047.541493242024,-26377.405598027864,-25722.162413378734,-25081.811939294683,-24456.354175775639,-23845.789122821705,-23250.116780432778,-22669.337148608938,-22103.450227350128,-21552.45601665639,-21016.354516527706,-20495.145726964052,-19988.829647965478,-19497.406279531948,-19020.875621663457,-18559.237674360062,-18112.492437621648,-17680.639911448321,-17263.680095840071,-16861.61299079685,-16474.438596318665,-16102.156912405548,-15744.767939057509,-15402.271676274515,-15074.668124056545,-14761.957282403653,-14464.139151315816,-14181.213730793013,-13913.181020835264,-13660.041021442592,-13421.793732614928,-13198.439154352365,-12989.97728665483,-12796.408129522348,-12617.731682954935,-12453.947946952569,-12305.056921515237,-12171.058606642979,-12051.953002335787,-11947.740108593611,-11858.4199254165,-11783.992452804452,-11724.457690757452,-11679.815639275497,-11650.066298358595,-11635.209668006763,-11635.245748219995,-11650.174538998252,-11679.996040341597,-11724.710252249934,-11784.31717472335,-11858.816807761859,-11948.209151365358,-12052.494205533956,-12171.671970267591,-12305.742445566266,-12454.705631430013,-12618.561527858805,-12797.310134852665,-12990.951452411566,-13199.485480535523,-13422.91221922454,-13661.231668478587,-13914.443828297686,-14182.54869868186,-14465.546279631082,-14763.436571145352,-15076.219573224667,-15403.89528586905,-15746.463709078495,-16103.924842852966],[-52105.695431954438,-51011.943694078109,-49933.084666766947,-48869.118350020763,-47820.04474383963,-46785.863848223591,-45766.575663172596,-44762.180188686631,-43772.677424765679,-42798.067371409859,-41838.350028619046,-40893.525396393357,-39963.593474732639,-39048.554263636994,-38148.407763106443,-37263.153973140914,-36392.792893740392,-35537.324524904914,-34696.748866634553,-33871.065918929242,-33060.275681788968,-32264.378155213781,-31483.37333920363,-30717.261233758523,-29966.041838878453,-29229.715154563455,-28508.281180813494,-27801.739917628583,-27110.091365008746,-26433.335522953967,-25771.472391464224,-25124.501970539517,-24492.424260179905,-23875.23926038533,-23272.946971155783,-22685.547392491309,-22113.040524391894,-21555.426366857559,-21012.704919888227,-20484.876183483939,-19971.940157644753,-19473.896842370603,-18990.746237661486,-18522.488343517442,-18069.123159938448,-17630.650686924513,-17207.070924475604,-16798.383872591796,-16404.589531272974,-16025.687900519248,-15661.678980330567,-15312.562770706951,-14978.339271648381,-14659.00848315485,-14354.570405226385,-14065.025037862972,-13790.372381064601,-13530.612434831299,-13285.745199163048,-13055.770674059848,-12840.688859521691,-12640.49975554859,-12455.203362140561,-12284.799679297565,-12129.28870701961,-11988.67044530674,-11862.944894158929,-11752.112053576122,-11656.171923558381,-11575.124504105719,-11508.969795218072,-11457.707796895531,-11421.338509138022,-11399.861931945561,-11393.278065318133,-11401.586909255773,-11424.788463758498,-11462.882728826238,-11515.869704459026,-11583.749390656874,-11666.521787419793,-11764.186894747758,-11876.744712640788,-12004.195241098849,-12146.538480121962,-12303.774429710138,-12475.903089863366,-12662.924460581657,-12864.838541864976,-13081.645333713384,-13313.344836126798,-13559.937049105301,-13821.421972648845,-14097.799606757437,-14389.069951431085,-14695.233006669801,-15016.288772473523,-15352.237248842368,-15703.07843577622,-16068.812333275122],[-51261.496669029781,-50176.017694877926,-49105.431431291137,-48049.737878269392,-47008.937035812698,-45983.028903921077,-44972.01348259447,-43975.890771832957,-42994.660771636503,-42028.3234820051,-41076.878902938726,-40140.327034437381,-39218.667876501175,-38311.901429130019,-37420.027692323827,-36543.046666082664,-35680.958350406676,-34833.762745295666,-34001.459850749699,-33184.049666768813,-32381.532193352992,-31593.90743050223,-30821.175378216481,-30063.336036495777,-29320.38940534016,-28592.335484749616,-27879.174274724108,-27180.9057752636,-26497.529986368208,-25829.046908037853,-25175.456540272557,-24536.758883072267,-23912.953936437079,-23304.041700366928,-22710.022174861813,-22130.895359921778,-21566.661255546824,-21017.31986173684,-20482.871178492001,-19963.315205812141,-19458.651943697343,-18968.881392147658,-18494.003551162983,-18034.018420743341,-17588.926000888809,-17158.726291599258,-16743.419292874813,-16343.005004715407,-15957.483427121044,-15586.854560091737,-15231.118403627506,-14890.274957728301,-14564.32422239418,-14253.26619762508,-13957.100883421059,-13675.828279782067,-13409.448386708131,-13157.961204199237,-12921.366732255439,-12699.664970876656,-12492.855920062924,-12300.939579814265,-12123.915950130675,-11961.78503101209,-11814.54682245858,-11682.201324470145,-11564.748537046718,-11462.188460188383,-11374.521093895099,-11301.746438166858,-11243.864493003657,-11200.875258405498,-11172.778734372423,-11159.574920904408,-11161.263818001433,-11177.845425663501,-11209.319743890625,-11255.68677268282,-11316.946512040053,-11393.098961962343,-11484.144122449696,-11590.081993502066,-11710.912575119517,-11846.635867302008,-11997.25187004956,-12162.760583362166,-12343.162007239838,-12538.456141682551,-12748.642986690318,-12973.722542263144,-13213.694808401006,-13468.55978510392,-13738.317472371888,-14022.967870204937,-14322.510978602999,-14636.946797566143,-14966.27532709431,-15310.496567187562,-15669.610517845875,-16043.617179069197],[-50427.215261477002,-49350.009051049572,-48287.695551187222,-47240.274761889901,-46207.746683157668,-45190.111314990456,-44187.368657388361,-43199.518710351258,-42226.561473879163,-41268.496947972177,-40325.325132630256,-39397.046027853386,-38483.659633641575,-37585.165949994778,-36701.564976913054,-35832.856714396366,-34979.041162444759,-34140.118321058188,-33316.08819023666,-32506.950769980256,-31712.706060288867,-30933.354061162427,-30168.89477260119,-29419.328194604917,-28684.654327173768,-27964.873170307619,-27259.984724006514,-26569.988988270481,-25894.885963099514,-25234.675648493561,-24589.358044452696,-23958.933150976874,-23343.400968066082,-22742.761495720406,-22157.014733939715,-21586.160682724098,-21030.199342073556,-20489.130711988044,-19962.954792467608,-19451.671583512216,-18955.281085121882,-18473.783297296566,-18007.178220036338,-17555.465853341128,-17118.646197211026,-16696.719251645925,-16289.685016645897,-15897.543492210918,-15520.294678341004,-15157.938575036142,-14810.475182296299,-14477.904500121549,-14160.226528511846,-13857.441267467204,-13569.548716987578,-13296.548877073026,-13038.441747723542,-12795.227328939071,-12566.905620719699,-12353.476623065355,-12154.940335976051,-11971.29675945182,-11802.545893492639,-11648.687738098522,-11509.722293269428,-11385.649559005426,-11276.469535306453,-11182.182222172529,-11102.787619603663,-11038.285727599865,-10988.676546161116,-10953.960075287396,-10934.136314978761,-10929.205265235138,-10939.166926056601,-10964.021297443111,-11003.768379394682,-11058.408171911289,-11127.940674992948,-11212.365888639668,-11311.683812851432,-11425.894447628256,-11554.997792970158,-11698.99384887708,-11857.882615349063,-12031.664092386105,-12220.338279988198,-12423.905178155335,-12642.36478688753,-12875.717106184766,-13123.962136047065,-13387.099876474434,-13665.130327466837,-13958.053489024296,-14265.869361146806,-14588.577943834372,-14926.179237086977,-15278.673240904676,-15646.059955287405,-16028.339380235173],[-49602.851209296139,-48533.917762593155,-47479.877026455273,-46440.729000882369,-45416.473685874545,-44407.11108143178,-43412.641187554051,-42433.064004241431,-41468.379531493782,-40518.587769311249,-39583.688717693723,-38663.6823766413,-37758.568746153913,-36868.347826231548,-35993.019616874284,-35132.584118082043,-34287.041329854794,-33456.391252192712,-32640.633885095594,-31839.769228563615,-31053.797282596621,-30282.718047194699,-29526.531522357815,-28785.237708086031,-28058.836604379248,-27347.328211237538,-26650.712528660893,-25968.989556649292,-25302.159295202757,-24650.221744321243,-24013.176904004795,-23391.02477425339,-22783.765355067073,-22191.398646445792,-21613.924648389555,-21051.343360898347,-20503.65478397227,-19970.858917611156,-19452.955761815159,-18949.945316584184,-18461.82758191826,-17988.602557817427,-17530.270244281615,-17086.830641310844,-16658.283748905149,-16244.629567064492,-15845.868095788885,-15461.999335078368,-15093.023284932868,-14738.939945352433,-14399.749316337036,-14075.45139788672,-13766.046190001434,-13471.533692681216,-13191.913905926043,-12927.186829735911,-12677.352464110849,-12442.410809050813,-12222.361864555893,-12017.205630625951,-11826.942107261108,-11651.571294461313,-11491.093192226559,-11345.507800556843,-11214.815119452218,-11099.015148912615,-10998.107888938081,-10912.093339528608,-10840.971500684158,-10784.742372404773,-10743.405954690457,-10716.962247541178,-10705.411250956964,-10708.752964937798,-10726.987389483693,-10760.114524594628,-10808.134370270629,-10871.046926511674,-10948.852193317758,-11041.550170688912,-11149.140858625116,-11271.624257126372,-11409.000366192682,-11561.269185824043,-11728.430716020466,-11910.484956781922,-12107.431908108461,-12319.27157000003,-12546.003942456635,-12787.629025478327,-13044.146819065067,-13315.557323216859,-13601.860537933713,-13903.056463215569,-14219.145099062529,-14550.126445474527,-14896.000502451572,-15256.767269993672,-15632.426748100826,-16022.97893677303],[-48788.404512487119,-47727.743829508589,-46681.975857095073,-45651.100595246688,-44635.118043963303,-43634.028203244976,-42647.831073091707,-41676.526653503395,-40720.114944480243,-39778.595946022135,-38851.969658129077,-37940.236080800991,-37043.395214038086,-36161.447057840174,-35294.391612207321,-34442.228877139532,-33604.95885263673,-32782.581538699036,-31975.096935326394,-31182.505042518795,-30404.805860276269,-29641.999388598793,-28894.085627486325,-28161.064576938945,-27442.936236956615,-26739.70060753938,-26051.357688687152,-25377.907480399976,-24719.34998267785,-24075.685195520789,-23446.913118928773,-22833.033752901814,-22234.0470974399,-21649.953152543072,-21080.751918211237,-20526.44339444453,-19987.02758124283,-19462.504478606144,-18952.874086534583,-18458.136405028054,-17978.291434086561,-17513.339173710134,-17063.279623898758,-16628.11278465244,-16207.838655971169,-15802.457237854946,-15411.968530303777,-15036.372533317672,-14675.669246896605,-14329.858671040594,-13998.940805749651,-13682.915651023737,-13381.783206862907,-13095.543473267126,-12824.196450236363,-12567.74213777068,-12326.180535870053,-12099.511644534459,-11887.735463763942,-11690.851993558463,-11508.861233918042,-11341.763184842657,-11189.557846332345,-11052.245218387086,-10929.825301006875,-10822.298094191712,-10729.663597941602,-10651.921812256543,-10589.072737136545,-10541.116372581593,-10508.052718591707,-10489.881775166872,-10486.603542307073,-10498.218020012348,-10524.725208282664,-10566.125107118034,-10622.417716518474,-10693.603036483937,-10779.681067014459,-10880.651808110051,-10996.515259770695,-11127.271421996375,-11272.920294787111,-11433.461878142905,-11608.896172063753,-11799.223176549662,-12004.442891600611,-12224.555317216616,-12459.560453397677,-12709.458300143786,-12974.248857454955,-13253.932125331168,-13548.508103772438,-13857.976792778758,-14182.338192350138,-14521.592302486562,-14875.739123188041,-15244.778654454587,-15628.710896286178,-16027.535848682804],[-47983.875171050175,-46931.487251796003,-45893.99204310702,-44871.389544982965,-43863.679757423946,-42870.86268043008,-41892.938314001229,-40929.906658137392,-39981.767712838679,-39048.521478104951,-38130.167953936354,-37226.70714033275,-36338.139037294204,-35464.463644820695,-34605.680962912324,-33761.790991568967,-32932.79373079064,-32118.689180577327,-31319.477340929137,-30535.15821184597,-29765.731793327839,-29011.198085374832,-28271.557087986825,-27546.808801163868,-26836.953224905948,-26141.990359213123,-25461.920204085334,-24796.742759522582,-24146.458025524895,-23511.066002092259,-22890.566689224695,-22284.960086922161,-21694.246195184671,-21118.425014012275,-20557.496543404894,-20011.460783362563,-19480.317733885298,-18964.067394973106,-18462.709766625936,-17976.244848843839,-17504.672641626781,-17047.993144974756,-16606.206358887837,-16179.312283365942,-15767.310918409101,-15370.202264017325,-14987.986320190583,-14620.663086928902,-14268.232564232296,-13930.6947521007,-13608.049650534196,-13300.297259532728,-13007.437579096313,-12729.47060922494,-12466.396349918639,-12218.214801177379,-11984.925963001167,-11766.529835390013,-11563.02641834393,-11374.415711862874,-11200.697715946873,-11041.872430595937,-10897.939855810053,-10768.899991589222,-10654.752837933453,-10555.498394842711,-10471.136662317047,-10401.667640356422,-10347.091328960842,-10307.407728130345,-10282.616837864862,-10272.71865816448,-10277.713189029102,-10297.600430458802,-10332.38038245355,-10382.053045013359,-10446.6184181382,-10526.076501828109,-10620.427296083066,-10729.670800903095,-10853.80701628817,-10992.835942238278,-11146.757578753452,-11315.571925833694,-11499.278983478955,-11697.878751689273,-11911.371230464669,-12139.756419805122,-12383.034319710587,-12641.204930181146,-12914.268251216741,-13202.224282817391,-13505.073024983099,-13822.814477713837,-14155.448641009654,-14502.975514870523,-14865.395099296426,-15242.707394287385,-15634.912399843424,-16042.010115964476],[-47189.263184984949,-46145.148029455238,-45115.925584490615,-44101.595850091049,-43102.158826256513,-42117.614512987057,-41147.9629102826,-40193.204018143297,-39253.33783656895,-38328.364365559682,-37418.283605115452,-36523.095555236323,-35642.800215922245,-34777.397587173138,-33926.887668989206,-33091.270461370223,-32270.545964316378,-31464.714177827547,-30673.775101903688,-29897.728736544988,-29136.575081751304,-28390.314137522713,-27658.945903859145,-26942.470380760591,-26240.88756822711,-25554.197466258724,-24882.400074855359,-24225.495394017067,-23583.483423743826,-22956.364164035629,-22344.137614892446,-21746.803776314337,-21164.362648301307,-20596.814230853321,-20044.158523970371,-19506.395527652494,-18983.525241899675,-18475.547666711878,-17982.462802089154,-17504.270648031474,-17040.971204538873,-16592.564471611309,-16159.050449248794,-15740.429137451347,-15336.700536218943,-14947.864645551583,-14573.921465449257,-14214.87099591203,-13870.713236939839,-13541.4481885327,-13227.075850690593,-12927.596223413553,-12643.009306701571,-12373.31510055465,-12118.513604972755,-11878.604819955957,-11653.588745504181,-11443.465381617454,-11248.2347282958,-11067.896785539167,-10902.451553347626,-10751.899031721106,-10616.239220659638,-10495.472120163256,-10389.597730231912,-10298.616050865605,-10222.527082064364,-10161.330823828177,-10115.027276157034,-10083.616439050953,-10067.098312509928,-10065.472896533945,-10078.740191123015,-10106.900196277133,-10149.952911996334,-10207.898338280558,-10280.736475129848,-10368.467322544182,-10471.090880523585,-10588.60714906803,-10721.016128177527,-10868.317817852087,-11030.51221809169,-11207.599328896351,-11399.579150266043,-11606.451682200804,-11828.216924700635,-12064.874877765502,-12316.425541395427,-12582.868915590414,-12864.20500035043,-13160.433795675503,-13471.555301565644,-13797.569518020839,-14138.476445041062,-14494.276082626357,-14864.968430776715,-15250.553489492107,-15651.031258772568,-16066.401738618066],[-46404.56855429164,-45368.726162486419,-44347.776481246197,-43341.71951057102,-42350.555250460937,-41374.283700915948,-40412.904861935967,-39466.418733521023,-38534.825315671107,-37618.124608386279,-36716.316611666523,-35829.401325511812,-34957.378749922093,-34100.248884897475,-33258.01173043796,-32430.667286543438,-31618.215553213966,-30820.656530449567,-30037.990218250226,-29270.216616615915,-28517.335725546691,-27779.347545042488,-27056.252075103315,-26348.049315729244,-25654.739266920231,-24976.321928676218,-24312.797300997299,-23664.165383883439,-23030.426177334593,-22411.579681350871,-21807.625895932142,-21218.564821078464,-20644.39645678984,-20085.120803066307,-19540.737859907771,-19011.247627314333,-18496.650105285924,-17996.945293822599,-17512.133192924302,-17042.213802591046,-16587.187122822877,-16147.05315361974,-15721.81189498166,-15311.463346908633,-14916.007509400652,-14535.444382457737,-14169.773966079847,-13818.996260267044,-13483.11126501929,-13162.118980336569,-12856.019406218906,-12564.812542666325,-12288.498389678753,-12027.076947256264,-11780.548215398823,-11548.912194106415,-11332.168883379081,-11130.318283216788,-10943.36039361955,-10771.295214587379,-10614.122746120236,-10471.84298821817,-10344.455940881144,-10231.961604109176,-10134.359977902259,-10051.651062260387,-9983.8348571835813,-9930.9113626718263,-9892.8805787251258,-9869.7425053434799,-9861.4971425268723,-9868.1444902753319,-9889.6845485888298,-9926.1173174673895,-9977.4427969110111,-10043.660986919673,-10124.771887493393,-10220.775498632163,-10331.671820335992,-10457.460852604876,-10598.1425954388,-10753.717048837772,-10924.18421280182,-11109.5440873309,-11309.796672425047,-11524.941968084247,-11754.979974308482,-11999.910691097799,-12259.734118452134,-12534.450256371561,-12824.059104856011,-13128.560663905539,-13447.954933520101,-13782.241913699709,-14131.421604444373,-14495.494005754112,-14874.459117628887,-15268.316940068724,-15677.067473073617,-16100.710716643525],[-45629.791278970311,-44602.221650889456,-43589.544733373739,-42591.760526423015,-41608.869030037335,-40640.870244216727,-39687.76416896117,-38749.550804270686,-37826.230150145253,-36917.802206584878,-36024.266973589474,-35145.624451159267,-34281.874639293979,-33433.017537993765,-32599.05314725863,-31779.981467088575,-30975.802497483528,-30186.516238443553,-29412.122689968637,-28652.621852058779,-27908.013724713965,-27178.298307934208,-26463.475601719481,-25763.545606069842,-25078.508320985253,-24408.363746465686,-23753.111882511184,-23112.752729121756,-22487.286286297349,-21876.712554038008,-21281.03153234371,-20700.243221214478,-20134.347620650326,-19583.344730651203,-19047.234551217101,-18526.017082348091,-18019.692324044132,-17528.260276305213,-17051.720939131348,-16590.074312522531,-16143.320396478781,-15711.459191000064,-15294.490696086435,-14892.414911737831,-14505.231837954296,-14132.941474735815,-13775.543822082371,-13433.03887999399,-13105.426648470644,-12792.707127512371,-12494.880317119147,-12211.946217290963,-11943.904828027849,-11690.756149329784,-11452.500181196778,-11229.136923628797,-11020.666376625901,-10827.088540188044,-10648.403414315246,-10484.610999007493,-10335.711294264802,-10201.704300087149,-10082.590016474556,-9978.368443427029,-9889.0395809445308,-9814.6034290271073,-9755.0599876747219,-9710.409256887393,-9680.6512366651259,-9665.7859270079025,-9665.8133279157391,-9680.7334393886231,-9710.5462614265543,-9755.2517940295529,-9814.8500371975952,-9889.3409909306974,-9978.7246552288434,-10083.001030092046,-10202.170115520308,-10336.231911513612,-10485.186418071975,-10649.033635195392,-10827.773562883858,-11021.406201137386,-11229.931549955947,-11453.349609339577,-11691.660379288265,-11944.863859801997,-12212.960050880785,-12495.94895252461,-12793.830564733511,-13106.604887507459,-13434.271920846446,-13776.831664750498,-14134.284119219607,-14506.629284253759,-14893.867159852962,-15295.997746017234,-15713.021042746564,-16144.937050040908],[-44864.931359020818,-43845.634494664417,-42841.230340873131,-41851.718897646817,-40877.100164985575,-39917.374142889457,-38972.540831358288,-38042.6002303922,-37127.552339991234,-36227.397160155248,-35342.134690884304,-34471.764932178492,-33616.287884037694,-32775.703546461911,-31950.011919451252,-31139.213003005578,-30343.306797124962,-29562.293301809419,-28796.172517058927,-28044.944442873486,-27308.609079253096,-26587.166426197793,-25880.616483707534,-25188.959251782311,-24512.194730422118,-23850.322919626989,-23203.343819396941,-22571.25742973193,-21954.063750631991,-21351.762782097052,-20764.354524127197,-20191.838976722414,-19634.216139882643,-19091.486013607966,-18563.648597898304,-18050.703892753721,-17552.65189817419,-17069.492614159702,-16601.226040710266,-16147.852177825922,-15709.371025506578,-15285.782583752312,-14877.086852563107,-14483.283831938934,-14104.373521879832,-13740.355922385761,-13391.231033456761,-13056.99885509279,-12737.659387293907,-12433.212630060059,-12143.658583391265,-11868.997247287527,-11609.228621748831,-11364.352706775197,-11134.369502366622,-10919.279008523083,-10719.081225244612,-10533.776152531176,-10363.363790382813,-10207.844138799483,-10067.217197781225,-9941.4829673280165,-9830.6414474398571,-9734.6926381167468,-9653.6365393587021,-9587.4731511657028,-9536.2024735377418,-9499.8245064748589,-9478.3392499770143,-9471.7467040442243,-9480.0468686764871,-9503.2397438738044,-9541.3253296361763,-9594.3036259635956,-9662.1746328560675,-9744.9383503136014,-9842.5947783361935,-9955.1439169238256,-10082.585766076514,-10224.920325794263,-10382.147596077046,-10554.267576924893,-10741.280268337799,-10943.18567031575,-11159.983782858742,-11391.674605966802,-11638.258139639933,-11899.734383878082,-12176.103338681296,-12467.365004049585,-12773.519379982899,-13094.566466481281,-13430.50626354471,-13781.338771173187,-14147.063989366723,-14527.681918125319,-14923.192557448952,-15333.595907337653,-15758.891967791396,-16199.080738810193],[-44109.988794443321,-43098.964693811315,-42102.833303744446,-41121.594624242622,-40155.248655305833,-39203.795396934009,-38267.234849127366,-37345.567011885723,-36438.791885209117,-35546.909469097613,-34669.919763551123,-33807.822768569662,-32960.618484153318,-32128.306910302024,-31310.888047015738,-30508.361894294503,-29720.728452138334,-28947.987720547222,-28190.139699521162,-27447.184389060181,-26719.121789164208,-26005.951899833315,-25307.674721067473,-24624.290252866667,-23955.798495230949,-23302.199448160223,-22663.493111654614,-22039.679485714063,-21430.758570338527,-20836.730365528041,-20257.59487128261,-19693.352087602245,-19144.002014486916,-18609.544651936671,-18089.979999951458,-17585.308058531285,-17095.5288276762,-16620.642307386152,-16160.648497661152,-15715.547398501205,-15285.339009906324,-14870.023331876479,-14469.600364411683,-14084.070107511956,-13713.432561177253,-13357.687725407644,-13016.835600203061,-12690.876185563546,-12379.809481489068,-12083.635487979665,-11802.354205035295,-11535.965632655985,-11284.469770841737,-11047.866619592525,-10826.156178908372,-10619.338448789274,-10427.413429235228,-10250.381120246242,-10088.241521822296,-9940.9946339634171,-9808.6404566695855,-9691.1789899407959,-9588.6102337770608,-9500.9341881783876,-9428.1508531447726,-9370.2602286762012,-9327.2623147726918,-9299.1571114342205,-9285.9446186608184,-9287.6248364524618,-9304.1977648091506,-9335.6634037309013,-9382.0217532176976,-9443.2728132695593,-9519.4165838864665,-9610.4530650684246,-9716.3822568154392,-9837.2041591274974,-9972.9187720046302,-10123.526095446803,-10289.026129454032,-10469.418874026298,-10664.704329163644,-10874.882494866015,-11099.953371133452,-11339.916957965943,-11594.7732553635,-11864.522263326095,-12149.16398185375,-12448.698410946441,-12763.125550604193,-13092.445400826997,-13436.657961614861,-13795.763232967785,-14169.761214885739,-14558.651907368769,-14962.435310416826,-15381.111424029963,-15814.680248208135,-16263.141782951363],[-43364.963585237638,-42362.212248330099,-41374.353621987633,-40401.387706210218,-39443.314500997833,-38500.134006350519,-37571.846222268236,-36658.451148751068,-35759.948785798908,-34876.339133411791,-34007.622191589748,-33153.797960332733,-32314.866439640828,-31490.827629513929,-30681.681529952053,-29887.428140955308,-29108.067462523584,-28343.59949465689,-27594.024237355239,-26859.341690618676,-26139.551854447163,-25434.654728840695,-24744.650313799306,-24069.538609322946,-23409.319615411638,-22763.99333206538,-22133.559759284159,-21518.01889706801,-20917.37074541692,-20331.615304330888,-19760.75257380987,-19204.78255385394,-18663.705244463068,-18137.520645637236,-17626.22875737647,-17129.82957968074,-16648.323112550064,-16181.709355984434,-15729.98830998389,-15293.15997454838,-14871.224349677907,-14464.181435372508,-14072.03123163214,-13694.77373845685,-13332.408955846595,-12984.936883801403,-12652.35752232125,-12334.670871406164,-12031.876931056137,-11743.975701271136,-11470.967182051218,-11212.851373396341,-10969.62827530651,-10741.29788778174,-10527.860210822018,-10329.315244427358,-10145.66298859774,-9976.9034433331635,-9823.0366086336726,-9684.0624844992089,-9559.9810709298108,-9450.79236792546,-9356.4963754861656,-9277.0930936119221,-9212.5825223027423,-9162.9646615585971,-9128.2395113795137,-9108.4070717654758,-9103.4673427165108,-9113.4203242325784,-9138.2660163137134,-9178.0044189598884,-9232.6355321711198,-9302.1593559474095,-9386.5758902887574,-9485.8851351951471,-9600.0870906665787,-9729.1817567030903,-9873.1691333046365,-10032.049220471225,-10205.822018202904,-10394.487526499604,-10598.045745361373,-10816.496674788203,-11049.840314780065,-11298.076665336983,-11561.205726458951,-11839.227498145978,-12132.141980398064,-12439.949173215216,-12762.649076597394,-13100.241690544619,-13452.727015056929,-13820.105050134269,-14202.375795776657,-14599.539251984106,-15011.595418756622,-15438.544296094178,-15880.385883996774,-16337.120182464445],[-42629.855731403884,-41635.377158220814,-40655.791295602728,-39691.098143549782,-38741.297702061835,-37806.389971138946,-36886.374950781108,-35981.25264098835,-35091.023041760593,-34215.686153097937,-33355.241975000317,-32509.690507467785,-31679.031750500282,-30863.265704097837,-30062.392368260407,-29276.411742988079,-28505.323828280736,-27749.128624138488,-27007.82613056132,-26281.416347549144,-25569.899275102056,-24873.274913220033,-24191.543261903047,-23524.704321151126,-22872.758090964227,-22235.704571342438,-21613.543762285655,-21006.275663793938,-20413.90027586725,-19836.417598505672,-19273.827631709089,-18726.130375477587,-18193.325829811125,-17675.41399470975,-17172.39487017339,-16684.268456202117,-16211.034752795858,-15752.69375995468,-15309.245477678549,-14880.689905967462,-14467.027044821418,-14068.256894240472,-13684.379454224521,-13315.394724773654,-12961.302705887843,-12622.103397567076,-12297.796799811362,-11988.382912620715,-11693.861735995108,-11414.233269934553,-11149.49751443905,-10899.654469508603,-10664.704135143216,-10444.646511342871,-10239.481598107583,-10049.209395437356,-9873.82990333216,-9713.3431217920297,-9567.7490508169649,-9437.0476904069419,-9321.2390405619735,-9220.3231012820452,-9134.2998725671805,-9063.1693544173777,-9006.9315468326131,-8965.5864498129085,-8939.1340633582568,-8927.5743874686486,-8930.9074221441042,-8949.1331673846216,-8982.25162319017,-9030.262789560793,-9093.1666664964541,-9170.9632539971681,-9263.6525520629366,-9371.2345606937633,-9493.7092798896465,-9631.0767096505697,-9783.3368499765566,-9950.4897008675835,-10132.535262323683,-10329.473534344814,-10541.304516931021,-10768.028210082271,-11009.644613798562,-11266.153728079913,-11537.555552926337,-11823.850088337786,-12125.037334314291,-12441.117290855876,-12772.089957962478,-13117.955335634157,-13478.713423870882,-13854.364222672652,-14244.907732039481,-14650.343951971361,-15070.672882468303,-15505.894523530284,-15956.008875157335,-16421.015937349424],[-41904.665232942018,-40918.459423483357,-39947.146324589739,-38990.725936261144,-38049.198258497687,-37122.563291299244,-36210.821034665838,-35313.971488597512,-34432.014653094207,-33564.950528155976,-32712.779113782788,-31875.500409974637,-31053.114416731543,-30245.621134053552,-29453.020561940546,-28675.312700392642,-27912.497549409796,-27164.575108991936,-26431.545379139185,-25713.408359851499,-25010.164051128835,-24321.81245297123,-23648.353565378682,-22989.787388351193,-22346.113921888726,-21717.333165991353,-21103.445120659009,-20504.44978589172,-19920.347161689489,-19351.137248052313,-18796.820044980173,-18257.395552473128,-17732.863770531098,-17223.224699154118,-16728.4783383422,-16248.624688095326,-15783.663748413532,-15333.595519296789,-14898.420000745084,-14478.137192758426,-14072.747095336823,-13682.249708480293,-13306.645032188788,-12945.933066462338,-12600.113811300973,-12269.187266704641,-11953.153432673353,-11652.012309207126,-11365.763896305951,-11094.408193969837,-10837.945202198771,-10596.374920992756,-10369.697350351786,-10157.912490275887,-9961.0203407650297,-9779.0209018192327,-9611.9141734384739,-9459.7001556227697,-9322.3788483721382,-9199.9502516865396,-9092.4143655659864,-8999.7711900105205,-8922.0207250200765,-8859.1629705947125,-8811.1979267343777,-8778.1255934391029,-8759.9459707088863,-8756.6590585437189,-8768.2648569435987,-8794.7633659085441,-8836.1545854385331,-8892.4385155335658,-8963.6151561936695,-9049.6845074188241,-9150.6465692090242,-9266.5013415642825,-9397.2488244846008,-9542.8890179699574,-9703.4219220203595,-9878.8475366358343,-10069.165861816347,-10274.376897561926,-10494.480643872557,-10729.477100748234,-10979.366268188969,-11244.148146194759,-11523.822734765597,-11818.390033901484,-12127.850043602417,-12452.202763868436,-12791.448194699471,-13145.586336095579,-13514.617188056727,-13898.540750582946,-14297.357023674203,-14711.066007330526,-15139.667701551884,-15583.162106338312,-16041.549221689804,-16514.829047606316],[-41189.392089852074,-40211.459044117873,-39248.418708948644,-38300.271084344502,-37367.016170305498,-36448.653966831473,-35545.184473922469,-34656.607691578574,-33782.923619799709,-32924.132258585916,-32080.233607937167,-31251.22766785344,-30437.114438334807,-29637.893919381204,-28853.566110992666,-28084.131013169164,-27329.588625910736,-26589.938949217336,-25865.181983089002,-25155.317727525748,-24460.346182527494,-23780.267348094363,-23115.081224226233,-22464.787810923175,-21829.387108185183,-21208.879116012191,-20603.263834404301,-20012.541263361447,-19436.711402883615,-18875.774252970899,-18329.729813623191,-17798.578084840541,-17282.319066622964,-16780.952758970427,-16294.479161882951,-15822.898275360498,-15366.210099403123,-14924.4146340108,-14497.511879183525,-14085.501834921313,-13688.384501224151,-13306.159878092032,-12938.827965524977,-12586.388763522975,-12248.842272086011,-11926.188491214121,-11618.427420907274,-11325.559061165488,-11047.583411988737,-10784.500473377047,-10536.310245330404,-10303.01272784882,-10084.607920932291,-9881.0958245808251,-9692.4764387943796,-9518.7497635730215,-9359.9157989166997,-9215.9745448254325,-9086.9260012992181,-8972.7701683380619,-8873.5070459419476,-8789.1366341109042,-8719.6589328449045,-8665.073942143943,-8625.3816620080543,-8600.5820924372201,-8590.675233431426,-8595.661084990692,-8615.539647115007,-8650.3109198043749,-8699.9749030588009,-8764.531596878267,-8843.9810012628004,-8938.3231162123902,-9047.5579417270255,-9171.6854778067027,-9310.7057244514472,-9464.6186816612353,-9633.4243494360871,-9817.1227277759826,-10015.713816680942,-10229.197616150937,-10457.574126186,-10700.84334678612,-10959.005277951273,-11232.059919681487,-11520.007271976763,-11822.84733483709,-12140.580108262462,-12473.205592252889,-12820.723786808365,-13183.134691928895,-13560.438307614486,-13952.634633865127,-14359.723670680816,-14781.705418061576,-15218.579876007369,-15670.347044518228,-16137.006923594143,-16618.559513235072],[-40484.036302133973,-39514.376020124204,-38559.608448679472,-37619.733587799747,-36694.751437485167,-35784.661997735595,-34889.465268551023,-34009.161249931523,-33143.749941877089,-32293.231344387728,-31457.605457463389,-30636.872281104137,-29831.031815309907,-29040.084060080742,-28264.029015416636,-27502.866681317566,-26756.597057783605,-26025.220144814593,-25308.735942410705,-24607.144450571883,-23920.445669298075,-23248.63959858934,-22591.726238445655,-21949.705588867007,-21322.577649853447,-20710.342421404923,-20112.999903521439,-19530.550096203027,-18962.992999449656,-18410.328613261336,-17872.556937638103,-17349.677972579884,-16841.691718086709,-16348.598174158611,-15870.397340795564,-15407.089217997544,-14958.673805764616,-14525.151104096716,-14106.521112993863,-13702.783832456083,-13313.939262483347,-12939.987403075675,-12580.928254233057,-12236.761815955462,-11907.488088242941,-11593.107071095475,-11293.61876451305,-11009.023168495703,-10739.320283043387,-10484.510108156128,-10244.592643833921,-10019.567890076778,-9809.4358468846785,-9614.1965142576337,-9433.8498921956361,-9268.3959806986968,-9117.8347797668212,-8982.1662893999764,-8861.3905095981991,-8755.5074403614708,-8664.5170816897935,-8588.419433583178,-8527.2144960416081,-8480.9022690650818,-8449.4827526536228,-8432.9559468072093,-8431.3218515258595,-8444.5804668095589,-8472.7317926583091,-8515.7758290720994,-8573.7125760509516,-8646.5420335948693,-8734.264201703827,-8836.879080377832,-8954.386669616908,-9086.7869694210185,-9234.0799797901927,-9396.2657007244197,-9573.3441322236904,-9765.3152742880284,-9972.1791269174209,-10193.935690111848,-10430.584963871343,-10682.126948195886,-10948.561643085475,-11229.889048540132,-11526.10916455983,-11837.221991144583,-12163.227528294392,-12504.125776009249,-12859.916734289174,-13230.600403134127,-13616.17678254416,-14016.645872519221,-14432.007673059341,-14862.262184164543,-15307.409405834755,-15767.449338070062,-16242.381980870396,-16732.207334235769],[-39788.597869787875,-38827.210351502494,-37880.715543782208,-36949.113446626892,-36032.404060036759,-35130.587384011626,-34243.663418551485,-33371.632163656381,-32514.4936193264,-31672.247785561514,-30844.894662361614,-30032.434249726757,-29234.866547656959,-28452.19155615224,-27684.409275212558,-26931.519704837927,-26193.522845028376,-25470.418695783817,-24762.207257104346,-24068.888528989941,-23390.46251144055,-22726.92920445629,-22078.288608037015,-21444.540722182821,-20825.685546893688,-20221.72308216957,-19632.653328010529,-19058.47628441656,-18499.191951387584,-17954.800328923739,-17425.301417024886,-16910.695215691114,-16410.981724922385,-15926.160944718698,-15456.232875080081,-15001.197516006521,-14561.054867498007,-14135.804929554544,-13725.44770217614,-13329.98318536278,-12949.411379114479,-12583.732283431233,-12232.945898313024,-11897.052223759887,-11576.051259771793,-11269.94300634876,-10978.727463490766,-10702.404631197835,-10440.974509469979,-10194.437098307146,-9962.7923977093633,-9746.0404076766499,-9544.1811282089784,-9357.2145593063688,-9185.1407009688119,-9027.9595531963005,-8885.6711159888473,-8758.2753893464323,-8645.7723732690829,-8548.1620677567898,-8465.4444728095477,-8397.6195884273566,-8344.6874146102236,-8306.6479513581289,-8283.5011986711015,-8275.2471565491251,-8281.8858249922032,-8303.4172040003268,-8339.8412935735014,-8391.1580937117305,-8457.3676044150252,-8538.4698256833617,-8634.4647575167564,-8745.3523999151985,-8871.1327528786987,-9011.8058164072536,-9167.3715905008521,-9337.8300751595089,-9523.181270383222,-9723.4251761719861,-9938.5617925257975,-10168.591119444667,-10413.51315692858,-10673.327904977567,-10948.035363591589,-11237.635532770677,-11542.128412514805,-11861.51400282398,-12195.792303698221,-12544.963315137513,-12909.027037141852,-13287.983469711258,-13681.83261284571,-14090.574466545206,-14514.209030809759,-14952.736305639379,-15406.156291034047,-15874.468986993756,-16357.674393518535,-16855.772510608338],[-39103.076792813583,-38149.962038252641,-37211.739994256815,-36288.410660825946,-35379.974037960157,-34486.430125659463,-33607.778923923775,-32744.020432753154,-31895.154652147598,-31061.181582107063,-30242.101222631616,-29437.913573721235,-28648.618635375882,-27874.216407595573,-27114.706890380323,-26370.090083730109,-25640.365987644975,-24925.534602124906,-24225.595927169874,-23540.549962779885,-22870.396708954955,-22215.136165695068,-21574.768333000269,-20949.293210870463,-20338.710799305769,-19743.021098306082,-19162.224107871494,-18596.319828001921,-18045.308258697427,-17509.18939995797,-16987.963251783585,-16481.629814174223,-15990.189087129924,-15513.641070650694,-15051.985764736497,-14605.223169387367,-14173.353284603281,-13756.37611038425,-13354.291646730278,-12967.099893641349,-12594.800851117478,-12237.394519158661,-11894.880897764891,-11567.25998693618,-11254.531786672538,-10956.696296973922,-10673.753517840374,-10405.703449271874,-10152.546091268421,-9914.2814438300356,-9690.9095069566902,-9482.4302806484066,-9288.8437649051648,-9110.1499597269903,-8946.3488651138614,-8797.4404810657743,-8663.4248075827527,-8544.3018446647766,-8440.0715923118532,-8350.734050523999,-8276.2892193011903,-8216.7370986434253,-8172.0776885507257,-8142.3109890230726,-8127.4370000604722,-8127.4557216629164,-8142.3671538304279,-8172.1712965629904,-8216.868149860602,-8276.4577137232736,-8350.9399881509817,-8440.3149731437643,-8544.5826687015833,-8663.7430748244587,-8797.7961915123924,-8946.7420187653624,-9110.5805565834089,-9289.3118049664845,-9482.9357639146383,-9691.4524334278321,-9914.8618135060806,-10153.163904149376,-10406.358705357732,-10674.446217131146,-10957.426439469591,-11255.299372373112,-11568.065015841676,-11895.723369875286,-12238.274434473962,-12595.718209637689,-12968.054695366458,-13355.283891660298,-13757.405798519167,-14174.420415943105,-14606.327743932101,-15053.127782486137,-15514.82053160523,-15991.405991289377,-16482.884161538597,-16989.255042352837],[-38427.473071211229,-37482.631080374755,-36552.68180010331,-35637.625230396872,-34737.461371255522,-33852.190222679237,-32981.81178466804,-32126.326057221791,-31285.733040340667,-30460.0327340246,-29649.225138273556,-28853.310253087599,-28072.288078466678,-27306.15861441083,-26554.921860919982,-25818.577817994243,-25097.126485633555,-24390.567863837859,-23698.901952607281,-23022.128751941702,-22360.24826184121,-21713.260482305785,-21081.165413335388,-20463.963054930049,-19861.65340708974,-19274.236469814543,-18701.712243104346,-18144.080726959211,-17601.341921379149,-17073.495826364127,-16560.542441914164,-16062.481768029242,-15579.313804709374,-15111.038551954569,-14657.656009764814,-14219.166178140113,-13795.569057080456,-13386.864646585846,-12993.052946656335,-12614.133957291819,-12250.107678492379,-11900.974110258016,-11566.733252588663,-11247.385105484391,-10942.929668945166,-10653.366942970984,-10378.696927561874,-10118.919622717802,-9874.0350284387823,-9644.0431447248266,-9428.9439715759054,-9228.7375089920606,-9043.4237569732541,-8873.0027155195057,-8717.4743846307992,-8576.8387643071674,-8451.0958545485682,-8340.2456553550364,-8244.288166726541,-8163.2233886631111,-8097.0513211647376,-8045.7719642314005,-8009.3853178631325,-7987.8913820599109,-7981.2901568217458,-7989.5816421486306,-8012.765838040561,-8050.8427444975605,-8103.8123615195982,-8171.6746891066978,-8254.4297272588483,-8352.0774759760498,-8464.6179352583022,-8592.0511051056128,-8734.376985517978,-8891.5955764953942,-9063.7068780378686,-9250.710890145383,-9452.6076128179484,-9669.3970460555793,-9901.0791898582556,-10147.654044225985,-10409.121609158772,-10685.48188465662,-10976.734870719505,-11282.88056734744,-11603.918974540455,-11939.850092298497,-12290.673920621593,-12656.390459509754,-13036.99970896296,-13432.501668981218,-13842.896339564546,-14268.183720712903,-14708.363812426322,-15163.436614704804,-15633.402127548325,-16118.260350956913,-16618.011284930537,-17132.654929469227],[-37761.786704980812,-36825.217477868711,-35903.54096132172,-34996.757155339728,-34104.866059922861,-33227.867675070978,-32365.762000784162,-31518.549037062417,-30686.228783905695,-29868.801241314053,-29066.266409287469,-28278.624287825936,-27505.874876929411,-26748.018176597987,-26005.054186831614,-25276.982907630292,-24563.804338993992,-23865.518480922779,-23182.125333416567,-22513.62489647547,-21860.017170099418,-21221.302154288402,-20597.479849042444,-19988.550254361529,-19394.513370245688,-18815.369196694875,-18251.117733709129,-17701.758981288433,-17167.292939432802,-16647.719608142201,-16143.038987416678,-15653.251077256185,-15178.355877660757,-14718.353388630383,-14273.243610165053,-13843.02654226479,-13427.702184929554,-13027.270538159395,-12641.73160195427,-12271.085376314219,-11915.331861239205,-11574.471056729257,-11248.502962784361,-10937.427579404506,-10641.244906589707,-10359.954944339977,-10093.557692655279,-9842.0531515356488,-9605.4413209810627,-9383.7222009915276,-9176.895791567058,-8984.9620927076303,-8807.9211044132553,-8645.7728266839367,-8498.5172595196691,-8366.1544029204615,-8248.6842568862976,-8146.1068214171937,-8058.4220965131426,-7985.6300821741424,-7927.7307784001878,-7884.724185191295,-7856.610302547454,-7843.3891304686604,-7845.0606689549313,-7861.6249180062259,-7893.0818776226151,-7939.4315478040335,-8000.6739285505064,-8076.8090198620393,-8167.8368217386214,-8273.7573341802472,-8394.5705571869385,-8530.2764907586825,-8680.875134895472,-8846.3664895973161,-9026.7505548642293,-9222.0273306961735,-9432.1968170931759,-9657.2590140552256,-9897.2139215823445,-10152.061539674505,-10421.801868331717,-10706.434907553994,-11005.960657341311,-11320.379117693697,-11649.69028861112,-11993.894170093594,-12352.990762141128,-12726.980064753729,-13115.862077931348,-13519.636801674051,-13938.304235981803,-14371.864380854597,-14820.317236292452,-15283.662802295352,-15761.9010788633,-16255.032065996329,-16763.055763694385,-17285.972171957503],[-37106.017694122223,-36177.721230734598,-35264.317477911987,-34365.806435654486,-33482.188103961962,-32613.462482834577,-31759.629572272184,-30920.689372274894,-30096.641882842581,-29287.487103975393,-28493.225035673182,-27713.855677936088,-26949.37903076403,-26199.795094157038,-25465.103868115097,-24745.305352638185,-24040.399547726323,-23350.386453379535,-22675.266069597812,-22015.038396381125,-21369.703433729483,-20739.261181642891,-20123.711640121386,-19523.054809164896,-18937.290688773479,-18366.419278947109,-17810.440579685797,-17269.354590989533,-16743.161312858327,-16231.860745292181,-15735.452888291045,-15253.937741854999,-14787.315305984008,-14335.585580678064,-13898.74856593717,-13476.804261761334,-13069.752668150544,-12677.5937851048,-12300.327612624127,-11937.954150708494,-11590.473399357921,-11257.885358572394,-10940.190028351928,-10637.387408696501,-10349.477499606146,-10076.460301080833,-9818.3358131205787,-9575.1040357253805,-9346.7649688952224,-9133.3186126301225,-8934.7649669300772,-8751.1040317950865,-8582.335807225154,-8428.4602932202688,-8289.4774897804327,-8165.3873969056494,-8056.1900145959171,-7961.8853428512393,-7882.4733816716252,-7817.9541310570467,-7768.3275910075281,-7733.5937615230705,-7713.7526426036657,-7708.8042342493027,-7718.7485364599925,-7743.5855492357441,-7783.3152725765431,-7837.9377064824048,-7907.4528509533156,-7991.8607059892656,-8091.1612715902775,-8205.3545477563493,-8334.4405344874594,-8478.4192317836423,-8637.2906396448725,-8811.0547580711391,-8999.711587062473,-9203.261126618856,-9421.7033767402972,-9655.038337426784,-9903.2660086783235,-10166.38639049491,-10444.399482876568,-10737.305285823277,-11045.10379933502,-11367.795023411829,-11705.378958053689,-12057.855603260612,-12425.224959032575,-12807.487025369603,-13204.641802271661,-13616.689289738793,-14043.629487770968,-14485.462396368193,-14942.188015530472,-15413.806345257812,-15900.317385550203,-16401.721136407643,-16918.017597830141,-17449.206769817691],[-36460.166038635602,-35540.142338972386,-34635.01134987425,-33744.773071341129,-32869.427503373081,-32008.974645970105,-31163.414499132145,-30332.747062859256,-29516.972337151426,-28716.090322008597,-27930.101017430905,-27159.004423418213,-26402.80053997058,-25661.489367088019,-24935.070904770502,-24223.545153018014,-23526.912111830628,-22845.17178120825,-22178.324161150929,-21526.369251658682,-20889.307052731499,-20267.137564369339,-19659.860786572248,-19067.476719340182,-18489.985362673207,-17927.386716571251,-17379.680781034396,-16846.867556062571,-16328.947041655778,-15825.919237814051,-15337.784144537363,-14864.541761825752,-14406.192089679189,-13962.735128097671,-13534.1708770812,-13120.499336629789,-12721.72050674343,-12337.834387422137,-11968.84097866589,-11614.740280474689,-11275.532292848558,-10951.217015787461,-10641.794449291425,-10347.264593360433,-10067.62744799451,-9802.8830131936193,-9553.0312889577981,-9318.0722752870333,-9098.005972181305,-8892.8323796406276,-8702.5514976650247,-8527.1633262544638,-8366.6678654089501,-8221.0651151284947,-8090.355075413092,-7974.5377462627457,-7873.6131276774495,-7787.5812196572033,-7716.4420222020162,-7660.195535311871,-7618.8417589867922,-7592.3806932267562,-7580.8123380317757,-7584.1366934018497,-7602.3537593369838,-7635.4635358371634,-7683.4660229023903,-7746.361220532679,-7824.149128728016,-7916.8297474884112,-8024.4030768138455,-8146.8691167043453,-8284.2278671599051,-8436.4793281805087,-8603.6234997661595,-8785.6603819168595,-8982.589974632634,-9194.4122779134486,-9421.1272917593142,-9662.7350161702343,-9919.2354511462145,-10190.628596687235,-10476.914452793317,-10778.093019464453,-11094.164296700628,-11425.128284501881,-11770.984982868162,-12131.734391799506,-12507.376511295908,-12897.911341357356,-13303.33888198386,-13723.659133175419,-14158.872094932023,-14608.977767253689,-15073.976150140403,-15553.867243592174,-16048.651047608997,-16558.327562190869,-17082.896787337799,-17622.35872304978],[-35824.231738520852,-34912.480802582089,-34015.62257720832,-33133.657062399667,-32266.584258156072,-31414.404164477477,-30577.116781363977,-29754.722108815513,-28947.220146832136,-28154.610895413782,-27376.894354560456,-26614.070524272203,-25866.139404549023,-25133.100995390843,-24414.955296797787,-23711.702308769731,-23023.342031306769,-22349.874464408815,-21691.299608075955,-21047.617462308128,-20418.828027105355,-19804.931302467641,-19205.927288394993,-18621.815984887337,-18052.597391944815,-17498.271509567297,-16958.838337754845,-16434.297876507451,-15924.650125825108,-15429.895085707805,-14950.032756155564,-14485.063137168379,-14034.986228746227,-13599.802030889156,-13179.510543597115,-12774.111766870139,-12383.605700708236,-12007.992345111355,-11647.271700079546,-11301.443765612767,-10970.508541711053,-10654.466028374405,-10353.316225602788,-10067.059133396238,-9795.6947517547451,-9539.2230806782918,-9297.6441201668986,-9070.9578702205617,-8859.164330839274,-8662.2635020230355,-8480.255383771846,-8313.1399760857203,-8160.9172789646473,-8023.5872924086198,-7901.1500164176468,-7793.6054509917294,-7700.9535961308693,-7623.1944518350501,-7560.3280181042974,-7512.3542949385919,-7479.2732823379411,-7461.0849803023357,-7457.7893888317903,-7469.3865079262905,-7495.8763375858543,-7537.2588778104673,-7593.5341286001285,-7664.7020899548543,-7750.762761874621,-7851.7161443594414,-7967.5622374093191,-8098.3010410242459,-8243.9325552042355,-8404.456779949267,-8579.8737152593567,-8770.1833611344919,-8975.3857175746907,-9195.4807845799332,-9430.4685621502394,-9680.3490502855893,-9945.1222489859938,-10224.788158251456,-10519.346778081968,-10828.798108477531,-11153.142149438139,-11492.37890096382,-11846.508363054538,-12215.530535710319,-12599.445418931145,-12998.253012717032,-13411.953317067953,-13840.546331983953,-14284.032057464994,-14742.410493511095,-15215.681640122235,-15703.845497298451,-16206.902065039691,-16724.851343345988,-17257.693332217365,-17805.428031653777],[-35198.214793778017,-34294.736621563672,-33406.151159914392,-32532.458408830134,-31673.658368310935,-30829.751038356793,-30000.736418967695,-29186.614510143736,-28387.38531188474,-27603.048824190824,-26833.605047061938,-26079.053980498116,-25339.395624499368,-24614.629979065634,-23904.757044196987,-23209.776819893385,-22529.689306154833,-21864.494502981303,-21214.192410372911,-20578.783028329501,-19958.266356851156,-19352.642395937874,-18761.911145589635,-18186.072605806472,-17625.126776588324,-17079.07365793526,-16547.913249847232,-16031.645552324258,-15530.270565366338,-15043.788288973479,-14572.198723145668,-14115.501867882918,-13673.697723185209,-13246.786289052559,-12834.767565484963,-12437.641552482424,-12055.408250044933,-11688.067658172491,-11335.619776865104,-10998.064606122776,-10675.402145945496,-10367.632396333258,-10074.755357286085,-9796.7710288039634,-9533.6794108868962,-9285.4805035348727,-9052.174306747911,-8833.7608205260094,-8630.2400448691442,-8441.6119797773426,-8267.8766252505884,-8109.0339812888942,-7965.0840478922482,-7836.0268250606596,-7721.8623127941173,-7622.5905110926333,-7538.2114199561984,-7468.7250393848171,-7414.1313693784887,-7374.4304099372148,-7349.6221610609891,-7339.7066227498253,-7344.6837950037097,-7364.5536778226497,-7399.3162712066378,-7448.9715751556796,-7513.5195896697805,-7592.9603147489288,-7687.2937503931271,-7796.5198966023836,-7920.6387533766847,-8059.6503207160549,-8213.5545986204688,-8382.3515870899264,-8566.0412861244549,-8764.6236957240271,-8978.0988158886539,-9206.4666466183226,-9449.7271879130603,-9707.8804397728363,-9980.9264021976815,-10268.865075187576,-10571.69645874251,-10889.420552862517,-11222.037357547561,-11569.546872797669,-11931.949098612815,-12309.244034993029,-12701.431681938288,-13108.5120394486,-13530.485107523962,-13967.350886164377,-14419.109375369851,-14885.760575140384,-15367.304485475956,-15863.741106376587,-16375.07043784228,-16901.292479873002,-17442.40723246881,-17998.414695629639],[-34582.115204407026,-33686.909795917134,-32806.597097992249,-31941.17711063246,-31090.649833837691,-30255.015267608003,-29434.273411943388,-28628.424266843744,-27837.46783230923,-27061.404108339739,-26300.233094935298,-25553.954792095901,-24822.569199821584,-24106.076318112297,-23404.476146968067,-22717.768686388896,-22045.953936374783,-21389.031896925713,-20747.002568041702,-20119.865949722735,-19507.622041968818,-18910.270844779967,-18327.812358156185,-17760.24658209741,-17207.57351660373,-16669.793161675087,-16146.905517311498,-15638.910583512949,-15145.808360279487,-14667.598847611047,-14204.282045507662,-13755.857953969338,-13322.326572996069,-12903.687902587848,-12499.941942744685,-12111.08869346658,-11737.128154753509,-11378.0603266055,-11033.885209022552,-10704.602802004643,-10390.2131055518,-10090.716119664005,-9806.1118443412524,-9536.4002795835659,-9281.5814253909339,-9041.6552817633565,-8816.6218487008155,-8606.4811262033472,-8411.2331142709099,-8230.8778129035418,-8065.4152221012246,-7914.8453418639638,-7779.168172191743,-7658.3837130845814,-7552.4919645424798,-7461.4929265654282,-7385.3865991534167,-7324.1729823064725,-7277.8520760245774,-7246.4238803077351,-7229.8883951559401,-7228.2456205692042,-7241.4955565475202,-7269.6382030908917,-7312.6735601993141,-7370.6016278727884,-7443.4224061113191,-7531.135894914898,-7633.7420942835297,-7751.2410042172141,-7883.6326247159559,-8030.9169557797541,-8193.0939974085923,-8370.1637496024905,-8562.1262123614506,-8768.9813856854435,-8990.7292695745055,-9227.3698640286184,-9478.9031690477786,-9745.3291846319989,-10026.647910781267,-10322.859347495589,-10633.963494774969,-10959.960352619401,-11300.849921028872,-11656.632200003412,-12027.307189542997,-12412.874889647632,-12813.335300317331,-13228.688421552077,-13658.934253351874,-14104.072795716729,-14564.104048646632,-15039.028012141585,-15528.844686201588,-16033.554070826653,-16553.156166016786,-17087.650971771931,-17637.038488092181,-18201.318714977424],[-33975.932970408016,-33089.000325642541,-32216.960391442088,-31359.813167806715,-30517.5586547364,-29690.196852231158,-28877.727760290923,-28080.151378915732,-27297.467708105643,-26529.676747860569,-25776.778498180574,-25038.772959065638,-24315.660130515709,-23607.440012530897,-22914.112605111099,-22235.677908256337,-21572.135921966656,-20923.48664624204,-20289.730081082424,-19670.866226487906,-19066.895082458424,-18477.816648994019,-17903.630926094658,-17344.337913760322,-16799.937611991045,-16270.430020786855,-15755.815140147683,-15256.092970073585,-14771.263510564533,-14301.326761620523,-13846.282723241586,-13406.13139542769,-12980.872778178846,-12570.506871495065,-12175.033675376322,-11794.453189822651,-11428.765414834012,-11077.970350410433,-10742.067996551918,-10421.058353258442,-10114.941420530025,-9823.7171983666667,-9547.3856867683462,-9285.9468857350912,-9039.400795266889,-8807.7474153637359,-8590.986746025641,-8389.1187872525898,-8202.1435390446022,-8030.0610014016584,-7872.8711743237654,-7730.5740578109335,-7603.169651863147,-7490.657956480426,-7393.0389716627469,-7310.3126974101251,-7242.4791337225533,-7189.5382806000316,-7151.4901380425727,-7128.334706050161,-7120.0719846228021,-7126.7019737604987,-7148.2246734632445,-7184.6400837310484,-7235.9482045638997,-7302.1490359618037,-7383.2425779247669,-7479.2288304527774,-7590.1077935458379,-7715.8794672039603,-7856.54385142713,-8012.1009462153543,-8182.5507515686368,-8367.8932674869611,-8568.1284939703473,-8783.2564310187772,-9013.2770786322744,-9258.1904368108117,-9517.9965055544053,-9792.6952848630481,-10082.28677473676,-10386.77097517551,-10706.147886179309,-11040.417507748174,-11389.579839882092,-11753.634882581064,-12132.582635845067,-12526.423099674141,-12935.156274068268,-13358.782159027451,-13797.300754551661,-14250.712060640959,-14719.016077295297,-15202.21280451468,-15700.302242299125,-16213.284390648636,-16741.159249563163,-17283.926819042779,-17841.587099087425,-18414.140089697139],[-33379.668091780855,-32501.008210739812,-31637.241040263798,-30788.366580352835,-29954.384831006966,-29135.295792226127,-28331.099464010345,-27541.795846359615,-26767.384939273921,-26007.866742753307,-25263.241256797737,-24533.508481407211,-23818.66841658175,-23118.721062321332,-22433.666418625966,-21763.504485495658,-21108.235262930422,-20467.858750930194,-19842.374949495039,-19231.783858624949,-18636.085478319899,-18055.27980857993,-17489.366849404982,-16938.346600795099,-16402.219062750271,-15880.984235270476,-15374.642118355758,-14883.192712006077,-14406.636016221453,-13944.972031001904,-13498.200756347376,-13066.322192257916,-12649.33633873351,-12247.243195774146,-11860.042763379852,-11487.735041550595,-11130.320030286406,-10787.797729587248,-10460.168139453166,-10147.431259884135,-9849.5870908801335,-9566.6356324412118,-9298.5768845673319,-9045.4108472585067,-8807.137520514736,-8583.756904336009,-8375.2689987223384,-8181.6738036737343,-8002.9713191901665,-7839.1615452716624,-7690.2444819181965,-7556.2201291297997,-7437.0884869064521,-7332.8495552481563,-7243.503334154907,-7169.0498236267185,-7109.4890236635802,-7064.8209342654936,-7035.0455554324617,-7020.1628871644807,-7020.1729294615579,-7035.0756823236788,-7064.8711457508616,-7109.5593197430971,-7169.1402043003764,-7243.6137994227174,-7332.9801051101094,-7437.2391213625506,-7556.3908481800481,-7690.435285562593,-7839.372433510197,-8003.2022920228637,-8181.9248611005623,-8375.5401407433274,-8584.0481309511488,-8807.4488317240084,-9045.7422430619299,-9298.9283649649096,-9567.0071974329367,-9849.9787404660092,-10147.842994064147,-10460.599958227323,-10788.249632955571,-11130.792018248858,-11488.227114107205,-11860.554920530605,-12247.775437519049,-12649.888665072551,-13066.894603191105,-13498.793251874729,-13945.584611123382,-14407.268680937097,-14883.845461315861,-15375.31495225969,-15881.677153768562,-16402.932065842491,-16939.079688481455,-17490.120021685507,-18056.053065454595,-18636.878819788733],[-32793.320568525625,-31922.933451208977,-31067.43904445746,-30226.837348270921,-29401.128362649484,-28590.312087593076,-27794.388523101705,-27013.357669175384,-26247.219525814166,-25495.974093017961,-24759.621370786823,-24038.161359120721,-23331.594058019684,-22639.91946748372,-21963.137587512778,-21301.248418106901,-20654.251959266097,-20022.148210990294,-19404.937173279581,-18802.618846133922,-18215.193229553301,-17642.660323537748,-17085.020128087228,-16542.272643201755,-16014.417868881384,-15501.455805126045,-15003.386451935743,-14520.209809310503,-14051.925877250311,-13598.534655755177,-13160.036144825099,-12736.430344460052,-12327.717254660085,-11933.896875425171,-11554.969206755284,-11190.934248650472,-10841.792001110702,-10507.542464135999,-10188.185637726336,-9883.7215218817291,-9594.1501166021662,-9319.4714218876688,-9059.685437738226,-8814.7921641538269,-8584.791601134486,-8369.6837486801924,-8169.4686067909579,-7984.1461754667816,-7813.7164547076472,-7658.1794445135683,-7517.5351448845486,-7391.7835558205752,-7280.9246773216564,-7184.9585093877904,-7103.885052018979,-7037.7043052152167,-6986.4162689765089,-6950.0209433028558,-6928.5183281942554,-6921.908423650706,-6930.1912296722176,-6953.3667462587691,-6991.4349734103798,-7044.3959111270451,-7112.249559408765,-7194.9959182555349,-7292.6349876673557,-7405.1667676442321,-7532.5912581861558,-7674.9084592931358,-7832.1183709651723,-8004.2209932022679,-8191.2163260044044,-8393.1043693715983,-8609.8851233038458,-8841.5585878011425,-9088.1247628634974,-9349.5836484909014,-9625.9352446833564,-9917.1795514408586,-10223.316568763426,-10544.346296651049,-10880.268735103718,-11231.083884121443,-11596.791743704211,-11977.392313852051,-12372.885594564923,-12783.271585842866,-13208.550287685854,-13648.721700093907,-14103.785823066984,-14573.742656605142,-15058.592200708335,-15558.334455376576,-16072.969420609879,-16602.497096408246,-17146.917482771663,-17706.230579700121,-18280.436387193644,-18869.534905252218],[-32216.890400642274,-31354.776047050051,-30507.554404022951,-29675.225471560872,-28857.789249663838,-28055.245738331876,-27267.594937564936,-26494.836847363062,-25736.97146772626,-24993.998798654466,-24265.918840147773,-23552.731592206124,-22854.437054829526,-22171.035228017965,-21502.526111771447,-20848.909706090031,-20210.186010973637,-19586.355026422265,-18977.416752435987,-18383.371189014782,-17804.218336158578,-17239.958193867453,-16690.590762141386,-16156.116040980376,-15636.534030384399,-15131.844730353485,-14642.048140887613,-14167.144261986792,-13707.133093651037,-13262.014635880338,-12831.788888674688,-12416.455852034083,-12016.015525958544,-11630.467910448049,-11259.813005502619,-10904.05081112223,-10563.181327306891,-10237.204554056605,-9926.1204913713809,-9629.9291392512168,-9348.6304976960782,-9082.224566706016,-8830.7113462810066,-8594.0908364210391,-8372.3630371261352,-8165.527948396275,-7973.5855702314693,-7796.5359026317165,-7634.3789455970191,-7487.1146991273718,-7354.7431632227772,-7237.2643378832418,-7134.6782231087564,-7046.9848188993237,-6974.1841252549402,-6916.2761421756113,-6873.2608696613388,-6845.1383077121118,-6831.9084563279494,-6833.5713155088324,-6850.1268852547728,-6881.5751655657587,-6927.9161564417991,-6989.149857882895,-7065.2762698890419,-7156.2953924602443,-7262.2072255964995,-7383.011769297811,-7518.7090235641717,-7669.2989883955779,-7834.7816637920432,-8015.1570497535658,-8210.4251462801385,-8420.585953371763,-8645.6394710284512,-8885.5856992501722,-9140.4246380369532,-9410.1562873887979,-9694.7806473056862,-9994.2977177876273,-10308.707498834625,-10638.009990446666,-10982.205192623769,-11341.29310536593,-11715.273728673128,-12104.147062545409,-12507.913106982722,-12926.57186198508,-13360.123327552497,-13808.567503684977,-14271.904390382491,-14750.13398764508,-15243.256295472713,-15751.271313865385,-16274.179042823125,-16811.979482345938,-17364.672632433751,-17932.258493086651,-18514.737064304627,-19112.108346087582],[-31650.377588130832,-30796.535998263083,-29957.587118960364,-29133.530950222725,-28324.367492050143,-27530.096744442599,-26750.71870740009,-25986.233380922662,-25236.640765010306,-24501.940859662944,-23782.133664880661,-23077.219180663451,-22387.197407011285,-21712.06834392414,-21051.831991402094,-20406.48834944507,-19776.037418053107,-19160.479197226174,-18559.813686964357,-17974.040887267533,-17403.160798135803,-16847.173419569117,-16306.078751567451,-15779.87679413086,-15268.567547259328,-14772.151010952837,-14290.627185211408,-13823.996070035022,-13372.257665423702,-12935.411971377436,-12513.458987896211,-12106.39871498004,-11714.231152628916,-11336.956300842861,-10974.574159621858,-10627.084728965903,-10294.488008875,-9976.7839993491489,-9673.97270038836,-9386.0541119926129,-9113.0282341619113,-8854.8950668962825,-8611.6546101956992,-8383.306864060165,-8169.8518284896882,-7971.2895034842641,-7787.6198890438818,-7618.8429851685723,-7464.9587918583002,-7325.9673091130853,-7201.8685369329287,-7092.6624753178194,-6998.3491242677655,-6918.9284837827618,-6854.4005538628098,-6804.7653345079198,-6770.0228257180734,-6750.1730274932816,-6745.2159398335425,-6755.151562738858,-6779.9798962092282,-6819.7009402446483,-6874.3146948451213,-6943.8211600106479,-7028.2203357412263,-7127.5122220368612,-7241.6968188975461,-7370.7741263232901,-7514.7441443140806,-7673.6068728699174,-7847.3623119908225,-8036.0104616767721,-8239.5513219277746,-8457.9848927438325,-8691.311174124945,-8939.5301660710975,-9202.6418685823191,-9480.6462816585899,-9773.5434052999135,-10081.333239506283,-10404.015784277708,-10741.591039614188,-11094.059005515726,-11461.419681982317,-11843.673069013947,-12240.819166610647,-12652.857974772394,-13079.789493499191,-13521.613722791035,-13978.330662647939,-14449.940313069896,-14936.442674056909,-15437.837745608973,-15954.125527726079,-16485.30602040825,-17031.37922365548,-17592.345137467746,-18168.203761845092,-18758.955096787467,-19364.599142294886],[-31093.782130991305,-30248.213304847959,-29417.537189269693,-28601.753784256471,-27800.863089808314,-27014.865105925193,-26243.759832607131,-25487.547269854113,-24746.227417666159,-24019.800276043257,-23308.265844985421,-22611.624124492657,-21929.8751145649,-21263.018815202217,-20611.055226404555,-19973.984348172009,-19351.806180504471,-18744.52072340198,-18152.127976864558,-17574.627940892191,-17012.020615484878,-16464.306000642606,-15931.484096365395,-15413.554902653232,-14910.518419506136,-14422.374646924076,-13949.123584907085,-13490.765233455128,-13047.299592568226,-12618.726662246401,-12205.046442489616,-11806.258933297868,-11422.364134671197,-11053.36204660956,-10699.252669112984,-10360.036002181459,-10035.712045814995,-9726.2808000135701,-9431.7422647772109,-9152.0964401058991,-8887.3433259996364,-8637.4829224584337,-8402.5152294822783,-8182.4402470711793,-7977.2579752251322,-7786.9684139441415,-7611.5715632281972,-7451.0674230773084,-7305.4559934914723,-7174.7372744706909,-7058.911266014964,-6957.9779681242835,-6871.9373807986622,-6800.7895040380936,-6744.534337842575,-6703.1718822121093,-6676.7021371466972,-6665.1251026463415,-6668.4407787110376,-6686.6491653407829,-6719.7502625355837,-6767.7440702954391,-6830.6305886203445,-6908.4098175103027,-7001.0817569653091,-7108.6464069853791,-7231.1037675704965,-7368.453838720663,-7520.6966204358887,-7687.8321127161707,-7869.8603155615019,-8066.7812289718786,-8278.5948529473153,-8505.301187487803,-8746.9002325933488,-9003.3919882639348,-9274.776454499588,-9561.0536313002922,-9862.22351866604,-10178.286116596842,-10509.241425092714,-10855.089444153618,-11215.830173779581,-11591.463613970613,-11981.989764726681,-12387.408626047796,-12807.720197933981,-13242.9244803852,-13693.021473401488,-14158.011176982827,-14637.893591129219,-15132.668715840657,-15642.336551117149,-16166.897096958694,-16706.350353365291,-17260.696320336967,-17829.934997873643,-18414.06638597542,-19013.090484642242,-19627.007293874089],[-30547.104029223614,-29709.807966804707,-28887.404614950901,-28079.893973662096,-27287.276042938378,-26509.550822779704,-25746.718313186058,-24998.7785141575,-24265.731425693964,-23547.577047795516,-22844.315380462103,-22155.946423693727,-21482.47017749041,-20823.886641852172,-20180.195816778956,-19551.397702270813,-18937.492298327707,-18338.479604949673,-17754.359622136679,-17185.132349888736,-16630.797788205833,-16091.355937088025,-15566.806796535229,-15057.15036654751,-14562.38664712484,-14082.515638267218,-13617.537339974646,-13167.451752247127,-12732.258875084664,-12311.958708487271,-11906.551252454905,-11516.036506987613,-11140.414472085355,-10779.68514774816,-10433.848533976008,-10102.904630768917,-9786.8534381268801,-9485.6949560498906,-9199.4291845379612,-8928.0561235910827,-8671.5757732092552,-8429.9881333924823,-8203.2932041407585,-7991.4909854540947,-7794.5814773324755,-7612.56467977592,-7445.4405927844073,-7293.2092163579473,-7155.870550496551,-7033.4245952001957,-6925.8713504688985,-6833.2108163026551,-6755.4429927014626,-6692.5678796653301,-6644.5854771942377,-6611.4957852882089,-6593.2988039472266,-6589.9945331713016,-6601.5829729604338,-6628.0641233146071,-6669.4379842338431,-6725.7045557181282,-6796.8638377674679,-6882.9158303818531,-6983.8605335612992,-7099.6979473057963,-7230.4280716153471,-7376.050906489947,-7536.5664519296006,-7711.9747079343142,-7902.2756745040697,-8107.4693516388852,-8327.5557393387571,-8562.5348376036745,-8812.4066464336574,-9077.1711658286731,-9356.8283957887543,-9651.3783363138882,-9960.8209874040713,-10285.156349059314,-10624.384421279607,-10978.505204064943,-11347.518697415346,-11731.424901330804,-12130.223815811296,-12543.915440856857,-12972.499776467461,-13415.976822643117,-13874.34657938383,-14347.609046689613,-14835.764224560424,-15338.8121129963,-15856.752711997229,-16389.586021563206,-16937.31204169424,-17499.93077239034,-18077.442213651448,-18669.846365477653,-19277.143227868895,-19899.332800825192],[-30010.343282827853,-29181.319984133421,-28367.189396004025,-27567.951518439695,-26783.606351440387,-26014.153895006115,-25259.594149136923,-24519.927113832789,-23795.152789093678,-23085.271174919653,-22390.282271310673,-21710.186078266757,-21044.982595787871,-20394.67182387405,-19759.253762525273,-19138.728411741555,-18533.095771522894,-17942.355841869277,-17366.508622780711,-16805.554114257207,-16259.492316298747,-15728.323228905354,-15212.046852077016,-14710.663185813704,-14224.17223011547,-13752.573984982273,-13295.868450414147,-12854.055626411073,-12427.135512973024,-12015.108110100044,-11617.973417792131,-11235.731436049258,-10868.382164871429,-10515.925604258668,-10178.361754210957,-9855.6906147282971,-9547.9121858106901,-9255.0264674581358,-8977.0334596706343,-8713.9331624481838,-8465.7255757907878,-8232.4106996984447,-8013.9885341711606,-7810.4590792089166,-7621.8223348117372,-7448.078300979605,-7289.2269777125275,-7145.2683650105064,-7016.2024628735362,-6902.0292713016133,-6802.7487902947487,-6718.3610198529368,-6648.8659599761777,-6594.2636106644723,-6554.5539719178178,-6529.7370437362133,-6519.8128261196662,-6524.7813190681718,-6544.6425225817275,-6579.3964366603386,-6629.0430613040044,-6693.5823965127165,-6773.0144422864869,-6867.3391986253127,-6976.5566655291896,-7100.6668429981155,-7239.6697310320997,-7393.5653296311284,-7562.3536387952163,-7746.0346585243569,-7944.6083888185522,-8158.0748296777965,-8386.4339811020945,-8629.6858430914399,-8887.830415645858,-9160.8676987653089,-9448.7976924498162,-9751.620396699378,-10069.335811514007,-10401.943936893671,-10749.444772838393,-11111.838319348168,-11489.12457642299,-11881.303544062892,-12288.37522226781,-12710.339611037807,-13147.196710372833,-13598.946520272932,-14065.589040738081,-14547.124271768284,-15043.55221336354,-15554.87286552385,-16081.086228249194,-16622.192301539602,-17178.191085395061,-17749.082579815593,-18334.866784801146,-18935.543700351795,-19551.113326467454,-20181.575663148178],[-29483.499891804036,-28662.749356834014,-27856.891532429057,-27065.926418589093,-26289.854015314253,-25528.674322604427,-24782.387340459674,-24050.993068879958,-23334.491507865299,-22632.882657415706,-21946.166517531143,-21274.343088211644,-20617.412369457219,-19975.374361267808,-19348.229063643463,-18735.97647658419,-18138.616600089947,-17556.149434160747,-16988.574978796634,-16435.893233997551,-15898.104199763546,-15375.207876094575,-14867.204262990666,-14374.093360451783,-13895.875168477971,-13432.549687069213,-12984.116916225512,-12550.576855946862,-12131.929506233266,-11728.174867084717,-11339.312938501229,-10965.343720482786,-10606.267213029398,-10262.083416141068,-9932.7923298177848,-9618.3939540595584,-9318.8882888663811,-9034.2753342382566,-8764.5550901751903,-8509.727556677175,-8269.7927337442106,-8044.7506213763045,-7834.6012195734456,-7639.3445283356386,-7458.9805476628853,-7293.5092775551911,-7142.9307180125415,-7007.2448690349502,-6886.4517306224088,-6780.5513027749221,-6689.5435854924908,-6613.4285787751087,-6552.2062826227802,-6505.8766970355064,-6474.4398220132862,-6457.8956575561106,-6456.2442036640005,-6469.4854603369349,-6497.6194275749222,-6540.6461053779676,-6598.565493746064,-6671.3775926792114,-6759.0824021774124,-6861.679922240668,-6979.17015286897,-7111.5530940623357,-7258.828745820746,-7420.9971081442145,-7598.0581810327312,-7790.0119644863062,-7996.8584585049284,-8218.5976630886034,-8455.229578237333,-8706.7542039511245,-8973.1715402299633,-9254.4815870738421,-9550.6843444827937,-9861.7798124567853,-10187.767990995828,-10528.648880099936,-10884.422479769099,-11255.088790003301,-11640.647810802566,-12041.099542166885,-12456.44398409624,-12886.681136590661,-13331.810999650137,-13791.833573274667,-14266.748857464232,-14756.55685221887,-15261.257557538536,-15780.850973423276,-16315.33709987307,-16864.715936887915,-17428.987484467805,-18008.151742612765,-18602.208711322761,-19211.158390597811,-19835.000780437935,-20473.735880843084],[-28966.573856152165,-28154.096084906509,-27356.511024225991,-26573.818674110509,-25806.019034560064,-25053.112105574677,-24315.097887154348,-23591.976379299056,-22883.747582008837,-22190.411495283661,-21511.968119123543,-20848.417453528476,-20199.75949849845,-19565.994254033489,-18947.121720133597,-18343.141896798734,-17754.054784028922,-17179.860381824161,-16620.558690184476,-16076.149709109837,-15546.633438600227,-15032.009878655708,-14532.279029276222,-14047.440890461774,-13577.495462212419,-13122.442744528094,-12682.282737408808,-12257.01544085459,-11846.640854865422,-11451.158979441305,-11070.569814582257,-10704.87336028824,-10354.069616559274,-10018.15858339538,-9697.1402607965319,-9391.0146487627353,-9099.7817472939896,-8823.441556390304,-8561.9940760516638,-8315.4393062780764,-8083.7772470695418,-7867.0078984260654,-7665.1312603476435,-7478.1473328342654,-7306.05611588595,-7148.8576095026801,-7006.5518136844676,-6879.1387284313041,-6766.618353743198,-6668.990689620141,-6586.2557360621377,-6518.4134930691889,-6465.463960641292,-6427.4071387784479,-6404.2430274806538,-6395.9716267479198,-6402.5929365802367,-6424.1069569776027,-6460.5136879400234,-6511.8131294675004,-6578.0052815600202,-6659.0901442176055,-6755.0677174402372,-6865.9380012279244,-6991.7009955806607,-7132.3567004984561,-7287.9051159812971,-7458.3462420291962,-7643.6800786421427,-7843.9066258201437,-8059.0258835632012,-8289.0378518713151,-8533.9425307444781,-8793.7399201826884,-9068.4300201859678,-9358.01283075428,-9662.4883518876559,-9981.8565835860845,-10316.11752584956,-10665.271178678093,-11029.317542071685,-11408.256616030318,-11802.08840055401,-12210.812895642757,-12634.430101296559,-13072.940017515415,-13526.342644299311,-13994.637981648269,-14477.826029562279,-14975.90678804134,-15488.880257085448,-16016.746436694621,-16559.505326868857,-17117.156927608125,-17689.701238912443,-18277.138260781838,-18879.467993216262,-19496.690436215758,-20128.805589780299,-20775.813453909868],[-28459.565175872063,-27655.360168350904,-26866.04787139481,-26091.628285003739,-25332.10140917774,-24587.467243916784,-23857.725789220887,-23142.877045090027,-22442.921011524224,-21757.857688523502,-21087.687076087801,-20432.409174217166,-19792.023982911578,-19166.531502171067,-18555.931731995584,-17960.224672385146,-17379.410323339802,-16813.488684859465,-16262.459756944192,-15726.323539593983,-15205.080032808828,-14698.729236588733,-14207.271150933662,-13730.705775843669,-13269.033111318722,-12822.253157358831,-12390.365913963997,-11973.371381134204,-11571.269558869462,-11184.060447169777,-10811.744046035154,-10454.32035546557,-10111.78937546105,-9784.1511060215853,-9471.4055471471638,-9173.5526988378006,-8890.5925610934937,-8622.5251339142233,-8369.3504173000256,-8131.0684112508698,-7907.6791157667667,-7699.1825308477273,-7505.5786564937298,-7326.8674927047869,-7163.0490394808976,-7014.1232968220638,-6880.0902647282783,-6760.9499431995519,-6656.7023322358727,-6567.34743183725,-6492.885242003681,-6433.3157627351638,-6388.6389940316994,-6358.8549358932851,-6343.9635883199262,-6343.9649513116201,-6358.8590248683677,-6388.6458089901707,-6433.3253036770211,-6492.8975089289279,-6567.3624247458838,-6656.7200511278998,-6760.970388074963,-6880.1134355870818,-7014.1491936642497,-7163.0776623064758,-7326.8988415137501,-7505.6127312860781,-7699.2193316234607,-7907.7186425258988,-8131.1106639933823,-8369.3953960259332,-8622.5728386235169,-8890.6429917861678,-9173.6058555138734,-9471.461429806619,-9784.2097146644246,-10111.850710087287,-10454.384416075198,-10811.810832628171,-11184.129959746188,-11571.341797429246,-11973.446345677383,-12390.44360449056,-12822.333573868782,-13269.116253812066,-13730.791644320403,-14207.359745393791,-14698.82055703223,-15205.174079235729,-15726.420312004269,-16262.559255337866,-16813.590909236518,-17379.515273700243,-17960.332348728989,-18556.042134322801,-19166.644630481653,-19792.139837205599,-20432.527754494578,-21087.808382348594],[-27962.473850963986,-27166.541607167223,-26385.502073935531,-25619.35525126892,-24868.101139167324,-24131.739737630822,-23410.271046659349,-22703.695066252927,-22012.011796411549,-21335.221237135251,-20673.323388424,-20026.318250277785,-19394.205822696655,-18776.98610568056,-18174.659099229495,-17587.224803343521,-17014.683218022565,-16457.034343266678,-15914.278179075834,-15386.414725450069,-14873.443982389343,-14375.365949893659,-13892.180627963038,-13423.888016597464,-12970.488115796959,-12531.980925561493,-12108.366445891086,-11699.644676785727,-11305.815618245424,-10926.879270270174,-10562.83563285998,-10213.684706014827,-9879.4264897347348,-9560.0609840196921,-9255.5881888697077,-8966.0081042847778,-8691.3207302648952,-8431.5260668100709,-8186.6241139202939,-7956.6148715955751,-7741.4983398359045,-7541.2745186412913,-7355.9434080117244,-7185.5050079472167,-7029.9593184477617,-6889.3063395133559,-6763.546071144001,-6652.6785133397088,-6556.7036661004604,-6475.6215294262674,-6409.4321033171273,-6358.1353877730453,-6321.7313827940088,-6300.2200883800297,-6293.6015045311033,-6301.8756312472269,-6325.0424685284097,-6363.1020163746371,-6416.0542747859199,-6483.8992437622592,-6566.6369233036476,-6664.2673134100933,-6776.7904140815881,-6904.2062253181393,-7046.5147471197397,-7203.7159794863946,-7375.8099224181024,-7562.7965759148628,-7764.6759399766834,-7981.4480146035467,-8213.1127997954609,-8459.6702955524343,-8721.1205018744604,-8997.4634187615411,-9288.699046213671,-9594.8273842308499,-9915.8484328130999,-10251.762191960388,-10602.568661672725,-10968.267841950121,-11348.859732792582,-11744.34433420007,-12154.721646172628,-12579.991668710238,-13020.154401812904,-13475.209845480618,-13945.157999713387,-14429.998864511197,-14929.73243987408,-15444.358725802022,-15973.877722294983,-16518.289429353015,-17077.593846976102,-17651.790975164226,-18240.880813917422,-18844.863363235665,-19463.738623118952,-20097.506593567312,-20746.167274580723,-21409.720666159163],[-27475.299881427665,-26687.640401355391,-25914.873631848124,-25156.999572905952,-24414.018224528816,-23685.929586716702,-22972.73365946969,-22274.4304427877,-21591.019936670753,-20922.502141118897,-20268.877056132067,-19630.144681710277,-19006.305017853574,-18397.358064561908,-17803.303821835289,-17224.142289673728,-16659.873468077232,-16110.49735704577,-15576.013956579354,-15056.423266678026,-14551.725287341727,-14061.920018570485,-13587.007460364295,-13126.987612723156,-12681.860475647076,-12251.626049136039,-11836.284333190062,-11435.835327809127,-11050.279032993269,-10679.615448742443,-10323.844575056683,-9982.9664119359641,-9656.9809593803093,-9345.8882173897018,-9049.6881859641453,-8768.3808651036416,-8501.9662548081906,-8250.444355077796,-8013.8151659124533,-7792.0786873121688,-7585.2349192769307,-7393.2838618067472,-7216.2255149016164,-7054.0598785615348,-6906.786952786515,-6774.4067375765417,-6656.9192329316229,-6554.324438851756,-6466.6223553369418,-6393.8129823871805,-6335.8963200024755,-6292.8723681828214,-6264.7411269282184,-6251.5025962386717,-6253.156776114175,-6269.7036665547303,-6301.1432675603446,-6347.4755791310054,-6408.7006012667225,-6484.8183339674933,-6575.8287772333124,-6681.7319310641888,-6802.5277954601188,-6938.216370421098,-7088.7976559471317,-7254.2716520382201,-7434.6383586943593,-7629.8977759155487,-7840.0499037017962,-8065.094742053092,-8305.0322909694441,-8559.8625504508564,-8829.5855204973122,-9114.2012011088245,-9413.7095922853878,-9728.1106940269983,-10057.404506333676,-10401.591029205392,-10760.670262642168,-11134.642206643988,-11523.506861210881,-11927.264226342812,-12345.914302039801,-12779.45708830184,-13227.892585128924,-13691.220792521081,-14169.441710478284,-14662.555339000528,-15170.561678087824,-15693.46072774019,-16231.252487957594,-16783.936958740065,-17351.514140087591,-17933.984032000146,-18531.346634477755,-19143.601947520452,-19770.749971128156,-20412.790705300977,-21069.724150038812,-21741.550305341683],[-26998.043267263361,-26218.65655091549,-25454.162545132698,-24704.561249914943,-23969.852665262217,-23250.036791174549,-22545.113627651932,-21855.083174694395,-21179.945432301894,-20519.700400474474,-19874.34807921205,-19243.888468514713,-18628.321568382438,-18027.6473788152,-17441.865899813016,-16870.977131375883,-16314.98107350381,-15773.877726196783,-15247.667089454817,-14736.349163277908,-14239.923947666028,-13758.39144261922,-13291.751648137461,-12840.004564220766,-12403.150190869103,-11981.188528082514,-11574.119575860961,-11181.943334204458,-10804.65980311302,-10442.26898258664,-10094.770872625306,-9762.165473229019,-9444.4527843977849,-9141.6328061316126,-8853.7055384304876,-8580.6709812944191,-8322.529134723407,-8079.2799987174385,-7850.9235732765283,-7637.4598584006726,-7438.8888540898697,-7255.2105603441159,-7086.4249771634159,-6932.5321045477649,-6793.5319424971758,-6669.424491011634,-6560.2097500911459,-6465.8877197357106,-6386.4583999453316,-6321.92179072,-6272.2778920597257,-6237.5267039645032,-6217.6682264343317,-6212.7024594692139,-6222.6294030691515,-6247.449057234141,-6287.1614219641815,-6341.7664972592793,-6411.2642831194216,-6495.6547795446277,-6594.9379865348783,-6709.1139040901853,-6838.1825322105433,-6982.1438708959586,-7140.9979201464193,-7314.7446799619393,-7503.3841503425119,-7706.9163312881356,-7925.3412227988156,-8158.6588248745429,-8406.8691375153212,-8669.9721607211613,-8947.9678944920488,-9240.8563388279872,-9548.6374937289947,-9871.3113591950314,-10208.877935226143,-10561.33722182229,-10928.689218983502,-11310.933926709758,-11708.07134500107,-12120.101473857434,-12547.024313278856,-12988.839863265328,-13445.548123816843,-13917.149094933417,-14403.642776615059,-14905.029168861738,-15421.30827167347,-15952.480085050276,-16498.544608992106,-17059.501843499016,-17635.351788570944,-18226.094444207942,-18831.729810410001,-19452.257887177126,-20087.678674509269,-20737.992172406477,-21403.198380868766,-22083.297299896047],[-26530.704008470922,-25759.590055847482,-25003.368813789093,-24262.040282295769,-23535.604461367482,-22824.061351004246,-22127.410951206104,-21445.653261972962,-20778.788283304908,-20126.816015201894,-19489.736457663919,-18867.549610691,-18260.255474283163,-17667.85404844036,-17090.345333162615,-16527.729328449925,-15980.006034302271,-15447.175450719682,-14929.237577702143,-14426.192415249654,-13938.03996336222,-13464.780222039844,-13006.413191282518,-12562.938871090239,-12134.357261463028,-11720.668362400853,-11321.872173903739,-10937.968695971678,-10568.957928604661,-10214.839871802713,-9875.6145255658103,-9551.2818898939622,-9241.8419647871615,-8947.2947502454226,-8667.6402462687292,-8402.8784528570886,-8153.0093700105044,-7918.032997728973,-7697.9493360124925,-7492.7583848610666,-7302.4601442746934,-7127.0546142533731,-6966.5417947971082,-6820.9216859058924,-6690.1942875797313,-6574.3595998186229,-6473.4176226225663,-6387.3683559915617,-6316.2117999256106,-6259.947954424717,-6218.5768194888733,-6192.0983951180815,-6180.5126813123416,-6183.8196780716607,-6202.0193853960245,-6235.1118032854465,-6283.0969317399185,-6345.974770759447,-6423.7453203440245,-6516.4085804936612,-6623.9645512083425,-6746.4132324880829,-6883.7546243328743,-7035.9887267427184,-7203.1155397176099,-7385.1350632575686,-7582.0472973625683,-7793.8522420326244,-8020.5498972677333,-8262.1402630678913,-8518.6233394331066,-8789.9991263633838,-9076.2676238587046,-9377.4288319190709,-9693.4827505445064,-10024.42937973498,-10370.268719490514,-10731.000769811097,-11106.625530696729,-11497.143002147426,-11902.55318416318,-12322.85607674397,-12758.051679889821,-13208.139993600729,-13673.121017876678,-14152.994752717703,-14647.761198123766,-15157.420354094867,-15681.972220631031,-16221.416797732267,-16775.754085398534,-17344.984083629868,-17929.106792426232,-18528.122211787675,-19142.030341714159,-19770.831182205697,-20414.524733262268,-21073.110994883944,-21746.589967070657,-22434.96164982237],[-26073.282105050392,-25310.440916151398,-24562.492437817447,-23829.436670048533,-23111.273612844692,-22408.003266205887,-21719.625630132177,-21046.140704623464,-20387.548489679844,-19743.848985301258,-19115.042191487715,-18501.128108239249,-17902.106735555819,-17317.978073437451,-16748.742121884126,-16194.398880895875,-15654.948350472647,-15130.39053061449,-14620.725421321378,-14125.953022593325,-13646.073334430335,-13181.086356832384,-12730.992089799489,-12295.790533331639,-11875.481687428859,-11470.065552091117,-11079.542127318437,-10703.911413110805,-10343.173409468225,-9997.3281163907013,-9666.3755338782357,-9350.3156619308138,-9049.1485005484465,-8762.8740497311392,-8491.4923094788755,-8235.003279791672,-7993.4069606695157,-7766.7033521124094,-7554.8924541203669,-7357.9742666933716,-7175.9487898314292,-7008.8160235345458,-6856.5759678027071,-6719.2286226359211,-6596.7739880341942,-6489.2120639975155,-6396.5428505258924,-6318.7663476193211,-6255.8825552778035,-6207.891473501335,-6174.7931022899229,-6156.5874416435618,-6153.274491562257,-6164.8542520459996,-6191.326723094804,-6232.6919047086531,-6288.9497968875621,-6360.1003996315194,-6446.1437129405276,-6547.0797368145913,-6662.9084712537096,-6793.6299162578789,-6939.2440718271018,-7099.7509379613839,-7275.1505146607014,-7465.44280192509,-7670.6277997545203,-7890.7055081490053,-8125.6759271085484,-8375.5390566331389,-8640.2948967227894,-8919.9434473774927,-9214.4847085972451,-9523.9186803820485,-9848.2453627319064,-10187.464755646814,-10541.576859126782,-10910.581673171801,-11294.47919778186,-11693.269432956986,-12106.952378697173,-12535.528035002386,-12978.996401872677,-13437.357479308017,-13910.611267308394,-14398.75776587385,-14901.796975004339,-15419.72889469988,-15952.553524960478,-16500.270865786144,-17062.880917176833,-17640.383679132599,-18232.779151653402,-18840.067334739273,-19462.248228390166,-20099.321832606169,-20751.288147387189,-21418.147172733261,-22099.898908644391,-22796.543355120572],[-25625.77755700174,-24871.209131827185,-24131.533417217659,-23406.750413173198,-22696.860119693774,-22001.862536779423,-21321.757664430101,-20656.545502645859,-20006.226051426638,-19370.799310772487,-18750.265280683379,-18144.623961159348,-17553.875352200354,-16978.019453806417,-16417.056265977531,-15870.985788713679,-15339.808022014933,-14823.522965881191,-14322.130620312506,-13835.630985308886,-13364.024060870315,-12907.309846996815,-12465.488343688341,-12038.559550944927,-11626.523468766578,-11229.380097153271,-10847.129436105017,-10479.771485621823,-10127.306245703676,-9789.7337163505836,-9467.0538975625441,-9159.2667893395555,-8866.3723916816234,-8588.3707045887422,-8325.2617280609156,-8077.04546209814,-7843.7219067004153,-7625.2910618677506,-7421.7529276001351,-7233.1075038975723,-7059.3547907600596,-6900.4947881876069,-6756.5274961801988,-6627.452914737848,-6513.2710438605491,-6413.9818835483075,-6329.5854338011122,-6260.0816946189725,-6205.4706660018865,-6165.752347949855,-6140.9267404628708,-6130.9938435409458,-6135.953657184069,-6155.8061813922495,-6190.5514161654783,-6240.1893615037616,-6304.7200174070967,-6384.1433838754911,-6478.4594609089318,-6587.6682485074307,-6711.7697466709742,-6850.7639553995823,-7004.6508746932359,-7173.4305045519432,-7357.1028449757032,-7555.6678959645124,-7769.1256575183797,-7997.4761296373053,-8240.7193123212728,-8498.8552055702967,-8771.8838093843769,-9059.8051237635118,-9362.6191487076903,-9680.3258842169307,-10012.925330291222,-10360.417486930561,-10722.802354134961,-11100.079931904409,-11492.250220238911,-11899.313219138472,-12321.268928603076,-12758.117348632735,-13209.858479227456,-13676.492320387224,-14158.01887211203,-14654.438134401918,-15165.75010725683,-15691.954790676808,-16233.052184661841,-16789.042289211939,-17359.925104327071,-17945.700630007264,-18546.368866252502,-19161.929813062801,-19792.383470438144,-20437.729838378546,-21097.968916883961,-21773.100705954515,-22463.125205590084,-23168.042415790682],[-25188.190364325004,-24441.894702874888,-23710.491751989779,-22993.98151166975,-22292.363981914772,-21605.63916272483,-20933.807054099962,-20276.867656040125,-19634.820968545362,-19007.666991615632,-18395.405725250956,-17798.037169451356,-17215.561324216789,-16647.978189547277,-16095.287765442838,-15557.490051903427,-15034.585048929073,-14526.572756519781,-14033.453174675537,-13555.226303396346,-13091.892142682207,-12643.450692533133,-12209.901952949098,-11791.245923930126,-11387.482605476198,-10998.611997587323,-10624.634100263505,-10265.548913504739,-9921.3564373110221,-9592.0566716823632,-9277.649616618759,-8978.1352721201947,-8693.5136381867032,-8423.7847148182482,-8168.9485020148577,-7929.0049997765072,-7703.9542081032205,-7493.7961269949856,-7298.5307564518025,-7118.1580964736704,-6952.6781470605929,-6802.0909082125709,-6666.3963799295952,-6545.594562211676,-6439.6854550588087,-6348.6690584709959,-6272.545372448235,-6211.3143969905286,-6164.9761320978714,-6133.5305777702706,-6116.9777340077244,-6115.3176008102291,-6128.5501781777839,-6156.6754661103951,-6199.6934646080581,-6257.6041736707721,-6330.4075932985425,-6418.1037234913638,-6520.6925642492379,-6638.1741155721693,-6770.5483774601489,-6917.8153499131831,-7079.9750329312656,-7257.0274265144108,-7448.9725306625987,-7655.8103453758449,-7877.5408706541448,-8114.1641064974938,-8365.6800529058928,-8632.0887098793555,-8913.3900774178655,-9209.5841555214283,-9520.6709441900493,-9846.6504434237104,-10187.522653222444,-10543.287573586211,-10913.945204515043,-11299.49554600892,-11699.938598067845,-12115.274360691838,-12545.502833880886,-12990.624017634975,-13450.637911954114,-13925.544516838327,-14415.34383228757,-14920.035858301888,-15439.620594881233,-15974.098042025642,-16523.4681997351,-17087.731068009623,-17666.886646849191,-18260.934936253805,-18869.87593622347,-19493.709646758216,-20132.436067857983,-20786.055199522831,-21454.567041752714,-22137.971594547649,-22836.268857907671,-23549.458831832686],[-24760.520527020206,-24022.49762929447,-23299.367442133829,-22591.129965538217,-21897.785199507685,-21219.333144042153,-20555.773799141731,-19907.107164806337,-19273.333241035998,-18654.452027830714,-18050.463525190462,-17461.367733115294,-16887.164651605148,-16327.854280660069,-15783.436620280059,-15253.911670465075,-14739.279431215178,-14239.53990253029,-13754.693084410488,-13284.73897685574,-12829.677579866016,-12389.508893441372,-11964.232917581769,-11553.849652287219,-11158.359097557728,-10777.761253393286,-10412.056119793902,-10061.243696759575,-9725.323984290284,-9404.2969823860567,-9098.1626910468876,-8806.9211102727586,-8530.572240063686,-8269.1160804196697,-8022.5526313407054,-7790.8818928267938,-7574.1038648779377,-7372.2185474941271,-7185.2259406753801,-7013.1260444216778,-6855.91885873303,-6713.6043836094386,-6586.1826190508973,-6473.6535650574106,-6376.0172216289739,-6293.2735887655899,-6225.4226664672606,-6172.4644547339849,-6134.398953565762,-6111.2261629625955,-6102.9460829244736,-6109.5587134514099,-6131.0640545434007,-6167.4621062004398,-6218.7528684225344,-6284.9363412096809,-6366.0125245618829,-6461.9814184791385,-6572.8430229614432,-6698.5973380088026,-6839.244363621212,-6994.7840997986796,-7165.2165465411972,-7350.5417038487685,-7550.7595717213917,-7765.8701501590658,-7995.8734391617963,-8240.7694387295796,-8500.5581488624157,-8775.2395695603063,-9064.8137008232443,-9369.2805426512423,-9688.6400950442912,-10022.892358002384,-10372.037331525546,-10736.075015613751,-11115.005410267015,-11508.828515485326,-11917.54433126868,-12341.152857617102,-12779.654094530573,-13233.048042009092,-13701.334700052676,-14184.514068661319,-14682.586147834982,-15195.550937573733,-15723.408437877526,-16266.15864874635,-16823.801570180251,-17396.337202179198,-17983.765544743204,-18586.086597872265,-19203.300361566366,-19835.406835825514,-20482.406020649738,-21144.29791603901,-21821.08252199331,-22512.759838512684,-23219.329865597123,-23940.792603246584],[-24342.768045087258,-23613.017911085983,-22898.160487649751,-22198.195774778564,-21513.123772472471,-20842.944480731407,-20187.657899555365,-19547.264028944413,-18921.762868898521,-18311.15441941766,-17715.438680501833,-17134.615652151078,-16568.685334365386,-16017.647727144737,-15481.502830489148,-14960.250644398631,-14453.89116887313,-13962.424403912702,-13485.850349517317,-13024.16900568699,-12577.380372421721,-12145.484449721505,-11728.481237586328,-11326.370736016215,-10939.152945011157,-10566.827864571147,-10209.395494696189,-9866.8558353862918,-9539.2088866414306,-9226.454648461644,-8928.5931208468992,-8645.6243037972017,-8377.5481973125643,-8124.3648013929815,-7886.0741160384478,-7662.6761412489668,-7454.1708770245432,-7260.5583233651687,-7081.8384802708497,-6918.0113477415798,-6769.0769257773636,-6635.035214378202,-6515.8862135440959,-6411.6299232750398,-6322.2663435710356,-6247.7954744320878,-6188.21731585819,-6143.5318678493422,-6113.7391304055527,-6098.8391035268141,-6098.8317872131283,-6113.7171814644962,-6143.4952862809159,-6188.1661016623884,-6247.7296276089164,-6322.1858641204917,-6411.5348111971271,-6515.7764688388133,-6634.9108370455569,-6768.9379158173451,-6917.857705154187,-7081.6702050560834,-7260.3754155230308,-7453.9733365550401,-7662.4639681520921,-7885.8473103142005,-8124.1233630413644,-8377.2921263335793,-8645.3536001908396,-8928.3077846131637,-9226.1546796005368,-9538.8942851529719,-9866.5266012704487,-10209.051627952966,-10566.46936520057,-10938.7798130132,-11325.982971390902,-11728.078840333641,-12145.067419841424,-12576.948709914279,-13023.722710552191,-13485.389421755131,-13961.948843523151,-14453.400975856217,-14959.745818754329,-15480.98337221751,-16017.113636245713,-16568.136610838996,-17134.052295997317,-17714.8606917207,-18310.561798009112,-18921.155614862615,-19546.642142281162,-20187.021380264734,-20842.293328813375,-21512.457987927119,-22197.515357605822,-22897.465437849642,-23612.308228658505,-24342.04373003239],[-23934.932918526225,-23213.455548249403,-22506.870888537582,-21815.178939390833,-21138.379700809157,-20476.473172792539,-19829.459355340943,-19197.338248454398,-18580.109852132926,-17977.774166376519,-17390.331191185145,-16817.780926558815,-16260.123372497565,-15717.358529001345,-15189.486396070182,-14676.506973704072,-14178.420261903024,-13695.226260667019,-13226.924969996075,-12773.516389890181,-12335.000520349324,-11911.377361373539,-11502.646912962799,-11108.809175117125,-10729.864147836495,-10365.811831120915,-10016.652224970396,-9682.3853293849206,-9363.0111443645001,-9058.5296699091341,-8768.9409060188227,-8494.2448526935586,-8234.4415099333546,-7989.5308777382052,-7759.5129561080976,-7544.38774504305,-7344.1552445430571,-7158.8154546081123,-6988.3683752382258,-6832.8140064333866,-6692.1523481936038,-6566.3834005188755,-6455.5071634091964,-6359.5236368645728,-6278.4328208850002,-6212.2347154704821,-6160.929320621015,-6124.5166363366025,-6102.9966626172436,-6096.3693994629375,-6104.6348468736796,-6127.7930048494809,-6165.8438733903313,-6218.787452496239,-6286.6237421671958,-6369.3527424032054,-6466.9744532042714,-6579.4888745703902,-6706.896006501559,-6849.1958489977787,-7006.3884020590522,-7178.4736656853838,-7365.4516398767664,-7567.3223246332018,-7784.0857199546826,-8015.7418258412254,-8262.2906422928172,-8523.7321693094655,-8800.066406891161,-9091.2933550379112,-9397.4130137497159,-9718.4253830265698,-10054.330462868489,-10405.128253275454,-10770.818754247472,-11151.401965784542,-11546.877887886669,-11957.246520553845,-12382.507863786061,-12822.661917583353,-13277.708681945693,-13747.648156873071,-14232.48034236551,-14732.20523842301,-15246.82284504555,-15776.333162233155,-16320.736189985806,-16880.031928303506,-17454.220377186277,-18043.301536634091,-18647.275406646935,-19266.141987224866,-19899.90127836783,-20548.553280075852,-21212.097992348943,-21890.535415187056,-22583.865548590242,-23292.088392558486,-24015.203947091766,-24753.212212190105],[-23537.015147337108,-22823.810540784667,-22125.498644797299,-21442.079459375003,-20773.552984517763,-20119.919220225547,-19481.178166498401,-18857.329823336295,-18248.374190739261,-17654.311268707253,-17075.141057240318,-16510.863556338423,-15961.478766001594,-15426.986686229817,-14907.387317023085,-14402.680658381416,-13912.86671030479,-13437.945472793212,-12977.916945846691,-12532.781129465238,-12102.538023648822,-11687.187628397474,-11286.729943711165,-10901.164969589916,-10530.492706033718,-10174.713153042576,-9833.826310616485,-9507.8321787554341,-9196.7307574594543,-8900.522046728518,-8619.20604656264,-8352.7827569618075,-8101.252177926036,-7864.6143094553117,-7642.8691515496403,-7436.0167042090252,-7244.056967433462,-7066.9899412229515,-6904.8156255774957,-6757.5340204970908,-6625.1451259817386,-6507.6489420314429,-6405.0454686461953,-6317.3347058260033,-6244.516653570864,-6186.5913118807784,-6143.5586807557447,-6115.4187601957619,-6102.1715502008319,-6103.8170507709583,-6120.3552619061384,-6151.7861836063666,-6198.1098158716513,-6259.3261587019852,-6335.4352120973736,-6426.4369760578202,-6532.3314505833187,-6653.1186356738672,-6788.7985313294639,-6939.3711375501225,-7104.8364543358284,-7285.194481686588,-7480.4452196023994,-7690.58866808327,-7915.6248271291852,-8155.5536967401604,-8410.3752769161856,-8680.0895676572654,-8964.6965689633871,-9264.1962808345779,-9578.5887032708088,-9907.8738362721087,-10252.051679838445,-10611.12223396984,-10985.085498666296,-11373.941473927791,-11777.690159754351,-12196.331556145948,-12629.865663102613,-13078.292480624326,-13541.612008711094,-14019.824247362907,-14512.929196579787,-15020.926856361719,-15543.817226708681,-16081.60030762072,-16634.276099097799,-17201.844601139943,-17784.305813747142,-18381.659736919377,-18993.906370656681,-19621.045714959022,-20263.077769826414,-20920.002535258889,-21591.820011256379,-22278.530197818953,-22980.133094946556,-23696.628702639231,-24428.017020896972,-25174.298049719728],[-23149.014731519877,-22444.082888691883,-21754.04375642896,-21078.897334731097,-20418.643623598269,-19773.282623030489,-19142.814333027756,-18527.238753590107,-17926.55588471748,-17340.765726409925,-16769.868278667404,-16213.863541489955,-15672.751514877553,-15146.5321988302,-14635.205593347911,-14138.771698430664,-13657.230514078477,-13190.58204029133,-12738.82627706926,-12301.963224412222,-11879.992882320235,-11472.915250793312,-11080.730329831436,-10703.438119434617,-10341.038619602859,-9993.53183033614,-9660.9177516344807,-9343.1963834978742,-9040.3677259263168,-8752.431778919814,-8479.3885424783657,-8221.2380166019648,-7977.9802012906184,-7749.6150965443285,-7536.1427023630931,-7337.5630187469096,-7153.8760456957762,-6985.0817832096991,-6831.1802312886703,-6692.1713899327005,-6568.05525914178,-6458.8318389159167,-6364.5011292551008,-6285.0631301593385,-6220.5178416286308,-6170.8652636629758,-6136.105396262371,-6116.2382394268234,-6111.2637931563258,-6121.182057450882,-6145.9930323104936,-6185.6967177351553,-6240.2931137248688,-6309.7822202796369,-6394.1640373994596,-6493.4385650843315,-6607.6058033342579,-6736.6657521492398,-6880.6184115292708,-7039.4637814743592,-7213.2018619844957,-7401.8326530596923,-7605.3561546999317,-7823.7723669052311,-8057.0812896755779,-8305.2829230109837,-8568.3772669114442,-8846.3643213769519,-9139.2440864075124,-9447.0165620031257,-9769.68174816379,-10107.239644889516,-10459.690252180288,-10827.033570036116,-11209.269598457002,-11606.398337442926,-12018.419786993931,-12445.333947109964,-12887.140817791053,-13343.840399037193,-13815.432690848393,-14301.91769322463,-14803.295406165947,-15319.565829672307,-15850.72896374371,-16396.784808380173,-16957.733363581701,-17533.574629348266,-18124.308605679867,-18729.935292576563,-19350.454690038281,-19985.86679806505,-20636.171616656902,-21301.369145813769,-21981.459385535745,-22676.442335822743,-23386.317996674741,-24111.086368091863,-24850.747450074014,-25605.301242621215],[-22770.931671074533,-22074.272591970977,-21392.506223432487,-20725.632565459047,-20073.65161805063,-19436.563381207314,-18814.367854929013,-18207.065039215784,-17614.654934067592,-17037.137539484469,-16474.512855466397,-15926.780882013361,-15393.9416191254,-14875.995066802487,-14372.941225044622,-13884.780093851798,-13411.511673224053,-12953.135963161341,-12509.652963663677,-12081.062674731098,-11667.365096363534,-11268.560228561048,-10884.648071323605,-10515.628624651217,-10161.501888543884,-9822.2678630016053,-9497.9265480243721,-9188.4779436122026,-8893.9220497650713,-8614.2588664830037,-8349.488393765987,-8099.6106316140158,-7864.6255800271065,-7644.5332390052472,-7439.333608548437,-7249.0266886566878,-7073.6124793299914,-6913.0909805683405,-6767.4621923717496,-6636.726114740206,-6520.8827476737206,-6419.9320911722834,-6333.8741452359,-6262.7089098645693,-6206.4363850582968,-6165.0565708170707,-6138.5694671409037,-6126.9750740297841,-6130.2733914837172,-6148.4644195027067,-6181.5481580867472,-6229.5246072358432,-6292.3937669499883,-6370.1556372291898,-6462.8102180734422,-6570.3575094827484,-6692.7975114571109,-6830.1302239965244,-6982.3556471009815,-7149.4737807705033,-7331.4846250050723,-7528.3881798046987,-7740.184445169376,-7966.8734210991079,-8208.4551075938816,-8464.9295046537209,-8736.2966122786111,-9022.5564304685504,-9323.7089592235498,-9639.7541985435892,-9970.6921484286868,-10316.522808878846,-10677.246179894055,-11052.862261474305,-11443.371053619627,-11848.772556329977,-12269.066769605402,-12704.253693445873,-13154.333327851395,-13619.305672821971,-14099.170728357607,-14593.928494458291,-15103.578971124032,-15628.122158354827,-16167.558056150649,-16721.886664511552,-17291.107983437498,-17875.222012928494,-18474.228752984563,-19088.128203605665,-19716.920364791826,-20360.60523654303,-21019.182818859303,-21692.653111740612,-22381.016115186983,-23084.271829198435,-23802.420253774879,-24535.46138891641,-25283.395234623029,-26046.221790894597],[-22402.765966001134,-21714.379650622002,-21040.886045807929,-20382.285151558917,-19738.576967874957,-19109.761494756051,-18495.838732202203,-17896.808680213384,-17312.671338789631,-16743.426707930943,-16189.074787637293,-15649.615577908709,-15125.04907874516,-14615.375290146674,-14120.594212113239,-13640.705844644859,-13175.710187741541,-12725.607241403251,-12290.397005630042,-11870.079480421868,-11464.654665778749,-11074.122561700689,-10698.483168187686,-10337.73648523973,-9991.8825128568242,-9660.9212510389661,-9344.85269978617,-9043.6768590984302,-8757.3937289757341,-8486.0033094180981,-8229.5056004255093,-7987.9006019979743,-7761.1883141354938,-7549.3687368380706,-7352.4418701056929,-7170.4077139383753,-7003.266268336105,-6851.0175332988874,-6713.6615088267254,-6591.198194919617,-6483.6275915775568,-6390.949698800554,-6313.1645165886048,-6250.2720449417084,-6202.2722838598638,-6169.165233343072,-6150.9508933913303,-6147.6292640046431,-6159.2003451830105,-6185.6641369264307,-6227.0206392349037,-6283.2698521084294,-6354.4117755470088,-6440.4464095506391,-6541.3737541193259,-6657.1938092530581,-6787.9065749518541,-6933.5120512156955,-7094.0102380445896,-7269.401135438542,-7459.6847433975454,-7664.861061921596,-7884.9300910107031,-8119.8918306648684,-8369.7462808840828,-8634.49344166835,-8914.1333130176699,-9208.6658949320445,-9518.0911874114663,-9842.4091904559464,-10181.619904065474,-10535.723328240059,-10904.719462979705,-11288.608308284391,-11687.389864154125,-12101.064130588922,-12529.631107588775,-12973.090795153677,-13431.443193283638,-13904.688301978646,-14392.826121238708,-14895.856651063808,-15413.779891453985,-15946.595842409211,-16494.304503929481,-17056.905876014811,-17634.399958665177,-18226.786751880623,-18834.066255661091,-19456.238470006632,-20093.303394917235,-20745.261030392874,-21412.111376433575,-22093.854433039312,-22790.490200210101,-23502.018677945969,-24228.439866246903,-24969.753765112844,-25725.960374543887,-26497.059694539923],[-22044.517616299599,-21364.404064644914,-20699.18322355525,-20048.855093030666,-19413.419673071148,-18792.876963676666,-18187.226964847236,-17596.469676582881,-17020.605098883563,-16459.6332317493,-15913.554075180069,-15382.367629175909,-14866.073893736811,-14364.672868862761,-13878.164554553756,-13406.548950809809,-12949.826057630908,-12507.99587501707,-12081.05840296828,-11669.013641484542,-11271.861590565852,-10889.602250212229,-10522.235620423653,-10169.761701200117,-9832.1804925416545,-9509.4919944482299,-9201.6962069198671,-8908.7931299565516,-8630.7827635582962,-8367.6651077250899,-8119.4401624569291,-7886.1079277538283,-7667.6684036157794,-7464.1215900427906,-7275.4674870348408,-7101.7060945919538,-6942.8374127141178,-6798.8614414013318,-6669.7781806536022,-6555.5876304709273,-6456.2897908532987,-6371.8846618007301,-6302.3722433132116,-6247.7525353907431,-6208.025538033331,-6183.1912512409717,-6173.2496750136643,-6178.2008093514096,-6198.0446542542086,-6232.7812097220576,-6282.4104757549612,-6346.9324523529212,-6426.3471395159313,-6520.6545372439923,-6629.8546455371088,-6753.947464395279,-6892.9329938185019,-7046.8112338067795,-7215.5821843601043,-7399.2458454784874,-7597.8022171619223,-7811.2512994104072,-8039.5930922239468,-8282.8275956025464,-8540.9548095461887,-8813.9747340548856,-9101.887369128639,-9404.6927147674396,-9722.3907709712912,-10054.981537740208,-10402.465015074167,-10764.841202973188,-11142.110101437254,-11534.271710466379,-11941.326030060567,-12363.273060219784,-12800.112800944065,-13251.845252233396,-13718.470414087786,-14199.98828650722,-14696.39886949171,-15207.702163041253,-15733.898167155861,-16274.986881835532,-16830.96830708022,-17401.84244289,-17987.609289264808,-18588.26884620465,-19203.82111370959,-19834.266091779544,-20479.60378041456,-21139.834179614649,-21814.957289379774,-22504.973109709928,-23209.881640605177,-23929.682882065499,-24664.376834090806,-25413.963496681201,-26178.442869836646,-26957.81495355715],[-21696.186621969966,-21024.345834039712,-20367.397756674516,-19725.342389874364,-19098.179733639277,-18485.90978796922,-17888.532552864228,-17306.048028324269,-16738.456214349389,-16185.757110939556,-15647.950718094777,-15125.03703581505,-14617.016064100369,-14123.887802950754,-13645.652252366175,-13182.309412346665,-12733.859282892196,-12300.301864002789,-11881.637155678423,-11477.865157919125,-11088.985870724868,-10714.999294095673,-10355.905428031525,-10011.70427253243,-9682.3958275983969,-9367.9800932293965,-9068.4570694254671,-8783.8267561865887,-8514.0891535127557,-8259.244261403981,-8019.2920798602609,-7794.2326088815871,-7584.0658484679725,-7388.7917986194116,-7208.4104593358934,-7042.9218306174407,-6892.3259124640335,-6756.6227048756791,-6635.8122078523811,-6529.8944213941359,-6438.8693455009443,-6362.7369801728028,-6301.4973254097149,-6255.1503812116807,-6223.6961475786993,-6207.1346245107707,-6205.4658120078921,-6218.6897100700689,-6246.8063186972995,-6289.8156378895847,-6347.7176676469189,-6420.5124079693087,-6508.1998588567494,-6610.7800203092429,-6728.252892326791,-6860.6184749093918,-7007.876768057049,-7170.0277717697545,-7347.0714860475127,-7539.0079108903265,-7745.8370462981948,-7967.5588922711104,-8204.1734488090788,-8455.6807159121108,-8722.0806935801847,-9003.3733818133169,-9299.5587806114963,-9610.6368899747322,-9936.607709903019,-10277.471240396357,-10633.227481454755,-11003.876433078211,-11389.418095266708,-11789.852468020261,-12205.179551338868,-12635.39934522253,-13080.511849671248,-13540.517064685009,-14015.414990263816,-14505.205626407691,-15009.888973116627,-15529.465030390586,-16063.933798229633,-16613.295276633718,-17177.549465602853,-17756.696365137039,-18350.735975236279,-18959.668295900574,-19583.493327129931,-20222.211068924331,-20875.821521283782,-21544.324684208288,-22227.720557697838,-22926.00914175246,-23639.190436372119,-24367.264441556857,-25110.231157306604,-25868.090583621452,-26640.842720501307,-27428.487567946242],[-21357.772983012241,-20694.2049588064,-20045.529645165625,-19411.747042089908,-18792.857149579278,-18188.859967633631,-17599.755496253078,-17025.543735437575,-16466.224685187117,-15921.798345501706,-15392.264716381364,-14877.623797826061,-14377.875589835827,-13893.020092410645,-13423.057305550485,-12967.987229255408,-12527.809863525366,-12102.525208360395,-11692.133263760466,-11296.634029725599,-10916.02750625577,-10550.31369335101,-10199.492591011292,-9863.5641992366327,-9542.5285180270221,-9236.385547382466,-8945.1352873029628,-8668.7777377885177,-8407.3128988391127,-8160.7407704547695,-7929.0613526354828,-7712.2746453812433,-7510.3806486920566,-7323.3793625679245,-7151.2707870088425,-6994.0549220148223,-6851.7317675858467,-6724.3013237219293,-6611.763590423061,-6514.1185676892464,-6431.3662555204846,-6363.5066539167756,-6310.5397628781211,-6272.4655824045176,-6249.2841124959659,-6240.9953531524734,-6247.5993043740291,-6269.0959661606394,-6305.4853385123006,-6356.7674214290137,-6422.9422149107822,-6504.0097189576036,-6599.9699335694759,-6710.8228587464018,-6836.5684944883833,-6977.2068407954112,-7132.7378976674991,-7303.1616651046388,-7488.4781431068313,-7688.6873316740794,-7903.789230806372,-8133.7838405037273,-8378.6711607661255,-8638.4511915935909,-8913.1239329860909,-9202.6893849436565,-9507.147547466273,-9826.4984205539295,-10160.742004206653,-10509.878298424428,-10873.907303207252,-11252.829018555143,-11646.643444468069,-12055.350580946048,-12478.950427989099,-12917.442985597185,-13370.828253770338,-13839.10623250853,-14322.276921811786,-14820.340321680069,-15333.296432113437,-15861.145253111852,-16403.886784675306,-16961.521026803835,-17534.047979497394,-18121.467642756019,-18723.780016579694,-19340.985100968421,-19973.082895922205,-20620.073401441034,-21281.956617524913,-21958.732544173843,-22650.401181387861,-23356.962529166885,-24078.416587511005,-24814.763356420146,-25566.002835894338,-26332.13502593361,-27113.159926537919,-27909.077537707264],[-21029.276699426398,-20373.981438945011,-19733.578889028664,-19108.069049677382,-18497.451920891144,-17901.727502669961,-17320.895795013836,-16754.956797922758,-16203.910511396733,-15667.756935435753,-15146.496070039848,-14640.127915208983,-14148.652470943172,-13672.069737242417,-13210.379714106704,-12763.582401536045,-12331.677799530456,-11914.665908089899,-11512.546727214412,-11125.320256903966,-10752.986497158581,-10395.545447978246,-10052.997109362965,-9725.3414813127274,-9412.5785638275538,-9114.7083569074275,-8831.7308605523613,-8563.6460747623405,-8310.4539995373743,-8072.1546348774682,-7848.7479807826076,-7640.2340372528006,-7446.6128042880464,-7267.8842818883477,-7104.0484700536999,-6955.1053687840995,-6821.0549780795618,-6701.897297940076,-6597.6323283656411,-6508.2600693562599,-6433.7805209119288,-6374.1936830326549,-6329.4995557184266,-6299.6981389692583,-6284.7894327851391,-6284.7734371660754,-6299.6501521120617,-6329.4195776231045,-6374.0817136991955,-6433.6365603403456,-6508.0841175465448,-6597.4243853177968,-6701.6573636541016,-6820.7830525554582,-6954.8014520218749,-7103.712562053337,-7267.5163826498574,-7446.2129138114287,-7639.8021555380501,-7848.2841078297224,-8071.6587706864548,-8309.9261441082381,-8563.0862280950787,-8831.1390226469593,-9114.0845277638946,-9411.9227434458935,-9724.6536696929397,-10052.277306505039,-10394.793653882192,-10752.202711824393,-11124.504480331649,-11511.698959403968,-11913.786149041331,-12330.766049243754,-12762.638660011227,-13209.40398134375,-13671.062013241328,-14147.612755703951,-14639.056208731628,-15145.39237232437,-15666.621246482158,-16202.742831204981,-16753.75712649287,-17319.664132345846,-17900.463848763851,-18496.1562757469,-19106.741413295014,-19732.219261408165,-20372.589820086363,-21027.853089329634,-21698.009069137959,-22383.057759511321,-23082.999160449748,-23797.833271953219,-24527.560094021777,-25272.179626655343,-26031.691869853981,-26806.096823617663,-27595.394487946403,-28399.584862840187],[-20710.697771212504,-20063.675274455534,-19431.545488263626,-18814.308412636761,-18211.964047574962,-17624.512393078221,-17051.953449146502,-16494.287215779863,-15951.513692978267,-15423.632880741743,-14910.644779070255,-14412.5493879638,-13929.346707422439,-13461.036737446109,-13007.619478034836,-12569.094929188614,-12145.463090907451,-11736.723963191325,-11342.877546040261,-10963.923839454254,-10599.862843433288,-10250.694557977396,-9916.4189830865362,-9597.0361187607414,-9292.5459649999975,-9002.9485218043046,-8728.2437891736699,-8468.4317671080771,-8223.5124556075425,-7993.4858546720661,-7778.3519643016407,-7578.1107844962571,-7392.7623152559399,-7222.3065565806737,-7066.7435084704566,-6926.0731709252932,-6800.2955439451816,-6689.4106275301247,-6593.4184216801204,-6512.3189263951699,-6446.1121416752703,-6394.7980675204244,-6358.3767039306385,-6336.8480509058954,-6330.2121084462078,-6338.4688765515757,-6361.6183552219954,-6399.6605444574661,-6452.5954442579969,-6520.4230546235713,-6603.1433755541993,-6700.7564070498865,-6813.2621491106238,-6940.6606017364093,-7082.9517649272566,-7240.1356386831521,-7412.2122230040995,-7599.1815178901088,-7801.0435233411554,-8017.7982393572656,-8249.4456659384268,-8495.9858030846372,-8757.4186507959057,-9033.7442090722325,-9324.9624779135993,-9631.0734573200243,-9952.0771472915039,-10287.973547828029,-10638.762658929616,-11004.444480596252,-11385.019012827943,-11780.486255624688,-12190.846208986488,-12616.098872913328,-13056.244247405248,-13511.28233246219,-13981.213128084199,-14466.036634271264,-14965.75285102337,-15480.361778340541,-16009.863416222761,-16554.257764670023,-17113.544823682372,-17687.72459325974,-18276.797073402158,-18880.76226410966,-19499.620165382195,-20133.370777219767,-20782.014099622407,-21445.550132590135,-22123.97887612287,-22817.300330220678,-23525.514494883515,-24248.621370111439,-24986.620955904378,-25739.513252262397,-26507.298259185474,-27289.975976673588,-28087.546404726781,-28900.009543345004],[-20402.036198370457,-19763.286465337944,-19139.42944287046,-18530.465130968034,-17936.393529630655,-17357.214638858342,-16792.928458651066,-16243.534989008862,-15709.034229931693,-15189.426181419605,-14684.710843472532,-14194.888216090536,-13719.958299273592,-13259.921093021698,-12814.77659733486,-12384.524812213054,-11969.165737656318,-11568.699373664633,-11183.125720238004,-10812.444777376426,-10456.656545079901,-10115.761023348434,-9789.7582121820124,-9478.6481115806473,-9182.4307215443332,-8901.1060420730737,-8634.6740731668615,-8383.1348148257093,-8146.488267049609,-7924.734429838556,-7717.873303192564,-7525.9048871116156,-7348.82918159573,-7186.6461866448944,-7039.3559022591089,-6906.958328438378,-6789.4534651826989,-6686.8413124920762,-6599.1218703665036,-6526.2951388059846,-6468.3611178105166,-6425.319807380105,-6397.1712075147434,-6383.91531821444,-6385.5521394791813,-6402.0816713089807,-6433.5039137038311,-6479.8188666637361,-6541.0265301886975,-6617.1269042787053,-6708.1199889337695,-6814.0057841538837,-6934.7842899390535,-7070.4555062892778,-7221.0194332045521,-7386.4760706848729,-7566.8254187302591,-7762.0674773406881,-7972.2022465161726,-8197.2297262567135,-8437.1499165623172,-8691.9628174329573,-8961.6684288686556,-9246.2667508694085,-9545.7577834352051,-9860.1415265660689,-10189.417980261978,-10533.587144522942,-10892.649019348955,-11266.603604740027,-11655.450900696147,-12059.190907217322,-12477.823624303548,-12911.34905195483,-13359.767190171182,-13823.078038952543,-14301.281598298992,-14794.377868210491,-15302.366848687034,-15825.248539728627,-16363.022941335284,-16915.690053506991,-17483.249876243764,-18065.702409545571,-18663.047653412417,-19275.285607844336,-19902.416272841314,-20544.439648403324,-21201.355734530393,-21873.164531222545,-22559.866038479719,-23261.460256301951,-23977.947184689241,-24709.326823641575,-25455.599173158967,-26216.764233241418,-26992.822003888919,-27783.772485101472,-28589.615676879104,-29410.351579221715],[-20103.291980900365,-19472.81501159224,-18857.230752849209,-18256.5392046712,-17670.740367058261,-17099.834240010387,-16543.82082352756,-16002.700117609769,-15476.472122257041,-14965.136837469357,-14468.694263246745,-13987.144399589166,-13520.487246496652,-13068.722803969189,-12631.851072006775,-12209.872050609414,-11802.785739777108,-11410.592139509856,-11033.291249807658,-10670.883070670514,-10323.367602098417,-9990.7448440913813,-9673.014796649386,-9370.1774597724489,-9082.2328334605772,-8809.1809177137493,-8551.0217125319723,-8307.7552179152462,-8079.3814338635748,-7865.9003603769561,-7667.3119974553983,-7483.6163450988815,-7314.8134033074248,-7160.903172081019,-7021.8856514196632,-6897.7608413233665,-6788.528741792119,-6694.189352825927,-6614.742674424785,-6550.1887065886958,-6500.5274493176676,-6465.7589026116802,-6445.8830664707539,-6440.899940894873,-6450.8095258840513,-6475.6118214382877,-6515.306827557567,-6569.8945442419026,-6639.3749714912947,-6723.7481093057277,-6823.0139576852271,-6937.1725166297765,-7066.2237861393742,-7210.1677662140282,-7369.0044568537342,-7542.733858058491,-7731.3559698283061,-7934.8707921631694,-8153.2783250630891,-8386.5785685280607,-8634.7715225580887,-8897.8571871531585,-9175.835562313292,-9468.7066480384783,-9776.4704443287064,-10099.126951183996,-10436.676168604339,-10789.118096589729,-11156.452735140185,-11538.680084255684,-11935.800143936229,-12347.812914181843,-12774.718394992506,-13216.516586368218,-13673.20748830899,-14144.791100814788,-14631.26742388568,-15132.636457521598,-15648.898201722572,-16180.052656488597,-16726.099821819698,-17287.039697715802,-17862.872284177029,-18453.597581203263,-19059.215588794548,-19679.72630695091,-20315.129735672286,-20965.425874958746,-21630.614724810264,-22310.696285226826,-23005.670556208403,-23715.537537755088,-24440.29722986681,-25179.949632543583,-25934.494745785407,-26703.932569592296,-27488.2631039642,-28287.486348901191,-29101.60230440327,-29930.610970470319],[-19814.465118802145,-19192.260913218452,-18584.949418199831,-17992.530633746268,-17415.004559857778,-16852.371196534317,-16304.63054377592,-15771.782601582572,-15253.827369954273,-14750.764848891014,-14262.595038392828,-13789.317938459693,-13330.933549091615,-12887.441870288574,-12458.842902050603,-12045.136644377666,-11646.323097269787,-11262.402260726969,-10893.374134749205,-10539.238719336494,-10199.99601448883,-9875.6460202062135,-9566.1887364886588,-9271.6241633361569,-8991.9523007487114,-8727.1731487263096,-8477.2867072689733,-8242.2929763766824,-8022.1919560494389,-7816.9836462872554,-7626.6680470901229,-7451.2451584580413,-7290.7149803910179,-7145.0775128890436,-7014.3327559521213,-6898.4807095802535,-6797.521373773443,-6711.4547485316834,-6640.2808338549721,-6583.9996297433154,-6542.6111361967105,-6516.1153532151584,-6504.5122807986681,-6507.8019189472207,-6525.9842676608278,-6559.0593269394876,-6607.0270967832048,-6669.8875771919747,-6747.6407681657965,-6840.2866697046693,-6947.8252818085912,-7070.256604477574,-7207.5806377116041,-7359.7973815106852,-7526.9068358748282,-7708.9090008040166,-7905.8038762982615,-8117.5914623575591,-8344.2717589819113,-8585.844766171318,-8842.3104839257649,-9113.6689122452735,-9399.9200511298422,-9701.0639005794583,-10017.100460594118,-10348.029731173847,-10693.851712318621,-11054.566404028439,-11430.173806303323,-11820.673919143252,-12226.066742548242,-12646.352276518275,-13081.530521053368,-13531.601476153508,-13996.56514181873,-14476.421518048957,-14971.170604844267,-15480.812402204623,-16005.346910130027,-16544.774128620487,-17099.094057676019,-17668.306697296546,-18252.412047482198,-18851.410108232885,-19465.300879548598,-20094.084361429363,-20737.760553875196,-21396.329456886102,-22069.791070462037,-22758.145394603045,-23461.39242930906,-24179.532174580156,-24912.564630416338,-25660.489796817528,-26423.307673783806,-27201.018261315083,-27993.621559411447,-28801.11756807287,-29623.506287299373,-30460.787717090847],[-19535.555612075816,-18921.624170216561,-18322.58543892239,-17738.439418193266,-17169.186108029193,-16614.825508430164,-16075.357619396194,-15550.782440927274,-15041.099973023409,-14546.310215684591,-14066.413168910836,-13601.408832702122,-13151.297207058476,-12716.07829197988,-12295.752087466324,-11890.31859351783,-11499.777810134388,-11124.12973731599,-10763.374375062669,-10417.51172337438,-10086.541782251144,-9770.4645516929741,-9469.2800316998437,-9182.9882222717679,-8911.5891234087539,-8655.082735110791,-8413.4690573778771,-8186.7480902100142,-7974.9198336072141,-7777.9842875694594,-7595.9414520967575,-7428.7913271891066,-7276.5339128465093,-7139.1692090689685,-7016.6972158564795,-6909.1179332090433,-6816.4313611266589,-6738.6374996093273,-6675.7363486570521,-6627.7279082698269,-6594.6121784476582,-6576.3891591905376,-6573.0588504984662,-6584.6212523714621,-6611.0763648095008,-6652.424187812594,-6708.6647213807419,-6779.7979655139379,-6865.8239202121904,-6966.7425854754956,-7082.5539613038472,-7213.2580476972598,-7358.8548446557288,-7519.3443521792415,-7694.7265702678178,-7885.0014989214287,-8090.1691381401106,-8310.2294879238434,-8545.1825482726181,-8795.0283191864601,-9059.7668006653475,-9339.3979927092805,-9633.9218953182753,-9943.3385084923284,-10267.647832231414,-10606.849866535573,-10960.944611404786,-11329.932066839036,-11713.812232838345,-12112.585109402709,-12526.25069653213,-12954.808994226598,-13398.260002486133,-13856.60372131069,-14329.84015070034,-14817.969290655001,-15320.991141174736,-15838.905702259524,-16371.712973909376,-16919.41295612427,-17482.005648904218,-18059.491052249206,-18651.869166159253,-19259.139990634376,-19881.303525674535,-20518.359771279756,-21170.308727450007,-21837.150394185323,-22518.884771485682,-23215.511859351122,-23927.031657781576,-24653.444166777139,-25394.749386337688,-26150.947316463331,-26922.037957154003,-27708.021308409778,-28508.897370230552,-29324.666142616421,-30155.32762556729,-31000.881819083268],[-19266.563460721383,-18660.904782586585,-18070.138815016846,-17494.265558012143,-16933.285011572501,-16387.197175697889,-15856.002050388359,-15339.699635643856,-14838.289931464435,-14351.772937850057,-13880.148654800736,-13423.417082316446,-12981.578220397232,-12554.632069043066,-12142.578628253941,-11745.41789802988,-11363.149878370867,-10995.774569276909,-10643.291970748007,-10305.702082784155,-9983.00490538536,-9675.200438551612,-9382.2886822829169,-9104.2696365792799,-8841.1433014406994,-8592.9096768671625,-8359.568762858682,-8141.1205594152489,-7937.5650665368776,-7748.9022842235536,-7575.1322124752805,-7416.2548512920675,-7272.2702006739037,-7143.1782606207935,-7028.9790311327388,-6929.6725122097369,-6845.258703851785,-6775.7376060588849,-6721.1092188310395,-6681.3735421682477,-6656.5305760705078,-6646.5803205378206,-6651.5227755701844,-6671.3579411676055,-6706.0858173300812,-6755.7064040576042,-6820.2197013501827,-6899.6257092078085,-6993.9244276304971,-7103.1158566182348,-7227.1999961710226,-7366.1768462888649,-7520.0464069717582,-7688.8086782197079,-7872.4636600327094,-8071.0113524107601,-8284.4517553538735,-8512.7848688620325,-8756.0106929352442,-9014.1292275735104,-9287.1404727768368,-9575.0444285452031,-9877.8410948786313,-10195.530471777111,-10528.112559240637,-10875.587357269229,-11237.954865862861,-11615.215085021551,-12007.368014745287,-12414.413655034095,-12836.352005887935,-13273.183067306838,-13724.906839290798,-14191.52332183979,-14673.032514953868,-15169.434418632974,-15680.729032877147,-16206.916357686358,-16747.996393060639,-17303.96913899995,-17874.834595504333,-18460.592762573753,-19061.243640208275,-19676.787228407811,-20307.223527172362,-20952.552536502026,-21612.774256396733,-22287.888686856466,-22977.895827881279,-23682.795679471128,-24402.588241626021,-25137.273514346009,-25886.851497631003,-26651.322191481071,-27430.685595896211,-28224.941710876366,-29034.090536421609,-29858.13207253188,-30697.066319207253,-31550.893276447576],[-19007.488664738856,-18410.102750328508,-17827.609546483192,-17260.009053202906,-16707.301270487711,-16169.486198337547,-15646.563836752435,-15138.53418573238,-14645.397245277372,-14167.15301538743,-13703.801496062535,-13255.342687302684,-12821.776589107903,-12403.103201478159,-11999.322524413474,-11610.434557913839,-11236.439301979262,-10877.336756609737,-10533.126921805258,-10203.809797565849,-9889.3853838914692,-9589.8536807821638,-9305.214688237902,-9035.4684062586894,-8780.6148348445386,-8540.6539739954387,-8315.5858237113898,-8105.410383992391,-7910.1276548384412,-7729.7376362495552,-7564.2403282257164,-7413.6357307669314,-7277.9238438732036,-7157.1046675445214,-7051.1782017808964,-6960.1444465823224,-6884.003401948803,-6822.7550678803364,-6776.399444376927,-6744.9365314385614,-6728.3663290652512,-6726.6888372569974,-6739.9040560137928,-6768.0119853356482,-6811.0126252225509,-6868.9059756745064,-6941.6920366915165,-7029.3708082735739,-7131.9422904206913,-7249.4064831328633,-7381.7633864100844,-7529.0130002523565,-7691.155324659685,-7868.190359632059,-8060.1181051694984,-8266.9385612719852,-8488.6517279395212,-8725.2576051721189,-8976.7561929697586,-9243.1474913324564,-9524.4315002602088,-9820.6082197530141,-10131.677649810867,-10457.639790433777,-10798.494641621735,-11154.242203374761,-11524.88247569283,-11910.415458575939,-12310.841152024117,-12726.159556037335,-13156.37067061563,-13601.474495758957,-14061.471031467343,-14536.360277740798,-15026.142234579289,-15530.816901982816,-16050.384279951426,-16584.844368485072,-17134.197167583778,-17698.442677247542,-18277.580897476335,-18871.611828270194,-19480.535469629118,-20104.3518215531,-20743.060884042108,-21396.662657096203,-22065.157140715317,-22748.544334899503,-23446.824239648719,-24159.996854963028,-24888.062180842353,-25631.020217286736,-26388.870964296213,-27161.61442187069,-27949.250590010219,-28751.779468714842,-29569.201057984508,-30401.515357819204,-31248.722368218987,-32110.822089183777],[-18758.331224128262,-18169.218073442302,-17594.997633321414,-17035.669903765582,-16491.234884774822,-15961.692576349089,-15447.042978488402,-14947.286091192767,-14462.421914462207,-13992.450448296688,-13537.371692696224,-13097.185647660812,-12671.89231319045,-12261.491689285145,-11865.983775944889,-11485.368573169699,-11119.646080959552,-10768.816299314458,-10432.879228234407,-10111.834867719423,-9805.6832177694814,-9514.4242783846057,-9238.0580495647773,-8976.5845313099999,-8730.0037236202734,-8498.3156264956106,-8281.5202399359878,-8079.6175639414323,-7892.6075985119178,-7720.4903436474597,-7563.2657993480516,-7420.9339656136954,-7293.4948424443992,-7180.9484298401503,-7083.294727800956,-7000.5337363268136,-6932.6654554177294,-6879.6898850736961,-6841.6070252947084,-6818.4168760807806,-6810.1194374319075,-6816.7147093480817,-6838.2026918293122,-6874.5833848755956,-6925.8567884869317,-6992.0229026633197,-7073.0817274047604,-7169.033262711253,-7279.8775085828038,-7405.6144650194037,-7546.244132021051,-7701.7665095877637,-7872.1815977195147,-8057.4893964163284,-8257.6899056781949,-8472.783125505106,-8702.7690558970826,-8947.6476968541119,-9207.4190483761849,-9482.0831104633162,-9771.6398831155038,-10076.089366332733,-10395.431560115023,-10729.666464462369,-11078.794079374757,-11442.814404852204,-11821.727440894705,-12215.533187502253,-12624.231644674859,-13047.822812412523,-13486.306690715232,-13939.683279582998,-14407.95257901582,-14891.114589013692,-15389.169309576613,-15902.116740704587,-16429.956882397615,-16972.689734655702,-17530.315297478832,-18102.833570867024,-18690.244554820289,-19292.548249338557,-19909.744654421906,-20541.833770070298,-21188.815596283763,-21850.690133062279,-22527.457380405824,-23219.117338314456,-23925.67000678811,-24647.115385826844,-25383.45347543063,-26134.684275599422,-26900.807786333309,-27681.82400763224,-28477.732939496207,-29288.534581925254,-30114.228934919309,-30954.81599847848,-31810.295772602694,-32680.668257291909],[-18519.091138889558,-17938.250751928041,-17372.303075531578,-16821.248109700173,-16285.085854433813,-15763.816309732521,-15257.439475596275,-14765.955352025094,-14289.363939018936,-13827.665236577872,-13380.859244701833,-12948.945963390843,-12531.925392644933,-12129.797532464054,-11742.562382848229,-11370.21994379746,-11012.77021531175,-10670.213197391076,-10342.548890035472,-10029.777293244913,-9731.898407019411,-9448.9122313589614,-9180.818766263561,-8927.6180117332115,-8689.3099677679202,-8465.8946343676798,-8257.3720115325032,-8063.7420992623674,-7885.0048975572881,-7721.1604064172579,-7572.2086258422869,-7438.149555832365,-7318.9831963874949,-7214.7095475076749,-7125.3286091929112,-7050.8403814432077,-6991.2448642585523,-6946.5420576389461,-6916.7319615843917,-6901.8145760949028,-6901.7899011704521,-6916.6579368110615,-6946.4186830167218,-6991.0721397874368,-7050.6183071232035,-7125.0571850240249,-7214.3887734898963,-7318.6130725208241,-7437.7300821167992,-7571.7398022778289,-7720.6422330039168,-7884.4373742950556,-8063.1252261512427,-8256.7057885724844,-8465.179061558787,-8688.5450451101296,-8926.8037392265323,-9179.9551439079914,-9447.9992591544978,-9730.9360849660679,-10028.76562134268,-10341.487868284337,-10669.102825791062,-11011.610493862834,-11369.010872499646,-11741.303961701546,-12128.489761468469,-12530.568271800454,-12947.539492697497,-13379.40342415958,-13826.160066186712,-14287.809418778936,-14764.351481936175,-15255.78625565847,-15762.113739945837,-16283.333934798249,-16819.4468402157,-17370.452456198211,-17936.350782745772,-18517.141819858392,-19112.825567536089,-19723.402025778792,-20348.871194586594,-20989.233073959422,-21644.487663897286,-22314.63496440024,-22999.674975468246,-23699.607697101281,-24414.433129299359,-25144.151272062525,-25888.762125390713,-26648.265689283973,-27422.66196374227,-28211.950948765654,-29016.132644354067,-29835.207050507532,-30669.174167226032,-31518.033994509628,-32381.786532358245,-33260.431780771891],[-18289.768409022727,-17717.200785785637,-17159.525873113635,-16616.74367100665,-16088.854179464719,-15575.857398487864,-15077.753328076051,-14594.541968229292,-14126.223318947577,-13672.797380230924,-13234.264152079335,-12810.623634492791,-12401.875827471295,-12008.020731014854,-11629.058345123449,-11264.988669797116,-10915.811705035836,-10581.527450839603,-10262.135907208423,-9957.6370741423034,-9668.0309516412162,-9393.3175397052109,-9133.4968383342439,-8888.5688475283314,-8658.5335672874717,-8443.3909976116647,-8243.1411385009051,-8057.7839899552037,-7887.3195519745595,-7731.7478245589627,-7591.0688077084278,-7465.2825014229265,-7354.3889057024962,-7258.388020547116,-7177.2798459567766,-7111.0643819315019,-7059.7416284712799,-7023.3115855761062,-7001.7742532459897,-6995.1296314809242,-7003.3777202809088,-7026.5185196459443,-7064.5520295760407,-7117.4782500711881,-7185.2971811313837,-7268.0088227566339,-7365.6131749469423,-7478.1102377022999,-7605.5000110227102,-7747.7824949081751,-7904.9576893586936,-8077.0255943742613,-8263.9862099548791,-8465.8395361005569,-8682.5855728112856,-8914.2243200870671,-9160.7557779278977,-9422.179946333792,-9698.4968253047227,-9989.7064148407262,-10295.808714941768,-10616.803725607868,-10952.691446839015,-11303.47187863522,-11669.145020996475,-12049.710873922784,-12445.169437414163,-12855.520711470564,-13280.764696092041,-13720.901391278556,-14175.930797030136,-14645.852913346765,-15130.667740228453,-15630.375277675188,-16144.975525686988,-16674.468484263787,-17218.8541534057,-17778.132533112654,-18352.303623384643,-18941.367424221695,-19545.323935623808,-20164.173157590962,-20797.915090123162,-21446.549733220454,-22110.077086882746,-22788.497151110139,-23481.809925902555,-24190.015411260021,-24913.113607182575,-25651.104513670143,-26403.98813072277,-27171.764458340476,-27954.433496523226,-28751.995245270977,-29564.449704583865,-30391.796874461739,-31234.036754904701,-32091.169345912705,-32963.194647485769,-33850.112659623883],[-18070.363034527796,-17506.068175015142,-16956.666026067571,-16422.156587685029,-15902.539859867527,-15397.815842615115,-14907.984535927704,-14433.045939805394,-13973.000054248127,-13527.846879255894,-13097.586414828733,-12682.218660966608,-12281.743617669546,-11896.161284937531,-11525.471662770586,-11169.674751168679,-10828.770550131821,-10502.759059660018,-10191.640279753279,-9895.4142104115745,-9614.0808516349425,-9347.6402034233615,-9096.0922657768187,-8859.4370386953415,-8637.6745221789206,-8430.8047162275361,-8238.8276208412135,-8061.7432360199464,-7899.5515617637357,-7752.2525980725659,-7619.8463449464571,-7502.332802385401,-7399.7119703893968,-7311.9838489584399,-7239.1484380925431,-7181.205737791699,-7138.1557480559077,-7109.9984688851646,-7096.7339002794843,-7098.3620422388422,-7114.8828947632646,-7146.2964578527371,-7192.6027315072579,-7253.8017157268405,-7329.8934105114677,-7420.8778158611567,-7526.7549317758931,-7647.5247582556822,-7783.1872953005259,-7933.7425429104205,-8099.1905010853643,-8279.5311698253645,-8474.7645491304211,-8684.8906390005322,-8909.9094394356889,-9149.8209504358965,-9404.6251720011642,-9674.3221041314901,-9958.9117468268596,-10258.394100087276,-10572.769163912773,-10902.036938303292,-11246.197423258876,-11605.250618779519,-11979.196524865194,-12368.035141515935,-12771.766468731741,-13190.390506512593,-13623.907254858503,-14072.316713769451,-14535.618883245441,-15013.813763286511,-15506.901353892619,-16014.881655063784,-16537.754666800007,-17075.52038910129,-17628.178821967609,-18195.729965398998,-18778.17381939543,-19375.510383956906,-19987.739659083447,-20614.861644775017,-21256.876341031653,-21913.783747853369,-22585.583865240114,-23272.276693191918,-23973.862231708765,-24690.340480790685,-25421.711440437648,-26167.975110649662,-26929.131491426713,-27705.180582768844,-28496.122384675997,-29301.956897148237,-30122.684120185528,-30958.304053787855,-31808.816697955233,-32674.222052687663,-33554.520117985179,-34449.710893847681],[-17860.875015404788,-17304.852919616584,-16763.72353439343,-16237.486859735305,-15726.142895642261,-15229.691642114243,-14748.133099151299,-14281.467266753412,-13829.694144920568,-13392.813733652771,-12970.826032950032,-12563.731042812344,-12171.528763239719,-11794.219194232141,-11431.802335789611,-11084.278187912136,-10751.646750599721,-10433.908023852346,-10131.062007670032,-9843.1087020527666,-9570.048107000559,-9311.8802225134168,-9068.6050485913074,-8840.222585234249,-8626.7328324422597,-8428.1357902153177,-8244.4314585534303,-8075.619837456592,-7921.7009269248065,-7782.6747269580692,-7658.5412375563928,-7549.3004587197656,-7454.9523904481903,-7375.4970327416722,-7310.9343856002088,-7261.2644490237908,-7226.4872230124292,-7206.6027075661204,-7201.6109026848681,-7211.5118083686611,-7236.3054246175179,-7275.9917514314175,-7330.5707888103698,-7400.0425367543867,-7484.4069952634363,-7583.6641643375606,-7697.8140439767212,-7826.8566341809437,-7970.7919349502226,-8129.619946284547,-8303.3406681839351,-8491.9541006483632,-8695.4602436778478,-8913.8590972723887,-9147.1506614319824,-9395.3349361566179,-9658.4119214463244,-9936.3816173010819,-10229.244023720874,-10536.999140705726,-10859.646968255647,-11197.18750637059,-11549.620755050597,-11916.946714295695,-12299.1653841058,-12696.276764480983,-13108.280855421195,-13535.177656926489,-13976.96716899682,-14433.649391632202,-14905.224324832641,-15391.691968598145,-15893.052322928675,-16409.30538782429,-16940.45116328491,-17486.489649310621,-18047.42084590139,-18623.244753057192,-19213.961370778066,-19819.570699063981,-20440.072737914954,-21075.46748733097,-21725.754947312045,-22390.935117858178,-23071.007998969362,-23765.973590645583,-24475.831892886883,-25200.582905693213,-25940.2266290646,-26694.763063001046,-27464.192207502558,-28248.514062569098,-29047.728628200712,-29861.835904397369,-30690.835891159033,-31534.728588485836,-32393.513996377675,-33267.192114834521,-34155.762943856411,-35059.226483443403],[-17661.304351653682,-17113.55501958988,-16580.698398091168,-16062.734487157486,-15559.663286788882,-15071.484796985294,-14598.199017746769,-14139.80594907331,-13696.305590964899,-13267.69794342153,-12853.983006443241,-12455.160780029981,-12071.231264181786,-11702.194458898635,-11348.050364180537,-11008.79898002749,-10684.440306439512,-10374.974343416568,-10080.40109095869,-9800.7205490658616,-9535.9327177380837,-9286.0375969753641,-9051.0351867776862,-8830.9254871450721,-8625.7084980775035,-8435.3842195749949,-8259.9526516375336,-8099.4137942651278,-7953.7676474577784,-7823.0142112154754,-7707.1534855382324,-7606.185470426035,-7520.1101658788957,-7448.9275718968129,-7392.6376884797683,-7351.2405156277891,-7324.736053340861,-7313.1243016189819,-7316.4052604621575,-7334.5789298703876,-7367.6453098436687,-7415.6044003820043,-7478.4562014853909,-7556.2007131538339,-7648.8379353873306,-7756.3678681858728,-7878.7905115494777,-8016.1058654781282,-8168.313929971835,-8335.4147050306001,-8517.4081906544088,-8714.2943868432649,-8926.0732935971864,-9152.7449109161535,-9394.3092388001933,-9650.7662772492549,-9922.1160262633857,-10208.358485842571,-10509.493655986795,-10825.521536696097,-11156.442127970429,-11502.255429809829,-11862.961442214273,-12238.560165183788,-12629.051598718321,-13034.435742817954,-13454.712597482603,-13889.882162712311,-14339.94443850706,-14804.899424866888,-15284.74712179175,-15779.487529281685,-16289.120647336662,-16813.646475956692,-17353.065015141794,-17907.376264891915,-18476.580225207101,-19060.676896087341,-19659.666277532633,-20273.548369542976,-20902.323172118387,-21545.990685258817,-22204.550908964367,-22878.00384323491,-23566.349488070511,-24269.587843471163,-24987.718909436866,-25720.742685967642,-26468.659173063475,-27231.468370724411,-28009.170278950281,-28801.764897741283,-29609.252227097313,-30431.632267018409,-31268.905017504556,-32121.070478555783,-32988.128650171966,-33870.079532353302,-34766.923125099645,-35678.659428411025],[-17471.651043274462,-16932.17447493512,-16407.590617160829,-15897.899469951586,-15403.101033307383,-14923.195307228239,-14458.18229171416,-14008.06198676512,-13572.834392381141,-13152.499508562216,-12747.057335308338,-12356.507872619532,-11980.851120495758,-11620.087078937036,-11274.21574794337,-10943.23712751476,-10627.151217651204,-10325.958018352698,-10039.657529619242,-9768.2497514508541,-9511.7346838475059,-9270.1123268092124,-9043.3826803359716,-8831.5457444277927,-8634.6015190846592,-8452.5500043065804,-8285.3912000935488,-8133.1251064455664,-7995.7517233626504,-7873.2710508447853,-7765.683088891964,-7672.9878375042063,-7595.1852966814904,-7532.2754664238364,-7484.2583467312297,-7451.1339376036794,-7432.9022390411883,-7429.5632510437417,-7441.1169736113461,-7467.563406744006,-7508.9025504417259,-7565.1344047044895,-7636.2589695323049,-7722.2762449251832,-7823.186230883106,-7938.9889274060852,-8069.6843344941153,-8215.272452147201,-8375.7532803653448,-8551.1268191485233,-8741.393068496769,-8946.5520284100712,-9166.6036988884189,-9401.5480799318175,-9651.3851715402707,-9916.1149737137821,-10195.737486452344,-10490.252709755958,-10799.660643624617,-11123.961288058339,-11463.154643057114,-11817.240708620946,-12186.219484749809,-12570.09097144376,-12968.855168702734,-13382.512076526764,-13811.061694915856,-14254.504023870006,-14712.839063389205,-15186.066813473451,-15674.187274122742,-16177.200445337105,-16695.106327116493,-17227.904919460983,-17775.596222370514,-18338.180235845048,-18915.656959884673,-19508.026394489352,-20115.288539659072,-20737.443395393857,-21374.490961693708,-22026.431238558558,-22693.264225988511,-23374.989923983514,-24071.608332543554,-24783.119451668645,-25509.523281358786,-26250.819821613986,-27007.009072434259,-27778.091033819561,-28564.065705769906,-29364.933088285317,-30180.693181365823,-31011.345985011321,-31856.891499221914,-32717.329723997522,-33592.660659338188,-34482.884305243912,-35388.000661714694,-36308.009728750541],[-17291.915090267139,-16760.711285652244,-16244.400191602368,-15742.981808117554,-15256.456135197788,-14784.823172843082,-14328.08292105343,-13886.235379828833,-13459.280549169283,-13047.218429074786,-12650.049019545339,-12267.772320580956,-11900.388332181628,-11547.897054347339,-11210.2984870781,-10887.592630373923,-10579.779484234808,-10286.859048660721,-10008.831323651715,-9745.6963092077458,-9497.4540053288256,-9264.1044120149745,-9045.6475292661617,-8842.0833570823997,-8653.4118954637124,-8479.6331444100542,-8320.7471039214615,-8176.753773997918,-8047.6531546394326,-7933.4452458459928,-7834.1300476176139,-7749.7075599542723,-7680.1777828559943,-7625.5407163227783,-7585.7963603546095,-7560.9447149514817,-7550.985780113414,-7555.9195558404035,-7575.7460421324395,-7610.4652389895309,-7660.0771464116806,-7724.5817643988776,-7803.9790929511364,-7898.2691320684389,-8007.4518817507978,-8131.5273419982077,-8270.4955128106703,-8424.3563941881803,-8593.1099861307521,-8776.7562886383694,-8975.2953017110431,-9188.7270253487823,-9417.0514595515615,-9660.2686043193862,-9918.3784596522819,-10191.381025550214,-10479.276302013213,-10782.064289041264,-11099.744986634352,-11432.318394792506,-11779.784513515711,-12142.143342803978,-12519.394882657285,-12911.539133075637,-13318.576094059057,-13740.505765607541,-14177.328147721057,-14629.043240399631,-15095.651043643244,-15577.151557451916,-16073.54478182566,-16584.830716764474,-17111.009362268291,-17652.080718337209,-18208.044784971138,-18778.901562170118,-19364.651049934197,-19965.293248263286,-20580.828157157455,-21211.255776616643,-21856.57610664091,-22516.789147230251,-23191.894898384628,-23881.893360104033,-24586.78453238849,-25306.56841523802,-26041.245008652622,-26790.814312632239,-27555.2763271769,-28334.631052286692,-29128.878487961418,-29938.018634201282,-30762.051491006234,-31600.977058376149,-32454.795336311181,-33323.506324811249,-34207.110023876317,-35105.606433506538,-36018.995553701752,-36947.277384461973],[-17122.096492631732,-16599.165451741253,-16091.127121415828,-15597.98150165544,-15119.728592460115,-14656.368393829833,-14207.900905764622,-13774.326128264445,-13355.644061329333,-12951.854704959269,-12562.958059154247,-12188.954123914296,-11829.842899239382,-11485.62438512954,-11156.298581584731,-10841.86548860499,-10542.325106190299,-10257.677434340645,-9987.9224730560709,-9733.0602223365313,-9493.0906821820463,-9268.0138525926195,-9057.829733568251,-8862.5383251089206,-8682.1396272146485,-8516.6336398854382,-8366.0203631212789,-8230.2997969221651,-8109.4719412881068,-8003.5367962190967,-7912.494361715153,-7836.3446377762475,-7775.0876244024021,-7728.723321593603,-7697.2517293498686,-7680.6728476711833,-7678.9866765575425,-7692.19321600896,-7720.2924660254321,-7763.2844266069569,-7821.1690977535318,-7893.9464794651612,-7981.6165717418517,-8084.1793745835885,-8201.634887990378,-8333.983111962214,-8481.2240464991137,-8643.3576916010534,-8820.3840472680586,-9012.3031135001129,-9219.1148902972127,-9440.8193776593762,-9677.416575586587,-9928.9064840788506,-10195.28910313618,-10476.564432758547,-10772.732472945958,-11083.793223698445,-11409.746685015976,-11750.592856898547,-12106.331739346188,-12476.963332358877,-12862.487635936621,-13262.904650079417,-13678.214374787252,-14108.416810060182,-14553.511955898124,-15013.499812301123,-15488.380379269172,-15978.153656802293,-16482.819644900461,-17002.378343563687,-17536.829752791964,-18086.173872585256,-18650.41070294366,-19229.540243867072,-19823.562495355553,-20432.477457409113,-21056.285130027693,-21694.98551321133,-22348.578606960036,-23017.064411273765,-23700.442926152566,-24398.714151596425,-25111.878087605342,-25839.934734179318,-26582.884091318323,-27340.726159022379,-28113.4609372915,-28901.088426125672,-29703.608625524888,-30521.02153548917,-31353.327156018495,-32200.525487112893,-33062.616528772327,-33939.60028099687,-34831.476743786334,-35738.245917140979,-36659.907801060574,-37596.462395545292],[-16962.195250368241,-16447.536973202179,-15947.77140660119,-15462.898550565227,-14992.918405094339,-14537.830970188494,-14097.636245847709,-13672.334232071949,-13261.924928861263,-12866.408336215642,-12485.784454135061,-12120.053282619534,-11769.214821669058,-11433.269071283636,-11112.216031463267,-10806.055702207957,-10514.788083517697,-10238.413175392485,-9976.9309778323277,-9730.3414908372179,-9498.6447144071717,-9281.8406485421765,-9079.9292932422268,-8892.9106485073353,-8720.7847143375002,-8563.551490732716,-8421.2109776929865,-8293.7631752183061,-8181.2080833086875,-8083.5457019641071,-8000.7760311845886,-7932.8990709701202,-7879.9148213207072,-7841.8232822363461,-7818.6244537170314,-7810.3183357627768,-7816.9049283735749,-7838.3842315494203,-7874.7562452903312,-7926.0209695962867,-7992.1784044673004,-8073.2285499033605,-8169.1714059044662,-8280.0069724706445,-8405.7352496018684,-8546.3562372981414,-8701.8699355594636,-8872.2763443858439,-9057.5754637772789,-9257.7672937337557,-9472.8518342552961,-9702.8290853418839,-9947.6990469935336,-10207.461719210232,-10482.117101991975,-10771.665195338777,-11076.105999250638,-11395.43951372755,-11729.665738769512,-12078.784674376519,-12442.796320548598,-12821.700677285704,-13215.497744587889,-13624.187522455115,-14047.770010887403,-14486.245209884721,-14939.613119447113,-15407.873739574545,-15891.027070267046,-16389.073111524573,-16902.011863347183,-17429.843325734837,-17972.56749868752,-18530.184382205287,-19102.693976288101,-19690.096280935963,-20292.391296148882,-20909.579021926824,-21541.659458269867,-22188.632605177962,-22850.498462651078,-23527.257030689223,-24218.908309292492,-24925.452298460761,-25646.888998194103,-26383.218408492503,-27134.440529355932,-27900.555360784434,-28681.56290277798,-29477.463155336605,-30288.25611846026,-31113.941792148929,-31954.520176402701,-32809.99127122153,-33680.355076605381,-34565.611592554334,-35465.76081906831,-36380.802756147328,-37310.737403791398,-38255.564762000533],[-16812.211363476632,-16305.825850034988,-15814.333047158429,-15337.732954846915,-14876.02557310044,-14429.210901919036,-13997.288941302677,-13580.259691251358,-13178.123151765114,-12790.879322843906,-12418.528204487764,-12061.069796696665,-11718.504099470631,-11390.831112809639,-11078.050836713715,-10780.163271182824,-10497.168416216993,-10229.066271816209,-9975.8568379804856,-9737.5401147098255,-9514.1161020041982,-9305.5847998636345,-9111.9462082881273,-8933.2003272776601,-8769.3471568322639,-8620.3866969519022,-8486.3189476366006,-8367.1439088863535,-8262.8615807011647,-8173.4719630810214,-8098.9750560259272,-8039.3708595358949,-7994.6593736109171,-7964.8405982509757,-7949.914533456109,-7949.8811792262877,-7964.7405355615138,-7994.4926024617962,-8039.1373799271341,-8098.6748679575176,-8173.1050665529565,-8262.4279757134482,-8366.6435954389999,-8485.751925729608,-8619.7529665852508,-8768.6467180059444,-8932.43317999172,-9111.1123525425246,-9304.6842356583948,-9513.148829339314,-9736.5061335852915,-9974.7561483962963,-10227.898873772379,-10495.934309713508,-10778.862456219696,-11076.683313290927,-11389.396880927226,-11717.003159128551,-12059.502147894942,-12416.893847226398,-12789.178257122887,-13176.355377584454,-13578.425208611065,-13995.387750202719,-14427.243002359415,-14873.990965081202,-15335.63163836801,-15812.165022219877,-16303.591116636799,-16809.909921618761,-17331.121437165806,-17867.225663277881,-18418.222599955025,-18984.112247197198,-19564.89460500444,-20160.569673376722,-20771.137452314091,-21396.597941816501,-22036.951141883932,-22692.197052516458,-23362.33567371402,-24047.367005476597,-24747.29104780429,-25462.10780069702,-26191.817264154779,-26936.419438177603,-27695.914322765486,-28470.30191791839,-29259.582223636397,-30063.75523991941,-30882.820966767475,-31716.779404180619,-32565.630552158858,-33429.374410702112,-34308.010979810366,-35201.540259483765,-36109.96224972215,-37033.276950525629,-37971.484361894174,-38924.584483827653],[-16672.144831956903,-16174.032082239743,-15690.812043087588,-15222.484714500488,-14769.05009647847,-14330.508189021491,-13906.858992129561,-13498.102505802679,-13104.238730040848,-12725.267664844099,-12361.189310212372,-12012.003666145698,-11677.710732644104,-11358.310509707542,-11053.802997336039,-10764.188195529581,-10489.466104288196,-10229.636723611839,-9984.7000535005463,-9754.6560939543124,-9539.5048449731275,-9339.2463065569882,-9153.8804787059125,-8983.4073614198842,-8827.826954698905,-8687.1392585429912,-8561.3442729521139,-8450.4419979263039,-8354.4324334655466,-8273.3155795698258,-8207.0914362391813,-8155.7600034735751,-8119.3212812730108,-8097.775269637521,-8091.121968567074,-8099.3613780616815,-8122.493498121341,-8160.5183287460486,-8213.4358699358254,-8281.2461216906413,-8363.9490840105136,-8461.5447568954405,-8574.0331403454165,-8701.4142343604508,-8843.6880389405269,-9000.8545540856685,-9172.9137797958465,-9359.8657160711027,-9561.7103629114026,-9778.4477203167517,-10010.077788287148,-10256.600566822588,-10518.016055923104,-10794.324255588665,-11085.525165819279,-11391.618786614945,-11712.605117975663,-12048.484159901447,-12399.255912392255,-12764.920375448155,-13145.477549069066,-13540.927433255065,-13951.270028006098,-14376.50533332218,-14816.633349203325,-15271.654075649525,-15741.567512660777,-16226.373660237086,-16726.072518378445,-17240.664087084835,-17770.148366356298,-18314.525356192822,-18873.795056594383,-19447.957467560991,-20037.012589092679,-20640.960421189404,-21259.800963851187,-21893.534217077999,-22542.160180869891,-23205.678855226819,-23884.090240148813,-24577.39433563585,-25285.591141687961,-26008.680658305129,-26746.662885487305,-27499.537823234554,-28267.305471546882,-29049.96583042424,-29847.518899866656,-30659.964679874145,-31487.303170446619,-32329.534371584181,-33186.658283286808,-34058.674905554479,-34945.584238387244,-35847.386281785017,-36764.081035747855,-37695.668500275744,-38642.148675368691,-39603.521561026682],[-16541.995655809103,-16052.155669816359,-15577.208394388657,-15117.153829525978,-14671.991975228389,-14241.72283149585,-13826.346398328351,-13425.862675725897,-13040.271663688512,-12669.573362216184,-12313.767771308892,-11972.854890966644,-11646.834721189476,-11335.707261977357,-11039.472513330275,-10758.130475248252,-10491.681147731284,-10240.12453077938,-10003.460624392508,-9781.6894285707058,-9574.8109433139489,-9382.8251686222466,-9205.732104495597,-9043.5317509339984,-8896.2241079374598,-8763.8091755059631,-8646.2869536395301,-8543.6574423381498,-8455.9206416018205,-8383.0765514305349,-8325.1251718243093,-8282.0665027831383,-8253.9005443070255,-8240.6272963959564,-8242.2467590499346,-8258.7589322689746,-8290.1638160530638,-8336.4614104022148,-8397.6517153164168,-8473.7347307956588,-8564.71045683997,-8670.5788934493175,-8791.3400406237306,-8926.9938983631928,-9077.5404666677059,-9242.9797455372864,-9423.3117349718959,-9618.5364349715855,-9828.6538455363007,-10053.663966666079,-10293.566798360907,-10548.362340620803,-10818.05059344574,-11102.631556835728,-11402.10523079077,-11716.471615310851,-12045.730710396032,-12389.882516046238,-12748.927032261474,-13122.864259041799,-13511.694196387163,-13915.416844297581,-14334.032202773025,-14767.540271813557,-15215.94105141914,-15679.234541589763,-16157.420742325439,-16650.49965362619,-17158.47127549196,-17681.335607922814,-18219.092650918679,-18771.742404479643,-19339.284868605631,-19921.720043296686,-20519.047928552813,-21131.268524373932,-21758.381830760147,-22400.387847711434,-23057.286575227728,-23729.078013309103,-24415.762161955499,-25117.33902116699,-25833.808590943532,-26565.170871285096,-27311.42586219174,-28072.573563663434,-28848.61397570018,-29639.547098301948,-30445.372931468846,-31266.091475200701,-32101.702729497621,-32952.206694359644,-33817.603369786702,-34697.892755778841,-35593.074852335965,-36503.149659458184,-37428.117177145439,-38367.977405397804,-39322.73034421519,-40292.375993597612],[-16421.763835033202,-15940.196612764865,-15473.52210106161,-15021.740299923355,-14584.851209350192,-14162.854829342084,-13755.751159899028,-13363.540201021024,-12986.221952708049,-12623.796414960143,-12276.263587777292,-11943.623471159497,-11625.876065106757,-11323.02136961906,-11035.059384696408,-10761.990110338826,-10503.813546546287,-10260.529693318807,-10032.138550656369,-9818.6401185589966,-9620.0343970266731,-9436.3213860594078,-9267.5010856571862,-9113.5734958200374,-8974.5386165479176,-8850.3964478408561,-8741.1469896988492,-8646.7902421219005,-8567.3262051099955,-8502.7548786631596,-8453.0762627813529,-8418.2903574646061,-8398.397162712934,-8393.3966785262892,-8403.2889049047135,-8428.0738418481851,-8467.7514893567131,-8522.3218474302812,-8591.7849160689111,-8676.1406952725902,-8775.3891850413347,-8889.5303853751175,-9018.5642962739694,-9162.4909177378613,-9321.310249766806,-9495.0222923608017,-9683.6270455198501,-9887.1245092439622,-10105.514683533129,-10338.79756838735,-10586.973163806615,-10850.041469790915,-11128.002486340292,-11420.856213454703,-11728.602651134184,-12051.241799378717,-12388.773658188311,-12741.198227562949,-13108.515507502614,-13490.725498007363,-13887.828199077179,-14299.823610712005,-14726.711732911901,-15168.492565676865,-15625.166109006866,-16096.732362901937,-16583.191327362038,-17084.543002387203,-17600.78738797742,-18131.92448413268,-18677.954290853006,-19238.876808138375,-19814.692035988825,-20405.399974404314,-21011.00062338484,-21631.493982930406,-22266.880053041074,-22917.158833716785,-23582.330324957511,-24262.39452676331,-24957.351439134189,-25667.201062070053,-26391.943395571019,-27131.578439637065,-27886.106194268119,-28655.526659464238,-29439.839835225423,-30239.045721551629,-31053.144318442901,-31882.135625899238,-32726.019643920663,-33584.79637250708,-34458.46581165852,-35347.02796137509,-36250.482821656668,-37168.83039250334,-38102.070673915063,-39050.203665891786,-40013.229368433625,-40991.147781540414],[-16311.449369629201,-15838.154911085296,-15379.753163106452,-14936.244125692663,-14507.627798843907,-14093.904182560231,-13695.073276841611,-13311.13508168802,-12942.08959709949,-12587.936823076023,-12248.676759617614,-11924.309406724227,-11614.834764395924,-11320.252832632665,-11040.563611434451,-10775.767100801297,-10525.863300733188,-10290.852211230142,-10070.733832292146,-9865.5081639191994,-9675.1752061113166,-9499.7349588684738,-9339.1874221906728,-9193.5325960779446,-9062.7704805302819,-8946.9010755476447,-8845.9243811300712,-8759.8403972775523,-8688.6491239900861,-8632.3505612676709,-8590.9447091103102,-8564.4315675180042,-8552.811136490749,-8556.0834160285394,-8574.2484061313935,-8607.3061067992858,-8655.2565180322435,-8718.0996398302541,-8795.8354721933174,-8888.4640151214353,-8995.9852686145932,-9118.3992326728185,-9255.7059072960856,-9407.9052924844218,-9574.9973882377981,-9756.9821945562289,-9953.8597114397089,-10165.629938888256,-10392.292876901851,-10633.848525480493,-10890.296884624189,-11161.637954332942,-11447.871734606737,-11748.998225445601,-12065.017426849501,-12395.929338818458,-12741.733961352485,-13102.431294451553,-13478.02133811567,-13868.504092344834,-14273.879557139069,-14694.147732498359,-15129.308618422672,-15579.362214912077,-16044.308521966492,-16524.147539586,-17018.87926777055,-17528.503706520132,-18053.02085583478,-18592.430715714479,-19146.733286159266,-19715.928567169045,-20300.016558743911,-20898.997260883814,-21512.870673588804,-22141.636796858838,-22785.295630693909,-23443.847175094015,-24117.291430059209,-24805.628395589411,-25508.858071684714,-26226.980458345053,-26959.995555570429,-27707.9033633609,-28470.703881716385,-29248.39711063695,-30040.983050122522,-30848.461700173189,-31670.8330607889,-32508.097131969669,-33360.253913715438,-34227.303406026338,-35109.245608902253,-36006.080522343247,-36917.8081463493,-37844.428480920309,-38785.941526056471,-39742.347281757648,-40713.645748023911,-41699.836924855168],[-16211.0522595971,-15746.030564777631,-15295.901580523223,-14860.665306833858,-14440.321743709557,-14034.870891150298,-13644.312749156099,-13268.647317726945,-12907.87459686285,-12561.9945865638,-12231.007286829825,-11914.912697660884,-11613.710819056994,-11327.401651018166,-11055.9851935444,-10799.461446635665,-10557.830410291994,-10331.092084513381,-10119.246469299807,-9922.2935646512888,-9740.2333705678393,-9573.0658870494226,-9420.7911140960678,-9283.4090517077675,-9160.91969988452,-9053.3230586263307,-8960.619127933187,-8882.8079078050996,-8819.8893982420541,-8771.8635992440759,-8738.730510811145,-8720.4901329432687,-8717.1424656404488,-8728.6875089026744,-8755.1252627299509,-8796.4557271222911,-8852.6789020796678,-8923.7947876021099,-9009.8033836896138,-9110.7046903421542,-9226.4987075597492,-9357.1854353424023,-9502.7648736901065,-9663.2370226028615,-9838.6018820806785,-10028.859452123543,-10234.009732731462,-10454.05272390442,-10688.988425642461,-10938.816837945535,-11203.537960813665,-11483.151794246833,-11777.658338245064,-12087.057592808354,-12411.349557936705,-12750.534233630086,-13104.611619888528,-13473.581716712039,-13857.444524100589,-14256.200042054188,-14669.848270572851,-15098.389209656561,-15541.822859305335,-16000.149219519157,-16473.368290298018,-16961.480071641941,-17464.484563550915,-17982.381766024933,-18515.171679064028,-19062.854302668165,-19625.429636837333,-20202.897681571572,-20795.258436870885,-21402.511902735234,-22024.658079164612,-22661.696966159056,-23313.628563718594,-23980.452871843139,-24662.169890532743,-25358.779619787405,-26070.282059607147,-26796.677209991896,-27537.965070941733,-28294.145642456613,-29065.218924536501,-29851.18491718149,-30652.043620391538,-31467.795034166622,-32298.439158506757,-33143.975993411965,-34004.405538882173,-34879.727794917526,-35769.942761517857,-36675.050438683276,-37595.050826413681,-38529.943924709267,-39479.729733569817,-40444.408252995454,-41423.97948298612,-42418.443423541845],[-16120.572504936887,-15663.823573841833,-15221.967353311882,-14795.003843346942,-14382.933043947065,-13985.754955112239,-13603.469576842479,-13236.076909137772,-12883.576951998099,-12545.969705423484,-12223.255169413922,-11915.433343969424,-11622.504229089975,-11344.467824775569,-11081.324131026227,-10833.073147841935,-10599.714875222697,-10381.249313168508,-10177.676461679372,-9988.9963207552973,-9815.2088903962576,-9656.3141706022943,-9512.3121613733674,-9383.2028627095006,-9268.9862746106919,-9169.6623970769124,-9085.2312301082166,-9015.6927737045407,-8961.047027865945,-8921.2939925923965,-8896.4336678838881,-8886.4660537404507,-8891.3911501620642,-8911.2089571487268,-8945.919474700444,-8995.5227028171976,-9060.0186414990185,-9139.4072907458831,-9233.6886505578277,-9342.8627209348051,-9466.9295018768171,-9605.8889933838964,-9759.7411954560448,-9928.4861080932387,-10112.12373129548,-10310.654065062763,-10524.077109395117,-10752.392864292515,-10995.601329754987,-11253.702505782483,-11526.696392375048,-11814.582989532648,-12117.362297255335,-12435.034315543042,-12767.599044395807,-13115.056483813631,-13477.406633796518,-13854.64949434445,-14246.785065457449,-14653.813347135487,-15075.734339378545,-15512.548042186707,-15964.254455559891,-16430.853579498151,-16912.345414001466,-17408.729959069802,-17920.00721470319,-18446.177180901665,-18987.239857665169,-19543.195244993767,-20114.043342887377,-20699.784151346048,-21300.417670369752,-21915.943899958533,-22546.362840112364,-23191.674490831239,-23851.878852115209,-24526.975923964201,-25216.965706378214,-25921.848199357315,-26641.623402901467,-27376.291317010662,-28125.851941684952,-28890.305276924279,-29669.651322728627,-30463.890079098019,-31273.021546032462,-32097.045723531992,-32935.962611596609,-33789.772210226212,-34658.474519420837,-35542.069539180637,-36440.557269505356,-37353.93771039525,-38282.210861850122,-39225.376723870038,-40183.435296455064,-41156.386579605103,-42144.230573320267,-43146.967277600343],[-16040.01010564858,-15591.533938277968,-15157.950481472433,-14739.259735231944,-14335.461699556499,-13946.5563744461,-13572.54375990076,-13213.423855920488,-12869.196662505245,-12539.862179655065,-12225.420407369947,-11925.87134564987,-11641.21499449484,-11371.451353904882,-11116.580423879972,-10876.602204420098,-10651.516695525297,-10441.323897195551,-10246.023809430848,-10065.616432231191,-9900.1017655965916,-9749.4798095270598,-9613.7505640225572,-9492.9140290831238,-9386.9702047087449,-9295.9190908994133,-9219.760687655129,-9158.4949949758957,-9112.1220128617169,-9080.6417413126055,-9064.0541803285378,-9062.3593299095301,-9075.5571900555515,-9103.6477607666529,-9146.6310420427999,-9204.5070338840014,-9277.2757362902485,-9364.9371492615446,-9467.4912727979063,-9584.938106899328,-9717.2776515657788,-9864.5099067972951,-10026.634872593859,-10203.652548955488,-10395.562935882148,-10602.366033373883,-10824.061841430668,-11060.650360052507,-11312.131589239378,-11578.505528991314,-11859.772179308315,-12155.931540190359,-12466.983611637454,-12792.928393649596,-13133.765886226814,-13489.496089369062,-13860.119003076372,-14245.634627348754,-14646.042962186162,-15061.344007588626,-15491.537763556153,-15936.624230088708,-16396.60340718634,-16871.475294849042,-17361.23989307677,-17865.897201869557,-18385.44722122739,-18919.889951150286,-19469.225391638218,-20033.453542691226,-20612.57440430926,-21206.587976492381,-21815.49425924052,-22439.29325255374,-23077.984956431996,-23731.569370875332,-24400.046495883704,-25083.416331457105,-25781.678877595572,-26494.834134299119,-27222.882101567688,-27965.822779401322,-28723.656167799993,-29496.382266763743,-30284.001076292545,-31086.512596386397,-31903.916827045308,-32736.21376826919,-33583.40342005821,-34445.485782412296,-35322.460855331396,-36214.32863881559,-37121.089132864785,-38042.742337479067,-38979.288252658385,-39930.726878402762,-40897.058214712146,-41878.282261586632,-42874.399019026212,-43885.408487030771],[-15969.365061732184,-15529.161658086006,-15103.850965004891,-14693.432982488834,-14297.907710537818,-13917.275149151857,-13551.535298330955,-13200.688158075107,-12864.733728384308,-12543.672009258549,-12237.503000697849,-11946.226702702215,-11669.843115271635,-11408.3522384061,-11161.754072105607,-10930.048616370183,-10713.235871199811,-10511.315836594484,-10324.288512554213,-10152.153899079,-9994.9119961688284,-9852.5628038237137,-9725.1063220436627,-9612.5425508286608,-9514.8714901786989,-9432.0931400937952,-9364.2075005739607,-9311.214571619159,-9273.1143532294082,-9249.9068454047338,-9241.5920481450958,-9248.1699614505142,-9269.6405853209799,-9306.0039197565093,-9357.2599647570842,-9423.4087203227027,-9504.4501864533904,-9600.3843631491218,-9711.2112504099132,-9836.9308482357537,-9977.5431566266561,-10133.048175582602,-10303.445905103605,-10488.736345189656,-10688.919495840768,-10903.995357056916,-11133.963928838131,-11378.825211184401,-11638.579204095719,-11913.225907572076,-12202.76532161352,-12507.197446219972,-12826.522281391501,-13160.739827128082,-13509.850083429716,-13873.853050296435,-14252.748727728174,-14646.537115724948,-15055.218214286795,-15478.792023413693,-15917.25854310565,-16370.617773362659,-16838.869714184722,-17322.01436557182,-17820.051727524005,-18332.981800041223,-18860.804583123507,-19403.520076770797,-19961.128280983172,-20533.629195760637,-21121.022821103099,-21723.309157010663,-22340.488203483241,-22972.559960520877,-23619.524428123543,-24281.381606291303,-24958.131495024099,-25649.774094321954,-26356.30940418486,-27077.737424612817,-27814.058155605853,-28565.271597163875,-29331.377749287021,-30112.376611975189,-30908.268185228415,-31719.052469046677,-32544.729463430049,-33385.299168378355,-34240.76158389185,-35111.116709970331,-35996.364546613855,-36896.505093822423,-37811.538351596144,-38741.464319934865,-39686.282998838549,-40645.994388307423,-41620.598488341209,-42610.095298940119,-43614.48482010408,-44633.767051833129],[-15908.637373187676,-15476.706733265946,-15059.668803909259,-14657.52358511762,-14270.271076891035,-13897.911279229516,-13540.444192133033,-13197.869815601625,-12870.188149635258,-12557.399194233949,-12259.502949397673,-11976.499415126455,-11708.388591420309,-11455.170478279197,-11216.845075703153,-10993.412383692154,-10784.87240224621,-10591.225131365318,-10412.470571049476,-10248.608721298689,-10099.639582112954,-9965.5631534922759,-9846.3794354366437,-9742.0884279460752,-9652.6901310205521,-9578.1845446600855,-9518.5716688646717,-9473.8515036342978,-9444.0240489690077,-9429.0893048687431,-9429.0472713335421,-9443.897948363383,-9473.6413359582875,-9518.2774341182521,-9577.8062428432459,-9652.2277621333142,-9741.5419919884371,-9845.7489324085909,-9964.8485833938103,-10098.840944944084,-10247.726017059409,-10411.50379973979,-10590.174292985221,-10783.7374967957,-10992.193411171251,-11215.54203611183,-11453.783371617459,-11706.917417688168,-11974.944174323924,-12257.86364152472,-12555.675819290584,-12868.380707621487,-13195.978306517436,-13538.468615978447,-13895.851636004531,-14268.127366595651,-14655.295807751825,-15057.356959473025,-15474.310821759309,-15906.157394610651,-16352.896678027038,-16814.528672008499,-17291.05337655497,-17782.470791666499,-18288.780917343101,-18809.983753584762,-19346.079300391459,-19897.067557763225,-20462.948525700027,-21043.722204201877,-21639.388593268806,-22249.947692900743,-22875.399503097768,-23515.74402385985,-24170.981255186984,-24841.111197079153,-25526.133849536389,-26226.049212558661,-26940.857286146034,-27670.558070298393,-28415.151565015833,-29174.63777029833,-29949.016686145893,-30738.288312558492,-31542.45264953615,-32361.509697078844,-33195.45945518661,-34044.301923859428,-34908.037103097318,-35786.664992900223,-36680.185593268208,-37588.598904201201,-38511.904925699273,-39450.10365776244,-40403.195100390629,-41371.179253583861,-42354.056117342087,-43351.825691665479,-44364.487976553894,-45392.042972007352],[-15857.827040015076,-15434.169163817767,-15025.403998185526,-14631.531543118339,-14252.551798616181,-13888.46476467908,-13539.270441307028,-13204.968828500045,-12885.559926258102,-12581.043734581228,-12291.420253469383,-12016.689482922608,-11756.851422940887,-11511.906073524227,-11281.853434672597,-11066.693506386026,-10866.426288664521,-10681.051781508049,-10510.569984916645,-10354.980898890302,-10214.284523428994,-10088.480858532741,-9977.5699042015331,-9881.5516604354034,-9800.4261272343101,-9734.1933045982696,-9682.8531925272928,-9646.4057910213742,-9624.8511000804865,-9618.1891197046662,-9626.419849893884,-9649.5432906481692,-9687.5594419674999,-9740.4683038518924,-9808.2698763013395,-9890.9641593158267,-9988.5511528953684,-10101.030857039974,-10228.403271749617,-10370.668397024321,-10527.826232864085,-10699.876779268892,-10886.820036238756,-11088.656003773689,-11305.384681873651,-11537.006070538673,-11783.520169768739,-12044.926979563874,-12321.226499924047,-12612.418730849291,-12918.503672339568,-13239.481324394903,-13575.351687015291,-13926.114760200764,-14291.770543951243,-14672.319038266798,-15067.760243147402,-15478.094158593058,-15903.320784603782,-16343.440121179552,-16798.452168320367,-17268.356926026208,-17753.154394297148,-18252.844573133116,-18767.427462534153,-19296.903062500234,-19841.271373031384,-20400.532394127578,-20974.686125788758,-21563.73256801509,-22167.671720806415,-22786.503584162805,-23420.228158084275,-24068.845442570775,-24732.355437622347,-25410.758143238942,-26104.05355942063,-26812.241686167326,-27535.322523479095,-28273.29607135593,-29026.162329797793,-29793.921298804722,-30576.572978376673,-31374.117368513747,-32186.5544692158,-33013.884280482976,-33856.106802315124,-34713.222034712431,-35585.229977674717,-36472.130631202104,-37373.923995294463,-38290.610069951916,-39222.18885517442,-40168.660350961967,-41130.024557314653,-42106.281474232317,-43097.431101715032,-44103.473439762813,-45124.408488375615,-46160.23624755349],[-15816.934062214374,-15401.548949741489,-15001.056547833696,-14615.456856490906,-14244.74987571318,-13888.935605500532,-13548.014045852919,-13221.985196770363,-12910.849058252867,-12614.605630300404,-12333.254912913013,-12066.796906090669,-11815.231609833354,-11578.55902414113,-11356.779149013943,-11149.891984451799,-10957.897530454731,-10780.795787022691,-10618.586754155733,-10471.270431853794,-10338.84682011692,-10221.315918945102,-10118.677728338345,-10030.932248296642,-9958.0794788199855,-9900.1194199083839,-9857.0520715618204,-9828.8774337803225,-9815.5955065638791,-9817.206289912494,-9833.7097838261525,-9865.1059883048601,-9911.3949033486242,-9972.5765289574465,-10048.650865131309,-10139.617911870237,-10245.477669174206,-10366.230137043251,-10501.875315477328,-10652.413204476479,-10817.843804040671,-10998.167114169893,-11193.383134864196,-11403.49186612355,-11628.493307947956,-11868.387460337395,-12123.174323291907,-12392.85389681147,-12677.426180896082,-12976.891175545717,-13291.248880760486,-13620.499296540231,-13964.642422885063,-14323.678259794922,-14697.606807269869,-15086.428065309845,-15490.142033914897,-15908.748713084986,-16342.248102820133,-16790.640203120332,-17253.925013985554,-17732.102535415863,-18225.172767411212,-18733.135709971641,-19255.991363097091,-19793.739726787622,-20346.380801043171,-20913.9145858638,-21496.341081249462,-22093.660287200182,-22705.872203715953,-23332.976830796797,-23974.974168442648,-24631.864216653594,-25303.646975429619,-25990.322444770645,-26691.890624676729,-27408.3515151479,-28139.705116184094,-28885.95142778536,-29647.090449951684,-30423.122182683022,-31214.046625979441,-32019.863779840925,-32840.573644267417,-33676.176219258959,-34526.671504815589,-35392.059500937285,-36272.340207624024,-37167.513624875806,-38077.579752692654,-39002.53859107451,-39942.39014002146,-40897.134399533461,-41866.771369610491,-42851.301050252645,-43850.723441459777,-44865.038543231989,-45894.246355569296,-46938.346878471559],[-15785.95843978558,-15378.846091037138,-14986.626452853749,-14609.299525235414,-14246.865308182112,-13899.32380169391,-13566.675005770707,-13248.918920412576,-12946.055545619507,-12658.084881391498,-12385.006927728526,-12126.821684630606,-11883.529152097739,-11655.129330129941,-11441.622218727185,-11243.007817889486,-11059.286127616815,-10890.457147909226,-10736.5208787667,-10597.477320189206,-10473.326472176759,-10364.068334729374,-10269.70290784705,-10190.23019152975,-10125.650185777542,-10075.962890590363,-10041.16830596824,-10021.266431911175,-10016.257268419164,-10026.140815492203,-10050.917073130309,-10090.586041333432,-10145.147720101631,-10214.602109434887,-10298.949209333183,-10398.189019796537,-10512.321540824949,-10641.346772418414,-10785.264714576937,-10944.075367300506,-11117.778730589118,-11306.374804442796,-11509.863588861524,-11728.245083845293,-11961.519289394128,-12209.686205508013,-12472.745832186951,-12750.698169430976,-13043.543217240007,-13351.2809756141,-13673.911444553241,-14011.434624057436,-14363.850514126698,-14731.159114761005,-15113.360425960371,-15510.45444772478,-15922.441180054253,-16349.320622948771,-16791.092776408346,-17247.757640432963,-17719.315215022663,-18205.765500177393,-18707.108495897191,-19223.344202182016,-19754.472619031891,-20300.493746446853,-20861.407584426845,-21437.21413297188,-22027.913392082002,-22633.505361757154,-23253.990041997378,-23889.367432802646,-24539.637534172958,-25204.800346108299,-25884.855868608727,-26579.804101674206,-27289.645045304722,-28014.378699500296,-28754.005064260957,-29508.524139586647,-30277.935925477395,-31062.240421933129,-31861.43762895398,-32675.527546539954,-33504.510174690855,-34348.385513406909,-35207.153562687949,-36080.814322534039,-36969.367792945195,-37872.813973921438,-38791.152865462645,-39724.384467568983,-40672.508780240372,-41635.52580347679,-42613.435537278296,-43606.237981644837,-44613.933136576423,-45636.521002072994,-46674.001578134754,-47726.374864761478],[-15764.900172728661,-15366.060587704669,-14982.11371324571,-14613.059549351803,-14258.89809602296,-13919.629353259144,-13595.253321060402,-13285.769999426706,-12991.179388358052,-12711.481487854478,-12446.676297915939,-12196.763818542453,-11961.744049734036,-11741.616991490639,-11536.382643812311,-11346.041006699046,-11170.59208015084,-11010.035864167661,-10864.372358749555,-10733.601563896507,-10617.723479608492,-10516.738105885544,-10430.645442727622,-10359.445490134789,-10303.138248106981,-10261.723716644254,-10235.201895746552,-10223.572785413933,-10226.83638564634,-10244.992696443815,-10278.041717806344,-10325.983449733918,-10388.81789222654,-10466.545045284216,-10559.164908906958,-10666.677483094749,-10789.082767847571,-10926.380763165467,-11078.571469048416,-11245.654885496409,-11427.631012509475,-11624.499850087575,-11836.261398230756,-12062.915656938945,-12304.462626212218,-12560.902306050531,-12832.234696453896,-13118.459797422331,-13419.577608955804,-13735.588131054345,-14066.491363717907,-14412.287306946542,-14772.97596074023,-15148.557325098984,-15539.031400022765,-15944.398185511602,-16364.65768156551,-16799.809888184467,-17249.854805368479,-17714.792433117538,-18194.622771431656,-18689.345820310813,-19198.961579755018,-19723.470049764273,-20262.871230338613,-20817.165121477999,-21386.35172318243,-21970.431035451889,-22569.403058286422,-23183.267791686027,-23812.025235650661,-24455.67539018036,-25114.218255275111,-25787.653830934927,-26475.982117159765,-27179.203113949661,-27897.316821304623,-28630.323239224614,-29378.222367709684,-30141.014206759799,-30918.698756374994,-31711.276016555195,-32518.745987300455,-33341.108668610817,-34178.364060486179,-35030.512162926621,-35897.552975932114,-36779.4864995026,-37676.312733638253,-38588.031678338921,-39514.643333604603,-40456.147699435351,-41412.544775831127,-42383.834562792035,-43370.017060317958,-44371.092268408931,-45387.060187064919,-46417.920816285994,-47463.674156072128,-48524.32020642329],[-15753.759261043668,-15363.192439744096,-14987.518329009576,-14626.736928840108,-14280.84823923568,-13949.852260196318,-13633.748991722006,-13332.538433812728,-13046.220586468522,-12774.79544968936,-12518.263023475247,-12276.623307826208,-12049.87630274221,-11838.022008223277,-11641.060424269359,-11458.991550880524,-11291.815388056764,-11139.531935798013,-11002.141194104332,-10879.643162975713,-10772.037842412126,-10679.325232413619,-10601.505332980152,-10538.578144111718,-10490.543665808358,-10457.401898070057,-10439.152840896804,-10435.796494288583,-10447.332858245434,-10473.761932767346,-10515.08371785429,-10571.298213506292,-10642.405419723369,-10728.405336505468,-10829.297963852641,-10945.083301764866,-11075.76135024213,-11221.332109284467,-11381.79557889185,-11557.151759064272,-11747.400649801748,-11952.542251104283,-12172.576562971873,-12407.503585404531,-12657.323318402208,-12922.035761964971,-13201.640916092781,-13496.138780785619,-13805.529356043537,-14129.812641866509,-14468.988638254506,-14823.057345207593,-15192.0187627257,-15575.872890808865,-15974.619729457101,-16388.259278670375,-16816.791538448699,-17260.216508792073,-17718.534189700513,-18191.744581174018,-18679.84768321256,-19182.843495816142,-19700.732018984818,-20233.513252718491,-20781.187197017243,-21343.753851881062,-21921.213217309953,-22513.565293303851,-23120.810079862807,-23742.9475769868,-24379.977784675888,-25031.900702930026,-25698.716331749223,-26380.424671133427,-27077.025721082748,-27788.519481597054,-28514.905952676483,-29256.185134320862,-30012.357026530386,-30783.421629304932,-31569.378942644551,-32370.228966549163,-33185.971701018854,-34016.607146053648,-34862.135301653441,-35722.55616781838,-36597.869744548247,-37488.076031843288,-38393.175029703256,-39313.166738128348,-40248.051157118491,-41197.828286673692,-42162.498126793871,-43142.060677479181,-44136.515938729535,-45145.863910544926,-46170.104592925331,-47209.237985870903,-48263.264089381417,-49332.182903457004],[-15752.535704730601,-15370.241647155446,-15002.840300145337,-14650.331663700304,-14312.715737820312,-13989.992522505379,-13682.162017755509,-13389.22422357064,-13111.179139950877,-12848.026766896161,-12599.767104406494,-12366.400152481865,-12147.9259111223,-11944.344380327784,-11755.65556009833,-11581.85945043392,-11422.956051334566,-11278.945362800259,-11149.827384831002,-11035.60211742681,-10936.269560587665,-10851.829714313579,-10782.282578604551,-10727.628153460562,-10687.866438881629,-10662.997434867746,-10653.021141418927,-10657.937558535155,-10677.746686216444,-10712.448524462776,-10762.043073274148,-10826.530332650593,-10905.910302592089,-11000.182983098632,-11109.348374170237,-11233.406475806893,-11372.357288008598,-11526.200810775337,-11694.937044107164,-11878.565988004029,-12077.087642465947,-12290.502007492898,-12518.809083084907,-12762.008869242018,-13020.10136596413,-13293.086573251299,-13580.964491103556,-13883.735119520832,-14201.398458503187,-14533.954508050569,-14881.403268163005,-15243.744738840509,-15620.978920083056,-16013.105811890668,-16420.125414263319,-16842.03772720103,-17278.842750703807,-17730.540484771613,-18197.130929404466,-18678.614084602421,-19174.989950365358,-19686.258526693418,-20212.419813586486,-20753.473811044638,-21309.420519067797,-21880.259937656039,-22465.992066809362,-23066.616906527692,-23682.134456811051,-24312.544717659526,-24957.847689073024,-25618.043371051601,-26293.1317635952,-26983.112866703879,-27687.986680377588,-28407.753204616332,-29142.412439420179,-29891.964384789062,-30656.40904072296,-31435.746407221966,-32229.976484286024,-33039.099271915074,-33863.114770109241,-34702.022978868445,-35555.823898192692,-36424.517528081953,-37308.103868536309,-38206.582919555702,-39119.954681140203,-40048.21915328972,-40991.37633600425,-41949.426229283905,-42922.368833128552,-43910.204147538258,-44912.932172513021,-45930.55290805285,-46963.066354157731,-48010.472510827662,-49072.771378062695,-50149.962955862691],[-15761.229503789393,-15387.208209938668,-15028.079626652991,-14683.843753932393,-14354.500591776836,-14040.050140186329,-13740.492399160887,-13455.82736870048,-13186.055048805123,-12931.175439474842,-12691.188540709607,-12466.094352509415,-12255.892874874296,-12060.584107804189,-11880.168051299172,-11714.644705359187,-11564.014069984274,-11428.276145174401,-11307.430930929582,-11201.478427249815,-11110.418634135105,-11034.251551585447,-10972.977179600823,-10926.595518181286,-10895.106567326786,-10878.510327037349,-10876.806797312962,-10889.995978153602,-10918.077869559311,-10961.052471530085,-11018.919784065904,-11091.679807166765,-11179.332540832689,-11281.877985063671,-11399.316139859702,-11531.647005220799,-11678.870581146919,-11840.986867638096,-12017.995864694349,-12209.897572315645,-12416.69199050198,-12638.379119253384,-12874.958958569845,-13126.431508451358,-13392.796768897902,-13674.054739909534,-13970.205421486184,-14281.248813627912,-14607.184916334692,-14948.013729606515,-15303.735253443376,-15674.349487845298,-16059.856432812303,-16460.256088344351,-16875.548454441425,-17305.733531103557,-17750.811318330743,-18210.78181612301,-18685.645024480313,-19175.400943402652,-19680.049572890079,-20199.590912942527,-20734.024963560045,-21283.351724742599,-21847.571196490222,-22426.683378802889,-23020.688271680592,-23629.585875123412,-24253.376189131217,-24892.059213704088,-25545.634948842038,-26214.103394545018,-26897.464550813056,-27595.718417646174,-28308.864995044292,-29036.904283007505,-29779.836281535798,-30537.660990629098,-31310.378410287427,-32097.988540510851,-32900.491381299296,-33717.886932652822,-34550.175194571406,-35397.356167055033,-36259.429850103697,-37136.396243717449,-38028.255347896251,-38935.00716264006,-39856.651687948921,-40793.188923822912,-41744.618870261867,-42710.941527265946,-43692.156894835076,-44688.264972969184,-45699.265761668357,-46725.159260932691,-47765.945470761937,-48821.624391156292,-49892.196022115808,-50977.660363640178],[-15779.84065822011,-15414.092128093804,-15063.23630853258,-14727.273199536392,-14406.202801105268,-14100.025113239213,-13808.740135938178,-13532.347869202207,-13270.848313031298,-13024.241467425438,-12792.527332384616,-12575.705907908872,-12373.777193998161,-12186.741190652512,-12014.59789787193,-11857.347315656378,-11714.989444005882,-11587.52428292044,-11474.951832400058,-11377.272092444719,-11294.485063054439,-11226.590744229226,-11173.589135969036,-11135.480238273936,-11112.264051143851,-11103.940574578848,-11110.509808578887,-11131.971753143975,-11168.32640827413,-11219.573773969314,-11285.713850229567,-11366.746637054865,-11462.672134445234,-11573.490342400626,-11699.201260921101,-11839.804890006613,-11995.301229657169,-12165.690279872808,-12350.972040653478,-12551.146511999208,-12766.213693909982,-12996.173586385798,-13241.026189426715,-13500.771503032624,-13775.409527203623,-14064.940261939681,-14369.363707240771,-14688.679863106916,-15022.888729538112,-15371.990306534384,-15735.984594095686,-16114.871592222047,-16508.651300913451,-16917.323720169916,-17340.888849991454,-17779.346690378021,-18232.69724132965,-18700.94050284633,-19184.076474928061,-19682.105157574857,-20195.026550786693,-20722.840654563588,-21265.547468905534,-21823.146993812516,-22395.639229284585,-22983.024175321683,-23585.301831923825,-24202.47219909104,-24834.535276823291,-25481.491065120616,-26143.339563982961,-26820.080773410416,-27511.714693402864,-28218.241323960356,-28939.660665082978,-29675.972716770601,-30427.177479023325,-31193.274951841071,-31974.265135223824,-32770.148029171658,-33580.923633684572,-34406.591948762521,-35247.152974405493,-36102.606710613582,-36972.953157386713,-37858.19231472486,-38758.324182628094,-39673.348761096335,-40603.26605012967,-41548.076049728057,-42507.778759891378,-43482.374180619983,-44471.862311913494,-45476.243153772062,-46495.516706195704,-47529.682969184396,-48578.741942738146,-49642.693626856941,-50721.538021540764,-51815.27512678966],[-15808.369168022704,-15450.893401620868,-15108.310345784041,-14780.620000512294,-14467.822365805598,-14169.917441663958,-13886.905228087366,-13618.785725075832,-13365.558932629354,-13127.224850747929,-12903.783479431548,-12695.234818680208,-12501.57886849394,-12322.815628872737,-12158.945099816567,-12009.967281325458,-11875.882173399394,-11756.68977603838,-11652.390089242446,-11562.983113011527,-11488.46884734567,-11428.847292244889,-11384.118447709156,-11354.282313738466,-11339.338890332825,-11339.288177492232,-11354.130175216695,-11383.864883506219,-11428.492302360806,-11488.012431780431,-11562.4252717651,-11651.730822314847,-11755.929083429626,-11875.020055109479,-12009.003737354376,-12157.880130164314,-12321.649233539316,-12500.311047479368,-12693.865571984468,-12902.312807054621,-13125.65275268983,-13363.885408890108,-13617.010775655444,-13885.028852985777,-14167.939640881197,-14465.743139341685,-14778.439348367201,-15106.028267957792,-15448.509898113449,-15805.884238834118,-16178.151290119858,-16565.31105197065,-16967.363524386499,-17384.308707367374,-17816.146600913366,-18262.87720502435,-18724.500519700421,-19201.016544941533,-19692.425280747673,-20198.726727118898,-20719.920884055195,-21256.007751556514,-21806.987329622898,-22372.859618254304,-22953.624617450791,-23549.282327212328,-24159.832747538894,-24785.275878430519,-25425.611719887223,-26080.840271908986,-26750.961534495778,-27435.975507647643,-28135.882191364559,-28850.681585646496,-29580.373690493499,-30324.958505905553,-31084.43603188268,-31858.806268424814,-32648.069215532065,-33452.224873204374,-34271.273241441646,-35105.214320244078,-35954.048109611475,-36817.774609543965,-37696.393820041529,-38589.905741104136,-39498.310372731808,-40421.607714924488,-41359.79776768227,-42312.880531005052,-43280.856004892841,-44263.724189345783,-45261.48508436371,-46274.138689946769,-47301.685006094856,-48344.124032807944,-49401.455770086126,-50473.680217929395,-51560.797376337694,-52662.807245311014],[-15846.815033197207,-15497.612030519782,-15163.301738407403,-14843.884156860107,-14539.359285877839,-14249.727125460624,-13974.987675608485,-13715.140936321366,-13470.186907599329,-13240.125589442318,-13024.956981850368,-12824.68108482348,-12639.297898361627,-12468.807422464844,-12313.209657133139,-12172.50460236642,-12046.69225816481,-11935.772624528217,-11839.745701456717,-11758.611488950253,-11692.369987008842,-11641.021195632453,-11604.565114821158,-11583.001744574885,-11576.331084893693,-11584.553135777529,-11607.667897226445,-11645.675369240405,-11698.575551819413,-11766.368444963462,-11849.054048672575,-11946.63236294673,-12059.103387785966,-12186.467123190232,-12328.72356915956,-12485.872725693938,-12657.91459279337,-12844.849170457859,-13046.676458687385,-13263.396457481966,-13495.009166841626,-13741.514586766321,-14002.912717256071,-14279.20355831087,-14570.387109930729,-14876.463372115637,-15197.43234486559,-15533.294028180615,-15884.048422060665,-16249.695526505777,-16630.235341515985,-17025.667867091175,-17435.993103231478,-17861.211049936792,-18301.321707207164,-18756.325075042609,-19226.221153443126,-19711.009942408666,-20210.691441939256,-20725.26565203489,-21254.732572695619,-21799.092203921333,-22358.344545712142,-22932.489598068016,-23521.527360988934,-24125.457834474917,-24744.28101852593,-25377.996913142015,-26026.605518323136,-26690.106834069309,-27368.500860380525,-28061.787597256836,-28769.967044698118,-29493.039202704567,-30231.004071276002,-30983.861650412502,-31751.611940114039,-32534.254940380648,-33331.790651212279,-34144.219072608976,-34971.540204570767,-35813.754047097602,-36670.860600189444,-37542.859863846337,-38429.751838068296,-39331.536522855356,-40248.213918207453,-41179.784024124543,-42126.246840606698,-43087.602367654035,-44063.850605266249,-45054.991553443644,-46061.025212185996,-47081.951581493442,-48117.770661366005,-49168.482451803487,-50234.086952806094,-51314.584164373817,-52409.974086506503,-53520.256719204299],[-15895.178253743621,-15554.248014790608,-15228.210486402699,-14917.065668579813,-14620.813561321969,-14339.454164629187,-14072.987478501464,-13821.413502938794,-13584.732237941171,-13362.943683508607,-13156.04783964108,-12964.044706338633,-12786.934283601231,-12624.716571428857,-12477.391569821564,-12344.959278779315,-12227.419698302117,-12124.772828389967,-12037.018669042875,-11964.157220260851,-11906.188482043866,-11863.112454391932,-11834.929137305066,-11821.638530783215,-11823.240634826445,-11839.735449434742,-11871.122974608059,-11917.403210346447,-11978.576156649879,-12054.641813518389,-12145.600180951924,-12251.451258950521,-12372.195047514168,-12507.83154664287,-12658.36075633664,-12823.782676595443,-13004.097307419304,-13199.304648808216,-13409.404700762183,-13634.397463281206,-13874.28293636528,-14129.061120014418,-14398.732014228603,-14683.29561900782,-14982.751934352109,-15297.100960261441,-15626.342696735852,-15970.477143775277,-16329.504301379789,-16703.424169549315,-17092.236748283918,-17495.942037583576,-17914.540037448307,-18348.030747878081,-18796.4141688729,-19259.690300432747,-19737.859142557663,-20230.920695247638,-20738.874958502638,-21261.721932322747,-21799.4616167079,-22352.094011658082,-22919.619117173315,-23502.036933253599,-24099.347459898934,-24711.550697109356,-25338.646644884779,-25980.63530322531,-26637.516672130834,-27309.290751601467,-27995.957541637086,-28697.517042237814,-29413.969253403622,-30145.314175134496,-30891.551807430333,-31652.682150291243,-32428.705203717203,-33219.620967708222,-34025.429442264307,-34846.130627385457,-35681.724523071716,-36532.211129322939,-37397.590446139191,-38277.862473520574,-39173.027211466935,-40083.084659978493,-41008.034819054948,-41947.877688696499,-42902.613268903122,-43872.241559674781,-44856.762561011463,-45856.17627291329,-46870.482695380117,-47899.681828412038,-48943.773672008916,-50002.758226170903,-51076.635490897905,-52165.405466190008,-53269.068152047235,-54387.623548469426],[-15953.458829661929,-15620.801354433372,-15303.036589769861,-15000.164535671403,-14712.185192138024,-14439.098559169654,-14180.904636766367,-13937.603424928126,-13709.194923654926,-13495.679132946807,-13297.056052803708,-13113.325683225677,-12944.488024212724,-12790.543075764781,-12651.490837881938,-12527.331310564103,-12418.064493811318,-12323.69038762361,-12244.208992000957,-12179.620306943361,-12129.924332450802,-12095.121068523316,-12075.210515160858,-12070.192672363484,-12080.067540131135,-12104.835118463834,-12144.495407361617,-12199.048406824413,-12268.494116852289,-12352.832537445223,-12452.063668603194,-12566.187510326232,-12695.204062614313,-12839.113325467442,-12997.915298885644,-13171.609982868864,-13360.197377417162,-13563.677482530515,-13782.050298208924,-14015.315824452358,-14263.474061260882,-14526.525008634429,-14804.468666573048,-15097.305035076706,-15405.034114145416,-15727.655903779187,-16065.170403978018,-16417.577614741895,-16784.87753607081,-17167.070167964805,-17564.155510423836,-17976.133563447926,-18403.004327037095,-18844.767801191258,-19301.423985910485,-19772.972881194801,-20259.414487044181,-20760.748803458584,-21276.97583043803,-21808.095567982564,-22354.108016092112,-22915.013174766733,-23490.811044006405,-24081.501623811142,-24687.084914180887,-25307.560915115748,-25942.929626615594,-26593.191048680572,-27258.345181310528,-27938.3920245056,-28633.331578265672,-29343.163842590839,-30067.888817481005,-30807.506502936281,-31562.016898956579,-32331.420005541891,-33115.715822692342,-33914.904350407807,-34728.985588688352,-35557.95953753389,-36401.826196944516,-37260.585566920156,-38134.237647460912,-39022.782438566763,-39926.21994023757,-40844.550152473428,-41777.773075274352,-42725.888708640392,-43688.897052571447,-44666.798107067531,-45659.591872128665,-46667.278347754946,-47689.857533946175,-48727.329430702477,-49779.694038023845,-50846.951355910285,-51929.101384361718,-53026.144123378319,-54138.079572959912,-55264.907733106462],[-16021.656760952128,-15697.272049448015,-15387.780048508936,-15093.180758134926,-14813.474178325951,-14548.660309082024,-14298.739150403155,-14063.710702289365,-13843.574964740586,-13638.331937756908,-13447.981621338246,-13272.524015484643,-13111.959120196105,-12966.286935472601,-12835.50746131417,-12719.620697720793,-12618.626644692449,-12532.525302229169,-12461.316670330962,-12405.00074899778,-12363.57753822966,-12337.047038026592,-12325.409248388572,-12328.664169315622,-12346.811800807711,-12379.852142864846,-12427.785195487053,-12490.610958674284,-12568.329432426601,-12660.940616743952,-12768.444511626365,-12890.841117073805,-13028.130433086348,-13180.312459663892,-13347.387196806529,-13529.354644514187,-13726.214802786919,-13937.9676716247,-14164.613251027549,-14406.151540995425,-14662.582541528373,-14933.906252626353,-15220.12267428939,-15521.2318065175,-15837.233649310645,-16168.128202668837,-16513.91546659208,-16874.595441080401,-17250.168126133776,-17640.633521752192,-18045.991627935648,-18466.242444684183,-18901.385971997744,-19351.422209876368,-19816.351158320067,-20296.172817328774,-20790.887186902604,-21300.494267041395,-21824.994057745302,-22364.38655901426,-22918.67177084821,-23487.849693247292,-24071.92032621141,-24670.883669740557,-25284.739723834755,-25913.488488494004,-26557.129963718304,-27215.664149507727,-27889.091045862144,-28577.410652781597,-29280.622970266093,-29998.727998315677,-30731.725736930312,-31479.616186109997,-32242.399345854756,-33020.075216164529,-33812.643797039382,-34620.105088479249,-35442.459090484219,-36279.705803054239,-37131.845226189347,-37998.877359889382,-38880.802204154548,-39777.619758984787,-40689.330024380055,-41615.933000340388,-42557.428686865773,-43513.817083956157,-44485.098191611651,-45471.272009832159,-46472.338538617754,-47488.297777968386,-48519.14972788412,-49564.894388364883,-50625.531759410653,-51701.061841021488,-52791.484633197404,-53896.80013593832,-55017.008349244403,-56152.109273115428],[-16099.772047614235,-15783.660099834549,-15482.440862619904,-15196.114335970295,-14924.680519885775,-14668.1394143663,-14426.491019411867,-14199.735335022493,-13987.872361198153,-13790.902097938872,-13608.824545244675,-13441.639703115494,-13289.347571551392,-13151.948150552325,-13029.441440118328,-12921.827440249366,-12829.10615094547,-12751.277572206613,-12688.341704032817,-12640.298546424066,-12607.148099380407,-12588.89036290177,-12585.525336988176,-12597.053021639636,-12623.473416856166,-12664.786522637747,-12720.992338984368,-12792.090865896054,-12878.082103372777,-12978.966051414578,-13094.742710021435,-13225.412079193293,-13370.974158930263,-13531.428949232246,-13706.7764500993,-13897.016661531406,-14102.149583528566,-14322.175216090765,-14557.093559218025,-14806.904612910346,-15071.608377167717,-15351.204851990156,-15645.694037377621,-15955.075933330172,-16279.350539847739,-16618.517856930368,-16972.577884578037,-17341.5306227908,-17725.376071568608,-18124.114230911397,-18537.745100819346,-18966.268681292269,-19409.684972330258,-19867.993973933331,-20341.19568610147,-20829.290108834597,-21332.277242132834,-21850.157085996114,-22382.929640424416,-22930.594905417798,-23493.152880976239,-24070.603567099723,-24662.946963788258,-25270.183071041858,-25892.311888860466,-26529.333417244168,-27181.247656192907,-27848.054605706704,-28529.754265785596,-29226.346636429436,-29937.831717638379,-30664.209509412416,-31405.480011751533,-32161.643224655621,-32932.69914812479,-33718.647782159038,-34519.489126758301,-35335.223181922651,-36165.849947652008,-37011.369423946409,-37871.781610805956,-38747.086508230459,-39637.28411622002,-40542.374434774669,-41462.357463894383,-42397.233203579191,-43347.001653828964,-44311.662814643794,-45291.216686023734,-46285.663267968695,-47295.002560478679,-48319.234563553808,-49358.359277193893,-50412.376701399087,-51481.286836169333,-52565.089681504571,-53663.785237404903,-54777.373503870338,-55905.854480900736,-57049.228168496164]],"type":"surface","colorscale":"Viridis","showscale":true,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"C (Recovery proportion)"},"yaxis":{"title":"Alpha parameter"},"zaxis":{"title":"Log-Likelihood"},"camera":{"eye":{"x":-1,"y":-2.5,"z":0.5}}},"title":"Log-Likelihood Landscape for alpha and c Parameters","hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":"Viridis","showscale":true,"x":[0.29999999999999999,0.31212121212121213,0.32424242424242422,0.33636363636363636,0.34848484848484845,0.3606060606060606,0.37272727272727268,0.38484848484848483,0.39696969696969697,0.40909090909090906,0.4212121212121212,0.43333333333333335,0.44545454545454544,0.45757575757575752,0.46969696969696972,0.48181818181818181,0.4939393939393939,0.5060606060606061,0.51818181818181819,0.53030303030303028,0.54242424242424248,0.55454545454545445,0.56666666666666665,0.57878787878787885,0.59090909090909083,0.60303030303030303,0.61515151515151512,0.6272727272727272,0.6393939393939394,0.65151515151515149,0.66363636363636358,0.67575757575757578,0.68787878787878787,0.69999999999999996,0.71212121212121215,0.72424242424242424,0.73636363636363633,0.74848484848484853,0.76060606060606062,0.77272727272727271,0.78484848484848491,0.79696969696969688,0.80909090909090908,0.82121212121212128,0.83333333333333326,0.84545454545454546,0.85757575757575766,0.86969696969696964,0.88181818181818183,0.89393939393939403,0.90606060606060601,0.91818181818181821,0.93030303030303019,0.94242424242424239,0.95454545454545459,0.96666666666666656,0.97878787878787876,0.99090909090909096,1.0030303030303029,1.0151515151515151,1.0272727272727273,1.0393939393939393,1.0515151515151515,1.0636363636363637,1.0757575757575757,1.0878787878787879,1.1000000000000001,1.1121212121212121,1.1242424242424243,1.1363636363636362,1.1484848484848484,1.1606060606060606,1.1727272727272726,1.1848484848484848,1.196969696969697,1.209090909090909,1.2212121212121212,1.2333333333333334,1.2454545454545454,1.2575757575757576,1.2696969696969698,1.2818181818181817,1.2939393939393939,1.3060606060606061,1.3181818181818181,1.3303030303030303,1.3424242424242425,1.3545454545454545,1.3666666666666667,1.3787878787878789,1.3909090909090909,1.4030303030303031,1.4151515151515153,1.4272727272727272,1.4393939393939394,1.4515151515151516,1.4636363636363636,1.4757575757575758,1.487878787878788,1.5],"y":[710,711.81818181818187,713.63636363636363,715.4545454545455,717.27272727272725,719.09090909090912,720.90909090909088,722.72727272727275,724.5454545454545,726.36363636363637,728.18181818181813,730,731.81818181818187,733.63636363636363,735.4545454545455,737.27272727272725,739.09090909090912,740.90909090909088,742.72727272727275,744.5454545454545,746.36363636363637,748.18181818181813,750,751.81818181818187,753.63636363636363,755.4545454545455,757.27272727272725,759.09090909090912,760.90909090909088,762.72727272727275,764.5454545454545,766.36363636363637,768.18181818181813,770,771.81818181818176,773.63636363636363,775.4545454545455,777.27272727272725,779.09090909090912,780.90909090909088,782.72727272727275,784.5454545454545,786.36363636363637,788.18181818181813,790,791.81818181818176,793.63636363636363,795.4545454545455,797.27272727272725,799.09090909090912,800.90909090909088,802.72727272727275,804.5454545454545,806.36363636363637,808.18181818181813,810,811.81818181818176,813.63636363636363,815.4545454545455,817.27272727272725,819.09090909090912,820.90909090909088,822.72727272727275,824.5454545454545,826.36363636363637,828.18181818181813,830,831.81818181818176,833.63636363636363,835.4545454545455,837.27272727272725,839.09090909090912,840.90909090909088,842.72727272727275,844.5454545454545,846.36363636363637,848.18181818181824,850,851.81818181818176,853.63636363636363,855.4545454545455,857.27272727272725,859.09090909090912,860.90909090909088,862.72727272727275,864.5454545454545,866.36363636363637,868.18181818181824,870,871.81818181818176,873.63636363636363,875.4545454545455,877.27272727272725,879.09090909090912,880.90909090909088,882.72727272727275,884.5454545454545,886.36363636363637,888.18181818181824,890],"z":[[-56475.449577156316,-55340.334020657909,-54220.111174724501,-53114.781039356145,-52024.343614552825,-50948.798900314643,-49888.146896641498,-48842.387603533331,-47811.521020990287,-46795.547149012258,-45794.465987599346,-44808.27753675144,-43836.981796468572,-42880.578766750805,-41939.068447598067,-41012.450839010351,-40100.725940987693,-39203.893753530159,-38321.954276637611,-37454.907510310135,-36602.753454547696,-35765.492109350285,-34943.123474717984,-34135.647550650734,-33343.064337148513,-32565.373834211343,-31802.576041839253,-31054.670960032199,-30321.658588790182,-29603.53892811323,-28900.311978001315,-28211.977738454472,-27538.536209472688,-26879.987391055955,-26236.331283204265,-25607.56788591767,-24993.69719919606,-24394.719223039523,-23810.633957448066,-23241.44140242166,-22687.141557960276,-22147.734424063987,-21623.220000732697,-21113.598287966473,-20618.869285765337,-20139.032994129233,-19674.089413058166,-19224.038542552189,-18788.880382611242,-18368.614933235342,-17963.242194424482,-17572.762166178742,-17197.174848497994,-16836.480241382305,-16490.678344831682,-16159.769158846122,-15843.752683425584,-15542.62891857013,-15256.397864279697,-14985.059520554345,-14728.613887394033,-14487.060964798786,-14260.400752768577,-14048.633251303429,-13851.758460403329,-13669.776380068275,-13502.687010298279,-13350.490351093345,-13213.186402453492,-13090.775164378647,-12983.256636868862,-12890.63081992413,-12812.897713544469,-12750.057317729828,-12702.109632480271,-12669.05465779577,-12650.892393676295,-12647.622840121876,-12659.245997132533,-12685.76186470824,-12727.170442848988,-12783.471731554775,-12854.665730825636,-12940.752440661539,-13041.73186106251,-13157.603992028538,-13288.368833559587,-13434.026385655718,-13594.576648316886,-13770.019621543113,-13960.355305334389,-14165.583699690711,-14385.704804612111,-14620.718620098545,-14870.625146150047,-15135.424382766589,-15415.116329948192,-15709.700987694821,-16019.178356006538,-16343.54843488328],[-55581.664037372109,-54454.821244598097,-53342.871162389209,-52245.813790745233,-51163.649129666381,-50096.377179152601,-49043.997939203866,-48006.511409820181,-46983.917591001547,-45976.216482748001,-44983.408085059469,-44005.492397935952,-43042.469421377544,-42094.339155384216,-41161.101599955902,-40242.756755092574,-39339.304620794464,-38450.745197061238,-37577.07848389318,-36718.304481290143,-35874.42318925212,-35045.434607779185,-34231.338736871287,-33432.135576528432,-32647.825126750671,-31878.407387537969,-31123.882358890274,-30384.250040807638,-29659.510433290037,-28949.663536337554,-28254.709349950092,-27574.647874127666,-26909.479108870313,-26259.203054178033,-25623.819710050768,-25003.329076488546,-24397.731153491433,-23807.025941059328,-23231.213439192274,-22670.293647890277,-22124.26656715331,-21593.132196981453,-21076.890537374653,-20575.541588332839,-20089.085349856148,-19617.521821944465,-19160.851004597847,-18719.072897816302,-18292.187501599794,-17880.194815948314,-17483.094840861915,-17100.887576340559,-16733.573022384255,-16381.151178992999,-16043.622046166802,-15720.985623905673,-15413.241912209591,-15120.390911078535,-14842.432620512556,-14579.367040511637,-14331.19417107574,-14097.914012204923,-13879.526563899153,-13676.031826158438,-13487.429798982779,-13313.720482372149,-13154.903876326594,-13010.979980846096,-12881.948795930646,-12767.810321580237,-12668.564557794907,-12584.211504574596,-12514.751161919365,-12460.183529829177,-12420.508608304024,-12395.726397343962,-12385.836896948918,-12390.840107118947,-12410.736027854022,-12445.524659154145,-12495.206001019338,-12559.780053449569,-12639.246816444858,-12733.606290005202,-12842.858474130604,-12967.003368821044,-13106.040974076546,-13259.971289897085,-13428.7943162827,-13612.510053233371,-13811.118500749048,-14024.619658829826,-14253.013527475669,-14496.300106686538,-14754.479396462435,-15027.551396803414,-15315.516107709451,-15618.373529180535,-15936.123661216692,-16268.766503817858],[-54697.795852959796,-53579.225823910281,-52475.548505425708,-51386.763897506316,-50312.872000151903,-49253.872813362585,-48209.766337138208,-47180.552571478969,-46166.231516384782,-45166.803171855667,-44182.267537891545,-43212.624614492459,-42257.874401658511,-41318.016899389542,-40393.052107685682,-39482.980026546844,-38587.800655973071,-37707.513995964357,-36842.120046520686,-35991.618807642073,-35156.01027932849,-34335.294461579986,-33529.471354396512,-32738.540957778154,-31962.50327172481,-31201.358296236496,-30455.106031313218,-29723.746476955042,-29007.27963316191,-28305.705499933843,-27619.02407727082,-26947.235365172826,-26290.339363639891,-25648.336072672035,-25021.225492269201,-24409.007622431396,-23811.682463158686,-23229.250014451063,-22661.710276308397,-22109.063248730869,-21571.308931718333,-21048.447325270914,-20540.478429388546,-20047.402244071171,-19569.218769318883,-19105.928005131656,-18657.529951509419,-18224.024608452328,-17805.411975960233,-17401.692054033207,-17012.864842671243,-16638.930341874322,-16279.888551642442,-15935.739471975647,-15606.483102873854,-15292.119444337155,-14992.648496365502,-14708.070258958893,-14438.384732117347,-14183.591915840831,-13943.691810129409,-13718.684414983001,-13508.569730401676,-13313.347756385381,-13133.018492934159,-12967.581940047969,-12817.038097726829,-12681.386965970771,-12560.628544779742,-12454.76283415378,-12363.789834092851,-12287.709544596997,-12226.521965666176,-12180.227097300434,-12148.824939499726,-12132.315492264079,-12130.698755593465,-12143.974729487933,-12172.143413947433,-12215.204808971994,-12273.158914561604,-12346.005730716268,-12433.745257435996,-12536.37749472076,-12653.902442570588,-12786.320100985478,-12933.630469965403,-13095.83354951038,-13272.92933962043,-13464.917840295526,-13671.799051535654,-13893.572973340864,-14130.239605711091,-14381.798948646399,-14648.251002146764,-14929.595766212158,-15225.833240842619,-15536.963426038132,-15862.986321798715,-16203.901928124313],[-53823.845023919486,-52713.547758594294,-51618.143203834203,-50537.631359639177,-49472.012226009232,-48421.285802944309,-47385.452090444451,-46364.511088509615,-45358.462797139844,-44367.30721633511,-43391.044346095405,-42429.674186420867,-41483.1967373113,-40551.611998766799,-39634.919970787334,-38733.120653372956,-37846.214046523601,-36974.200150239267,-36117.078964520064,-35274.850489365868,-34447.514724776745,-33635.071670752688,-32837.521327293667,-32054.86369439969,-31287.098772070778,-30534.226560306881,-29796.2470591081,-29073.160268474356,-28364.966188405633,-27671.664818901969,-26993.256159963355,-26329.7402115898,-25681.116973781289,-25047.386446537843,-24428.548629859477,-23824.603523746155,-23235.551128197883,-22661.391443214605,-22102.124468796472,-21557.750204943324,-21028.268651655231,-20513.679808932218,-20013.983676774274,-19529.180255181374,-19059.269544153496,-18604.251543690705,-18164.126253792929,-17738.893674460236,-17328.553805692576,-16933.106647489985,-16552.552199852442,-16186.890462779955,-15836.121436272493,-15500.245120330139,-15179.261514952786,-14873.170620140516,-14581.972435893282,-14305.666962211115,-14044.25419909401,-13797.734146541929,-13566.106804554911,-13349.372173132961,-13147.530252276061,-12960.581041984206,-12788.524542257403,-12631.36075309564,-12489.089674498946,-12361.711306467301,-12249.225649000702,-12151.632702099183,-12068.932465762686,-12001.124939991256,-11948.210124784891,-11910.188020143574,-11887.058626067295,-11878.821942556076,-11885.477969609912,-11907.026707228801,-11943.468155412711,-11994.802314161734,-12061.029183475754,-12142.148763354864,-12238.161053799027,-12349.066054808231,-12474.863766382488,-12615.554188521786,-12771.137321226151,-12941.613164495579,-13126.981718330051,-13327.242982729565,-13542.396957694129,-13772.44364322376,-14017.383039318449,-14277.21514597818,-14551.939963202956,-14841.557490992807,-15146.067729347691,-15465.470678267646,-15799.766337752657,-16148.954707802697],[-52959.811550250983,-51857.787048650294,-50770.65525761465,-49698.416177144063,-48641.069807238477,-47598.616147898036,-46571.055199122558,-45558.386960912154,-44560.611433266837,-43577.72861618652,-42609.738509671355,-41656.641113721184,-40718.436428336012,-39795.124453515993,-38886.705189260967,-37993.178635570963,-37114.54479244606,-36250.803659886165,-35401.955237891401,-34567.999526461652,-33748.936525596939,-32944.766235297306,-32155.488655562716,-31381.103786393163,-30621.611627788683,-29877.012179749217,-29147.30544227489,-28432.491415365534,-27732.570099021228,-27047.541493242024,-26377.405598027864,-25722.162413378734,-25081.811939294683,-24456.354175775639,-23845.789122821705,-23250.116780432778,-22669.337148608938,-22103.450227350128,-21552.45601665639,-21016.354516527706,-20495.145726964052,-19988.829647965478,-19497.406279531948,-19020.875621663457,-18559.237674360062,-18112.492437621648,-17680.639911448321,-17263.680095840071,-16861.61299079685,-16474.438596318665,-16102.156912405548,-15744.767939057509,-15402.271676274515,-15074.668124056545,-14761.957282403653,-14464.139151315816,-14181.213730793013,-13913.181020835264,-13660.041021442592,-13421.793732614928,-13198.439154352365,-12989.97728665483,-12796.408129522348,-12617.731682954935,-12453.947946952569,-12305.056921515237,-12171.058606642979,-12051.953002335787,-11947.740108593611,-11858.4199254165,-11783.992452804452,-11724.457690757452,-11679.815639275497,-11650.066298358595,-11635.209668006763,-11635.245748219995,-11650.174538998252,-11679.996040341597,-11724.710252249934,-11784.31717472335,-11858.816807761859,-11948.209151365358,-12052.494205533956,-12171.671970267591,-12305.742445566266,-12454.705631430013,-12618.561527858805,-12797.310134852665,-12990.951452411566,-13199.485480535523,-13422.91221922454,-13661.231668478587,-13914.443828297686,-14182.54869868186,-14465.546279631082,-14763.436571145352,-15076.219573224667,-15403.89528586905,-15746.463709078495,-16103.924842852966],[-52105.695431954438,-51011.943694078109,-49933.084666766947,-48869.118350020763,-47820.04474383963,-46785.863848223591,-45766.575663172596,-44762.180188686631,-43772.677424765679,-42798.067371409859,-41838.350028619046,-40893.525396393357,-39963.593474732639,-39048.554263636994,-38148.407763106443,-37263.153973140914,-36392.792893740392,-35537.324524904914,-34696.748866634553,-33871.065918929242,-33060.275681788968,-32264.378155213781,-31483.37333920363,-30717.261233758523,-29966.041838878453,-29229.715154563455,-28508.281180813494,-27801.739917628583,-27110.091365008746,-26433.335522953967,-25771.472391464224,-25124.501970539517,-24492.424260179905,-23875.23926038533,-23272.946971155783,-22685.547392491309,-22113.040524391894,-21555.426366857559,-21012.704919888227,-20484.876183483939,-19971.940157644753,-19473.896842370603,-18990.746237661486,-18522.488343517442,-18069.123159938448,-17630.650686924513,-17207.070924475604,-16798.383872591796,-16404.589531272974,-16025.687900519248,-15661.678980330567,-15312.562770706951,-14978.339271648381,-14659.00848315485,-14354.570405226385,-14065.025037862972,-13790.372381064601,-13530.612434831299,-13285.745199163048,-13055.770674059848,-12840.688859521691,-12640.49975554859,-12455.203362140561,-12284.799679297565,-12129.28870701961,-11988.67044530674,-11862.944894158929,-11752.112053576122,-11656.171923558381,-11575.124504105719,-11508.969795218072,-11457.707796895531,-11421.338509138022,-11399.861931945561,-11393.278065318133,-11401.586909255773,-11424.788463758498,-11462.882728826238,-11515.869704459026,-11583.749390656874,-11666.521787419793,-11764.186894747758,-11876.744712640788,-12004.195241098849,-12146.538480121962,-12303.774429710138,-12475.903089863366,-12662.924460581657,-12864.838541864976,-13081.645333713384,-13313.344836126798,-13559.937049105301,-13821.421972648845,-14097.799606757437,-14389.069951431085,-14695.233006669801,-15016.288772473523,-15352.237248842368,-15703.07843577622,-16068.812333275122],[-51261.496669029781,-50176.017694877926,-49105.431431291137,-48049.737878269392,-47008.937035812698,-45983.028903921077,-44972.01348259447,-43975.890771832957,-42994.660771636503,-42028.3234820051,-41076.878902938726,-40140.327034437381,-39218.667876501175,-38311.901429130019,-37420.027692323827,-36543.046666082664,-35680.958350406676,-34833.762745295666,-34001.459850749699,-33184.049666768813,-32381.532193352992,-31593.90743050223,-30821.175378216481,-30063.336036495777,-29320.38940534016,-28592.335484749616,-27879.174274724108,-27180.9057752636,-26497.529986368208,-25829.046908037853,-25175.456540272557,-24536.758883072267,-23912.953936437079,-23304.041700366928,-22710.022174861813,-22130.895359921778,-21566.661255546824,-21017.31986173684,-20482.871178492001,-19963.315205812141,-19458.651943697343,-18968.881392147658,-18494.003551162983,-18034.018420743341,-17588.926000888809,-17158.726291599258,-16743.419292874813,-16343.005004715407,-15957.483427121044,-15586.854560091737,-15231.118403627506,-14890.274957728301,-14564.32422239418,-14253.26619762508,-13957.100883421059,-13675.828279782067,-13409.448386708131,-13157.961204199237,-12921.366732255439,-12699.664970876656,-12492.855920062924,-12300.939579814265,-12123.915950130675,-11961.78503101209,-11814.54682245858,-11682.201324470145,-11564.748537046718,-11462.188460188383,-11374.521093895099,-11301.746438166858,-11243.864493003657,-11200.875258405498,-11172.778734372423,-11159.574920904408,-11161.263818001433,-11177.845425663501,-11209.319743890625,-11255.68677268282,-11316.946512040053,-11393.098961962343,-11484.144122449696,-11590.081993502066,-11710.912575119517,-11846.635867302008,-11997.25187004956,-12162.760583362166,-12343.162007239838,-12538.456141682551,-12748.642986690318,-12973.722542263144,-13213.694808401006,-13468.55978510392,-13738.317472371888,-14022.967870204937,-14322.510978602999,-14636.946797566143,-14966.27532709431,-15310.496567187562,-15669.610517845875,-16043.617179069197],[-50427.215261477002,-49350.009051049572,-48287.695551187222,-47240.274761889901,-46207.746683157668,-45190.111314990456,-44187.368657388361,-43199.518710351258,-42226.561473879163,-41268.496947972177,-40325.325132630256,-39397.046027853386,-38483.659633641575,-37585.165949994778,-36701.564976913054,-35832.856714396366,-34979.041162444759,-34140.118321058188,-33316.08819023666,-32506.950769980256,-31712.706060288867,-30933.354061162427,-30168.89477260119,-29419.328194604917,-28684.654327173768,-27964.873170307619,-27259.984724006514,-26569.988988270481,-25894.885963099514,-25234.675648493561,-24589.358044452696,-23958.933150976874,-23343.400968066082,-22742.761495720406,-22157.014733939715,-21586.160682724098,-21030.199342073556,-20489.130711988044,-19962.954792467608,-19451.671583512216,-18955.281085121882,-18473.783297296566,-18007.178220036338,-17555.465853341128,-17118.646197211026,-16696.719251645925,-16289.685016645897,-15897.543492210918,-15520.294678341004,-15157.938575036142,-14810.475182296299,-14477.904500121549,-14160.226528511846,-13857.441267467204,-13569.548716987578,-13296.548877073026,-13038.441747723542,-12795.227328939071,-12566.905620719699,-12353.476623065355,-12154.940335976051,-11971.29675945182,-11802.545893492639,-11648.687738098522,-11509.722293269428,-11385.649559005426,-11276.469535306453,-11182.182222172529,-11102.787619603663,-11038.285727599865,-10988.676546161116,-10953.960075287396,-10934.136314978761,-10929.205265235138,-10939.166926056601,-10964.021297443111,-11003.768379394682,-11058.408171911289,-11127.940674992948,-11212.365888639668,-11311.683812851432,-11425.894447628256,-11554.997792970158,-11698.99384887708,-11857.882615349063,-12031.664092386105,-12220.338279988198,-12423.905178155335,-12642.36478688753,-12875.717106184766,-13123.962136047065,-13387.099876474434,-13665.130327466837,-13958.053489024296,-14265.869361146806,-14588.577943834372,-14926.179237086977,-15278.673240904676,-15646.059955287405,-16028.339380235173],[-49602.851209296139,-48533.917762593155,-47479.877026455273,-46440.729000882369,-45416.473685874545,-44407.11108143178,-43412.641187554051,-42433.064004241431,-41468.379531493782,-40518.587769311249,-39583.688717693723,-38663.6823766413,-37758.568746153913,-36868.347826231548,-35993.019616874284,-35132.584118082043,-34287.041329854794,-33456.391252192712,-32640.633885095594,-31839.769228563615,-31053.797282596621,-30282.718047194699,-29526.531522357815,-28785.237708086031,-28058.836604379248,-27347.328211237538,-26650.712528660893,-25968.989556649292,-25302.159295202757,-24650.221744321243,-24013.176904004795,-23391.02477425339,-22783.765355067073,-22191.398646445792,-21613.924648389555,-21051.343360898347,-20503.65478397227,-19970.858917611156,-19452.955761815159,-18949.945316584184,-18461.82758191826,-17988.602557817427,-17530.270244281615,-17086.830641310844,-16658.283748905149,-16244.629567064492,-15845.868095788885,-15461.999335078368,-15093.023284932868,-14738.939945352433,-14399.749316337036,-14075.45139788672,-13766.046190001434,-13471.533692681216,-13191.913905926043,-12927.186829735911,-12677.352464110849,-12442.410809050813,-12222.361864555893,-12017.205630625951,-11826.942107261108,-11651.571294461313,-11491.093192226559,-11345.507800556843,-11214.815119452218,-11099.015148912615,-10998.107888938081,-10912.093339528608,-10840.971500684158,-10784.742372404773,-10743.405954690457,-10716.962247541178,-10705.411250956964,-10708.752964937798,-10726.987389483693,-10760.114524594628,-10808.134370270629,-10871.046926511674,-10948.852193317758,-11041.550170688912,-11149.140858625116,-11271.624257126372,-11409.000366192682,-11561.269185824043,-11728.430716020466,-11910.484956781922,-12107.431908108461,-12319.27157000003,-12546.003942456635,-12787.629025478327,-13044.146819065067,-13315.557323216859,-13601.860537933713,-13903.056463215569,-14219.145099062529,-14550.126445474527,-14896.000502451572,-15256.767269993672,-15632.426748100826,-16022.97893677303],[-48788.404512487119,-47727.743829508589,-46681.975857095073,-45651.100595246688,-44635.118043963303,-43634.028203244976,-42647.831073091707,-41676.526653503395,-40720.114944480243,-39778.595946022135,-38851.969658129077,-37940.236080800991,-37043.395214038086,-36161.447057840174,-35294.391612207321,-34442.228877139532,-33604.95885263673,-32782.581538699036,-31975.096935326394,-31182.505042518795,-30404.805860276269,-29641.999388598793,-28894.085627486325,-28161.064576938945,-27442.936236956615,-26739.70060753938,-26051.357688687152,-25377.907480399976,-24719.34998267785,-24075.685195520789,-23446.913118928773,-22833.033752901814,-22234.0470974399,-21649.953152543072,-21080.751918211237,-20526.44339444453,-19987.02758124283,-19462.504478606144,-18952.874086534583,-18458.136405028054,-17978.291434086561,-17513.339173710134,-17063.279623898758,-16628.11278465244,-16207.838655971169,-15802.457237854946,-15411.968530303777,-15036.372533317672,-14675.669246896605,-14329.858671040594,-13998.940805749651,-13682.915651023737,-13381.783206862907,-13095.543473267126,-12824.196450236363,-12567.74213777068,-12326.180535870053,-12099.511644534459,-11887.735463763942,-11690.851993558463,-11508.861233918042,-11341.763184842657,-11189.557846332345,-11052.245218387086,-10929.825301006875,-10822.298094191712,-10729.663597941602,-10651.921812256543,-10589.072737136545,-10541.116372581593,-10508.052718591707,-10489.881775166872,-10486.603542307073,-10498.218020012348,-10524.725208282664,-10566.125107118034,-10622.417716518474,-10693.603036483937,-10779.681067014459,-10880.651808110051,-10996.515259770695,-11127.271421996375,-11272.920294787111,-11433.461878142905,-11608.896172063753,-11799.223176549662,-12004.442891600611,-12224.555317216616,-12459.560453397677,-12709.458300143786,-12974.248857454955,-13253.932125331168,-13548.508103772438,-13857.976792778758,-14182.338192350138,-14521.592302486562,-14875.739123188041,-15244.778654454587,-15628.710896286178,-16027.535848682804],[-47983.875171050175,-46931.487251796003,-45893.99204310702,-44871.389544982965,-43863.679757423946,-42870.86268043008,-41892.938314001229,-40929.906658137392,-39981.767712838679,-39048.521478104951,-38130.167953936354,-37226.70714033275,-36338.139037294204,-35464.463644820695,-34605.680962912324,-33761.790991568967,-32932.79373079064,-32118.689180577327,-31319.477340929137,-30535.15821184597,-29765.731793327839,-29011.198085374832,-28271.557087986825,-27546.808801163868,-26836.953224905948,-26141.990359213123,-25461.920204085334,-24796.742759522582,-24146.458025524895,-23511.066002092259,-22890.566689224695,-22284.960086922161,-21694.246195184671,-21118.425014012275,-20557.496543404894,-20011.460783362563,-19480.317733885298,-18964.067394973106,-18462.709766625936,-17976.244848843839,-17504.672641626781,-17047.993144974756,-16606.206358887837,-16179.312283365942,-15767.310918409101,-15370.202264017325,-14987.986320190583,-14620.663086928902,-14268.232564232296,-13930.6947521007,-13608.049650534196,-13300.297259532728,-13007.437579096313,-12729.47060922494,-12466.396349918639,-12218.214801177379,-11984.925963001167,-11766.529835390013,-11563.02641834393,-11374.415711862874,-11200.697715946873,-11041.872430595937,-10897.939855810053,-10768.899991589222,-10654.752837933453,-10555.498394842711,-10471.136662317047,-10401.667640356422,-10347.091328960842,-10307.407728130345,-10282.616837864862,-10272.71865816448,-10277.713189029102,-10297.600430458802,-10332.38038245355,-10382.053045013359,-10446.6184181382,-10526.076501828109,-10620.427296083066,-10729.670800903095,-10853.80701628817,-10992.835942238278,-11146.757578753452,-11315.571925833694,-11499.278983478955,-11697.878751689273,-11911.371230464669,-12139.756419805122,-12383.034319710587,-12641.204930181146,-12914.268251216741,-13202.224282817391,-13505.073024983099,-13822.814477713837,-14155.448641009654,-14502.975514870523,-14865.395099296426,-15242.707394287385,-15634.912399843424,-16042.010115964476],[-47189.263184984949,-46145.148029455238,-45115.925584490615,-44101.595850091049,-43102.158826256513,-42117.614512987057,-41147.9629102826,-40193.204018143297,-39253.33783656895,-38328.364365559682,-37418.283605115452,-36523.095555236323,-35642.800215922245,-34777.397587173138,-33926.887668989206,-33091.270461370223,-32270.545964316378,-31464.714177827547,-30673.775101903688,-29897.728736544988,-29136.575081751304,-28390.314137522713,-27658.945903859145,-26942.470380760591,-26240.88756822711,-25554.197466258724,-24882.400074855359,-24225.495394017067,-23583.483423743826,-22956.364164035629,-22344.137614892446,-21746.803776314337,-21164.362648301307,-20596.814230853321,-20044.158523970371,-19506.395527652494,-18983.525241899675,-18475.547666711878,-17982.462802089154,-17504.270648031474,-17040.971204538873,-16592.564471611309,-16159.050449248794,-15740.429137451347,-15336.700536218943,-14947.864645551583,-14573.921465449257,-14214.87099591203,-13870.713236939839,-13541.4481885327,-13227.075850690593,-12927.596223413553,-12643.009306701571,-12373.31510055465,-12118.513604972755,-11878.604819955957,-11653.588745504181,-11443.465381617454,-11248.2347282958,-11067.896785539167,-10902.451553347626,-10751.899031721106,-10616.239220659638,-10495.472120163256,-10389.597730231912,-10298.616050865605,-10222.527082064364,-10161.330823828177,-10115.027276157034,-10083.616439050953,-10067.098312509928,-10065.472896533945,-10078.740191123015,-10106.900196277133,-10149.952911996334,-10207.898338280558,-10280.736475129848,-10368.467322544182,-10471.090880523585,-10588.60714906803,-10721.016128177527,-10868.317817852087,-11030.51221809169,-11207.599328896351,-11399.579150266043,-11606.451682200804,-11828.216924700635,-12064.874877765502,-12316.425541395427,-12582.868915590414,-12864.20500035043,-13160.433795675503,-13471.555301565644,-13797.569518020839,-14138.476445041062,-14494.276082626357,-14864.968430776715,-15250.553489492107,-15651.031258772568,-16066.401738618066],[-46404.56855429164,-45368.726162486419,-44347.776481246197,-43341.71951057102,-42350.555250460937,-41374.283700915948,-40412.904861935967,-39466.418733521023,-38534.825315671107,-37618.124608386279,-36716.316611666523,-35829.401325511812,-34957.378749922093,-34100.248884897475,-33258.01173043796,-32430.667286543438,-31618.215553213966,-30820.656530449567,-30037.990218250226,-29270.216616615915,-28517.335725546691,-27779.347545042488,-27056.252075103315,-26348.049315729244,-25654.739266920231,-24976.321928676218,-24312.797300997299,-23664.165383883439,-23030.426177334593,-22411.579681350871,-21807.625895932142,-21218.564821078464,-20644.39645678984,-20085.120803066307,-19540.737859907771,-19011.247627314333,-18496.650105285924,-17996.945293822599,-17512.133192924302,-17042.213802591046,-16587.187122822877,-16147.05315361974,-15721.81189498166,-15311.463346908633,-14916.007509400652,-14535.444382457737,-14169.773966079847,-13818.996260267044,-13483.11126501929,-13162.118980336569,-12856.019406218906,-12564.812542666325,-12288.498389678753,-12027.076947256264,-11780.548215398823,-11548.912194106415,-11332.168883379081,-11130.318283216788,-10943.36039361955,-10771.295214587379,-10614.122746120236,-10471.84298821817,-10344.455940881144,-10231.961604109176,-10134.359977902259,-10051.651062260387,-9983.8348571835813,-9930.9113626718263,-9892.8805787251258,-9869.7425053434799,-9861.4971425268723,-9868.1444902753319,-9889.6845485888298,-9926.1173174673895,-9977.4427969110111,-10043.660986919673,-10124.771887493393,-10220.775498632163,-10331.671820335992,-10457.460852604876,-10598.1425954388,-10753.717048837772,-10924.18421280182,-11109.5440873309,-11309.796672425047,-11524.941968084247,-11754.979974308482,-11999.910691097799,-12259.734118452134,-12534.450256371561,-12824.059104856011,-13128.560663905539,-13447.954933520101,-13782.241913699709,-14131.421604444373,-14495.494005754112,-14874.459117628887,-15268.316940068724,-15677.067473073617,-16100.710716643525],[-45629.791278970311,-44602.221650889456,-43589.544733373739,-42591.760526423015,-41608.869030037335,-40640.870244216727,-39687.76416896117,-38749.550804270686,-37826.230150145253,-36917.802206584878,-36024.266973589474,-35145.624451159267,-34281.874639293979,-33433.017537993765,-32599.05314725863,-31779.981467088575,-30975.802497483528,-30186.516238443553,-29412.122689968637,-28652.621852058779,-27908.013724713965,-27178.298307934208,-26463.475601719481,-25763.545606069842,-25078.508320985253,-24408.363746465686,-23753.111882511184,-23112.752729121756,-22487.286286297349,-21876.712554038008,-21281.03153234371,-20700.243221214478,-20134.347620650326,-19583.344730651203,-19047.234551217101,-18526.017082348091,-18019.692324044132,-17528.260276305213,-17051.720939131348,-16590.074312522531,-16143.320396478781,-15711.459191000064,-15294.490696086435,-14892.414911737831,-14505.231837954296,-14132.941474735815,-13775.543822082371,-13433.03887999399,-13105.426648470644,-12792.707127512371,-12494.880317119147,-12211.946217290963,-11943.904828027849,-11690.756149329784,-11452.500181196778,-11229.136923628797,-11020.666376625901,-10827.088540188044,-10648.403414315246,-10484.610999007493,-10335.711294264802,-10201.704300087149,-10082.590016474556,-9978.368443427029,-9889.0395809445308,-9814.6034290271073,-9755.0599876747219,-9710.409256887393,-9680.6512366651259,-9665.7859270079025,-9665.8133279157391,-9680.7334393886231,-9710.5462614265543,-9755.2517940295529,-9814.8500371975952,-9889.3409909306974,-9978.7246552288434,-10083.001030092046,-10202.170115520308,-10336.231911513612,-10485.186418071975,-10649.033635195392,-10827.773562883858,-11021.406201137386,-11229.931549955947,-11453.349609339577,-11691.660379288265,-11944.863859801997,-12212.960050880785,-12495.94895252461,-12793.830564733511,-13106.604887507459,-13434.271920846446,-13776.831664750498,-14134.284119219607,-14506.629284253759,-14893.867159852962,-15295.997746017234,-15713.021042746564,-16144.937050040908],[-44864.931359020818,-43845.634494664417,-42841.230340873131,-41851.718897646817,-40877.100164985575,-39917.374142889457,-38972.540831358288,-38042.6002303922,-37127.552339991234,-36227.397160155248,-35342.134690884304,-34471.764932178492,-33616.287884037694,-32775.703546461911,-31950.011919451252,-31139.213003005578,-30343.306797124962,-29562.293301809419,-28796.172517058927,-28044.944442873486,-27308.609079253096,-26587.166426197793,-25880.616483707534,-25188.959251782311,-24512.194730422118,-23850.322919626989,-23203.343819396941,-22571.25742973193,-21954.063750631991,-21351.762782097052,-20764.354524127197,-20191.838976722414,-19634.216139882643,-19091.486013607966,-18563.648597898304,-18050.703892753721,-17552.65189817419,-17069.492614159702,-16601.226040710266,-16147.852177825922,-15709.371025506578,-15285.782583752312,-14877.086852563107,-14483.283831938934,-14104.373521879832,-13740.355922385761,-13391.231033456761,-13056.99885509279,-12737.659387293907,-12433.212630060059,-12143.658583391265,-11868.997247287527,-11609.228621748831,-11364.352706775197,-11134.369502366622,-10919.279008523083,-10719.081225244612,-10533.776152531176,-10363.363790382813,-10207.844138799483,-10067.217197781225,-9941.4829673280165,-9830.6414474398571,-9734.6926381167468,-9653.6365393587021,-9587.4731511657028,-9536.2024735377418,-9499.8245064748589,-9478.3392499770143,-9471.7467040442243,-9480.0468686764871,-9503.2397438738044,-9541.3253296361763,-9594.3036259635956,-9662.1746328560675,-9744.9383503136014,-9842.5947783361935,-9955.1439169238256,-10082.585766076514,-10224.920325794263,-10382.147596077046,-10554.267576924893,-10741.280268337799,-10943.18567031575,-11159.983782858742,-11391.674605966802,-11638.258139639933,-11899.734383878082,-12176.103338681296,-12467.365004049585,-12773.519379982899,-13094.566466481281,-13430.50626354471,-13781.338771173187,-14147.063989366723,-14527.681918125319,-14923.192557448952,-15333.595907337653,-15758.891967791396,-16199.080738810193],[-44109.988794443321,-43098.964693811315,-42102.833303744446,-41121.594624242622,-40155.248655305833,-39203.795396934009,-38267.234849127366,-37345.567011885723,-36438.791885209117,-35546.909469097613,-34669.919763551123,-33807.822768569662,-32960.618484153318,-32128.306910302024,-31310.888047015738,-30508.361894294503,-29720.728452138334,-28947.987720547222,-28190.139699521162,-27447.184389060181,-26719.121789164208,-26005.951899833315,-25307.674721067473,-24624.290252866667,-23955.798495230949,-23302.199448160223,-22663.493111654614,-22039.679485714063,-21430.758570338527,-20836.730365528041,-20257.59487128261,-19693.352087602245,-19144.002014486916,-18609.544651936671,-18089.979999951458,-17585.308058531285,-17095.5288276762,-16620.642307386152,-16160.648497661152,-15715.547398501205,-15285.339009906324,-14870.023331876479,-14469.600364411683,-14084.070107511956,-13713.432561177253,-13357.687725407644,-13016.835600203061,-12690.876185563546,-12379.809481489068,-12083.635487979665,-11802.354205035295,-11535.965632655985,-11284.469770841737,-11047.866619592525,-10826.156178908372,-10619.338448789274,-10427.413429235228,-10250.381120246242,-10088.241521822296,-9940.9946339634171,-9808.6404566695855,-9691.1789899407959,-9588.6102337770608,-9500.9341881783876,-9428.1508531447726,-9370.2602286762012,-9327.2623147726918,-9299.1571114342205,-9285.9446186608184,-9287.6248364524618,-9304.1977648091506,-9335.6634037309013,-9382.0217532176976,-9443.2728132695593,-9519.4165838864665,-9610.4530650684246,-9716.3822568154392,-9837.2041591274974,-9972.9187720046302,-10123.526095446803,-10289.026129454032,-10469.418874026298,-10664.704329163644,-10874.882494866015,-11099.953371133452,-11339.916957965943,-11594.7732553635,-11864.522263326095,-12149.16398185375,-12448.698410946441,-12763.125550604193,-13092.445400826997,-13436.657961614861,-13795.763232967785,-14169.761214885739,-14558.651907368769,-14962.435310416826,-15381.111424029963,-15814.680248208135,-16263.141782951363],[-43364.963585237638,-42362.212248330099,-41374.353621987633,-40401.387706210218,-39443.314500997833,-38500.134006350519,-37571.846222268236,-36658.451148751068,-35759.948785798908,-34876.339133411791,-34007.622191589748,-33153.797960332733,-32314.866439640828,-31490.827629513929,-30681.681529952053,-29887.428140955308,-29108.067462523584,-28343.59949465689,-27594.024237355239,-26859.341690618676,-26139.551854447163,-25434.654728840695,-24744.650313799306,-24069.538609322946,-23409.319615411638,-22763.99333206538,-22133.559759284159,-21518.01889706801,-20917.37074541692,-20331.615304330888,-19760.75257380987,-19204.78255385394,-18663.705244463068,-18137.520645637236,-17626.22875737647,-17129.82957968074,-16648.323112550064,-16181.709355984434,-15729.98830998389,-15293.15997454838,-14871.224349677907,-14464.181435372508,-14072.03123163214,-13694.77373845685,-13332.408955846595,-12984.936883801403,-12652.35752232125,-12334.670871406164,-12031.876931056137,-11743.975701271136,-11470.967182051218,-11212.851373396341,-10969.62827530651,-10741.29788778174,-10527.860210822018,-10329.315244427358,-10145.66298859774,-9976.9034433331635,-9823.0366086336726,-9684.0624844992089,-9559.9810709298108,-9450.79236792546,-9356.4963754861656,-9277.0930936119221,-9212.5825223027423,-9162.9646615585971,-9128.2395113795137,-9108.4070717654758,-9103.4673427165108,-9113.4203242325784,-9138.2660163137134,-9178.0044189598884,-9232.6355321711198,-9302.1593559474095,-9386.5758902887574,-9485.8851351951471,-9600.0870906665787,-9729.1817567030903,-9873.1691333046365,-10032.049220471225,-10205.822018202904,-10394.487526499604,-10598.045745361373,-10816.496674788203,-11049.840314780065,-11298.076665336983,-11561.205726458951,-11839.227498145978,-12132.141980398064,-12439.949173215216,-12762.649076597394,-13100.241690544619,-13452.727015056929,-13820.105050134269,-14202.375795776657,-14599.539251984106,-15011.595418756622,-15438.544296094178,-15880.385883996774,-16337.120182464445],[-42629.855731403884,-41635.377158220814,-40655.791295602728,-39691.098143549782,-38741.297702061835,-37806.389971138946,-36886.374950781108,-35981.25264098835,-35091.023041760593,-34215.686153097937,-33355.241975000317,-32509.690507467785,-31679.031750500282,-30863.265704097837,-30062.392368260407,-29276.411742988079,-28505.323828280736,-27749.128624138488,-27007.82613056132,-26281.416347549144,-25569.899275102056,-24873.274913220033,-24191.543261903047,-23524.704321151126,-22872.758090964227,-22235.704571342438,-21613.543762285655,-21006.275663793938,-20413.90027586725,-19836.417598505672,-19273.827631709089,-18726.130375477587,-18193.325829811125,-17675.41399470975,-17172.39487017339,-16684.268456202117,-16211.034752795858,-15752.69375995468,-15309.245477678549,-14880.689905967462,-14467.027044821418,-14068.256894240472,-13684.379454224521,-13315.394724773654,-12961.302705887843,-12622.103397567076,-12297.796799811362,-11988.382912620715,-11693.861735995108,-11414.233269934553,-11149.49751443905,-10899.654469508603,-10664.704135143216,-10444.646511342871,-10239.481598107583,-10049.209395437356,-9873.82990333216,-9713.3431217920297,-9567.7490508169649,-9437.0476904069419,-9321.2390405619735,-9220.3231012820452,-9134.2998725671805,-9063.1693544173777,-9006.9315468326131,-8965.5864498129085,-8939.1340633582568,-8927.5743874686486,-8930.9074221441042,-8949.1331673846216,-8982.25162319017,-9030.262789560793,-9093.1666664964541,-9170.9632539971681,-9263.6525520629366,-9371.2345606937633,-9493.7092798896465,-9631.0767096505697,-9783.3368499765566,-9950.4897008675835,-10132.535262323683,-10329.473534344814,-10541.304516931021,-10768.028210082271,-11009.644613798562,-11266.153728079913,-11537.555552926337,-11823.850088337786,-12125.037334314291,-12441.117290855876,-12772.089957962478,-13117.955335634157,-13478.713423870882,-13854.364222672652,-14244.907732039481,-14650.343951971361,-15070.672882468303,-15505.894523530284,-15956.008875157335,-16421.015937349424],[-41904.665232942018,-40918.459423483357,-39947.146324589739,-38990.725936261144,-38049.198258497687,-37122.563291299244,-36210.821034665838,-35313.971488597512,-34432.014653094207,-33564.950528155976,-32712.779113782788,-31875.500409974637,-31053.114416731543,-30245.621134053552,-29453.020561940546,-28675.312700392642,-27912.497549409796,-27164.575108991936,-26431.545379139185,-25713.408359851499,-25010.164051128835,-24321.81245297123,-23648.353565378682,-22989.787388351193,-22346.113921888726,-21717.333165991353,-21103.445120659009,-20504.44978589172,-19920.347161689489,-19351.137248052313,-18796.820044980173,-18257.395552473128,-17732.863770531098,-17223.224699154118,-16728.4783383422,-16248.624688095326,-15783.663748413532,-15333.595519296789,-14898.420000745084,-14478.137192758426,-14072.747095336823,-13682.249708480293,-13306.645032188788,-12945.933066462338,-12600.113811300973,-12269.187266704641,-11953.153432673353,-11652.012309207126,-11365.763896305951,-11094.408193969837,-10837.945202198771,-10596.374920992756,-10369.697350351786,-10157.912490275887,-9961.0203407650297,-9779.0209018192327,-9611.9141734384739,-9459.7001556227697,-9322.3788483721382,-9199.9502516865396,-9092.4143655659864,-8999.7711900105205,-8922.0207250200765,-8859.1629705947125,-8811.1979267343777,-8778.1255934391029,-8759.9459707088863,-8756.6590585437189,-8768.2648569435987,-8794.7633659085441,-8836.1545854385331,-8892.4385155335658,-8963.6151561936695,-9049.6845074188241,-9150.6465692090242,-9266.5013415642825,-9397.2488244846008,-9542.8890179699574,-9703.4219220203595,-9878.8475366358343,-10069.165861816347,-10274.376897561926,-10494.480643872557,-10729.477100748234,-10979.366268188969,-11244.148146194759,-11523.822734765597,-11818.390033901484,-12127.850043602417,-12452.202763868436,-12791.448194699471,-13145.586336095579,-13514.617188056727,-13898.540750582946,-14297.357023674203,-14711.066007330526,-15139.667701551884,-15583.162106338312,-16041.549221689804,-16514.829047606316],[-41189.392089852074,-40211.459044117873,-39248.418708948644,-38300.271084344502,-37367.016170305498,-36448.653966831473,-35545.184473922469,-34656.607691578574,-33782.923619799709,-32924.132258585916,-32080.233607937167,-31251.22766785344,-30437.114438334807,-29637.893919381204,-28853.566110992666,-28084.131013169164,-27329.588625910736,-26589.938949217336,-25865.181983089002,-25155.317727525748,-24460.346182527494,-23780.267348094363,-23115.081224226233,-22464.787810923175,-21829.387108185183,-21208.879116012191,-20603.263834404301,-20012.541263361447,-19436.711402883615,-18875.774252970899,-18329.729813623191,-17798.578084840541,-17282.319066622964,-16780.952758970427,-16294.479161882951,-15822.898275360498,-15366.210099403123,-14924.4146340108,-14497.511879183525,-14085.501834921313,-13688.384501224151,-13306.159878092032,-12938.827965524977,-12586.388763522975,-12248.842272086011,-11926.188491214121,-11618.427420907274,-11325.559061165488,-11047.583411988737,-10784.500473377047,-10536.310245330404,-10303.01272784882,-10084.607920932291,-9881.0958245808251,-9692.4764387943796,-9518.7497635730215,-9359.9157989166997,-9215.9745448254325,-9086.9260012992181,-8972.7701683380619,-8873.5070459419476,-8789.1366341109042,-8719.6589328449045,-8665.073942143943,-8625.3816620080543,-8600.5820924372201,-8590.675233431426,-8595.661084990692,-8615.539647115007,-8650.3109198043749,-8699.9749030588009,-8764.531596878267,-8843.9810012628004,-8938.3231162123902,-9047.5579417270255,-9171.6854778067027,-9310.7057244514472,-9464.6186816612353,-9633.4243494360871,-9817.1227277759826,-10015.713816680942,-10229.197616150937,-10457.574126186,-10700.84334678612,-10959.005277951273,-11232.059919681487,-11520.007271976763,-11822.84733483709,-12140.580108262462,-12473.205592252889,-12820.723786808365,-13183.134691928895,-13560.438307614486,-13952.634633865127,-14359.723670680816,-14781.705418061576,-15218.579876007369,-15670.347044518228,-16137.006923594143,-16618.559513235072],[-40484.036302133973,-39514.376020124204,-38559.608448679472,-37619.733587799747,-36694.751437485167,-35784.661997735595,-34889.465268551023,-34009.161249931523,-33143.749941877089,-32293.231344387728,-31457.605457463389,-30636.872281104137,-29831.031815309907,-29040.084060080742,-28264.029015416636,-27502.866681317566,-26756.597057783605,-26025.220144814593,-25308.735942410705,-24607.144450571883,-23920.445669298075,-23248.63959858934,-22591.726238445655,-21949.705588867007,-21322.577649853447,-20710.342421404923,-20112.999903521439,-19530.550096203027,-18962.992999449656,-18410.328613261336,-17872.556937638103,-17349.677972579884,-16841.691718086709,-16348.598174158611,-15870.397340795564,-15407.089217997544,-14958.673805764616,-14525.151104096716,-14106.521112993863,-13702.783832456083,-13313.939262483347,-12939.987403075675,-12580.928254233057,-12236.761815955462,-11907.488088242941,-11593.107071095475,-11293.61876451305,-11009.023168495703,-10739.320283043387,-10484.510108156128,-10244.592643833921,-10019.567890076778,-9809.4358468846785,-9614.1965142576337,-9433.8498921956361,-9268.3959806986968,-9117.8347797668212,-8982.1662893999764,-8861.3905095981991,-8755.5074403614708,-8664.5170816897935,-8588.419433583178,-8527.2144960416081,-8480.9022690650818,-8449.4827526536228,-8432.9559468072093,-8431.3218515258595,-8444.5804668095589,-8472.7317926583091,-8515.7758290720994,-8573.7125760509516,-8646.5420335948693,-8734.264201703827,-8836.879080377832,-8954.386669616908,-9086.7869694210185,-9234.0799797901927,-9396.2657007244197,-9573.3441322236904,-9765.3152742880284,-9972.1791269174209,-10193.935690111848,-10430.584963871343,-10682.126948195886,-10948.561643085475,-11229.889048540132,-11526.10916455983,-11837.221991144583,-12163.227528294392,-12504.125776009249,-12859.916734289174,-13230.600403134127,-13616.17678254416,-14016.645872519221,-14432.007673059341,-14862.262184164543,-15307.409405834755,-15767.449338070062,-16242.381980870396,-16732.207334235769],[-39788.597869787875,-38827.210351502494,-37880.715543782208,-36949.113446626892,-36032.404060036759,-35130.587384011626,-34243.663418551485,-33371.632163656381,-32514.4936193264,-31672.247785561514,-30844.894662361614,-30032.434249726757,-29234.866547656959,-28452.19155615224,-27684.409275212558,-26931.519704837927,-26193.522845028376,-25470.418695783817,-24762.207257104346,-24068.888528989941,-23390.46251144055,-22726.92920445629,-22078.288608037015,-21444.540722182821,-20825.685546893688,-20221.72308216957,-19632.653328010529,-19058.47628441656,-18499.191951387584,-17954.800328923739,-17425.301417024886,-16910.695215691114,-16410.981724922385,-15926.160944718698,-15456.232875080081,-15001.197516006521,-14561.054867498007,-14135.804929554544,-13725.44770217614,-13329.98318536278,-12949.411379114479,-12583.732283431233,-12232.945898313024,-11897.052223759887,-11576.051259771793,-11269.94300634876,-10978.727463490766,-10702.404631197835,-10440.974509469979,-10194.437098307146,-9962.7923977093633,-9746.0404076766499,-9544.1811282089784,-9357.2145593063688,-9185.1407009688119,-9027.9595531963005,-8885.6711159888473,-8758.2753893464323,-8645.7723732690829,-8548.1620677567898,-8465.4444728095477,-8397.6195884273566,-8344.6874146102236,-8306.6479513581289,-8283.5011986711015,-8275.2471565491251,-8281.8858249922032,-8303.4172040003268,-8339.8412935735014,-8391.1580937117305,-8457.3676044150252,-8538.4698256833617,-8634.4647575167564,-8745.3523999151985,-8871.1327528786987,-9011.8058164072536,-9167.3715905008521,-9337.8300751595089,-9523.181270383222,-9723.4251761719861,-9938.5617925257975,-10168.591119444667,-10413.51315692858,-10673.327904977567,-10948.035363591589,-11237.635532770677,-11542.128412514805,-11861.51400282398,-12195.792303698221,-12544.963315137513,-12909.027037141852,-13287.983469711258,-13681.83261284571,-14090.574466545206,-14514.209030809759,-14952.736305639379,-15406.156291034047,-15874.468986993756,-16357.674393518535,-16855.772510608338],[-39103.076792813583,-38149.962038252641,-37211.739994256815,-36288.410660825946,-35379.974037960157,-34486.430125659463,-33607.778923923775,-32744.020432753154,-31895.154652147598,-31061.181582107063,-30242.101222631616,-29437.913573721235,-28648.618635375882,-27874.216407595573,-27114.706890380323,-26370.090083730109,-25640.365987644975,-24925.534602124906,-24225.595927169874,-23540.549962779885,-22870.396708954955,-22215.136165695068,-21574.768333000269,-20949.293210870463,-20338.710799305769,-19743.021098306082,-19162.224107871494,-18596.319828001921,-18045.308258697427,-17509.18939995797,-16987.963251783585,-16481.629814174223,-15990.189087129924,-15513.641070650694,-15051.985764736497,-14605.223169387367,-14173.353284603281,-13756.37611038425,-13354.291646730278,-12967.099893641349,-12594.800851117478,-12237.394519158661,-11894.880897764891,-11567.25998693618,-11254.531786672538,-10956.696296973922,-10673.753517840374,-10405.703449271874,-10152.546091268421,-9914.2814438300356,-9690.9095069566902,-9482.4302806484066,-9288.8437649051648,-9110.1499597269903,-8946.3488651138614,-8797.4404810657743,-8663.4248075827527,-8544.3018446647766,-8440.0715923118532,-8350.734050523999,-8276.2892193011903,-8216.7370986434253,-8172.0776885507257,-8142.3109890230726,-8127.4370000604722,-8127.4557216629164,-8142.3671538304279,-8172.1712965629904,-8216.868149860602,-8276.4577137232736,-8350.9399881509817,-8440.3149731437643,-8544.5826687015833,-8663.7430748244587,-8797.7961915123924,-8946.7420187653624,-9110.5805565834089,-9289.3118049664845,-9482.9357639146383,-9691.4524334278321,-9914.8618135060806,-10153.163904149376,-10406.358705357732,-10674.446217131146,-10957.426439469591,-11255.299372373112,-11568.065015841676,-11895.723369875286,-12238.274434473962,-12595.718209637689,-12968.054695366458,-13355.283891660298,-13757.405798519167,-14174.420415943105,-14606.327743932101,-15053.127782486137,-15514.82053160523,-15991.405991289377,-16482.884161538597,-16989.255042352837],[-38427.473071211229,-37482.631080374755,-36552.68180010331,-35637.625230396872,-34737.461371255522,-33852.190222679237,-32981.81178466804,-32126.326057221791,-31285.733040340667,-30460.0327340246,-29649.225138273556,-28853.310253087599,-28072.288078466678,-27306.15861441083,-26554.921860919982,-25818.577817994243,-25097.126485633555,-24390.567863837859,-23698.901952607281,-23022.128751941702,-22360.24826184121,-21713.260482305785,-21081.165413335388,-20463.963054930049,-19861.65340708974,-19274.236469814543,-18701.712243104346,-18144.080726959211,-17601.341921379149,-17073.495826364127,-16560.542441914164,-16062.481768029242,-15579.313804709374,-15111.038551954569,-14657.656009764814,-14219.166178140113,-13795.569057080456,-13386.864646585846,-12993.052946656335,-12614.133957291819,-12250.107678492379,-11900.974110258016,-11566.733252588663,-11247.385105484391,-10942.929668945166,-10653.366942970984,-10378.696927561874,-10118.919622717802,-9874.0350284387823,-9644.0431447248266,-9428.9439715759054,-9228.7375089920606,-9043.4237569732541,-8873.0027155195057,-8717.4743846307992,-8576.8387643071674,-8451.0958545485682,-8340.2456553550364,-8244.288166726541,-8163.2233886631111,-8097.0513211647376,-8045.7719642314005,-8009.3853178631325,-7987.8913820599109,-7981.2901568217458,-7989.5816421486306,-8012.765838040561,-8050.8427444975605,-8103.8123615195982,-8171.6746891066978,-8254.4297272588483,-8352.0774759760498,-8464.6179352583022,-8592.0511051056128,-8734.376985517978,-8891.5955764953942,-9063.7068780378686,-9250.710890145383,-9452.6076128179484,-9669.3970460555793,-9901.0791898582556,-10147.654044225985,-10409.121609158772,-10685.48188465662,-10976.734870719505,-11282.88056734744,-11603.918974540455,-11939.850092298497,-12290.673920621593,-12656.390459509754,-13036.99970896296,-13432.501668981218,-13842.896339564546,-14268.183720712903,-14708.363812426322,-15163.436614704804,-15633.402127548325,-16118.260350956913,-16618.011284930537,-17132.654929469227],[-37761.786704980812,-36825.217477868711,-35903.54096132172,-34996.757155339728,-34104.866059922861,-33227.867675070978,-32365.762000784162,-31518.549037062417,-30686.228783905695,-29868.801241314053,-29066.266409287469,-28278.624287825936,-27505.874876929411,-26748.018176597987,-26005.054186831614,-25276.982907630292,-24563.804338993992,-23865.518480922779,-23182.125333416567,-22513.62489647547,-21860.017170099418,-21221.302154288402,-20597.479849042444,-19988.550254361529,-19394.513370245688,-18815.369196694875,-18251.117733709129,-17701.758981288433,-17167.292939432802,-16647.719608142201,-16143.038987416678,-15653.251077256185,-15178.355877660757,-14718.353388630383,-14273.243610165053,-13843.02654226479,-13427.702184929554,-13027.270538159395,-12641.73160195427,-12271.085376314219,-11915.331861239205,-11574.471056729257,-11248.502962784361,-10937.427579404506,-10641.244906589707,-10359.954944339977,-10093.557692655279,-9842.0531515356488,-9605.4413209810627,-9383.7222009915276,-9176.895791567058,-8984.9620927076303,-8807.9211044132553,-8645.7728266839367,-8498.5172595196691,-8366.1544029204615,-8248.6842568862976,-8146.1068214171937,-8058.4220965131426,-7985.6300821741424,-7927.7307784001878,-7884.724185191295,-7856.610302547454,-7843.3891304686604,-7845.0606689549313,-7861.6249180062259,-7893.0818776226151,-7939.4315478040335,-8000.6739285505064,-8076.8090198620393,-8167.8368217386214,-8273.7573341802472,-8394.5705571869385,-8530.2764907586825,-8680.875134895472,-8846.3664895973161,-9026.7505548642293,-9222.0273306961735,-9432.1968170931759,-9657.2590140552256,-9897.2139215823445,-10152.061539674505,-10421.801868331717,-10706.434907553994,-11005.960657341311,-11320.379117693697,-11649.69028861112,-11993.894170093594,-12352.990762141128,-12726.980064753729,-13115.862077931348,-13519.636801674051,-13938.304235981803,-14371.864380854597,-14820.317236292452,-15283.662802295352,-15761.9010788633,-16255.032065996329,-16763.055763694385,-17285.972171957503],[-37106.017694122223,-36177.721230734598,-35264.317477911987,-34365.806435654486,-33482.188103961962,-32613.462482834577,-31759.629572272184,-30920.689372274894,-30096.641882842581,-29287.487103975393,-28493.225035673182,-27713.855677936088,-26949.37903076403,-26199.795094157038,-25465.103868115097,-24745.305352638185,-24040.399547726323,-23350.386453379535,-22675.266069597812,-22015.038396381125,-21369.703433729483,-20739.261181642891,-20123.711640121386,-19523.054809164896,-18937.290688773479,-18366.419278947109,-17810.440579685797,-17269.354590989533,-16743.161312858327,-16231.860745292181,-15735.452888291045,-15253.937741854999,-14787.315305984008,-14335.585580678064,-13898.74856593717,-13476.804261761334,-13069.752668150544,-12677.5937851048,-12300.327612624127,-11937.954150708494,-11590.473399357921,-11257.885358572394,-10940.190028351928,-10637.387408696501,-10349.477499606146,-10076.460301080833,-9818.3358131205787,-9575.1040357253805,-9346.7649688952224,-9133.3186126301225,-8934.7649669300772,-8751.1040317950865,-8582.335807225154,-8428.4602932202688,-8289.4774897804327,-8165.3873969056494,-8056.1900145959171,-7961.8853428512393,-7882.4733816716252,-7817.9541310570467,-7768.3275910075281,-7733.5937615230705,-7713.7526426036657,-7708.8042342493027,-7718.7485364599925,-7743.5855492357441,-7783.3152725765431,-7837.9377064824048,-7907.4528509533156,-7991.8607059892656,-8091.1612715902775,-8205.3545477563493,-8334.4405344874594,-8478.4192317836423,-8637.2906396448725,-8811.0547580711391,-8999.711587062473,-9203.261126618856,-9421.7033767402972,-9655.038337426784,-9903.2660086783235,-10166.38639049491,-10444.399482876568,-10737.305285823277,-11045.10379933502,-11367.795023411829,-11705.378958053689,-12057.855603260612,-12425.224959032575,-12807.487025369603,-13204.641802271661,-13616.689289738793,-14043.629487770968,-14485.462396368193,-14942.188015530472,-15413.806345257812,-15900.317385550203,-16401.721136407643,-16918.017597830141,-17449.206769817691],[-36460.166038635602,-35540.142338972386,-34635.01134987425,-33744.773071341129,-32869.427503373081,-32008.974645970105,-31163.414499132145,-30332.747062859256,-29516.972337151426,-28716.090322008597,-27930.101017430905,-27159.004423418213,-26402.80053997058,-25661.489367088019,-24935.070904770502,-24223.545153018014,-23526.912111830628,-22845.17178120825,-22178.324161150929,-21526.369251658682,-20889.307052731499,-20267.137564369339,-19659.860786572248,-19067.476719340182,-18489.985362673207,-17927.386716571251,-17379.680781034396,-16846.867556062571,-16328.947041655778,-15825.919237814051,-15337.784144537363,-14864.541761825752,-14406.192089679189,-13962.735128097671,-13534.1708770812,-13120.499336629789,-12721.72050674343,-12337.834387422137,-11968.84097866589,-11614.740280474689,-11275.532292848558,-10951.217015787461,-10641.794449291425,-10347.264593360433,-10067.62744799451,-9802.8830131936193,-9553.0312889577981,-9318.0722752870333,-9098.005972181305,-8892.8323796406276,-8702.5514976650247,-8527.1633262544638,-8366.6678654089501,-8221.0651151284947,-8090.355075413092,-7974.5377462627457,-7873.6131276774495,-7787.5812196572033,-7716.4420222020162,-7660.195535311871,-7618.8417589867922,-7592.3806932267562,-7580.8123380317757,-7584.1366934018497,-7602.3537593369838,-7635.4635358371634,-7683.4660229023903,-7746.361220532679,-7824.149128728016,-7916.8297474884112,-8024.4030768138455,-8146.8691167043453,-8284.2278671599051,-8436.4793281805087,-8603.6234997661595,-8785.6603819168595,-8982.589974632634,-9194.4122779134486,-9421.1272917593142,-9662.7350161702343,-9919.2354511462145,-10190.628596687235,-10476.914452793317,-10778.093019464453,-11094.164296700628,-11425.128284501881,-11770.984982868162,-12131.734391799506,-12507.376511295908,-12897.911341357356,-13303.33888198386,-13723.659133175419,-14158.872094932023,-14608.977767253689,-15073.976150140403,-15553.867243592174,-16048.651047608997,-16558.327562190869,-17082.896787337799,-17622.35872304978],[-35824.231738520852,-34912.480802582089,-34015.62257720832,-33133.657062399667,-32266.584258156072,-31414.404164477477,-30577.116781363977,-29754.722108815513,-28947.220146832136,-28154.610895413782,-27376.894354560456,-26614.070524272203,-25866.139404549023,-25133.100995390843,-24414.955296797787,-23711.702308769731,-23023.342031306769,-22349.874464408815,-21691.299608075955,-21047.617462308128,-20418.828027105355,-19804.931302467641,-19205.927288394993,-18621.815984887337,-18052.597391944815,-17498.271509567297,-16958.838337754845,-16434.297876507451,-15924.650125825108,-15429.895085707805,-14950.032756155564,-14485.063137168379,-14034.986228746227,-13599.802030889156,-13179.510543597115,-12774.111766870139,-12383.605700708236,-12007.992345111355,-11647.271700079546,-11301.443765612767,-10970.508541711053,-10654.466028374405,-10353.316225602788,-10067.059133396238,-9795.6947517547451,-9539.2230806782918,-9297.6441201668986,-9070.9578702205617,-8859.164330839274,-8662.2635020230355,-8480.255383771846,-8313.1399760857203,-8160.9172789646473,-8023.5872924086198,-7901.1500164176468,-7793.6054509917294,-7700.9535961308693,-7623.1944518350501,-7560.3280181042974,-7512.3542949385919,-7479.2732823379411,-7461.0849803023357,-7457.7893888317903,-7469.3865079262905,-7495.8763375858543,-7537.2588778104673,-7593.5341286001285,-7664.7020899548543,-7750.762761874621,-7851.7161443594414,-7967.5622374093191,-8098.3010410242459,-8243.9325552042355,-8404.456779949267,-8579.8737152593567,-8770.1833611344919,-8975.3857175746907,-9195.4807845799332,-9430.4685621502394,-9680.3490502855893,-9945.1222489859938,-10224.788158251456,-10519.346778081968,-10828.798108477531,-11153.142149438139,-11492.37890096382,-11846.508363054538,-12215.530535710319,-12599.445418931145,-12998.253012717032,-13411.953317067953,-13840.546331983953,-14284.032057464994,-14742.410493511095,-15215.681640122235,-15703.845497298451,-16206.902065039691,-16724.851343345988,-17257.693332217365,-17805.428031653777],[-35198.214793778017,-34294.736621563672,-33406.151159914392,-32532.458408830134,-31673.658368310935,-30829.751038356793,-30000.736418967695,-29186.614510143736,-28387.38531188474,-27603.048824190824,-26833.605047061938,-26079.053980498116,-25339.395624499368,-24614.629979065634,-23904.757044196987,-23209.776819893385,-22529.689306154833,-21864.494502981303,-21214.192410372911,-20578.783028329501,-19958.266356851156,-19352.642395937874,-18761.911145589635,-18186.072605806472,-17625.126776588324,-17079.07365793526,-16547.913249847232,-16031.645552324258,-15530.270565366338,-15043.788288973479,-14572.198723145668,-14115.501867882918,-13673.697723185209,-13246.786289052559,-12834.767565484963,-12437.641552482424,-12055.408250044933,-11688.067658172491,-11335.619776865104,-10998.064606122776,-10675.402145945496,-10367.632396333258,-10074.755357286085,-9796.7710288039634,-9533.6794108868962,-9285.4805035348727,-9052.174306747911,-8833.7608205260094,-8630.2400448691442,-8441.6119797773426,-8267.8766252505884,-8109.0339812888942,-7965.0840478922482,-7836.0268250606596,-7721.8623127941173,-7622.5905110926333,-7538.2114199561984,-7468.7250393848171,-7414.1313693784887,-7374.4304099372148,-7349.6221610609891,-7339.7066227498253,-7344.6837950037097,-7364.5536778226497,-7399.3162712066378,-7448.9715751556796,-7513.5195896697805,-7592.9603147489288,-7687.2937503931271,-7796.5198966023836,-7920.6387533766847,-8059.6503207160549,-8213.5545986204688,-8382.3515870899264,-8566.0412861244549,-8764.6236957240271,-8978.0988158886539,-9206.4666466183226,-9449.7271879130603,-9707.8804397728363,-9980.9264021976815,-10268.865075187576,-10571.69645874251,-10889.420552862517,-11222.037357547561,-11569.546872797669,-11931.949098612815,-12309.244034993029,-12701.431681938288,-13108.5120394486,-13530.485107523962,-13967.350886164377,-14419.109375369851,-14885.760575140384,-15367.304485475956,-15863.741106376587,-16375.07043784228,-16901.292479873002,-17442.40723246881,-17998.414695629639],[-34582.115204407026,-33686.909795917134,-32806.597097992249,-31941.17711063246,-31090.649833837691,-30255.015267608003,-29434.273411943388,-28628.424266843744,-27837.46783230923,-27061.404108339739,-26300.233094935298,-25553.954792095901,-24822.569199821584,-24106.076318112297,-23404.476146968067,-22717.768686388896,-22045.953936374783,-21389.031896925713,-20747.002568041702,-20119.865949722735,-19507.622041968818,-18910.270844779967,-18327.812358156185,-17760.24658209741,-17207.57351660373,-16669.793161675087,-16146.905517311498,-15638.910583512949,-15145.808360279487,-14667.598847611047,-14204.282045507662,-13755.857953969338,-13322.326572996069,-12903.687902587848,-12499.941942744685,-12111.08869346658,-11737.128154753509,-11378.0603266055,-11033.885209022552,-10704.602802004643,-10390.2131055518,-10090.716119664005,-9806.1118443412524,-9536.4002795835659,-9281.5814253909339,-9041.6552817633565,-8816.6218487008155,-8606.4811262033472,-8411.2331142709099,-8230.8778129035418,-8065.4152221012246,-7914.8453418639638,-7779.168172191743,-7658.3837130845814,-7552.4919645424798,-7461.4929265654282,-7385.3865991534167,-7324.1729823064725,-7277.8520760245774,-7246.4238803077351,-7229.8883951559401,-7228.2456205692042,-7241.4955565475202,-7269.6382030908917,-7312.6735601993141,-7370.6016278727884,-7443.4224061113191,-7531.135894914898,-7633.7420942835297,-7751.2410042172141,-7883.6326247159559,-8030.9169557797541,-8193.0939974085923,-8370.1637496024905,-8562.1262123614506,-8768.9813856854435,-8990.7292695745055,-9227.3698640286184,-9478.9031690477786,-9745.3291846319989,-10026.647910781267,-10322.859347495589,-10633.963494774969,-10959.960352619401,-11300.849921028872,-11656.632200003412,-12027.307189542997,-12412.874889647632,-12813.335300317331,-13228.688421552077,-13658.934253351874,-14104.072795716729,-14564.104048646632,-15039.028012141585,-15528.844686201588,-16033.554070826653,-16553.156166016786,-17087.650971771931,-17637.038488092181,-18201.318714977424],[-33975.932970408016,-33089.000325642541,-32216.960391442088,-31359.813167806715,-30517.5586547364,-29690.196852231158,-28877.727760290923,-28080.151378915732,-27297.467708105643,-26529.676747860569,-25776.778498180574,-25038.772959065638,-24315.660130515709,-23607.440012530897,-22914.112605111099,-22235.677908256337,-21572.135921966656,-20923.48664624204,-20289.730081082424,-19670.866226487906,-19066.895082458424,-18477.816648994019,-17903.630926094658,-17344.337913760322,-16799.937611991045,-16270.430020786855,-15755.815140147683,-15256.092970073585,-14771.263510564533,-14301.326761620523,-13846.282723241586,-13406.13139542769,-12980.872778178846,-12570.506871495065,-12175.033675376322,-11794.453189822651,-11428.765414834012,-11077.970350410433,-10742.067996551918,-10421.058353258442,-10114.941420530025,-9823.7171983666667,-9547.3856867683462,-9285.9468857350912,-9039.400795266889,-8807.7474153637359,-8590.986746025641,-8389.1187872525898,-8202.1435390446022,-8030.0610014016584,-7872.8711743237654,-7730.5740578109335,-7603.169651863147,-7490.657956480426,-7393.0389716627469,-7310.3126974101251,-7242.4791337225533,-7189.5382806000316,-7151.4901380425727,-7128.334706050161,-7120.0719846228021,-7126.7019737604987,-7148.2246734632445,-7184.6400837310484,-7235.9482045638997,-7302.1490359618037,-7383.2425779247669,-7479.2288304527774,-7590.1077935458379,-7715.8794672039603,-7856.54385142713,-8012.1009462153543,-8182.5507515686368,-8367.8932674869611,-8568.1284939703473,-8783.2564310187772,-9013.2770786322744,-9258.1904368108117,-9517.9965055544053,-9792.6952848630481,-10082.28677473676,-10386.77097517551,-10706.147886179309,-11040.417507748174,-11389.579839882092,-11753.634882581064,-12132.582635845067,-12526.423099674141,-12935.156274068268,-13358.782159027451,-13797.300754551661,-14250.712060640959,-14719.016077295297,-15202.21280451468,-15700.302242299125,-16213.284390648636,-16741.159249563163,-17283.926819042779,-17841.587099087425,-18414.140089697139],[-33379.668091780855,-32501.008210739812,-31637.241040263798,-30788.366580352835,-29954.384831006966,-29135.295792226127,-28331.099464010345,-27541.795846359615,-26767.384939273921,-26007.866742753307,-25263.241256797737,-24533.508481407211,-23818.66841658175,-23118.721062321332,-22433.666418625966,-21763.504485495658,-21108.235262930422,-20467.858750930194,-19842.374949495039,-19231.783858624949,-18636.085478319899,-18055.27980857993,-17489.366849404982,-16938.346600795099,-16402.219062750271,-15880.984235270476,-15374.642118355758,-14883.192712006077,-14406.636016221453,-13944.972031001904,-13498.200756347376,-13066.322192257916,-12649.33633873351,-12247.243195774146,-11860.042763379852,-11487.735041550595,-11130.320030286406,-10787.797729587248,-10460.168139453166,-10147.431259884135,-9849.5870908801335,-9566.6356324412118,-9298.5768845673319,-9045.4108472585067,-8807.137520514736,-8583.756904336009,-8375.2689987223384,-8181.6738036737343,-8002.9713191901665,-7839.1615452716624,-7690.2444819181965,-7556.2201291297997,-7437.0884869064521,-7332.8495552481563,-7243.503334154907,-7169.0498236267185,-7109.4890236635802,-7064.8209342654936,-7035.0455554324617,-7020.1628871644807,-7020.1729294615579,-7035.0756823236788,-7064.8711457508616,-7109.5593197430971,-7169.1402043003764,-7243.6137994227174,-7332.9801051101094,-7437.2391213625506,-7556.3908481800481,-7690.435285562593,-7839.372433510197,-8003.2022920228637,-8181.9248611005623,-8375.5401407433274,-8584.0481309511488,-8807.4488317240084,-9045.7422430619299,-9298.9283649649096,-9567.0071974329367,-9849.9787404660092,-10147.842994064147,-10460.599958227323,-10788.249632955571,-11130.792018248858,-11488.227114107205,-11860.554920530605,-12247.775437519049,-12649.888665072551,-13066.894603191105,-13498.793251874729,-13945.584611123382,-14407.268680937097,-14883.845461315861,-15375.31495225969,-15881.677153768562,-16402.932065842491,-16939.079688481455,-17490.120021685507,-18056.053065454595,-18636.878819788733],[-32793.320568525625,-31922.933451208977,-31067.43904445746,-30226.837348270921,-29401.128362649484,-28590.312087593076,-27794.388523101705,-27013.357669175384,-26247.219525814166,-25495.974093017961,-24759.621370786823,-24038.161359120721,-23331.594058019684,-22639.91946748372,-21963.137587512778,-21301.248418106901,-20654.251959266097,-20022.148210990294,-19404.937173279581,-18802.618846133922,-18215.193229553301,-17642.660323537748,-17085.020128087228,-16542.272643201755,-16014.417868881384,-15501.455805126045,-15003.386451935743,-14520.209809310503,-14051.925877250311,-13598.534655755177,-13160.036144825099,-12736.430344460052,-12327.717254660085,-11933.896875425171,-11554.969206755284,-11190.934248650472,-10841.792001110702,-10507.542464135999,-10188.185637726336,-9883.7215218817291,-9594.1501166021662,-9319.4714218876688,-9059.685437738226,-8814.7921641538269,-8584.791601134486,-8369.6837486801924,-8169.4686067909579,-7984.1461754667816,-7813.7164547076472,-7658.1794445135683,-7517.5351448845486,-7391.7835558205752,-7280.9246773216564,-7184.9585093877904,-7103.885052018979,-7037.7043052152167,-6986.4162689765089,-6950.0209433028558,-6928.5183281942554,-6921.908423650706,-6930.1912296722176,-6953.3667462587691,-6991.4349734103798,-7044.3959111270451,-7112.249559408765,-7194.9959182555349,-7292.6349876673557,-7405.1667676442321,-7532.5912581861558,-7674.9084592931358,-7832.1183709651723,-8004.2209932022679,-8191.2163260044044,-8393.1043693715983,-8609.8851233038458,-8841.5585878011425,-9088.1247628634974,-9349.5836484909014,-9625.9352446833564,-9917.1795514408586,-10223.316568763426,-10544.346296651049,-10880.268735103718,-11231.083884121443,-11596.791743704211,-11977.392313852051,-12372.885594564923,-12783.271585842866,-13208.550287685854,-13648.721700093907,-14103.785823066984,-14573.742656605142,-15058.592200708335,-15558.334455376576,-16072.969420609879,-16602.497096408246,-17146.917482771663,-17706.230579700121,-18280.436387193644,-18869.534905252218],[-32216.890400642274,-31354.776047050051,-30507.554404022951,-29675.225471560872,-28857.789249663838,-28055.245738331876,-27267.594937564936,-26494.836847363062,-25736.97146772626,-24993.998798654466,-24265.918840147773,-23552.731592206124,-22854.437054829526,-22171.035228017965,-21502.526111771447,-20848.909706090031,-20210.186010973637,-19586.355026422265,-18977.416752435987,-18383.371189014782,-17804.218336158578,-17239.958193867453,-16690.590762141386,-16156.116040980376,-15636.534030384399,-15131.844730353485,-14642.048140887613,-14167.144261986792,-13707.133093651037,-13262.014635880338,-12831.788888674688,-12416.455852034083,-12016.015525958544,-11630.467910448049,-11259.813005502619,-10904.05081112223,-10563.181327306891,-10237.204554056605,-9926.1204913713809,-9629.9291392512168,-9348.6304976960782,-9082.224566706016,-8830.7113462810066,-8594.0908364210391,-8372.3630371261352,-8165.527948396275,-7973.5855702314693,-7796.5359026317165,-7634.3789455970191,-7487.1146991273718,-7354.7431632227772,-7237.2643378832418,-7134.6782231087564,-7046.9848188993237,-6974.1841252549402,-6916.2761421756113,-6873.2608696613388,-6845.1383077121118,-6831.9084563279494,-6833.5713155088324,-6850.1268852547728,-6881.5751655657587,-6927.9161564417991,-6989.149857882895,-7065.2762698890419,-7156.2953924602443,-7262.2072255964995,-7383.011769297811,-7518.7090235641717,-7669.2989883955779,-7834.7816637920432,-8015.1570497535658,-8210.4251462801385,-8420.585953371763,-8645.6394710284512,-8885.5856992501722,-9140.4246380369532,-9410.1562873887979,-9694.7806473056862,-9994.2977177876273,-10308.707498834625,-10638.009990446666,-10982.205192623769,-11341.29310536593,-11715.273728673128,-12104.147062545409,-12507.913106982722,-12926.57186198508,-13360.123327552497,-13808.567503684977,-14271.904390382491,-14750.13398764508,-15243.256295472713,-15751.271313865385,-16274.179042823125,-16811.979482345938,-17364.672632433751,-17932.258493086651,-18514.737064304627,-19112.108346087582],[-31650.377588130832,-30796.535998263083,-29957.587118960364,-29133.530950222725,-28324.367492050143,-27530.096744442599,-26750.71870740009,-25986.233380922662,-25236.640765010306,-24501.940859662944,-23782.133664880661,-23077.219180663451,-22387.197407011285,-21712.06834392414,-21051.831991402094,-20406.48834944507,-19776.037418053107,-19160.479197226174,-18559.813686964357,-17974.040887267533,-17403.160798135803,-16847.173419569117,-16306.078751567451,-15779.87679413086,-15268.567547259328,-14772.151010952837,-14290.627185211408,-13823.996070035022,-13372.257665423702,-12935.411971377436,-12513.458987896211,-12106.39871498004,-11714.231152628916,-11336.956300842861,-10974.574159621858,-10627.084728965903,-10294.488008875,-9976.7839993491489,-9673.97270038836,-9386.0541119926129,-9113.0282341619113,-8854.8950668962825,-8611.6546101956992,-8383.306864060165,-8169.8518284896882,-7971.2895034842641,-7787.6198890438818,-7618.8429851685723,-7464.9587918583002,-7325.9673091130853,-7201.8685369329287,-7092.6624753178194,-6998.3491242677655,-6918.9284837827618,-6854.4005538628098,-6804.7653345079198,-6770.0228257180734,-6750.1730274932816,-6745.2159398335425,-6755.151562738858,-6779.9798962092282,-6819.7009402446483,-6874.3146948451213,-6943.8211600106479,-7028.2203357412263,-7127.5122220368612,-7241.6968188975461,-7370.7741263232901,-7514.7441443140806,-7673.6068728699174,-7847.3623119908225,-8036.0104616767721,-8239.5513219277746,-8457.9848927438325,-8691.311174124945,-8939.5301660710975,-9202.6418685823191,-9480.6462816585899,-9773.5434052999135,-10081.333239506283,-10404.015784277708,-10741.591039614188,-11094.059005515726,-11461.419681982317,-11843.673069013947,-12240.819166610647,-12652.857974772394,-13079.789493499191,-13521.613722791035,-13978.330662647939,-14449.940313069896,-14936.442674056909,-15437.837745608973,-15954.125527726079,-16485.30602040825,-17031.37922365548,-17592.345137467746,-18168.203761845092,-18758.955096787467,-19364.599142294886],[-31093.782130991305,-30248.213304847959,-29417.537189269693,-28601.753784256471,-27800.863089808314,-27014.865105925193,-26243.759832607131,-25487.547269854113,-24746.227417666159,-24019.800276043257,-23308.265844985421,-22611.624124492657,-21929.8751145649,-21263.018815202217,-20611.055226404555,-19973.984348172009,-19351.806180504471,-18744.52072340198,-18152.127976864558,-17574.627940892191,-17012.020615484878,-16464.306000642606,-15931.484096365395,-15413.554902653232,-14910.518419506136,-14422.374646924076,-13949.123584907085,-13490.765233455128,-13047.299592568226,-12618.726662246401,-12205.046442489616,-11806.258933297868,-11422.364134671197,-11053.36204660956,-10699.252669112984,-10360.036002181459,-10035.712045814995,-9726.2808000135701,-9431.7422647772109,-9152.0964401058991,-8887.3433259996364,-8637.4829224584337,-8402.5152294822783,-8182.4402470711793,-7977.2579752251322,-7786.9684139441415,-7611.5715632281972,-7451.0674230773084,-7305.4559934914723,-7174.7372744706909,-7058.911266014964,-6957.9779681242835,-6871.9373807986622,-6800.7895040380936,-6744.534337842575,-6703.1718822121093,-6676.7021371466972,-6665.1251026463415,-6668.4407787110376,-6686.6491653407829,-6719.7502625355837,-6767.7440702954391,-6830.6305886203445,-6908.4098175103027,-7001.0817569653091,-7108.6464069853791,-7231.1037675704965,-7368.453838720663,-7520.6966204358887,-7687.8321127161707,-7869.8603155615019,-8066.7812289718786,-8278.5948529473153,-8505.301187487803,-8746.9002325933488,-9003.3919882639348,-9274.776454499588,-9561.0536313002922,-9862.22351866604,-10178.286116596842,-10509.241425092714,-10855.089444153618,-11215.830173779581,-11591.463613970613,-11981.989764726681,-12387.408626047796,-12807.720197933981,-13242.9244803852,-13693.021473401488,-14158.011176982827,-14637.893591129219,-15132.668715840657,-15642.336551117149,-16166.897096958694,-16706.350353365291,-17260.696320336967,-17829.934997873643,-18414.06638597542,-19013.090484642242,-19627.007293874089],[-30547.104029223614,-29709.807966804707,-28887.404614950901,-28079.893973662096,-27287.276042938378,-26509.550822779704,-25746.718313186058,-24998.7785141575,-24265.731425693964,-23547.577047795516,-22844.315380462103,-22155.946423693727,-21482.47017749041,-20823.886641852172,-20180.195816778956,-19551.397702270813,-18937.492298327707,-18338.479604949673,-17754.359622136679,-17185.132349888736,-16630.797788205833,-16091.355937088025,-15566.806796535229,-15057.15036654751,-14562.38664712484,-14082.515638267218,-13617.537339974646,-13167.451752247127,-12732.258875084664,-12311.958708487271,-11906.551252454905,-11516.036506987613,-11140.414472085355,-10779.68514774816,-10433.848533976008,-10102.904630768917,-9786.8534381268801,-9485.6949560498906,-9199.4291845379612,-8928.0561235910827,-8671.5757732092552,-8429.9881333924823,-8203.2932041407585,-7991.4909854540947,-7794.5814773324755,-7612.56467977592,-7445.4405927844073,-7293.2092163579473,-7155.870550496551,-7033.4245952001957,-6925.8713504688985,-6833.2108163026551,-6755.4429927014626,-6692.5678796653301,-6644.5854771942377,-6611.4957852882089,-6593.2988039472266,-6589.9945331713016,-6601.5829729604338,-6628.0641233146071,-6669.4379842338431,-6725.7045557181282,-6796.8638377674679,-6882.9158303818531,-6983.8605335612992,-7099.6979473057963,-7230.4280716153471,-7376.050906489947,-7536.5664519296006,-7711.9747079343142,-7902.2756745040697,-8107.4693516388852,-8327.5557393387571,-8562.5348376036745,-8812.4066464336574,-9077.1711658286731,-9356.8283957887543,-9651.3783363138882,-9960.8209874040713,-10285.156349059314,-10624.384421279607,-10978.505204064943,-11347.518697415346,-11731.424901330804,-12130.223815811296,-12543.915440856857,-12972.499776467461,-13415.976822643117,-13874.34657938383,-14347.609046689613,-14835.764224560424,-15338.8121129963,-15856.752711997229,-16389.586021563206,-16937.31204169424,-17499.93077239034,-18077.442213651448,-18669.846365477653,-19277.143227868895,-19899.332800825192],[-30010.343282827853,-29181.319984133421,-28367.189396004025,-27567.951518439695,-26783.606351440387,-26014.153895006115,-25259.594149136923,-24519.927113832789,-23795.152789093678,-23085.271174919653,-22390.282271310673,-21710.186078266757,-21044.982595787871,-20394.67182387405,-19759.253762525273,-19138.728411741555,-18533.095771522894,-17942.355841869277,-17366.508622780711,-16805.554114257207,-16259.492316298747,-15728.323228905354,-15212.046852077016,-14710.663185813704,-14224.17223011547,-13752.573984982273,-13295.868450414147,-12854.055626411073,-12427.135512973024,-12015.108110100044,-11617.973417792131,-11235.731436049258,-10868.382164871429,-10515.925604258668,-10178.361754210957,-9855.6906147282971,-9547.9121858106901,-9255.0264674581358,-8977.0334596706343,-8713.9331624481838,-8465.7255757907878,-8232.4106996984447,-8013.9885341711606,-7810.4590792089166,-7621.8223348117372,-7448.078300979605,-7289.2269777125275,-7145.2683650105064,-7016.2024628735362,-6902.0292713016133,-6802.7487902947487,-6718.3610198529368,-6648.8659599761777,-6594.2636106644723,-6554.5539719178178,-6529.7370437362133,-6519.8128261196662,-6524.7813190681718,-6544.6425225817275,-6579.3964366603386,-6629.0430613040044,-6693.5823965127165,-6773.0144422864869,-6867.3391986253127,-6976.5566655291896,-7100.6668429981155,-7239.6697310320997,-7393.5653296311284,-7562.3536387952163,-7746.0346585243569,-7944.6083888185522,-8158.0748296777965,-8386.4339811020945,-8629.6858430914399,-8887.830415645858,-9160.8676987653089,-9448.7976924498162,-9751.620396699378,-10069.335811514007,-10401.943936893671,-10749.444772838393,-11111.838319348168,-11489.12457642299,-11881.303544062892,-12288.37522226781,-12710.339611037807,-13147.196710372833,-13598.946520272932,-14065.589040738081,-14547.124271768284,-15043.55221336354,-15554.87286552385,-16081.086228249194,-16622.192301539602,-17178.191085395061,-17749.082579815593,-18334.866784801146,-18935.543700351795,-19551.113326467454,-20181.575663148178],[-29483.499891804036,-28662.749356834014,-27856.891532429057,-27065.926418589093,-26289.854015314253,-25528.674322604427,-24782.387340459674,-24050.993068879958,-23334.491507865299,-22632.882657415706,-21946.166517531143,-21274.343088211644,-20617.412369457219,-19975.374361267808,-19348.229063643463,-18735.97647658419,-18138.616600089947,-17556.149434160747,-16988.574978796634,-16435.893233997551,-15898.104199763546,-15375.207876094575,-14867.204262990666,-14374.093360451783,-13895.875168477971,-13432.549687069213,-12984.116916225512,-12550.576855946862,-12131.929506233266,-11728.174867084717,-11339.312938501229,-10965.343720482786,-10606.267213029398,-10262.083416141068,-9932.7923298177848,-9618.3939540595584,-9318.8882888663811,-9034.2753342382566,-8764.5550901751903,-8509.727556677175,-8269.7927337442106,-8044.7506213763045,-7834.6012195734456,-7639.3445283356386,-7458.9805476628853,-7293.5092775551911,-7142.9307180125415,-7007.2448690349502,-6886.4517306224088,-6780.5513027749221,-6689.5435854924908,-6613.4285787751087,-6552.2062826227802,-6505.8766970355064,-6474.4398220132862,-6457.8956575561106,-6456.2442036640005,-6469.4854603369349,-6497.6194275749222,-6540.6461053779676,-6598.565493746064,-6671.3775926792114,-6759.0824021774124,-6861.679922240668,-6979.17015286897,-7111.5530940623357,-7258.828745820746,-7420.9971081442145,-7598.0581810327312,-7790.0119644863062,-7996.8584585049284,-8218.5976630886034,-8455.229578237333,-8706.7542039511245,-8973.1715402299633,-9254.4815870738421,-9550.6843444827937,-9861.7798124567853,-10187.767990995828,-10528.648880099936,-10884.422479769099,-11255.088790003301,-11640.647810802566,-12041.099542166885,-12456.44398409624,-12886.681136590661,-13331.810999650137,-13791.833573274667,-14266.748857464232,-14756.55685221887,-15261.257557538536,-15780.850973423276,-16315.33709987307,-16864.715936887915,-17428.987484467805,-18008.151742612765,-18602.208711322761,-19211.158390597811,-19835.000780437935,-20473.735880843084],[-28966.573856152165,-28154.096084906509,-27356.511024225991,-26573.818674110509,-25806.019034560064,-25053.112105574677,-24315.097887154348,-23591.976379299056,-22883.747582008837,-22190.411495283661,-21511.968119123543,-20848.417453528476,-20199.75949849845,-19565.994254033489,-18947.121720133597,-18343.141896798734,-17754.054784028922,-17179.860381824161,-16620.558690184476,-16076.149709109837,-15546.633438600227,-15032.009878655708,-14532.279029276222,-14047.440890461774,-13577.495462212419,-13122.442744528094,-12682.282737408808,-12257.01544085459,-11846.640854865422,-11451.158979441305,-11070.569814582257,-10704.87336028824,-10354.069616559274,-10018.15858339538,-9697.1402607965319,-9391.0146487627353,-9099.7817472939896,-8823.441556390304,-8561.9940760516638,-8315.4393062780764,-8083.7772470695418,-7867.0078984260654,-7665.1312603476435,-7478.1473328342654,-7306.05611588595,-7148.8576095026801,-7006.5518136844676,-6879.1387284313041,-6766.618353743198,-6668.990689620141,-6586.2557360621377,-6518.4134930691889,-6465.463960641292,-6427.4071387784479,-6404.2430274806538,-6395.9716267479198,-6402.5929365802367,-6424.1069569776027,-6460.5136879400234,-6511.8131294675004,-6578.0052815600202,-6659.0901442176055,-6755.0677174402372,-6865.9380012279244,-6991.7009955806607,-7132.3567004984561,-7287.9051159812971,-7458.3462420291962,-7643.6800786421427,-7843.9066258201437,-8059.0258835632012,-8289.0378518713151,-8533.9425307444781,-8793.7399201826884,-9068.4300201859678,-9358.01283075428,-9662.4883518876559,-9981.8565835860845,-10316.11752584956,-10665.271178678093,-11029.317542071685,-11408.256616030318,-11802.08840055401,-12210.812895642757,-12634.430101296559,-13072.940017515415,-13526.342644299311,-13994.637981648269,-14477.826029562279,-14975.90678804134,-15488.880257085448,-16016.746436694621,-16559.505326868857,-17117.156927608125,-17689.701238912443,-18277.138260781838,-18879.467993216262,-19496.690436215758,-20128.805589780299,-20775.813453909868],[-28459.565175872063,-27655.360168350904,-26866.04787139481,-26091.628285003739,-25332.10140917774,-24587.467243916784,-23857.725789220887,-23142.877045090027,-22442.921011524224,-21757.857688523502,-21087.687076087801,-20432.409174217166,-19792.023982911578,-19166.531502171067,-18555.931731995584,-17960.224672385146,-17379.410323339802,-16813.488684859465,-16262.459756944192,-15726.323539593983,-15205.080032808828,-14698.729236588733,-14207.271150933662,-13730.705775843669,-13269.033111318722,-12822.253157358831,-12390.365913963997,-11973.371381134204,-11571.269558869462,-11184.060447169777,-10811.744046035154,-10454.32035546557,-10111.78937546105,-9784.1511060215853,-9471.4055471471638,-9173.5526988378006,-8890.5925610934937,-8622.5251339142233,-8369.3504173000256,-8131.0684112508698,-7907.6791157667667,-7699.1825308477273,-7505.5786564937298,-7326.8674927047869,-7163.0490394808976,-7014.1232968220638,-6880.0902647282783,-6760.9499431995519,-6656.7023322358727,-6567.34743183725,-6492.885242003681,-6433.3157627351638,-6388.6389940316994,-6358.8549358932851,-6343.9635883199262,-6343.9649513116201,-6358.8590248683677,-6388.6458089901707,-6433.3253036770211,-6492.8975089289279,-6567.3624247458838,-6656.7200511278998,-6760.970388074963,-6880.1134355870818,-7014.1491936642497,-7163.0776623064758,-7326.8988415137501,-7505.6127312860781,-7699.2193316234607,-7907.7186425258988,-8131.1106639933823,-8369.3953960259332,-8622.5728386235169,-8890.6429917861678,-9173.6058555138734,-9471.461429806619,-9784.2097146644246,-10111.850710087287,-10454.384416075198,-10811.810832628171,-11184.129959746188,-11571.341797429246,-11973.446345677383,-12390.44360449056,-12822.333573868782,-13269.116253812066,-13730.791644320403,-14207.359745393791,-14698.82055703223,-15205.174079235729,-15726.420312004269,-16262.559255337866,-16813.590909236518,-17379.515273700243,-17960.332348728989,-18556.042134322801,-19166.644630481653,-19792.139837205599,-20432.527754494578,-21087.808382348594],[-27962.473850963986,-27166.541607167223,-26385.502073935531,-25619.35525126892,-24868.101139167324,-24131.739737630822,-23410.271046659349,-22703.695066252927,-22012.011796411549,-21335.221237135251,-20673.323388424,-20026.318250277785,-19394.205822696655,-18776.98610568056,-18174.659099229495,-17587.224803343521,-17014.683218022565,-16457.034343266678,-15914.278179075834,-15386.414725450069,-14873.443982389343,-14375.365949893659,-13892.180627963038,-13423.888016597464,-12970.488115796959,-12531.980925561493,-12108.366445891086,-11699.644676785727,-11305.815618245424,-10926.879270270174,-10562.83563285998,-10213.684706014827,-9879.4264897347348,-9560.0609840196921,-9255.5881888697077,-8966.0081042847778,-8691.3207302648952,-8431.5260668100709,-8186.6241139202939,-7956.6148715955751,-7741.4983398359045,-7541.2745186412913,-7355.9434080117244,-7185.5050079472167,-7029.9593184477617,-6889.3063395133559,-6763.546071144001,-6652.6785133397088,-6556.7036661004604,-6475.6215294262674,-6409.4321033171273,-6358.1353877730453,-6321.7313827940088,-6300.2200883800297,-6293.6015045311033,-6301.8756312472269,-6325.0424685284097,-6363.1020163746371,-6416.0542747859199,-6483.8992437622592,-6566.6369233036476,-6664.2673134100933,-6776.7904140815881,-6904.2062253181393,-7046.5147471197397,-7203.7159794863946,-7375.8099224181024,-7562.7965759148628,-7764.6759399766834,-7981.4480146035467,-8213.1127997954609,-8459.6702955524343,-8721.1205018744604,-8997.4634187615411,-9288.699046213671,-9594.8273842308499,-9915.8484328130999,-10251.762191960388,-10602.568661672725,-10968.267841950121,-11348.859732792582,-11744.34433420007,-12154.721646172628,-12579.991668710238,-13020.154401812904,-13475.209845480618,-13945.157999713387,-14429.998864511197,-14929.73243987408,-15444.358725802022,-15973.877722294983,-16518.289429353015,-17077.593846976102,-17651.790975164226,-18240.880813917422,-18844.863363235665,-19463.738623118952,-20097.506593567312,-20746.167274580723,-21409.720666159163],[-27475.299881427665,-26687.640401355391,-25914.873631848124,-25156.999572905952,-24414.018224528816,-23685.929586716702,-22972.73365946969,-22274.4304427877,-21591.019936670753,-20922.502141118897,-20268.877056132067,-19630.144681710277,-19006.305017853574,-18397.358064561908,-17803.303821835289,-17224.142289673728,-16659.873468077232,-16110.49735704577,-15576.013956579354,-15056.423266678026,-14551.725287341727,-14061.920018570485,-13587.007460364295,-13126.987612723156,-12681.860475647076,-12251.626049136039,-11836.284333190062,-11435.835327809127,-11050.279032993269,-10679.615448742443,-10323.844575056683,-9982.9664119359641,-9656.9809593803093,-9345.8882173897018,-9049.6881859641453,-8768.3808651036416,-8501.9662548081906,-8250.444355077796,-8013.8151659124533,-7792.0786873121688,-7585.2349192769307,-7393.2838618067472,-7216.2255149016164,-7054.0598785615348,-6906.786952786515,-6774.4067375765417,-6656.9192329316229,-6554.324438851756,-6466.6223553369418,-6393.8129823871805,-6335.8963200024755,-6292.8723681828214,-6264.7411269282184,-6251.5025962386717,-6253.156776114175,-6269.7036665547303,-6301.1432675603446,-6347.4755791310054,-6408.7006012667225,-6484.8183339674933,-6575.8287772333124,-6681.7319310641888,-6802.5277954601188,-6938.216370421098,-7088.7976559471317,-7254.2716520382201,-7434.6383586943593,-7629.8977759155487,-7840.0499037017962,-8065.094742053092,-8305.0322909694441,-8559.8625504508564,-8829.5855204973122,-9114.2012011088245,-9413.7095922853878,-9728.1106940269983,-10057.404506333676,-10401.591029205392,-10760.670262642168,-11134.642206643988,-11523.506861210881,-11927.264226342812,-12345.914302039801,-12779.45708830184,-13227.892585128924,-13691.220792521081,-14169.441710478284,-14662.555339000528,-15170.561678087824,-15693.46072774019,-16231.252487957594,-16783.936958740065,-17351.514140087591,-17933.984032000146,-18531.346634477755,-19143.601947520452,-19770.749971128156,-20412.790705300977,-21069.724150038812,-21741.550305341683],[-26998.043267263361,-26218.65655091549,-25454.162545132698,-24704.561249914943,-23969.852665262217,-23250.036791174549,-22545.113627651932,-21855.083174694395,-21179.945432301894,-20519.700400474474,-19874.34807921205,-19243.888468514713,-18628.321568382438,-18027.6473788152,-17441.865899813016,-16870.977131375883,-16314.98107350381,-15773.877726196783,-15247.667089454817,-14736.349163277908,-14239.923947666028,-13758.39144261922,-13291.751648137461,-12840.004564220766,-12403.150190869103,-11981.188528082514,-11574.119575860961,-11181.943334204458,-10804.65980311302,-10442.26898258664,-10094.770872625306,-9762.165473229019,-9444.4527843977849,-9141.6328061316126,-8853.7055384304876,-8580.6709812944191,-8322.529134723407,-8079.2799987174385,-7850.9235732765283,-7637.4598584006726,-7438.8888540898697,-7255.2105603441159,-7086.4249771634159,-6932.5321045477649,-6793.5319424971758,-6669.424491011634,-6560.2097500911459,-6465.8877197357106,-6386.4583999453316,-6321.92179072,-6272.2778920597257,-6237.5267039645032,-6217.6682264343317,-6212.7024594692139,-6222.6294030691515,-6247.449057234141,-6287.1614219641815,-6341.7664972592793,-6411.2642831194216,-6495.6547795446277,-6594.9379865348783,-6709.1139040901853,-6838.1825322105433,-6982.1438708959586,-7140.9979201464193,-7314.7446799619393,-7503.3841503425119,-7706.9163312881356,-7925.3412227988156,-8158.6588248745429,-8406.8691375153212,-8669.9721607211613,-8947.9678944920488,-9240.8563388279872,-9548.6374937289947,-9871.3113591950314,-10208.877935226143,-10561.33722182229,-10928.689218983502,-11310.933926709758,-11708.07134500107,-12120.101473857434,-12547.024313278856,-12988.839863265328,-13445.548123816843,-13917.149094933417,-14403.642776615059,-14905.029168861738,-15421.30827167347,-15952.480085050276,-16498.544608992106,-17059.501843499016,-17635.351788570944,-18226.094444207942,-18831.729810410001,-19452.257887177126,-20087.678674509269,-20737.992172406477,-21403.198380868766,-22083.297299896047],[-26530.704008470922,-25759.590055847482,-25003.368813789093,-24262.040282295769,-23535.604461367482,-22824.061351004246,-22127.410951206104,-21445.653261972962,-20778.788283304908,-20126.816015201894,-19489.736457663919,-18867.549610691,-18260.255474283163,-17667.85404844036,-17090.345333162615,-16527.729328449925,-15980.006034302271,-15447.175450719682,-14929.237577702143,-14426.192415249654,-13938.03996336222,-13464.780222039844,-13006.413191282518,-12562.938871090239,-12134.357261463028,-11720.668362400853,-11321.872173903739,-10937.968695971678,-10568.957928604661,-10214.839871802713,-9875.6145255658103,-9551.2818898939622,-9241.8419647871615,-8947.2947502454226,-8667.6402462687292,-8402.8784528570886,-8153.0093700105044,-7918.032997728973,-7697.9493360124925,-7492.7583848610666,-7302.4601442746934,-7127.0546142533731,-6966.5417947971082,-6820.9216859058924,-6690.1942875797313,-6574.3595998186229,-6473.4176226225663,-6387.3683559915617,-6316.2117999256106,-6259.947954424717,-6218.5768194888733,-6192.0983951180815,-6180.5126813123416,-6183.8196780716607,-6202.0193853960245,-6235.1118032854465,-6283.0969317399185,-6345.974770759447,-6423.7453203440245,-6516.4085804936612,-6623.9645512083425,-6746.4132324880829,-6883.7546243328743,-7035.9887267427184,-7203.1155397176099,-7385.1350632575686,-7582.0472973625683,-7793.8522420326244,-8020.5498972677333,-8262.1402630678913,-8518.6233394331066,-8789.9991263633838,-9076.2676238587046,-9377.4288319190709,-9693.4827505445064,-10024.42937973498,-10370.268719490514,-10731.000769811097,-11106.625530696729,-11497.143002147426,-11902.55318416318,-12322.85607674397,-12758.051679889821,-13208.139993600729,-13673.121017876678,-14152.994752717703,-14647.761198123766,-15157.420354094867,-15681.972220631031,-16221.416797732267,-16775.754085398534,-17344.984083629868,-17929.106792426232,-18528.122211787675,-19142.030341714159,-19770.831182205697,-20414.524733262268,-21073.110994883944,-21746.589967070657,-22434.96164982237],[-26073.282105050392,-25310.440916151398,-24562.492437817447,-23829.436670048533,-23111.273612844692,-22408.003266205887,-21719.625630132177,-21046.140704623464,-20387.548489679844,-19743.848985301258,-19115.042191487715,-18501.128108239249,-17902.106735555819,-17317.978073437451,-16748.742121884126,-16194.398880895875,-15654.948350472647,-15130.39053061449,-14620.725421321378,-14125.953022593325,-13646.073334430335,-13181.086356832384,-12730.992089799489,-12295.790533331639,-11875.481687428859,-11470.065552091117,-11079.542127318437,-10703.911413110805,-10343.173409468225,-9997.3281163907013,-9666.3755338782357,-9350.3156619308138,-9049.1485005484465,-8762.8740497311392,-8491.4923094788755,-8235.003279791672,-7993.4069606695157,-7766.7033521124094,-7554.8924541203669,-7357.9742666933716,-7175.9487898314292,-7008.8160235345458,-6856.5759678027071,-6719.2286226359211,-6596.7739880341942,-6489.2120639975155,-6396.5428505258924,-6318.7663476193211,-6255.8825552778035,-6207.891473501335,-6174.7931022899229,-6156.5874416435618,-6153.274491562257,-6164.8542520459996,-6191.326723094804,-6232.6919047086531,-6288.9497968875621,-6360.1003996315194,-6446.1437129405276,-6547.0797368145913,-6662.9084712537096,-6793.6299162578789,-6939.2440718271018,-7099.7509379613839,-7275.1505146607014,-7465.44280192509,-7670.6277997545203,-7890.7055081490053,-8125.6759271085484,-8375.5390566331389,-8640.2948967227894,-8919.9434473774927,-9214.4847085972451,-9523.9186803820485,-9848.2453627319064,-10187.464755646814,-10541.576859126782,-10910.581673171801,-11294.47919778186,-11693.269432956986,-12106.952378697173,-12535.528035002386,-12978.996401872677,-13437.357479308017,-13910.611267308394,-14398.75776587385,-14901.796975004339,-15419.72889469988,-15952.553524960478,-16500.270865786144,-17062.880917176833,-17640.383679132599,-18232.779151653402,-18840.067334739273,-19462.248228390166,-20099.321832606169,-20751.288147387189,-21418.147172733261,-22099.898908644391,-22796.543355120572],[-25625.77755700174,-24871.209131827185,-24131.533417217659,-23406.750413173198,-22696.860119693774,-22001.862536779423,-21321.757664430101,-20656.545502645859,-20006.226051426638,-19370.799310772487,-18750.265280683379,-18144.623961159348,-17553.875352200354,-16978.019453806417,-16417.056265977531,-15870.985788713679,-15339.808022014933,-14823.522965881191,-14322.130620312506,-13835.630985308886,-13364.024060870315,-12907.309846996815,-12465.488343688341,-12038.559550944927,-11626.523468766578,-11229.380097153271,-10847.129436105017,-10479.771485621823,-10127.306245703676,-9789.7337163505836,-9467.0538975625441,-9159.2667893395555,-8866.3723916816234,-8588.3707045887422,-8325.2617280609156,-8077.04546209814,-7843.7219067004153,-7625.2910618677506,-7421.7529276001351,-7233.1075038975723,-7059.3547907600596,-6900.4947881876069,-6756.5274961801988,-6627.452914737848,-6513.2710438605491,-6413.9818835483075,-6329.5854338011122,-6260.0816946189725,-6205.4706660018865,-6165.752347949855,-6140.9267404628708,-6130.9938435409458,-6135.953657184069,-6155.8061813922495,-6190.5514161654783,-6240.1893615037616,-6304.7200174070967,-6384.1433838754911,-6478.4594609089318,-6587.6682485074307,-6711.7697466709742,-6850.7639553995823,-7004.6508746932359,-7173.4305045519432,-7357.1028449757032,-7555.6678959645124,-7769.1256575183797,-7997.4761296373053,-8240.7193123212728,-8498.8552055702967,-8771.8838093843769,-9059.8051237635118,-9362.6191487076903,-9680.3258842169307,-10012.925330291222,-10360.417486930561,-10722.802354134961,-11100.079931904409,-11492.250220238911,-11899.313219138472,-12321.268928603076,-12758.117348632735,-13209.858479227456,-13676.492320387224,-14158.01887211203,-14654.438134401918,-15165.75010725683,-15691.954790676808,-16233.052184661841,-16789.042289211939,-17359.925104327071,-17945.700630007264,-18546.368866252502,-19161.929813062801,-19792.383470438144,-20437.729838378546,-21097.968916883961,-21773.100705954515,-22463.125205590084,-23168.042415790682],[-25188.190364325004,-24441.894702874888,-23710.491751989779,-22993.98151166975,-22292.363981914772,-21605.63916272483,-20933.807054099962,-20276.867656040125,-19634.820968545362,-19007.666991615632,-18395.405725250956,-17798.037169451356,-17215.561324216789,-16647.978189547277,-16095.287765442838,-15557.490051903427,-15034.585048929073,-14526.572756519781,-14033.453174675537,-13555.226303396346,-13091.892142682207,-12643.450692533133,-12209.901952949098,-11791.245923930126,-11387.482605476198,-10998.611997587323,-10624.634100263505,-10265.548913504739,-9921.3564373110221,-9592.0566716823632,-9277.649616618759,-8978.1352721201947,-8693.5136381867032,-8423.7847148182482,-8168.9485020148577,-7929.0049997765072,-7703.9542081032205,-7493.7961269949856,-7298.5307564518025,-7118.1580964736704,-6952.6781470605929,-6802.0909082125709,-6666.3963799295952,-6545.594562211676,-6439.6854550588087,-6348.6690584709959,-6272.545372448235,-6211.3143969905286,-6164.9761320978714,-6133.5305777702706,-6116.9777340077244,-6115.3176008102291,-6128.5501781777839,-6156.6754661103951,-6199.6934646080581,-6257.6041736707721,-6330.4075932985425,-6418.1037234913638,-6520.6925642492379,-6638.1741155721693,-6770.5483774601489,-6917.8153499131831,-7079.9750329312656,-7257.0274265144108,-7448.9725306625987,-7655.8103453758449,-7877.5408706541448,-8114.1641064974938,-8365.6800529058928,-8632.0887098793555,-8913.3900774178655,-9209.5841555214283,-9520.6709441900493,-9846.6504434237104,-10187.522653222444,-10543.287573586211,-10913.945204515043,-11299.49554600892,-11699.938598067845,-12115.274360691838,-12545.502833880886,-12990.624017634975,-13450.637911954114,-13925.544516838327,-14415.34383228757,-14920.035858301888,-15439.620594881233,-15974.098042025642,-16523.4681997351,-17087.731068009623,-17666.886646849191,-18260.934936253805,-18869.87593622347,-19493.709646758216,-20132.436067857983,-20786.055199522831,-21454.567041752714,-22137.971594547649,-22836.268857907671,-23549.458831832686],[-24760.520527020206,-24022.49762929447,-23299.367442133829,-22591.129965538217,-21897.785199507685,-21219.333144042153,-20555.773799141731,-19907.107164806337,-19273.333241035998,-18654.452027830714,-18050.463525190462,-17461.367733115294,-16887.164651605148,-16327.854280660069,-15783.436620280059,-15253.911670465075,-14739.279431215178,-14239.53990253029,-13754.693084410488,-13284.73897685574,-12829.677579866016,-12389.508893441372,-11964.232917581769,-11553.849652287219,-11158.359097557728,-10777.761253393286,-10412.056119793902,-10061.243696759575,-9725.323984290284,-9404.2969823860567,-9098.1626910468876,-8806.9211102727586,-8530.572240063686,-8269.1160804196697,-8022.5526313407054,-7790.8818928267938,-7574.1038648779377,-7372.2185474941271,-7185.2259406753801,-7013.1260444216778,-6855.91885873303,-6713.6043836094386,-6586.1826190508973,-6473.6535650574106,-6376.0172216289739,-6293.2735887655899,-6225.4226664672606,-6172.4644547339849,-6134.398953565762,-6111.2261629625955,-6102.9460829244736,-6109.5587134514099,-6131.0640545434007,-6167.4621062004398,-6218.7528684225344,-6284.9363412096809,-6366.0125245618829,-6461.9814184791385,-6572.8430229614432,-6698.5973380088026,-6839.244363621212,-6994.7840997986796,-7165.2165465411972,-7350.5417038487685,-7550.7595717213917,-7765.8701501590658,-7995.8734391617963,-8240.7694387295796,-8500.5581488624157,-8775.2395695603063,-9064.8137008232443,-9369.2805426512423,-9688.6400950442912,-10022.892358002384,-10372.037331525546,-10736.075015613751,-11115.005410267015,-11508.828515485326,-11917.54433126868,-12341.152857617102,-12779.654094530573,-13233.048042009092,-13701.334700052676,-14184.514068661319,-14682.586147834982,-15195.550937573733,-15723.408437877526,-16266.15864874635,-16823.801570180251,-17396.337202179198,-17983.765544743204,-18586.086597872265,-19203.300361566366,-19835.406835825514,-20482.406020649738,-21144.29791603901,-21821.08252199331,-22512.759838512684,-23219.329865597123,-23940.792603246584],[-24342.768045087258,-23613.017911085983,-22898.160487649751,-22198.195774778564,-21513.123772472471,-20842.944480731407,-20187.657899555365,-19547.264028944413,-18921.762868898521,-18311.15441941766,-17715.438680501833,-17134.615652151078,-16568.685334365386,-16017.647727144737,-15481.502830489148,-14960.250644398631,-14453.89116887313,-13962.424403912702,-13485.850349517317,-13024.16900568699,-12577.380372421721,-12145.484449721505,-11728.481237586328,-11326.370736016215,-10939.152945011157,-10566.827864571147,-10209.395494696189,-9866.8558353862918,-9539.2088866414306,-9226.454648461644,-8928.5931208468992,-8645.6243037972017,-8377.5481973125643,-8124.3648013929815,-7886.0741160384478,-7662.6761412489668,-7454.1708770245432,-7260.5583233651687,-7081.8384802708497,-6918.0113477415798,-6769.0769257773636,-6635.035214378202,-6515.8862135440959,-6411.6299232750398,-6322.2663435710356,-6247.7954744320878,-6188.21731585819,-6143.5318678493422,-6113.7391304055527,-6098.8391035268141,-6098.8317872131283,-6113.7171814644962,-6143.4952862809159,-6188.1661016623884,-6247.7296276089164,-6322.1858641204917,-6411.5348111971271,-6515.7764688388133,-6634.9108370455569,-6768.9379158173451,-6917.857705154187,-7081.6702050560834,-7260.3754155230308,-7453.9733365550401,-7662.4639681520921,-7885.8473103142005,-8124.1233630413644,-8377.2921263335793,-8645.3536001908396,-8928.3077846131637,-9226.1546796005368,-9538.8942851529719,-9866.5266012704487,-10209.051627952966,-10566.46936520057,-10938.7798130132,-11325.982971390902,-11728.078840333641,-12145.067419841424,-12576.948709914279,-13023.722710552191,-13485.389421755131,-13961.948843523151,-14453.400975856217,-14959.745818754329,-15480.98337221751,-16017.113636245713,-16568.136610838996,-17134.052295997317,-17714.8606917207,-18310.561798009112,-18921.155614862615,-19546.642142281162,-20187.021380264734,-20842.293328813375,-21512.457987927119,-22197.515357605822,-22897.465437849642,-23612.308228658505,-24342.04373003239],[-23934.932918526225,-23213.455548249403,-22506.870888537582,-21815.178939390833,-21138.379700809157,-20476.473172792539,-19829.459355340943,-19197.338248454398,-18580.109852132926,-17977.774166376519,-17390.331191185145,-16817.780926558815,-16260.123372497565,-15717.358529001345,-15189.486396070182,-14676.506973704072,-14178.420261903024,-13695.226260667019,-13226.924969996075,-12773.516389890181,-12335.000520349324,-11911.377361373539,-11502.646912962799,-11108.809175117125,-10729.864147836495,-10365.811831120915,-10016.652224970396,-9682.3853293849206,-9363.0111443645001,-9058.5296699091341,-8768.9409060188227,-8494.2448526935586,-8234.4415099333546,-7989.5308777382052,-7759.5129561080976,-7544.38774504305,-7344.1552445430571,-7158.8154546081123,-6988.3683752382258,-6832.8140064333866,-6692.1523481936038,-6566.3834005188755,-6455.5071634091964,-6359.5236368645728,-6278.4328208850002,-6212.2347154704821,-6160.929320621015,-6124.5166363366025,-6102.9966626172436,-6096.3693994629375,-6104.6348468736796,-6127.7930048494809,-6165.8438733903313,-6218.787452496239,-6286.6237421671958,-6369.3527424032054,-6466.9744532042714,-6579.4888745703902,-6706.896006501559,-6849.1958489977787,-7006.3884020590522,-7178.4736656853838,-7365.4516398767664,-7567.3223246332018,-7784.0857199546826,-8015.7418258412254,-8262.2906422928172,-8523.7321693094655,-8800.066406891161,-9091.2933550379112,-9397.4130137497159,-9718.4253830265698,-10054.330462868489,-10405.128253275454,-10770.818754247472,-11151.401965784542,-11546.877887886669,-11957.246520553845,-12382.507863786061,-12822.661917583353,-13277.708681945693,-13747.648156873071,-14232.48034236551,-14732.20523842301,-15246.82284504555,-15776.333162233155,-16320.736189985806,-16880.031928303506,-17454.220377186277,-18043.301536634091,-18647.275406646935,-19266.141987224866,-19899.90127836783,-20548.553280075852,-21212.097992348943,-21890.535415187056,-22583.865548590242,-23292.088392558486,-24015.203947091766,-24753.212212190105],[-23537.015147337108,-22823.810540784667,-22125.498644797299,-21442.079459375003,-20773.552984517763,-20119.919220225547,-19481.178166498401,-18857.329823336295,-18248.374190739261,-17654.311268707253,-17075.141057240318,-16510.863556338423,-15961.478766001594,-15426.986686229817,-14907.387317023085,-14402.680658381416,-13912.86671030479,-13437.945472793212,-12977.916945846691,-12532.781129465238,-12102.538023648822,-11687.187628397474,-11286.729943711165,-10901.164969589916,-10530.492706033718,-10174.713153042576,-9833.826310616485,-9507.8321787554341,-9196.7307574594543,-8900.522046728518,-8619.20604656264,-8352.7827569618075,-8101.252177926036,-7864.6143094553117,-7642.8691515496403,-7436.0167042090252,-7244.056967433462,-7066.9899412229515,-6904.8156255774957,-6757.5340204970908,-6625.1451259817386,-6507.6489420314429,-6405.0454686461953,-6317.3347058260033,-6244.516653570864,-6186.5913118807784,-6143.5586807557447,-6115.4187601957619,-6102.1715502008319,-6103.8170507709583,-6120.3552619061384,-6151.7861836063666,-6198.1098158716513,-6259.3261587019852,-6335.4352120973736,-6426.4369760578202,-6532.3314505833187,-6653.1186356738672,-6788.7985313294639,-6939.3711375501225,-7104.8364543358284,-7285.194481686588,-7480.4452196023994,-7690.58866808327,-7915.6248271291852,-8155.5536967401604,-8410.3752769161856,-8680.0895676572654,-8964.6965689633871,-9264.1962808345779,-9578.5887032708088,-9907.8738362721087,-10252.051679838445,-10611.12223396984,-10985.085498666296,-11373.941473927791,-11777.690159754351,-12196.331556145948,-12629.865663102613,-13078.292480624326,-13541.612008711094,-14019.824247362907,-14512.929196579787,-15020.926856361719,-15543.817226708681,-16081.60030762072,-16634.276099097799,-17201.844601139943,-17784.305813747142,-18381.659736919377,-18993.906370656681,-19621.045714959022,-20263.077769826414,-20920.002535258889,-21591.820011256379,-22278.530197818953,-22980.133094946556,-23696.628702639231,-24428.017020896972,-25174.298049719728],[-23149.014731519877,-22444.082888691883,-21754.04375642896,-21078.897334731097,-20418.643623598269,-19773.282623030489,-19142.814333027756,-18527.238753590107,-17926.55588471748,-17340.765726409925,-16769.868278667404,-16213.863541489955,-15672.751514877553,-15146.5321988302,-14635.205593347911,-14138.771698430664,-13657.230514078477,-13190.58204029133,-12738.82627706926,-12301.963224412222,-11879.992882320235,-11472.915250793312,-11080.730329831436,-10703.438119434617,-10341.038619602859,-9993.53183033614,-9660.9177516344807,-9343.1963834978742,-9040.3677259263168,-8752.431778919814,-8479.3885424783657,-8221.2380166019648,-7977.9802012906184,-7749.6150965443285,-7536.1427023630931,-7337.5630187469096,-7153.8760456957762,-6985.0817832096991,-6831.1802312886703,-6692.1713899327005,-6568.05525914178,-6458.8318389159167,-6364.5011292551008,-6285.0631301593385,-6220.5178416286308,-6170.8652636629758,-6136.105396262371,-6116.2382394268234,-6111.2637931563258,-6121.182057450882,-6145.9930323104936,-6185.6967177351553,-6240.2931137248688,-6309.7822202796369,-6394.1640373994596,-6493.4385650843315,-6607.6058033342579,-6736.6657521492398,-6880.6184115292708,-7039.4637814743592,-7213.2018619844957,-7401.8326530596923,-7605.3561546999317,-7823.7723669052311,-8057.0812896755779,-8305.2829230109837,-8568.3772669114442,-8846.3643213769519,-9139.2440864075124,-9447.0165620031257,-9769.68174816379,-10107.239644889516,-10459.690252180288,-10827.033570036116,-11209.269598457002,-11606.398337442926,-12018.419786993931,-12445.333947109964,-12887.140817791053,-13343.840399037193,-13815.432690848393,-14301.91769322463,-14803.295406165947,-15319.565829672307,-15850.72896374371,-16396.784808380173,-16957.733363581701,-17533.574629348266,-18124.308605679867,-18729.935292576563,-19350.454690038281,-19985.86679806505,-20636.171616656902,-21301.369145813769,-21981.459385535745,-22676.442335822743,-23386.317996674741,-24111.086368091863,-24850.747450074014,-25605.301242621215],[-22770.931671074533,-22074.272591970977,-21392.506223432487,-20725.632565459047,-20073.65161805063,-19436.563381207314,-18814.367854929013,-18207.065039215784,-17614.654934067592,-17037.137539484469,-16474.512855466397,-15926.780882013361,-15393.9416191254,-14875.995066802487,-14372.941225044622,-13884.780093851798,-13411.511673224053,-12953.135963161341,-12509.652963663677,-12081.062674731098,-11667.365096363534,-11268.560228561048,-10884.648071323605,-10515.628624651217,-10161.501888543884,-9822.2678630016053,-9497.9265480243721,-9188.4779436122026,-8893.9220497650713,-8614.2588664830037,-8349.488393765987,-8099.6106316140158,-7864.6255800271065,-7644.5332390052472,-7439.333608548437,-7249.0266886566878,-7073.6124793299914,-6913.0909805683405,-6767.4621923717496,-6636.726114740206,-6520.8827476737206,-6419.9320911722834,-6333.8741452359,-6262.7089098645693,-6206.4363850582968,-6165.0565708170707,-6138.5694671409037,-6126.9750740297841,-6130.2733914837172,-6148.4644195027067,-6181.5481580867472,-6229.5246072358432,-6292.3937669499883,-6370.1556372291898,-6462.8102180734422,-6570.3575094827484,-6692.7975114571109,-6830.1302239965244,-6982.3556471009815,-7149.4737807705033,-7331.4846250050723,-7528.3881798046987,-7740.184445169376,-7966.8734210991079,-8208.4551075938816,-8464.9295046537209,-8736.2966122786111,-9022.5564304685504,-9323.7089592235498,-9639.7541985435892,-9970.6921484286868,-10316.522808878846,-10677.246179894055,-11052.862261474305,-11443.371053619627,-11848.772556329977,-12269.066769605402,-12704.253693445873,-13154.333327851395,-13619.305672821971,-14099.170728357607,-14593.928494458291,-15103.578971124032,-15628.122158354827,-16167.558056150649,-16721.886664511552,-17291.107983437498,-17875.222012928494,-18474.228752984563,-19088.128203605665,-19716.920364791826,-20360.60523654303,-21019.182818859303,-21692.653111740612,-22381.016115186983,-23084.271829198435,-23802.420253774879,-24535.46138891641,-25283.395234623029,-26046.221790894597],[-22402.765966001134,-21714.379650622002,-21040.886045807929,-20382.285151558917,-19738.576967874957,-19109.761494756051,-18495.838732202203,-17896.808680213384,-17312.671338789631,-16743.426707930943,-16189.074787637293,-15649.615577908709,-15125.04907874516,-14615.375290146674,-14120.594212113239,-13640.705844644859,-13175.710187741541,-12725.607241403251,-12290.397005630042,-11870.079480421868,-11464.654665778749,-11074.122561700689,-10698.483168187686,-10337.73648523973,-9991.8825128568242,-9660.9212510389661,-9344.85269978617,-9043.6768590984302,-8757.3937289757341,-8486.0033094180981,-8229.5056004255093,-7987.9006019979743,-7761.1883141354938,-7549.3687368380706,-7352.4418701056929,-7170.4077139383753,-7003.266268336105,-6851.0175332988874,-6713.6615088267254,-6591.198194919617,-6483.6275915775568,-6390.949698800554,-6313.1645165886048,-6250.2720449417084,-6202.2722838598638,-6169.165233343072,-6150.9508933913303,-6147.6292640046431,-6159.2003451830105,-6185.6641369264307,-6227.0206392349037,-6283.2698521084294,-6354.4117755470088,-6440.4464095506391,-6541.3737541193259,-6657.1938092530581,-6787.9065749518541,-6933.5120512156955,-7094.0102380445896,-7269.401135438542,-7459.6847433975454,-7664.861061921596,-7884.9300910107031,-8119.8918306648684,-8369.7462808840828,-8634.49344166835,-8914.1333130176699,-9208.6658949320445,-9518.0911874114663,-9842.4091904559464,-10181.619904065474,-10535.723328240059,-10904.719462979705,-11288.608308284391,-11687.389864154125,-12101.064130588922,-12529.631107588775,-12973.090795153677,-13431.443193283638,-13904.688301978646,-14392.826121238708,-14895.856651063808,-15413.779891453985,-15946.595842409211,-16494.304503929481,-17056.905876014811,-17634.399958665177,-18226.786751880623,-18834.066255661091,-19456.238470006632,-20093.303394917235,-20745.261030392874,-21412.111376433575,-22093.854433039312,-22790.490200210101,-23502.018677945969,-24228.439866246903,-24969.753765112844,-25725.960374543887,-26497.059694539923],[-22044.517616299599,-21364.404064644914,-20699.18322355525,-20048.855093030666,-19413.419673071148,-18792.876963676666,-18187.226964847236,-17596.469676582881,-17020.605098883563,-16459.6332317493,-15913.554075180069,-15382.367629175909,-14866.073893736811,-14364.672868862761,-13878.164554553756,-13406.548950809809,-12949.826057630908,-12507.99587501707,-12081.05840296828,-11669.013641484542,-11271.861590565852,-10889.602250212229,-10522.235620423653,-10169.761701200117,-9832.1804925416545,-9509.4919944482299,-9201.6962069198671,-8908.7931299565516,-8630.7827635582962,-8367.6651077250899,-8119.4401624569291,-7886.1079277538283,-7667.6684036157794,-7464.1215900427906,-7275.4674870348408,-7101.7060945919538,-6942.8374127141178,-6798.8614414013318,-6669.7781806536022,-6555.5876304709273,-6456.2897908532987,-6371.8846618007301,-6302.3722433132116,-6247.7525353907431,-6208.025538033331,-6183.1912512409717,-6173.2496750136643,-6178.2008093514096,-6198.0446542542086,-6232.7812097220576,-6282.4104757549612,-6346.9324523529212,-6426.3471395159313,-6520.6545372439923,-6629.8546455371088,-6753.947464395279,-6892.9329938185019,-7046.8112338067795,-7215.5821843601043,-7399.2458454784874,-7597.8022171619223,-7811.2512994104072,-8039.5930922239468,-8282.8275956025464,-8540.9548095461887,-8813.9747340548856,-9101.887369128639,-9404.6927147674396,-9722.3907709712912,-10054.981537740208,-10402.465015074167,-10764.841202973188,-11142.110101437254,-11534.271710466379,-11941.326030060567,-12363.273060219784,-12800.112800944065,-13251.845252233396,-13718.470414087786,-14199.98828650722,-14696.39886949171,-15207.702163041253,-15733.898167155861,-16274.986881835532,-16830.96830708022,-17401.84244289,-17987.609289264808,-18588.26884620465,-19203.82111370959,-19834.266091779544,-20479.60378041456,-21139.834179614649,-21814.957289379774,-22504.973109709928,-23209.881640605177,-23929.682882065499,-24664.376834090806,-25413.963496681201,-26178.442869836646,-26957.81495355715],[-21696.186621969966,-21024.345834039712,-20367.397756674516,-19725.342389874364,-19098.179733639277,-18485.90978796922,-17888.532552864228,-17306.048028324269,-16738.456214349389,-16185.757110939556,-15647.950718094777,-15125.03703581505,-14617.016064100369,-14123.887802950754,-13645.652252366175,-13182.309412346665,-12733.859282892196,-12300.301864002789,-11881.637155678423,-11477.865157919125,-11088.985870724868,-10714.999294095673,-10355.905428031525,-10011.70427253243,-9682.3958275983969,-9367.9800932293965,-9068.4570694254671,-8783.8267561865887,-8514.0891535127557,-8259.244261403981,-8019.2920798602609,-7794.2326088815871,-7584.0658484679725,-7388.7917986194116,-7208.4104593358934,-7042.9218306174407,-6892.3259124640335,-6756.6227048756791,-6635.8122078523811,-6529.8944213941359,-6438.8693455009443,-6362.7369801728028,-6301.4973254097149,-6255.1503812116807,-6223.6961475786993,-6207.1346245107707,-6205.4658120078921,-6218.6897100700689,-6246.8063186972995,-6289.8156378895847,-6347.7176676469189,-6420.5124079693087,-6508.1998588567494,-6610.7800203092429,-6728.252892326791,-6860.6184749093918,-7007.876768057049,-7170.0277717697545,-7347.0714860475127,-7539.0079108903265,-7745.8370462981948,-7967.5588922711104,-8204.1734488090788,-8455.6807159121108,-8722.0806935801847,-9003.3733818133169,-9299.5587806114963,-9610.6368899747322,-9936.607709903019,-10277.471240396357,-10633.227481454755,-11003.876433078211,-11389.418095266708,-11789.852468020261,-12205.179551338868,-12635.39934522253,-13080.511849671248,-13540.517064685009,-14015.414990263816,-14505.205626407691,-15009.888973116627,-15529.465030390586,-16063.933798229633,-16613.295276633718,-17177.549465602853,-17756.696365137039,-18350.735975236279,-18959.668295900574,-19583.493327129931,-20222.211068924331,-20875.821521283782,-21544.324684208288,-22227.720557697838,-22926.00914175246,-23639.190436372119,-24367.264441556857,-25110.231157306604,-25868.090583621452,-26640.842720501307,-27428.487567946242],[-21357.772983012241,-20694.2049588064,-20045.529645165625,-19411.747042089908,-18792.857149579278,-18188.859967633631,-17599.755496253078,-17025.543735437575,-16466.224685187117,-15921.798345501706,-15392.264716381364,-14877.623797826061,-14377.875589835827,-13893.020092410645,-13423.057305550485,-12967.987229255408,-12527.809863525366,-12102.525208360395,-11692.133263760466,-11296.634029725599,-10916.02750625577,-10550.31369335101,-10199.492591011292,-9863.5641992366327,-9542.5285180270221,-9236.385547382466,-8945.1352873029628,-8668.7777377885177,-8407.3128988391127,-8160.7407704547695,-7929.0613526354828,-7712.2746453812433,-7510.3806486920566,-7323.3793625679245,-7151.2707870088425,-6994.0549220148223,-6851.7317675858467,-6724.3013237219293,-6611.763590423061,-6514.1185676892464,-6431.3662555204846,-6363.5066539167756,-6310.5397628781211,-6272.4655824045176,-6249.2841124959659,-6240.9953531524734,-6247.5993043740291,-6269.0959661606394,-6305.4853385123006,-6356.7674214290137,-6422.9422149107822,-6504.0097189576036,-6599.9699335694759,-6710.8228587464018,-6836.5684944883833,-6977.2068407954112,-7132.7378976674991,-7303.1616651046388,-7488.4781431068313,-7688.6873316740794,-7903.789230806372,-8133.7838405037273,-8378.6711607661255,-8638.4511915935909,-8913.1239329860909,-9202.6893849436565,-9507.147547466273,-9826.4984205539295,-10160.742004206653,-10509.878298424428,-10873.907303207252,-11252.829018555143,-11646.643444468069,-12055.350580946048,-12478.950427989099,-12917.442985597185,-13370.828253770338,-13839.10623250853,-14322.276921811786,-14820.340321680069,-15333.296432113437,-15861.145253111852,-16403.886784675306,-16961.521026803835,-17534.047979497394,-18121.467642756019,-18723.780016579694,-19340.985100968421,-19973.082895922205,-20620.073401441034,-21281.956617524913,-21958.732544173843,-22650.401181387861,-23356.962529166885,-24078.416587511005,-24814.763356420146,-25566.002835894338,-26332.13502593361,-27113.159926537919,-27909.077537707264],[-21029.276699426398,-20373.981438945011,-19733.578889028664,-19108.069049677382,-18497.451920891144,-17901.727502669961,-17320.895795013836,-16754.956797922758,-16203.910511396733,-15667.756935435753,-15146.496070039848,-14640.127915208983,-14148.652470943172,-13672.069737242417,-13210.379714106704,-12763.582401536045,-12331.677799530456,-11914.665908089899,-11512.546727214412,-11125.320256903966,-10752.986497158581,-10395.545447978246,-10052.997109362965,-9725.3414813127274,-9412.5785638275538,-9114.7083569074275,-8831.7308605523613,-8563.6460747623405,-8310.4539995373743,-8072.1546348774682,-7848.7479807826076,-7640.2340372528006,-7446.6128042880464,-7267.8842818883477,-7104.0484700536999,-6955.1053687840995,-6821.0549780795618,-6701.897297940076,-6597.6323283656411,-6508.2600693562599,-6433.7805209119288,-6374.1936830326549,-6329.4995557184266,-6299.6981389692583,-6284.7894327851391,-6284.7734371660754,-6299.6501521120617,-6329.4195776231045,-6374.0817136991955,-6433.6365603403456,-6508.0841175465448,-6597.4243853177968,-6701.6573636541016,-6820.7830525554582,-6954.8014520218749,-7103.712562053337,-7267.5163826498574,-7446.2129138114287,-7639.8021555380501,-7848.2841078297224,-8071.6587706864548,-8309.9261441082381,-8563.0862280950787,-8831.1390226469593,-9114.0845277638946,-9411.9227434458935,-9724.6536696929397,-10052.277306505039,-10394.793653882192,-10752.202711824393,-11124.504480331649,-11511.698959403968,-11913.786149041331,-12330.766049243754,-12762.638660011227,-13209.40398134375,-13671.062013241328,-14147.612755703951,-14639.056208731628,-15145.39237232437,-15666.621246482158,-16202.742831204981,-16753.75712649287,-17319.664132345846,-17900.463848763851,-18496.1562757469,-19106.741413295014,-19732.219261408165,-20372.589820086363,-21027.853089329634,-21698.009069137959,-22383.057759511321,-23082.999160449748,-23797.833271953219,-24527.560094021777,-25272.179626655343,-26031.691869853981,-26806.096823617663,-27595.394487946403,-28399.584862840187],[-20710.697771212504,-20063.675274455534,-19431.545488263626,-18814.308412636761,-18211.964047574962,-17624.512393078221,-17051.953449146502,-16494.287215779863,-15951.513692978267,-15423.632880741743,-14910.644779070255,-14412.5493879638,-13929.346707422439,-13461.036737446109,-13007.619478034836,-12569.094929188614,-12145.463090907451,-11736.723963191325,-11342.877546040261,-10963.923839454254,-10599.862843433288,-10250.694557977396,-9916.4189830865362,-9597.0361187607414,-9292.5459649999975,-9002.9485218043046,-8728.2437891736699,-8468.4317671080771,-8223.5124556075425,-7993.4858546720661,-7778.3519643016407,-7578.1107844962571,-7392.7623152559399,-7222.3065565806737,-7066.7435084704566,-6926.0731709252932,-6800.2955439451816,-6689.4106275301247,-6593.4184216801204,-6512.3189263951699,-6446.1121416752703,-6394.7980675204244,-6358.3767039306385,-6336.8480509058954,-6330.2121084462078,-6338.4688765515757,-6361.6183552219954,-6399.6605444574661,-6452.5954442579969,-6520.4230546235713,-6603.1433755541993,-6700.7564070498865,-6813.2621491106238,-6940.6606017364093,-7082.9517649272566,-7240.1356386831521,-7412.2122230040995,-7599.1815178901088,-7801.0435233411554,-8017.7982393572656,-8249.4456659384268,-8495.9858030846372,-8757.4186507959057,-9033.7442090722325,-9324.9624779135993,-9631.0734573200243,-9952.0771472915039,-10287.973547828029,-10638.762658929616,-11004.444480596252,-11385.019012827943,-11780.486255624688,-12190.846208986488,-12616.098872913328,-13056.244247405248,-13511.28233246219,-13981.213128084199,-14466.036634271264,-14965.75285102337,-15480.361778340541,-16009.863416222761,-16554.257764670023,-17113.544823682372,-17687.72459325974,-18276.797073402158,-18880.76226410966,-19499.620165382195,-20133.370777219767,-20782.014099622407,-21445.550132590135,-22123.97887612287,-22817.300330220678,-23525.514494883515,-24248.621370111439,-24986.620955904378,-25739.513252262397,-26507.298259185474,-27289.975976673588,-28087.546404726781,-28900.009543345004],[-20402.036198370457,-19763.286465337944,-19139.42944287046,-18530.465130968034,-17936.393529630655,-17357.214638858342,-16792.928458651066,-16243.534989008862,-15709.034229931693,-15189.426181419605,-14684.710843472532,-14194.888216090536,-13719.958299273592,-13259.921093021698,-12814.77659733486,-12384.524812213054,-11969.165737656318,-11568.699373664633,-11183.125720238004,-10812.444777376426,-10456.656545079901,-10115.761023348434,-9789.7582121820124,-9478.6481115806473,-9182.4307215443332,-8901.1060420730737,-8634.6740731668615,-8383.1348148257093,-8146.488267049609,-7924.734429838556,-7717.873303192564,-7525.9048871116156,-7348.82918159573,-7186.6461866448944,-7039.3559022591089,-6906.958328438378,-6789.4534651826989,-6686.8413124920762,-6599.1218703665036,-6526.2951388059846,-6468.3611178105166,-6425.319807380105,-6397.1712075147434,-6383.91531821444,-6385.5521394791813,-6402.0816713089807,-6433.5039137038311,-6479.8188666637361,-6541.0265301886975,-6617.1269042787053,-6708.1199889337695,-6814.0057841538837,-6934.7842899390535,-7070.4555062892778,-7221.0194332045521,-7386.4760706848729,-7566.8254187302591,-7762.0674773406881,-7972.2022465161726,-8197.2297262567135,-8437.1499165623172,-8691.9628174329573,-8961.6684288686556,-9246.2667508694085,-9545.7577834352051,-9860.1415265660689,-10189.417980261978,-10533.587144522942,-10892.649019348955,-11266.603604740027,-11655.450900696147,-12059.190907217322,-12477.823624303548,-12911.34905195483,-13359.767190171182,-13823.078038952543,-14301.281598298992,-14794.377868210491,-15302.366848687034,-15825.248539728627,-16363.022941335284,-16915.690053506991,-17483.249876243764,-18065.702409545571,-18663.047653412417,-19275.285607844336,-19902.416272841314,-20544.439648403324,-21201.355734530393,-21873.164531222545,-22559.866038479719,-23261.460256301951,-23977.947184689241,-24709.326823641575,-25455.599173158967,-26216.764233241418,-26992.822003888919,-27783.772485101472,-28589.615676879104,-29410.351579221715],[-20103.291980900365,-19472.81501159224,-18857.230752849209,-18256.5392046712,-17670.740367058261,-17099.834240010387,-16543.82082352756,-16002.700117609769,-15476.472122257041,-14965.136837469357,-14468.694263246745,-13987.144399589166,-13520.487246496652,-13068.722803969189,-12631.851072006775,-12209.872050609414,-11802.785739777108,-11410.592139509856,-11033.291249807658,-10670.883070670514,-10323.367602098417,-9990.7448440913813,-9673.014796649386,-9370.1774597724489,-9082.2328334605772,-8809.1809177137493,-8551.0217125319723,-8307.7552179152462,-8079.3814338635748,-7865.9003603769561,-7667.3119974553983,-7483.6163450988815,-7314.8134033074248,-7160.903172081019,-7021.8856514196632,-6897.7608413233665,-6788.528741792119,-6694.189352825927,-6614.742674424785,-6550.1887065886958,-6500.5274493176676,-6465.7589026116802,-6445.8830664707539,-6440.899940894873,-6450.8095258840513,-6475.6118214382877,-6515.306827557567,-6569.8945442419026,-6639.3749714912947,-6723.7481093057277,-6823.0139576852271,-6937.1725166297765,-7066.2237861393742,-7210.1677662140282,-7369.0044568537342,-7542.733858058491,-7731.3559698283061,-7934.8707921631694,-8153.2783250630891,-8386.5785685280607,-8634.7715225580887,-8897.8571871531585,-9175.835562313292,-9468.7066480384783,-9776.4704443287064,-10099.126951183996,-10436.676168604339,-10789.118096589729,-11156.452735140185,-11538.680084255684,-11935.800143936229,-12347.812914181843,-12774.718394992506,-13216.516586368218,-13673.20748830899,-14144.791100814788,-14631.26742388568,-15132.636457521598,-15648.898201722572,-16180.052656488597,-16726.099821819698,-17287.039697715802,-17862.872284177029,-18453.597581203263,-19059.215588794548,-19679.72630695091,-20315.129735672286,-20965.425874958746,-21630.614724810264,-22310.696285226826,-23005.670556208403,-23715.537537755088,-24440.29722986681,-25179.949632543583,-25934.494745785407,-26703.932569592296,-27488.2631039642,-28287.486348901191,-29101.60230440327,-29930.610970470319],[-19814.465118802145,-19192.260913218452,-18584.949418199831,-17992.530633746268,-17415.004559857778,-16852.371196534317,-16304.63054377592,-15771.782601582572,-15253.827369954273,-14750.764848891014,-14262.595038392828,-13789.317938459693,-13330.933549091615,-12887.441870288574,-12458.842902050603,-12045.136644377666,-11646.323097269787,-11262.402260726969,-10893.374134749205,-10539.238719336494,-10199.99601448883,-9875.6460202062135,-9566.1887364886588,-9271.6241633361569,-8991.9523007487114,-8727.1731487263096,-8477.2867072689733,-8242.2929763766824,-8022.1919560494389,-7816.9836462872554,-7626.6680470901229,-7451.2451584580413,-7290.7149803910179,-7145.0775128890436,-7014.3327559521213,-6898.4807095802535,-6797.521373773443,-6711.4547485316834,-6640.2808338549721,-6583.9996297433154,-6542.6111361967105,-6516.1153532151584,-6504.5122807986681,-6507.8019189472207,-6525.9842676608278,-6559.0593269394876,-6607.0270967832048,-6669.8875771919747,-6747.6407681657965,-6840.2866697046693,-6947.8252818085912,-7070.256604477574,-7207.5806377116041,-7359.7973815106852,-7526.9068358748282,-7708.9090008040166,-7905.8038762982615,-8117.5914623575591,-8344.2717589819113,-8585.844766171318,-8842.3104839257649,-9113.6689122452735,-9399.9200511298422,-9701.0639005794583,-10017.100460594118,-10348.029731173847,-10693.851712318621,-11054.566404028439,-11430.173806303323,-11820.673919143252,-12226.066742548242,-12646.352276518275,-13081.530521053368,-13531.601476153508,-13996.56514181873,-14476.421518048957,-14971.170604844267,-15480.812402204623,-16005.346910130027,-16544.774128620487,-17099.094057676019,-17668.306697296546,-18252.412047482198,-18851.410108232885,-19465.300879548598,-20094.084361429363,-20737.760553875196,-21396.329456886102,-22069.791070462037,-22758.145394603045,-23461.39242930906,-24179.532174580156,-24912.564630416338,-25660.489796817528,-26423.307673783806,-27201.018261315083,-27993.621559411447,-28801.11756807287,-29623.506287299373,-30460.787717090847],[-19535.555612075816,-18921.624170216561,-18322.58543892239,-17738.439418193266,-17169.186108029193,-16614.825508430164,-16075.357619396194,-15550.782440927274,-15041.099973023409,-14546.310215684591,-14066.413168910836,-13601.408832702122,-13151.297207058476,-12716.07829197988,-12295.752087466324,-11890.31859351783,-11499.777810134388,-11124.12973731599,-10763.374375062669,-10417.51172337438,-10086.541782251144,-9770.4645516929741,-9469.2800316998437,-9182.9882222717679,-8911.5891234087539,-8655.082735110791,-8413.4690573778771,-8186.7480902100142,-7974.9198336072141,-7777.9842875694594,-7595.9414520967575,-7428.7913271891066,-7276.5339128465093,-7139.1692090689685,-7016.6972158564795,-6909.1179332090433,-6816.4313611266589,-6738.6374996093273,-6675.7363486570521,-6627.7279082698269,-6594.6121784476582,-6576.3891591905376,-6573.0588504984662,-6584.6212523714621,-6611.0763648095008,-6652.424187812594,-6708.6647213807419,-6779.7979655139379,-6865.8239202121904,-6966.7425854754956,-7082.5539613038472,-7213.2580476972598,-7358.8548446557288,-7519.3443521792415,-7694.7265702678178,-7885.0014989214287,-8090.1691381401106,-8310.2294879238434,-8545.1825482726181,-8795.0283191864601,-9059.7668006653475,-9339.3979927092805,-9633.9218953182753,-9943.3385084923284,-10267.647832231414,-10606.849866535573,-10960.944611404786,-11329.932066839036,-11713.812232838345,-12112.585109402709,-12526.25069653213,-12954.808994226598,-13398.260002486133,-13856.60372131069,-14329.84015070034,-14817.969290655001,-15320.991141174736,-15838.905702259524,-16371.712973909376,-16919.41295612427,-17482.005648904218,-18059.491052249206,-18651.869166159253,-19259.139990634376,-19881.303525674535,-20518.359771279756,-21170.308727450007,-21837.150394185323,-22518.884771485682,-23215.511859351122,-23927.031657781576,-24653.444166777139,-25394.749386337688,-26150.947316463331,-26922.037957154003,-27708.021308409778,-28508.897370230552,-29324.666142616421,-30155.32762556729,-31000.881819083268],[-19266.563460721383,-18660.904782586585,-18070.138815016846,-17494.265558012143,-16933.285011572501,-16387.197175697889,-15856.002050388359,-15339.699635643856,-14838.289931464435,-14351.772937850057,-13880.148654800736,-13423.417082316446,-12981.578220397232,-12554.632069043066,-12142.578628253941,-11745.41789802988,-11363.149878370867,-10995.774569276909,-10643.291970748007,-10305.702082784155,-9983.00490538536,-9675.200438551612,-9382.2886822829169,-9104.2696365792799,-8841.1433014406994,-8592.9096768671625,-8359.568762858682,-8141.1205594152489,-7937.5650665368776,-7748.9022842235536,-7575.1322124752805,-7416.2548512920675,-7272.2702006739037,-7143.1782606207935,-7028.9790311327388,-6929.6725122097369,-6845.258703851785,-6775.7376060588849,-6721.1092188310395,-6681.3735421682477,-6656.5305760705078,-6646.5803205378206,-6651.5227755701844,-6671.3579411676055,-6706.0858173300812,-6755.7064040576042,-6820.2197013501827,-6899.6257092078085,-6993.9244276304971,-7103.1158566182348,-7227.1999961710226,-7366.1768462888649,-7520.0464069717582,-7688.8086782197079,-7872.4636600327094,-8071.0113524107601,-8284.4517553538735,-8512.7848688620325,-8756.0106929352442,-9014.1292275735104,-9287.1404727768368,-9575.0444285452031,-9877.8410948786313,-10195.530471777111,-10528.112559240637,-10875.587357269229,-11237.954865862861,-11615.215085021551,-12007.368014745287,-12414.413655034095,-12836.352005887935,-13273.183067306838,-13724.906839290798,-14191.52332183979,-14673.032514953868,-15169.434418632974,-15680.729032877147,-16206.916357686358,-16747.996393060639,-17303.96913899995,-17874.834595504333,-18460.592762573753,-19061.243640208275,-19676.787228407811,-20307.223527172362,-20952.552536502026,-21612.774256396733,-22287.888686856466,-22977.895827881279,-23682.795679471128,-24402.588241626021,-25137.273514346009,-25886.851497631003,-26651.322191481071,-27430.685595896211,-28224.941710876366,-29034.090536421609,-29858.13207253188,-30697.066319207253,-31550.893276447576],[-19007.488664738856,-18410.102750328508,-17827.609546483192,-17260.009053202906,-16707.301270487711,-16169.486198337547,-15646.563836752435,-15138.53418573238,-14645.397245277372,-14167.15301538743,-13703.801496062535,-13255.342687302684,-12821.776589107903,-12403.103201478159,-11999.322524413474,-11610.434557913839,-11236.439301979262,-10877.336756609737,-10533.126921805258,-10203.809797565849,-9889.3853838914692,-9589.8536807821638,-9305.214688237902,-9035.4684062586894,-8780.6148348445386,-8540.6539739954387,-8315.5858237113898,-8105.410383992391,-7910.1276548384412,-7729.7376362495552,-7564.2403282257164,-7413.6357307669314,-7277.9238438732036,-7157.1046675445214,-7051.1782017808964,-6960.1444465823224,-6884.003401948803,-6822.7550678803364,-6776.399444376927,-6744.9365314385614,-6728.3663290652512,-6726.6888372569974,-6739.9040560137928,-6768.0119853356482,-6811.0126252225509,-6868.9059756745064,-6941.6920366915165,-7029.3708082735739,-7131.9422904206913,-7249.4064831328633,-7381.7633864100844,-7529.0130002523565,-7691.155324659685,-7868.190359632059,-8060.1181051694984,-8266.9385612719852,-8488.6517279395212,-8725.2576051721189,-8976.7561929697586,-9243.1474913324564,-9524.4315002602088,-9820.6082197530141,-10131.677649810867,-10457.639790433777,-10798.494641621735,-11154.242203374761,-11524.88247569283,-11910.415458575939,-12310.841152024117,-12726.159556037335,-13156.37067061563,-13601.474495758957,-14061.471031467343,-14536.360277740798,-15026.142234579289,-15530.816901982816,-16050.384279951426,-16584.844368485072,-17134.197167583778,-17698.442677247542,-18277.580897476335,-18871.611828270194,-19480.535469629118,-20104.3518215531,-20743.060884042108,-21396.662657096203,-22065.157140715317,-22748.544334899503,-23446.824239648719,-24159.996854963028,-24888.062180842353,-25631.020217286736,-26388.870964296213,-27161.61442187069,-27949.250590010219,-28751.779468714842,-29569.201057984508,-30401.515357819204,-31248.722368218987,-32110.822089183777],[-18758.331224128262,-18169.218073442302,-17594.997633321414,-17035.669903765582,-16491.234884774822,-15961.692576349089,-15447.042978488402,-14947.286091192767,-14462.421914462207,-13992.450448296688,-13537.371692696224,-13097.185647660812,-12671.89231319045,-12261.491689285145,-11865.983775944889,-11485.368573169699,-11119.646080959552,-10768.816299314458,-10432.879228234407,-10111.834867719423,-9805.6832177694814,-9514.4242783846057,-9238.0580495647773,-8976.5845313099999,-8730.0037236202734,-8498.3156264956106,-8281.5202399359878,-8079.6175639414323,-7892.6075985119178,-7720.4903436474597,-7563.2657993480516,-7420.9339656136954,-7293.4948424443992,-7180.9484298401503,-7083.294727800956,-7000.5337363268136,-6932.6654554177294,-6879.6898850736961,-6841.6070252947084,-6818.4168760807806,-6810.1194374319075,-6816.7147093480817,-6838.2026918293122,-6874.5833848755956,-6925.8567884869317,-6992.0229026633197,-7073.0817274047604,-7169.033262711253,-7279.8775085828038,-7405.6144650194037,-7546.244132021051,-7701.7665095877637,-7872.1815977195147,-8057.4893964163284,-8257.6899056781949,-8472.783125505106,-8702.7690558970826,-8947.6476968541119,-9207.4190483761849,-9482.0831104633162,-9771.6398831155038,-10076.089366332733,-10395.431560115023,-10729.666464462369,-11078.794079374757,-11442.814404852204,-11821.727440894705,-12215.533187502253,-12624.231644674859,-13047.822812412523,-13486.306690715232,-13939.683279582998,-14407.95257901582,-14891.114589013692,-15389.169309576613,-15902.116740704587,-16429.956882397615,-16972.689734655702,-17530.315297478832,-18102.833570867024,-18690.244554820289,-19292.548249338557,-19909.744654421906,-20541.833770070298,-21188.815596283763,-21850.690133062279,-22527.457380405824,-23219.117338314456,-23925.67000678811,-24647.115385826844,-25383.45347543063,-26134.684275599422,-26900.807786333309,-27681.82400763224,-28477.732939496207,-29288.534581925254,-30114.228934919309,-30954.81599847848,-31810.295772602694,-32680.668257291909],[-18519.091138889558,-17938.250751928041,-17372.303075531578,-16821.248109700173,-16285.085854433813,-15763.816309732521,-15257.439475596275,-14765.955352025094,-14289.363939018936,-13827.665236577872,-13380.859244701833,-12948.945963390843,-12531.925392644933,-12129.797532464054,-11742.562382848229,-11370.21994379746,-11012.77021531175,-10670.213197391076,-10342.548890035472,-10029.777293244913,-9731.898407019411,-9448.9122313589614,-9180.818766263561,-8927.6180117332115,-8689.3099677679202,-8465.8946343676798,-8257.3720115325032,-8063.7420992623674,-7885.0048975572881,-7721.1604064172579,-7572.2086258422869,-7438.149555832365,-7318.9831963874949,-7214.7095475076749,-7125.3286091929112,-7050.8403814432077,-6991.2448642585523,-6946.5420576389461,-6916.7319615843917,-6901.8145760949028,-6901.7899011704521,-6916.6579368110615,-6946.4186830167218,-6991.0721397874368,-7050.6183071232035,-7125.0571850240249,-7214.3887734898963,-7318.6130725208241,-7437.7300821167992,-7571.7398022778289,-7720.6422330039168,-7884.4373742950556,-8063.1252261512427,-8256.7057885724844,-8465.179061558787,-8688.5450451101296,-8926.8037392265323,-9179.9551439079914,-9447.9992591544978,-9730.9360849660679,-10028.76562134268,-10341.487868284337,-10669.102825791062,-11011.610493862834,-11369.010872499646,-11741.303961701546,-12128.489761468469,-12530.568271800454,-12947.539492697497,-13379.40342415958,-13826.160066186712,-14287.809418778936,-14764.351481936175,-15255.78625565847,-15762.113739945837,-16283.333934798249,-16819.4468402157,-17370.452456198211,-17936.350782745772,-18517.141819858392,-19112.825567536089,-19723.402025778792,-20348.871194586594,-20989.233073959422,-21644.487663897286,-22314.63496440024,-22999.674975468246,-23699.607697101281,-24414.433129299359,-25144.151272062525,-25888.762125390713,-26648.265689283973,-27422.66196374227,-28211.950948765654,-29016.132644354067,-29835.207050507532,-30669.174167226032,-31518.033994509628,-32381.786532358245,-33260.431780771891],[-18289.768409022727,-17717.200785785637,-17159.525873113635,-16616.74367100665,-16088.854179464719,-15575.857398487864,-15077.753328076051,-14594.541968229292,-14126.223318947577,-13672.797380230924,-13234.264152079335,-12810.623634492791,-12401.875827471295,-12008.020731014854,-11629.058345123449,-11264.988669797116,-10915.811705035836,-10581.527450839603,-10262.135907208423,-9957.6370741423034,-9668.0309516412162,-9393.3175397052109,-9133.4968383342439,-8888.5688475283314,-8658.5335672874717,-8443.3909976116647,-8243.1411385009051,-8057.7839899552037,-7887.3195519745595,-7731.7478245589627,-7591.0688077084278,-7465.2825014229265,-7354.3889057024962,-7258.388020547116,-7177.2798459567766,-7111.0643819315019,-7059.7416284712799,-7023.3115855761062,-7001.7742532459897,-6995.1296314809242,-7003.3777202809088,-7026.5185196459443,-7064.5520295760407,-7117.4782500711881,-7185.2971811313837,-7268.0088227566339,-7365.6131749469423,-7478.1102377022999,-7605.5000110227102,-7747.7824949081751,-7904.9576893586936,-8077.0255943742613,-8263.9862099548791,-8465.8395361005569,-8682.5855728112856,-8914.2243200870671,-9160.7557779278977,-9422.179946333792,-9698.4968253047227,-9989.7064148407262,-10295.808714941768,-10616.803725607868,-10952.691446839015,-11303.47187863522,-11669.145020996475,-12049.710873922784,-12445.169437414163,-12855.520711470564,-13280.764696092041,-13720.901391278556,-14175.930797030136,-14645.852913346765,-15130.667740228453,-15630.375277675188,-16144.975525686988,-16674.468484263787,-17218.8541534057,-17778.132533112654,-18352.303623384643,-18941.367424221695,-19545.323935623808,-20164.173157590962,-20797.915090123162,-21446.549733220454,-22110.077086882746,-22788.497151110139,-23481.809925902555,-24190.015411260021,-24913.113607182575,-25651.104513670143,-26403.98813072277,-27171.764458340476,-27954.433496523226,-28751.995245270977,-29564.449704583865,-30391.796874461739,-31234.036754904701,-32091.169345912705,-32963.194647485769,-33850.112659623883],[-18070.363034527796,-17506.068175015142,-16956.666026067571,-16422.156587685029,-15902.539859867527,-15397.815842615115,-14907.984535927704,-14433.045939805394,-13973.000054248127,-13527.846879255894,-13097.586414828733,-12682.218660966608,-12281.743617669546,-11896.161284937531,-11525.471662770586,-11169.674751168679,-10828.770550131821,-10502.759059660018,-10191.640279753279,-9895.4142104115745,-9614.0808516349425,-9347.6402034233615,-9096.0922657768187,-8859.4370386953415,-8637.6745221789206,-8430.8047162275361,-8238.8276208412135,-8061.7432360199464,-7899.5515617637357,-7752.2525980725659,-7619.8463449464571,-7502.332802385401,-7399.7119703893968,-7311.9838489584399,-7239.1484380925431,-7181.205737791699,-7138.1557480559077,-7109.9984688851646,-7096.7339002794843,-7098.3620422388422,-7114.8828947632646,-7146.2964578527371,-7192.6027315072579,-7253.8017157268405,-7329.8934105114677,-7420.8778158611567,-7526.7549317758931,-7647.5247582556822,-7783.1872953005259,-7933.7425429104205,-8099.1905010853643,-8279.5311698253645,-8474.7645491304211,-8684.8906390005322,-8909.9094394356889,-9149.8209504358965,-9404.6251720011642,-9674.3221041314901,-9958.9117468268596,-10258.394100087276,-10572.769163912773,-10902.036938303292,-11246.197423258876,-11605.250618779519,-11979.196524865194,-12368.035141515935,-12771.766468731741,-13190.390506512593,-13623.907254858503,-14072.316713769451,-14535.618883245441,-15013.813763286511,-15506.901353892619,-16014.881655063784,-16537.754666800007,-17075.52038910129,-17628.178821967609,-18195.729965398998,-18778.17381939543,-19375.510383956906,-19987.739659083447,-20614.861644775017,-21256.876341031653,-21913.783747853369,-22585.583865240114,-23272.276693191918,-23973.862231708765,-24690.340480790685,-25421.711440437648,-26167.975110649662,-26929.131491426713,-27705.180582768844,-28496.122384675997,-29301.956897148237,-30122.684120185528,-30958.304053787855,-31808.816697955233,-32674.222052687663,-33554.520117985179,-34449.710893847681],[-17860.875015404788,-17304.852919616584,-16763.72353439343,-16237.486859735305,-15726.142895642261,-15229.691642114243,-14748.133099151299,-14281.467266753412,-13829.694144920568,-13392.813733652771,-12970.826032950032,-12563.731042812344,-12171.528763239719,-11794.219194232141,-11431.802335789611,-11084.278187912136,-10751.646750599721,-10433.908023852346,-10131.062007670032,-9843.1087020527666,-9570.048107000559,-9311.8802225134168,-9068.6050485913074,-8840.222585234249,-8626.7328324422597,-8428.1357902153177,-8244.4314585534303,-8075.619837456592,-7921.7009269248065,-7782.6747269580692,-7658.5412375563928,-7549.3004587197656,-7454.9523904481903,-7375.4970327416722,-7310.9343856002088,-7261.2644490237908,-7226.4872230124292,-7206.6027075661204,-7201.6109026848681,-7211.5118083686611,-7236.3054246175179,-7275.9917514314175,-7330.5707888103698,-7400.0425367543867,-7484.4069952634363,-7583.6641643375606,-7697.8140439767212,-7826.8566341809437,-7970.7919349502226,-8129.619946284547,-8303.3406681839351,-8491.9541006483632,-8695.4602436778478,-8913.8590972723887,-9147.1506614319824,-9395.3349361566179,-9658.4119214463244,-9936.3816173010819,-10229.244023720874,-10536.999140705726,-10859.646968255647,-11197.18750637059,-11549.620755050597,-11916.946714295695,-12299.1653841058,-12696.276764480983,-13108.280855421195,-13535.177656926489,-13976.96716899682,-14433.649391632202,-14905.224324832641,-15391.691968598145,-15893.052322928675,-16409.30538782429,-16940.45116328491,-17486.489649310621,-18047.42084590139,-18623.244753057192,-19213.961370778066,-19819.570699063981,-20440.072737914954,-21075.46748733097,-21725.754947312045,-22390.935117858178,-23071.007998969362,-23765.973590645583,-24475.831892886883,-25200.582905693213,-25940.2266290646,-26694.763063001046,-27464.192207502558,-28248.514062569098,-29047.728628200712,-29861.835904397369,-30690.835891159033,-31534.728588485836,-32393.513996377675,-33267.192114834521,-34155.762943856411,-35059.226483443403],[-17661.304351653682,-17113.55501958988,-16580.698398091168,-16062.734487157486,-15559.663286788882,-15071.484796985294,-14598.199017746769,-14139.80594907331,-13696.305590964899,-13267.69794342153,-12853.983006443241,-12455.160780029981,-12071.231264181786,-11702.194458898635,-11348.050364180537,-11008.79898002749,-10684.440306439512,-10374.974343416568,-10080.40109095869,-9800.7205490658616,-9535.9327177380837,-9286.0375969753641,-9051.0351867776862,-8830.9254871450721,-8625.7084980775035,-8435.3842195749949,-8259.9526516375336,-8099.4137942651278,-7953.7676474577784,-7823.0142112154754,-7707.1534855382324,-7606.185470426035,-7520.1101658788957,-7448.9275718968129,-7392.6376884797683,-7351.2405156277891,-7324.736053340861,-7313.1243016189819,-7316.4052604621575,-7334.5789298703876,-7367.6453098436687,-7415.6044003820043,-7478.4562014853909,-7556.2007131538339,-7648.8379353873306,-7756.3678681858728,-7878.7905115494777,-8016.1058654781282,-8168.313929971835,-8335.4147050306001,-8517.4081906544088,-8714.2943868432649,-8926.0732935971864,-9152.7449109161535,-9394.3092388001933,-9650.7662772492549,-9922.1160262633857,-10208.358485842571,-10509.493655986795,-10825.521536696097,-11156.442127970429,-11502.255429809829,-11862.961442214273,-12238.560165183788,-12629.051598718321,-13034.435742817954,-13454.712597482603,-13889.882162712311,-14339.94443850706,-14804.899424866888,-15284.74712179175,-15779.487529281685,-16289.120647336662,-16813.646475956692,-17353.065015141794,-17907.376264891915,-18476.580225207101,-19060.676896087341,-19659.666277532633,-20273.548369542976,-20902.323172118387,-21545.990685258817,-22204.550908964367,-22878.00384323491,-23566.349488070511,-24269.587843471163,-24987.718909436866,-25720.742685967642,-26468.659173063475,-27231.468370724411,-28009.170278950281,-28801.764897741283,-29609.252227097313,-30431.632267018409,-31268.905017504556,-32121.070478555783,-32988.128650171966,-33870.079532353302,-34766.923125099645,-35678.659428411025],[-17471.651043274462,-16932.17447493512,-16407.590617160829,-15897.899469951586,-15403.101033307383,-14923.195307228239,-14458.18229171416,-14008.06198676512,-13572.834392381141,-13152.499508562216,-12747.057335308338,-12356.507872619532,-11980.851120495758,-11620.087078937036,-11274.21574794337,-10943.23712751476,-10627.151217651204,-10325.958018352698,-10039.657529619242,-9768.2497514508541,-9511.7346838475059,-9270.1123268092124,-9043.3826803359716,-8831.5457444277927,-8634.6015190846592,-8452.5500043065804,-8285.3912000935488,-8133.1251064455664,-7995.7517233626504,-7873.2710508447853,-7765.683088891964,-7672.9878375042063,-7595.1852966814904,-7532.2754664238364,-7484.2583467312297,-7451.1339376036794,-7432.9022390411883,-7429.5632510437417,-7441.1169736113461,-7467.563406744006,-7508.9025504417259,-7565.1344047044895,-7636.2589695323049,-7722.2762449251832,-7823.186230883106,-7938.9889274060852,-8069.6843344941153,-8215.272452147201,-8375.7532803653448,-8551.1268191485233,-8741.393068496769,-8946.5520284100712,-9166.6036988884189,-9401.5480799318175,-9651.3851715402707,-9916.1149737137821,-10195.737486452344,-10490.252709755958,-10799.660643624617,-11123.961288058339,-11463.154643057114,-11817.240708620946,-12186.219484749809,-12570.09097144376,-12968.855168702734,-13382.512076526764,-13811.061694915856,-14254.504023870006,-14712.839063389205,-15186.066813473451,-15674.187274122742,-16177.200445337105,-16695.106327116493,-17227.904919460983,-17775.596222370514,-18338.180235845048,-18915.656959884673,-19508.026394489352,-20115.288539659072,-20737.443395393857,-21374.490961693708,-22026.431238558558,-22693.264225988511,-23374.989923983514,-24071.608332543554,-24783.119451668645,-25509.523281358786,-26250.819821613986,-27007.009072434259,-27778.091033819561,-28564.065705769906,-29364.933088285317,-30180.693181365823,-31011.345985011321,-31856.891499221914,-32717.329723997522,-33592.660659338188,-34482.884305243912,-35388.000661714694,-36308.009728750541],[-17291.915090267139,-16760.711285652244,-16244.400191602368,-15742.981808117554,-15256.456135197788,-14784.823172843082,-14328.08292105343,-13886.235379828833,-13459.280549169283,-13047.218429074786,-12650.049019545339,-12267.772320580956,-11900.388332181628,-11547.897054347339,-11210.2984870781,-10887.592630373923,-10579.779484234808,-10286.859048660721,-10008.831323651715,-9745.6963092077458,-9497.4540053288256,-9264.1044120149745,-9045.6475292661617,-8842.0833570823997,-8653.4118954637124,-8479.6331444100542,-8320.7471039214615,-8176.753773997918,-8047.6531546394326,-7933.4452458459928,-7834.1300476176139,-7749.7075599542723,-7680.1777828559943,-7625.5407163227783,-7585.7963603546095,-7560.9447149514817,-7550.985780113414,-7555.9195558404035,-7575.7460421324395,-7610.4652389895309,-7660.0771464116806,-7724.5817643988776,-7803.9790929511364,-7898.2691320684389,-8007.4518817507978,-8131.5273419982077,-8270.4955128106703,-8424.3563941881803,-8593.1099861307521,-8776.7562886383694,-8975.2953017110431,-9188.7270253487823,-9417.0514595515615,-9660.2686043193862,-9918.3784596522819,-10191.381025550214,-10479.276302013213,-10782.064289041264,-11099.744986634352,-11432.318394792506,-11779.784513515711,-12142.143342803978,-12519.394882657285,-12911.539133075637,-13318.576094059057,-13740.505765607541,-14177.328147721057,-14629.043240399631,-15095.651043643244,-15577.151557451916,-16073.54478182566,-16584.830716764474,-17111.009362268291,-17652.080718337209,-18208.044784971138,-18778.901562170118,-19364.651049934197,-19965.293248263286,-20580.828157157455,-21211.255776616643,-21856.57610664091,-22516.789147230251,-23191.894898384628,-23881.893360104033,-24586.78453238849,-25306.56841523802,-26041.245008652622,-26790.814312632239,-27555.2763271769,-28334.631052286692,-29128.878487961418,-29938.018634201282,-30762.051491006234,-31600.977058376149,-32454.795336311181,-33323.506324811249,-34207.110023876317,-35105.606433506538,-36018.995553701752,-36947.277384461973],[-17122.096492631732,-16599.165451741253,-16091.127121415828,-15597.98150165544,-15119.728592460115,-14656.368393829833,-14207.900905764622,-13774.326128264445,-13355.644061329333,-12951.854704959269,-12562.958059154247,-12188.954123914296,-11829.842899239382,-11485.62438512954,-11156.298581584731,-10841.86548860499,-10542.325106190299,-10257.677434340645,-9987.9224730560709,-9733.0602223365313,-9493.0906821820463,-9268.0138525926195,-9057.829733568251,-8862.5383251089206,-8682.1396272146485,-8516.6336398854382,-8366.0203631212789,-8230.2997969221651,-8109.4719412881068,-8003.5367962190967,-7912.494361715153,-7836.3446377762475,-7775.0876244024021,-7728.723321593603,-7697.2517293498686,-7680.6728476711833,-7678.9866765575425,-7692.19321600896,-7720.2924660254321,-7763.2844266069569,-7821.1690977535318,-7893.9464794651612,-7981.6165717418517,-8084.1793745835885,-8201.634887990378,-8333.983111962214,-8481.2240464991137,-8643.3576916010534,-8820.3840472680586,-9012.3031135001129,-9219.1148902972127,-9440.8193776593762,-9677.416575586587,-9928.9064840788506,-10195.28910313618,-10476.564432758547,-10772.732472945958,-11083.793223698445,-11409.746685015976,-11750.592856898547,-12106.331739346188,-12476.963332358877,-12862.487635936621,-13262.904650079417,-13678.214374787252,-14108.416810060182,-14553.511955898124,-15013.499812301123,-15488.380379269172,-15978.153656802293,-16482.819644900461,-17002.378343563687,-17536.829752791964,-18086.173872585256,-18650.41070294366,-19229.540243867072,-19823.562495355553,-20432.477457409113,-21056.285130027693,-21694.98551321133,-22348.578606960036,-23017.064411273765,-23700.442926152566,-24398.714151596425,-25111.878087605342,-25839.934734179318,-26582.884091318323,-27340.726159022379,-28113.4609372915,-28901.088426125672,-29703.608625524888,-30521.02153548917,-31353.327156018495,-32200.525487112893,-33062.616528772327,-33939.60028099687,-34831.476743786334,-35738.245917140979,-36659.907801060574,-37596.462395545292],[-16962.195250368241,-16447.536973202179,-15947.77140660119,-15462.898550565227,-14992.918405094339,-14537.830970188494,-14097.636245847709,-13672.334232071949,-13261.924928861263,-12866.408336215642,-12485.784454135061,-12120.053282619534,-11769.214821669058,-11433.269071283636,-11112.216031463267,-10806.055702207957,-10514.788083517697,-10238.413175392485,-9976.9309778323277,-9730.3414908372179,-9498.6447144071717,-9281.8406485421765,-9079.9292932422268,-8892.9106485073353,-8720.7847143375002,-8563.551490732716,-8421.2109776929865,-8293.7631752183061,-8181.2080833086875,-8083.5457019641071,-8000.7760311845886,-7932.8990709701202,-7879.9148213207072,-7841.8232822363461,-7818.6244537170314,-7810.3183357627768,-7816.9049283735749,-7838.3842315494203,-7874.7562452903312,-7926.0209695962867,-7992.1784044673004,-8073.2285499033605,-8169.1714059044662,-8280.0069724706445,-8405.7352496018684,-8546.3562372981414,-8701.8699355594636,-8872.2763443858439,-9057.5754637772789,-9257.7672937337557,-9472.8518342552961,-9702.8290853418839,-9947.6990469935336,-10207.461719210232,-10482.117101991975,-10771.665195338777,-11076.105999250638,-11395.43951372755,-11729.665738769512,-12078.784674376519,-12442.796320548598,-12821.700677285704,-13215.497744587889,-13624.187522455115,-14047.770010887403,-14486.245209884721,-14939.613119447113,-15407.873739574545,-15891.027070267046,-16389.073111524573,-16902.011863347183,-17429.843325734837,-17972.56749868752,-18530.184382205287,-19102.693976288101,-19690.096280935963,-20292.391296148882,-20909.579021926824,-21541.659458269867,-22188.632605177962,-22850.498462651078,-23527.257030689223,-24218.908309292492,-24925.452298460761,-25646.888998194103,-26383.218408492503,-27134.440529355932,-27900.555360784434,-28681.56290277798,-29477.463155336605,-30288.25611846026,-31113.941792148929,-31954.520176402701,-32809.99127122153,-33680.355076605381,-34565.611592554334,-35465.76081906831,-36380.802756147328,-37310.737403791398,-38255.564762000533],[-16812.211363476632,-16305.825850034988,-15814.333047158429,-15337.732954846915,-14876.02557310044,-14429.210901919036,-13997.288941302677,-13580.259691251358,-13178.123151765114,-12790.879322843906,-12418.528204487764,-12061.069796696665,-11718.504099470631,-11390.831112809639,-11078.050836713715,-10780.163271182824,-10497.168416216993,-10229.066271816209,-9975.8568379804856,-9737.5401147098255,-9514.1161020041982,-9305.5847998636345,-9111.9462082881273,-8933.2003272776601,-8769.3471568322639,-8620.3866969519022,-8486.3189476366006,-8367.1439088863535,-8262.8615807011647,-8173.4719630810214,-8098.9750560259272,-8039.3708595358949,-7994.6593736109171,-7964.8405982509757,-7949.914533456109,-7949.8811792262877,-7964.7405355615138,-7994.4926024617962,-8039.1373799271341,-8098.6748679575176,-8173.1050665529565,-8262.4279757134482,-8366.6435954389999,-8485.751925729608,-8619.7529665852508,-8768.6467180059444,-8932.43317999172,-9111.1123525425246,-9304.6842356583948,-9513.148829339314,-9736.5061335852915,-9974.7561483962963,-10227.898873772379,-10495.934309713508,-10778.862456219696,-11076.683313290927,-11389.396880927226,-11717.003159128551,-12059.502147894942,-12416.893847226398,-12789.178257122887,-13176.355377584454,-13578.425208611065,-13995.387750202719,-14427.243002359415,-14873.990965081202,-15335.63163836801,-15812.165022219877,-16303.591116636799,-16809.909921618761,-17331.121437165806,-17867.225663277881,-18418.222599955025,-18984.112247197198,-19564.89460500444,-20160.569673376722,-20771.137452314091,-21396.597941816501,-22036.951141883932,-22692.197052516458,-23362.33567371402,-24047.367005476597,-24747.29104780429,-25462.10780069702,-26191.817264154779,-26936.419438177603,-27695.914322765486,-28470.30191791839,-29259.582223636397,-30063.75523991941,-30882.820966767475,-31716.779404180619,-32565.630552158858,-33429.374410702112,-34308.010979810366,-35201.540259483765,-36109.96224972215,-37033.276950525629,-37971.484361894174,-38924.584483827653],[-16672.144831956903,-16174.032082239743,-15690.812043087588,-15222.484714500488,-14769.05009647847,-14330.508189021491,-13906.858992129561,-13498.102505802679,-13104.238730040848,-12725.267664844099,-12361.189310212372,-12012.003666145698,-11677.710732644104,-11358.310509707542,-11053.802997336039,-10764.188195529581,-10489.466104288196,-10229.636723611839,-9984.7000535005463,-9754.6560939543124,-9539.5048449731275,-9339.2463065569882,-9153.8804787059125,-8983.4073614198842,-8827.826954698905,-8687.1392585429912,-8561.3442729521139,-8450.4419979263039,-8354.4324334655466,-8273.3155795698258,-8207.0914362391813,-8155.7600034735751,-8119.3212812730108,-8097.775269637521,-8091.121968567074,-8099.3613780616815,-8122.493498121341,-8160.5183287460486,-8213.4358699358254,-8281.2461216906413,-8363.9490840105136,-8461.5447568954405,-8574.0331403454165,-8701.4142343604508,-8843.6880389405269,-9000.8545540856685,-9172.9137797958465,-9359.8657160711027,-9561.7103629114026,-9778.4477203167517,-10010.077788287148,-10256.600566822588,-10518.016055923104,-10794.324255588665,-11085.525165819279,-11391.618786614945,-11712.605117975663,-12048.484159901447,-12399.255912392255,-12764.920375448155,-13145.477549069066,-13540.927433255065,-13951.270028006098,-14376.50533332218,-14816.633349203325,-15271.654075649525,-15741.567512660777,-16226.373660237086,-16726.072518378445,-17240.664087084835,-17770.148366356298,-18314.525356192822,-18873.795056594383,-19447.957467560991,-20037.012589092679,-20640.960421189404,-21259.800963851187,-21893.534217077999,-22542.160180869891,-23205.678855226819,-23884.090240148813,-24577.39433563585,-25285.591141687961,-26008.680658305129,-26746.662885487305,-27499.537823234554,-28267.305471546882,-29049.96583042424,-29847.518899866656,-30659.964679874145,-31487.303170446619,-32329.534371584181,-33186.658283286808,-34058.674905554479,-34945.584238387244,-35847.386281785017,-36764.081035747855,-37695.668500275744,-38642.148675368691,-39603.521561026682],[-16541.995655809103,-16052.155669816359,-15577.208394388657,-15117.153829525978,-14671.991975228389,-14241.72283149585,-13826.346398328351,-13425.862675725897,-13040.271663688512,-12669.573362216184,-12313.767771308892,-11972.854890966644,-11646.834721189476,-11335.707261977357,-11039.472513330275,-10758.130475248252,-10491.681147731284,-10240.12453077938,-10003.460624392508,-9781.6894285707058,-9574.8109433139489,-9382.8251686222466,-9205.732104495597,-9043.5317509339984,-8896.2241079374598,-8763.8091755059631,-8646.2869536395301,-8543.6574423381498,-8455.9206416018205,-8383.0765514305349,-8325.1251718243093,-8282.0665027831383,-8253.9005443070255,-8240.6272963959564,-8242.2467590499346,-8258.7589322689746,-8290.1638160530638,-8336.4614104022148,-8397.6517153164168,-8473.7347307956588,-8564.71045683997,-8670.5788934493175,-8791.3400406237306,-8926.9938983631928,-9077.5404666677059,-9242.9797455372864,-9423.3117349718959,-9618.5364349715855,-9828.6538455363007,-10053.663966666079,-10293.566798360907,-10548.362340620803,-10818.05059344574,-11102.631556835728,-11402.10523079077,-11716.471615310851,-12045.730710396032,-12389.882516046238,-12748.927032261474,-13122.864259041799,-13511.694196387163,-13915.416844297581,-14334.032202773025,-14767.540271813557,-15215.94105141914,-15679.234541589763,-16157.420742325439,-16650.49965362619,-17158.47127549196,-17681.335607922814,-18219.092650918679,-18771.742404479643,-19339.284868605631,-19921.720043296686,-20519.047928552813,-21131.268524373932,-21758.381830760147,-22400.387847711434,-23057.286575227728,-23729.078013309103,-24415.762161955499,-25117.33902116699,-25833.808590943532,-26565.170871285096,-27311.42586219174,-28072.573563663434,-28848.61397570018,-29639.547098301948,-30445.372931468846,-31266.091475200701,-32101.702729497621,-32952.206694359644,-33817.603369786702,-34697.892755778841,-35593.074852335965,-36503.149659458184,-37428.117177145439,-38367.977405397804,-39322.73034421519,-40292.375993597612],[-16421.763835033202,-15940.196612764865,-15473.52210106161,-15021.740299923355,-14584.851209350192,-14162.854829342084,-13755.751159899028,-13363.540201021024,-12986.221952708049,-12623.796414960143,-12276.263587777292,-11943.623471159497,-11625.876065106757,-11323.02136961906,-11035.059384696408,-10761.990110338826,-10503.813546546287,-10260.529693318807,-10032.138550656369,-9818.6401185589966,-9620.0343970266731,-9436.3213860594078,-9267.5010856571862,-9113.5734958200374,-8974.5386165479176,-8850.3964478408561,-8741.1469896988492,-8646.7902421219005,-8567.3262051099955,-8502.7548786631596,-8453.0762627813529,-8418.2903574646061,-8398.397162712934,-8393.3966785262892,-8403.2889049047135,-8428.0738418481851,-8467.7514893567131,-8522.3218474302812,-8591.7849160689111,-8676.1406952725902,-8775.3891850413347,-8889.5303853751175,-9018.5642962739694,-9162.4909177378613,-9321.310249766806,-9495.0222923608017,-9683.6270455198501,-9887.1245092439622,-10105.514683533129,-10338.79756838735,-10586.973163806615,-10850.041469790915,-11128.002486340292,-11420.856213454703,-11728.602651134184,-12051.241799378717,-12388.773658188311,-12741.198227562949,-13108.515507502614,-13490.725498007363,-13887.828199077179,-14299.823610712005,-14726.711732911901,-15168.492565676865,-15625.166109006866,-16096.732362901937,-16583.191327362038,-17084.543002387203,-17600.78738797742,-18131.92448413268,-18677.954290853006,-19238.876808138375,-19814.692035988825,-20405.399974404314,-21011.00062338484,-21631.493982930406,-22266.880053041074,-22917.158833716785,-23582.330324957511,-24262.39452676331,-24957.351439134189,-25667.201062070053,-26391.943395571019,-27131.578439637065,-27886.106194268119,-28655.526659464238,-29439.839835225423,-30239.045721551629,-31053.144318442901,-31882.135625899238,-32726.019643920663,-33584.79637250708,-34458.46581165852,-35347.02796137509,-36250.482821656668,-37168.83039250334,-38102.070673915063,-39050.203665891786,-40013.229368433625,-40991.147781540414],[-16311.449369629201,-15838.154911085296,-15379.753163106452,-14936.244125692663,-14507.627798843907,-14093.904182560231,-13695.073276841611,-13311.13508168802,-12942.08959709949,-12587.936823076023,-12248.676759617614,-11924.309406724227,-11614.834764395924,-11320.252832632665,-11040.563611434451,-10775.767100801297,-10525.863300733188,-10290.852211230142,-10070.733832292146,-9865.5081639191994,-9675.1752061113166,-9499.7349588684738,-9339.1874221906728,-9193.5325960779446,-9062.7704805302819,-8946.9010755476447,-8845.9243811300712,-8759.8403972775523,-8688.6491239900861,-8632.3505612676709,-8590.9447091103102,-8564.4315675180042,-8552.811136490749,-8556.0834160285394,-8574.2484061313935,-8607.3061067992858,-8655.2565180322435,-8718.0996398302541,-8795.8354721933174,-8888.4640151214353,-8995.9852686145932,-9118.3992326728185,-9255.7059072960856,-9407.9052924844218,-9574.9973882377981,-9756.9821945562289,-9953.8597114397089,-10165.629938888256,-10392.292876901851,-10633.848525480493,-10890.296884624189,-11161.637954332942,-11447.871734606737,-11748.998225445601,-12065.017426849501,-12395.929338818458,-12741.733961352485,-13102.431294451553,-13478.02133811567,-13868.504092344834,-14273.879557139069,-14694.147732498359,-15129.308618422672,-15579.362214912077,-16044.308521966492,-16524.147539586,-17018.87926777055,-17528.503706520132,-18053.02085583478,-18592.430715714479,-19146.733286159266,-19715.928567169045,-20300.016558743911,-20898.997260883814,-21512.870673588804,-22141.636796858838,-22785.295630693909,-23443.847175094015,-24117.291430059209,-24805.628395589411,-25508.858071684714,-26226.980458345053,-26959.995555570429,-27707.9033633609,-28470.703881716385,-29248.39711063695,-30040.983050122522,-30848.461700173189,-31670.8330607889,-32508.097131969669,-33360.253913715438,-34227.303406026338,-35109.245608902253,-36006.080522343247,-36917.8081463493,-37844.428480920309,-38785.941526056471,-39742.347281757648,-40713.645748023911,-41699.836924855168],[-16211.0522595971,-15746.030564777631,-15295.901580523223,-14860.665306833858,-14440.321743709557,-14034.870891150298,-13644.312749156099,-13268.647317726945,-12907.87459686285,-12561.9945865638,-12231.007286829825,-11914.912697660884,-11613.710819056994,-11327.401651018166,-11055.9851935444,-10799.461446635665,-10557.830410291994,-10331.092084513381,-10119.246469299807,-9922.2935646512888,-9740.2333705678393,-9573.0658870494226,-9420.7911140960678,-9283.4090517077675,-9160.91969988452,-9053.3230586263307,-8960.619127933187,-8882.8079078050996,-8819.8893982420541,-8771.8635992440759,-8738.730510811145,-8720.4901329432687,-8717.1424656404488,-8728.6875089026744,-8755.1252627299509,-8796.4557271222911,-8852.6789020796678,-8923.7947876021099,-9009.8033836896138,-9110.7046903421542,-9226.4987075597492,-9357.1854353424023,-9502.7648736901065,-9663.2370226028615,-9838.6018820806785,-10028.859452123543,-10234.009732731462,-10454.05272390442,-10688.988425642461,-10938.816837945535,-11203.537960813665,-11483.151794246833,-11777.658338245064,-12087.057592808354,-12411.349557936705,-12750.534233630086,-13104.611619888528,-13473.581716712039,-13857.444524100589,-14256.200042054188,-14669.848270572851,-15098.389209656561,-15541.822859305335,-16000.149219519157,-16473.368290298018,-16961.480071641941,-17464.484563550915,-17982.381766024933,-18515.171679064028,-19062.854302668165,-19625.429636837333,-20202.897681571572,-20795.258436870885,-21402.511902735234,-22024.658079164612,-22661.696966159056,-23313.628563718594,-23980.452871843139,-24662.169890532743,-25358.779619787405,-26070.282059607147,-26796.677209991896,-27537.965070941733,-28294.145642456613,-29065.218924536501,-29851.18491718149,-30652.043620391538,-31467.795034166622,-32298.439158506757,-33143.975993411965,-34004.405538882173,-34879.727794917526,-35769.942761517857,-36675.050438683276,-37595.050826413681,-38529.943924709267,-39479.729733569817,-40444.408252995454,-41423.97948298612,-42418.443423541845],[-16120.572504936887,-15663.823573841833,-15221.967353311882,-14795.003843346942,-14382.933043947065,-13985.754955112239,-13603.469576842479,-13236.076909137772,-12883.576951998099,-12545.969705423484,-12223.255169413922,-11915.433343969424,-11622.504229089975,-11344.467824775569,-11081.324131026227,-10833.073147841935,-10599.714875222697,-10381.249313168508,-10177.676461679372,-9988.9963207552973,-9815.2088903962576,-9656.3141706022943,-9512.3121613733674,-9383.2028627095006,-9268.9862746106919,-9169.6623970769124,-9085.2312301082166,-9015.6927737045407,-8961.047027865945,-8921.2939925923965,-8896.4336678838881,-8886.4660537404507,-8891.3911501620642,-8911.2089571487268,-8945.919474700444,-8995.5227028171976,-9060.0186414990185,-9139.4072907458831,-9233.6886505578277,-9342.8627209348051,-9466.9295018768171,-9605.8889933838964,-9759.7411954560448,-9928.4861080932387,-10112.12373129548,-10310.654065062763,-10524.077109395117,-10752.392864292515,-10995.601329754987,-11253.702505782483,-11526.696392375048,-11814.582989532648,-12117.362297255335,-12435.034315543042,-12767.599044395807,-13115.056483813631,-13477.406633796518,-13854.64949434445,-14246.785065457449,-14653.813347135487,-15075.734339378545,-15512.548042186707,-15964.254455559891,-16430.853579498151,-16912.345414001466,-17408.729959069802,-17920.00721470319,-18446.177180901665,-18987.239857665169,-19543.195244993767,-20114.043342887377,-20699.784151346048,-21300.417670369752,-21915.943899958533,-22546.362840112364,-23191.674490831239,-23851.878852115209,-24526.975923964201,-25216.965706378214,-25921.848199357315,-26641.623402901467,-27376.291317010662,-28125.851941684952,-28890.305276924279,-29669.651322728627,-30463.890079098019,-31273.021546032462,-32097.045723531992,-32935.962611596609,-33789.772210226212,-34658.474519420837,-35542.069539180637,-36440.557269505356,-37353.93771039525,-38282.210861850122,-39225.376723870038,-40183.435296455064,-41156.386579605103,-42144.230573320267,-43146.967277600343],[-16040.01010564858,-15591.533938277968,-15157.950481472433,-14739.259735231944,-14335.461699556499,-13946.5563744461,-13572.54375990076,-13213.423855920488,-12869.196662505245,-12539.862179655065,-12225.420407369947,-11925.87134564987,-11641.21499449484,-11371.451353904882,-11116.580423879972,-10876.602204420098,-10651.516695525297,-10441.323897195551,-10246.023809430848,-10065.616432231191,-9900.1017655965916,-9749.4798095270598,-9613.7505640225572,-9492.9140290831238,-9386.9702047087449,-9295.9190908994133,-9219.760687655129,-9158.4949949758957,-9112.1220128617169,-9080.6417413126055,-9064.0541803285378,-9062.3593299095301,-9075.5571900555515,-9103.6477607666529,-9146.6310420427999,-9204.5070338840014,-9277.2757362902485,-9364.9371492615446,-9467.4912727979063,-9584.938106899328,-9717.2776515657788,-9864.5099067972951,-10026.634872593859,-10203.652548955488,-10395.562935882148,-10602.366033373883,-10824.061841430668,-11060.650360052507,-11312.131589239378,-11578.505528991314,-11859.772179308315,-12155.931540190359,-12466.983611637454,-12792.928393649596,-13133.765886226814,-13489.496089369062,-13860.119003076372,-14245.634627348754,-14646.042962186162,-15061.344007588626,-15491.537763556153,-15936.624230088708,-16396.60340718634,-16871.475294849042,-17361.23989307677,-17865.897201869557,-18385.44722122739,-18919.889951150286,-19469.225391638218,-20033.453542691226,-20612.57440430926,-21206.587976492381,-21815.49425924052,-22439.29325255374,-23077.984956431996,-23731.569370875332,-24400.046495883704,-25083.416331457105,-25781.678877595572,-26494.834134299119,-27222.882101567688,-27965.822779401322,-28723.656167799993,-29496.382266763743,-30284.001076292545,-31086.512596386397,-31903.916827045308,-32736.21376826919,-33583.40342005821,-34445.485782412296,-35322.460855331396,-36214.32863881559,-37121.089132864785,-38042.742337479067,-38979.288252658385,-39930.726878402762,-40897.058214712146,-41878.282261586632,-42874.399019026212,-43885.408487030771],[-15969.365061732184,-15529.161658086006,-15103.850965004891,-14693.432982488834,-14297.907710537818,-13917.275149151857,-13551.535298330955,-13200.688158075107,-12864.733728384308,-12543.672009258549,-12237.503000697849,-11946.226702702215,-11669.843115271635,-11408.3522384061,-11161.754072105607,-10930.048616370183,-10713.235871199811,-10511.315836594484,-10324.288512554213,-10152.153899079,-9994.9119961688284,-9852.5628038237137,-9725.1063220436627,-9612.5425508286608,-9514.8714901786989,-9432.0931400937952,-9364.2075005739607,-9311.214571619159,-9273.1143532294082,-9249.9068454047338,-9241.5920481450958,-9248.1699614505142,-9269.6405853209799,-9306.0039197565093,-9357.2599647570842,-9423.4087203227027,-9504.4501864533904,-9600.3843631491218,-9711.2112504099132,-9836.9308482357537,-9977.5431566266561,-10133.048175582602,-10303.445905103605,-10488.736345189656,-10688.919495840768,-10903.995357056916,-11133.963928838131,-11378.825211184401,-11638.579204095719,-11913.225907572076,-12202.76532161352,-12507.197446219972,-12826.522281391501,-13160.739827128082,-13509.850083429716,-13873.853050296435,-14252.748727728174,-14646.537115724948,-15055.218214286795,-15478.792023413693,-15917.25854310565,-16370.617773362659,-16838.869714184722,-17322.01436557182,-17820.051727524005,-18332.981800041223,-18860.804583123507,-19403.520076770797,-19961.128280983172,-20533.629195760637,-21121.022821103099,-21723.309157010663,-22340.488203483241,-22972.559960520877,-23619.524428123543,-24281.381606291303,-24958.131495024099,-25649.774094321954,-26356.30940418486,-27077.737424612817,-27814.058155605853,-28565.271597163875,-29331.377749287021,-30112.376611975189,-30908.268185228415,-31719.052469046677,-32544.729463430049,-33385.299168378355,-34240.76158389185,-35111.116709970331,-35996.364546613855,-36896.505093822423,-37811.538351596144,-38741.464319934865,-39686.282998838549,-40645.994388307423,-41620.598488341209,-42610.095298940119,-43614.48482010408,-44633.767051833129],[-15908.637373187676,-15476.706733265946,-15059.668803909259,-14657.52358511762,-14270.271076891035,-13897.911279229516,-13540.444192133033,-13197.869815601625,-12870.188149635258,-12557.399194233949,-12259.502949397673,-11976.499415126455,-11708.388591420309,-11455.170478279197,-11216.845075703153,-10993.412383692154,-10784.87240224621,-10591.225131365318,-10412.470571049476,-10248.608721298689,-10099.639582112954,-9965.5631534922759,-9846.3794354366437,-9742.0884279460752,-9652.6901310205521,-9578.1845446600855,-9518.5716688646717,-9473.8515036342978,-9444.0240489690077,-9429.0893048687431,-9429.0472713335421,-9443.897948363383,-9473.6413359582875,-9518.2774341182521,-9577.8062428432459,-9652.2277621333142,-9741.5419919884371,-9845.7489324085909,-9964.8485833938103,-10098.840944944084,-10247.726017059409,-10411.50379973979,-10590.174292985221,-10783.7374967957,-10992.193411171251,-11215.54203611183,-11453.783371617459,-11706.917417688168,-11974.944174323924,-12257.86364152472,-12555.675819290584,-12868.380707621487,-13195.978306517436,-13538.468615978447,-13895.851636004531,-14268.127366595651,-14655.295807751825,-15057.356959473025,-15474.310821759309,-15906.157394610651,-16352.896678027038,-16814.528672008499,-17291.05337655497,-17782.470791666499,-18288.780917343101,-18809.983753584762,-19346.079300391459,-19897.067557763225,-20462.948525700027,-21043.722204201877,-21639.388593268806,-22249.947692900743,-22875.399503097768,-23515.74402385985,-24170.981255186984,-24841.111197079153,-25526.133849536389,-26226.049212558661,-26940.857286146034,-27670.558070298393,-28415.151565015833,-29174.63777029833,-29949.016686145893,-30738.288312558492,-31542.45264953615,-32361.509697078844,-33195.45945518661,-34044.301923859428,-34908.037103097318,-35786.664992900223,-36680.185593268208,-37588.598904201201,-38511.904925699273,-39450.10365776244,-40403.195100390629,-41371.179253583861,-42354.056117342087,-43351.825691665479,-44364.487976553894,-45392.042972007352],[-15857.827040015076,-15434.169163817767,-15025.403998185526,-14631.531543118339,-14252.551798616181,-13888.46476467908,-13539.270441307028,-13204.968828500045,-12885.559926258102,-12581.043734581228,-12291.420253469383,-12016.689482922608,-11756.851422940887,-11511.906073524227,-11281.853434672597,-11066.693506386026,-10866.426288664521,-10681.051781508049,-10510.569984916645,-10354.980898890302,-10214.284523428994,-10088.480858532741,-9977.5699042015331,-9881.5516604354034,-9800.4261272343101,-9734.1933045982696,-9682.8531925272928,-9646.4057910213742,-9624.8511000804865,-9618.1891197046662,-9626.419849893884,-9649.5432906481692,-9687.5594419674999,-9740.4683038518924,-9808.2698763013395,-9890.9641593158267,-9988.5511528953684,-10101.030857039974,-10228.403271749617,-10370.668397024321,-10527.826232864085,-10699.876779268892,-10886.820036238756,-11088.656003773689,-11305.384681873651,-11537.006070538673,-11783.520169768739,-12044.926979563874,-12321.226499924047,-12612.418730849291,-12918.503672339568,-13239.481324394903,-13575.351687015291,-13926.114760200764,-14291.770543951243,-14672.319038266798,-15067.760243147402,-15478.094158593058,-15903.320784603782,-16343.440121179552,-16798.452168320367,-17268.356926026208,-17753.154394297148,-18252.844573133116,-18767.427462534153,-19296.903062500234,-19841.271373031384,-20400.532394127578,-20974.686125788758,-21563.73256801509,-22167.671720806415,-22786.503584162805,-23420.228158084275,-24068.845442570775,-24732.355437622347,-25410.758143238942,-26104.05355942063,-26812.241686167326,-27535.322523479095,-28273.29607135593,-29026.162329797793,-29793.921298804722,-30576.572978376673,-31374.117368513747,-32186.5544692158,-33013.884280482976,-33856.106802315124,-34713.222034712431,-35585.229977674717,-36472.130631202104,-37373.923995294463,-38290.610069951916,-39222.18885517442,-40168.660350961967,-41130.024557314653,-42106.281474232317,-43097.431101715032,-44103.473439762813,-45124.408488375615,-46160.23624755349],[-15816.934062214374,-15401.548949741489,-15001.056547833696,-14615.456856490906,-14244.74987571318,-13888.935605500532,-13548.014045852919,-13221.985196770363,-12910.849058252867,-12614.605630300404,-12333.254912913013,-12066.796906090669,-11815.231609833354,-11578.55902414113,-11356.779149013943,-11149.891984451799,-10957.897530454731,-10780.795787022691,-10618.586754155733,-10471.270431853794,-10338.84682011692,-10221.315918945102,-10118.677728338345,-10030.932248296642,-9958.0794788199855,-9900.1194199083839,-9857.0520715618204,-9828.8774337803225,-9815.5955065638791,-9817.206289912494,-9833.7097838261525,-9865.1059883048601,-9911.3949033486242,-9972.5765289574465,-10048.650865131309,-10139.617911870237,-10245.477669174206,-10366.230137043251,-10501.875315477328,-10652.413204476479,-10817.843804040671,-10998.167114169893,-11193.383134864196,-11403.49186612355,-11628.493307947956,-11868.387460337395,-12123.174323291907,-12392.85389681147,-12677.426180896082,-12976.891175545717,-13291.248880760486,-13620.499296540231,-13964.642422885063,-14323.678259794922,-14697.606807269869,-15086.428065309845,-15490.142033914897,-15908.748713084986,-16342.248102820133,-16790.640203120332,-17253.925013985554,-17732.102535415863,-18225.172767411212,-18733.135709971641,-19255.991363097091,-19793.739726787622,-20346.380801043171,-20913.9145858638,-21496.341081249462,-22093.660287200182,-22705.872203715953,-23332.976830796797,-23974.974168442648,-24631.864216653594,-25303.646975429619,-25990.322444770645,-26691.890624676729,-27408.3515151479,-28139.705116184094,-28885.95142778536,-29647.090449951684,-30423.122182683022,-31214.046625979441,-32019.863779840925,-32840.573644267417,-33676.176219258959,-34526.671504815589,-35392.059500937285,-36272.340207624024,-37167.513624875806,-38077.579752692654,-39002.53859107451,-39942.39014002146,-40897.134399533461,-41866.771369610491,-42851.301050252645,-43850.723441459777,-44865.038543231989,-45894.246355569296,-46938.346878471559],[-15785.95843978558,-15378.846091037138,-14986.626452853749,-14609.299525235414,-14246.865308182112,-13899.32380169391,-13566.675005770707,-13248.918920412576,-12946.055545619507,-12658.084881391498,-12385.006927728526,-12126.821684630606,-11883.529152097739,-11655.129330129941,-11441.622218727185,-11243.007817889486,-11059.286127616815,-10890.457147909226,-10736.5208787667,-10597.477320189206,-10473.326472176759,-10364.068334729374,-10269.70290784705,-10190.23019152975,-10125.650185777542,-10075.962890590363,-10041.16830596824,-10021.266431911175,-10016.257268419164,-10026.140815492203,-10050.917073130309,-10090.586041333432,-10145.147720101631,-10214.602109434887,-10298.949209333183,-10398.189019796537,-10512.321540824949,-10641.346772418414,-10785.264714576937,-10944.075367300506,-11117.778730589118,-11306.374804442796,-11509.863588861524,-11728.245083845293,-11961.519289394128,-12209.686205508013,-12472.745832186951,-12750.698169430976,-13043.543217240007,-13351.2809756141,-13673.911444553241,-14011.434624057436,-14363.850514126698,-14731.159114761005,-15113.360425960371,-15510.45444772478,-15922.441180054253,-16349.320622948771,-16791.092776408346,-17247.757640432963,-17719.315215022663,-18205.765500177393,-18707.108495897191,-19223.344202182016,-19754.472619031891,-20300.493746446853,-20861.407584426845,-21437.21413297188,-22027.913392082002,-22633.505361757154,-23253.990041997378,-23889.367432802646,-24539.637534172958,-25204.800346108299,-25884.855868608727,-26579.804101674206,-27289.645045304722,-28014.378699500296,-28754.005064260957,-29508.524139586647,-30277.935925477395,-31062.240421933129,-31861.43762895398,-32675.527546539954,-33504.510174690855,-34348.385513406909,-35207.153562687949,-36080.814322534039,-36969.367792945195,-37872.813973921438,-38791.152865462645,-39724.384467568983,-40672.508780240372,-41635.52580347679,-42613.435537278296,-43606.237981644837,-44613.933136576423,-45636.521002072994,-46674.001578134754,-47726.374864761478],[-15764.900172728661,-15366.060587704669,-14982.11371324571,-14613.059549351803,-14258.89809602296,-13919.629353259144,-13595.253321060402,-13285.769999426706,-12991.179388358052,-12711.481487854478,-12446.676297915939,-12196.763818542453,-11961.744049734036,-11741.616991490639,-11536.382643812311,-11346.041006699046,-11170.59208015084,-11010.035864167661,-10864.372358749555,-10733.601563896507,-10617.723479608492,-10516.738105885544,-10430.645442727622,-10359.445490134789,-10303.138248106981,-10261.723716644254,-10235.201895746552,-10223.572785413933,-10226.83638564634,-10244.992696443815,-10278.041717806344,-10325.983449733918,-10388.81789222654,-10466.545045284216,-10559.164908906958,-10666.677483094749,-10789.082767847571,-10926.380763165467,-11078.571469048416,-11245.654885496409,-11427.631012509475,-11624.499850087575,-11836.261398230756,-12062.915656938945,-12304.462626212218,-12560.902306050531,-12832.234696453896,-13118.459797422331,-13419.577608955804,-13735.588131054345,-14066.491363717907,-14412.287306946542,-14772.97596074023,-15148.557325098984,-15539.031400022765,-15944.398185511602,-16364.65768156551,-16799.809888184467,-17249.854805368479,-17714.792433117538,-18194.622771431656,-18689.345820310813,-19198.961579755018,-19723.470049764273,-20262.871230338613,-20817.165121477999,-21386.35172318243,-21970.431035451889,-22569.403058286422,-23183.267791686027,-23812.025235650661,-24455.67539018036,-25114.218255275111,-25787.653830934927,-26475.982117159765,-27179.203113949661,-27897.316821304623,-28630.323239224614,-29378.222367709684,-30141.014206759799,-30918.698756374994,-31711.276016555195,-32518.745987300455,-33341.108668610817,-34178.364060486179,-35030.512162926621,-35897.552975932114,-36779.4864995026,-37676.312733638253,-38588.031678338921,-39514.643333604603,-40456.147699435351,-41412.544775831127,-42383.834562792035,-43370.017060317958,-44371.092268408931,-45387.060187064919,-46417.920816285994,-47463.674156072128,-48524.32020642329],[-15753.759261043668,-15363.192439744096,-14987.518329009576,-14626.736928840108,-14280.84823923568,-13949.852260196318,-13633.748991722006,-13332.538433812728,-13046.220586468522,-12774.79544968936,-12518.263023475247,-12276.623307826208,-12049.87630274221,-11838.022008223277,-11641.060424269359,-11458.991550880524,-11291.815388056764,-11139.531935798013,-11002.141194104332,-10879.643162975713,-10772.037842412126,-10679.325232413619,-10601.505332980152,-10538.578144111718,-10490.543665808358,-10457.401898070057,-10439.152840896804,-10435.796494288583,-10447.332858245434,-10473.761932767346,-10515.08371785429,-10571.298213506292,-10642.405419723369,-10728.405336505468,-10829.297963852641,-10945.083301764866,-11075.76135024213,-11221.332109284467,-11381.79557889185,-11557.151759064272,-11747.400649801748,-11952.542251104283,-12172.576562971873,-12407.503585404531,-12657.323318402208,-12922.035761964971,-13201.640916092781,-13496.138780785619,-13805.529356043537,-14129.812641866509,-14468.988638254506,-14823.057345207593,-15192.0187627257,-15575.872890808865,-15974.619729457101,-16388.259278670375,-16816.791538448699,-17260.216508792073,-17718.534189700513,-18191.744581174018,-18679.84768321256,-19182.843495816142,-19700.732018984818,-20233.513252718491,-20781.187197017243,-21343.753851881062,-21921.213217309953,-22513.565293303851,-23120.810079862807,-23742.9475769868,-24379.977784675888,-25031.900702930026,-25698.716331749223,-26380.424671133427,-27077.025721082748,-27788.519481597054,-28514.905952676483,-29256.185134320862,-30012.357026530386,-30783.421629304932,-31569.378942644551,-32370.228966549163,-33185.971701018854,-34016.607146053648,-34862.135301653441,-35722.55616781838,-36597.869744548247,-37488.076031843288,-38393.175029703256,-39313.166738128348,-40248.051157118491,-41197.828286673692,-42162.498126793871,-43142.060677479181,-44136.515938729535,-45145.863910544926,-46170.104592925331,-47209.237985870903,-48263.264089381417,-49332.182903457004],[-15752.535704730601,-15370.241647155446,-15002.840300145337,-14650.331663700304,-14312.715737820312,-13989.992522505379,-13682.162017755509,-13389.22422357064,-13111.179139950877,-12848.026766896161,-12599.767104406494,-12366.400152481865,-12147.9259111223,-11944.344380327784,-11755.65556009833,-11581.85945043392,-11422.956051334566,-11278.945362800259,-11149.827384831002,-11035.60211742681,-10936.269560587665,-10851.829714313579,-10782.282578604551,-10727.628153460562,-10687.866438881629,-10662.997434867746,-10653.021141418927,-10657.937558535155,-10677.746686216444,-10712.448524462776,-10762.043073274148,-10826.530332650593,-10905.910302592089,-11000.182983098632,-11109.348374170237,-11233.406475806893,-11372.357288008598,-11526.200810775337,-11694.937044107164,-11878.565988004029,-12077.087642465947,-12290.502007492898,-12518.809083084907,-12762.008869242018,-13020.10136596413,-13293.086573251299,-13580.964491103556,-13883.735119520832,-14201.398458503187,-14533.954508050569,-14881.403268163005,-15243.744738840509,-15620.978920083056,-16013.105811890668,-16420.125414263319,-16842.03772720103,-17278.842750703807,-17730.540484771613,-18197.130929404466,-18678.614084602421,-19174.989950365358,-19686.258526693418,-20212.419813586486,-20753.473811044638,-21309.420519067797,-21880.259937656039,-22465.992066809362,-23066.616906527692,-23682.134456811051,-24312.544717659526,-24957.847689073024,-25618.043371051601,-26293.1317635952,-26983.112866703879,-27687.986680377588,-28407.753204616332,-29142.412439420179,-29891.964384789062,-30656.40904072296,-31435.746407221966,-32229.976484286024,-33039.099271915074,-33863.114770109241,-34702.022978868445,-35555.823898192692,-36424.517528081953,-37308.103868536309,-38206.582919555702,-39119.954681140203,-40048.21915328972,-40991.37633600425,-41949.426229283905,-42922.368833128552,-43910.204147538258,-44912.932172513021,-45930.55290805285,-46963.066354157731,-48010.472510827662,-49072.771378062695,-50149.962955862691],[-15761.229503789393,-15387.208209938668,-15028.079626652991,-14683.843753932393,-14354.500591776836,-14040.050140186329,-13740.492399160887,-13455.82736870048,-13186.055048805123,-12931.175439474842,-12691.188540709607,-12466.094352509415,-12255.892874874296,-12060.584107804189,-11880.168051299172,-11714.644705359187,-11564.014069984274,-11428.276145174401,-11307.430930929582,-11201.478427249815,-11110.418634135105,-11034.251551585447,-10972.977179600823,-10926.595518181286,-10895.106567326786,-10878.510327037349,-10876.806797312962,-10889.995978153602,-10918.077869559311,-10961.052471530085,-11018.919784065904,-11091.679807166765,-11179.332540832689,-11281.877985063671,-11399.316139859702,-11531.647005220799,-11678.870581146919,-11840.986867638096,-12017.995864694349,-12209.897572315645,-12416.69199050198,-12638.379119253384,-12874.958958569845,-13126.431508451358,-13392.796768897902,-13674.054739909534,-13970.205421486184,-14281.248813627912,-14607.184916334692,-14948.013729606515,-15303.735253443376,-15674.349487845298,-16059.856432812303,-16460.256088344351,-16875.548454441425,-17305.733531103557,-17750.811318330743,-18210.78181612301,-18685.645024480313,-19175.400943402652,-19680.049572890079,-20199.590912942527,-20734.024963560045,-21283.351724742599,-21847.571196490222,-22426.683378802889,-23020.688271680592,-23629.585875123412,-24253.376189131217,-24892.059213704088,-25545.634948842038,-26214.103394545018,-26897.464550813056,-27595.718417646174,-28308.864995044292,-29036.904283007505,-29779.836281535798,-30537.660990629098,-31310.378410287427,-32097.988540510851,-32900.491381299296,-33717.886932652822,-34550.175194571406,-35397.356167055033,-36259.429850103697,-37136.396243717449,-38028.255347896251,-38935.00716264006,-39856.651687948921,-40793.188923822912,-41744.618870261867,-42710.941527265946,-43692.156894835076,-44688.264972969184,-45699.265761668357,-46725.159260932691,-47765.945470761937,-48821.624391156292,-49892.196022115808,-50977.660363640178],[-15779.84065822011,-15414.092128093804,-15063.23630853258,-14727.273199536392,-14406.202801105268,-14100.025113239213,-13808.740135938178,-13532.347869202207,-13270.848313031298,-13024.241467425438,-12792.527332384616,-12575.705907908872,-12373.777193998161,-12186.741190652512,-12014.59789787193,-11857.347315656378,-11714.989444005882,-11587.52428292044,-11474.951832400058,-11377.272092444719,-11294.485063054439,-11226.590744229226,-11173.589135969036,-11135.480238273936,-11112.264051143851,-11103.940574578848,-11110.509808578887,-11131.971753143975,-11168.32640827413,-11219.573773969314,-11285.713850229567,-11366.746637054865,-11462.672134445234,-11573.490342400626,-11699.201260921101,-11839.804890006613,-11995.301229657169,-12165.690279872808,-12350.972040653478,-12551.146511999208,-12766.213693909982,-12996.173586385798,-13241.026189426715,-13500.771503032624,-13775.409527203623,-14064.940261939681,-14369.363707240771,-14688.679863106916,-15022.888729538112,-15371.990306534384,-15735.984594095686,-16114.871592222047,-16508.651300913451,-16917.323720169916,-17340.888849991454,-17779.346690378021,-18232.69724132965,-18700.94050284633,-19184.076474928061,-19682.105157574857,-20195.026550786693,-20722.840654563588,-21265.547468905534,-21823.146993812516,-22395.639229284585,-22983.024175321683,-23585.301831923825,-24202.47219909104,-24834.535276823291,-25481.491065120616,-26143.339563982961,-26820.080773410416,-27511.714693402864,-28218.241323960356,-28939.660665082978,-29675.972716770601,-30427.177479023325,-31193.274951841071,-31974.265135223824,-32770.148029171658,-33580.923633684572,-34406.591948762521,-35247.152974405493,-36102.606710613582,-36972.953157386713,-37858.19231472486,-38758.324182628094,-39673.348761096335,-40603.26605012967,-41548.076049728057,-42507.778759891378,-43482.374180619983,-44471.862311913494,-45476.243153772062,-46495.516706195704,-47529.682969184396,-48578.741942738146,-49642.693626856941,-50721.538021540764,-51815.27512678966],[-15808.369168022704,-15450.893401620868,-15108.310345784041,-14780.620000512294,-14467.822365805598,-14169.917441663958,-13886.905228087366,-13618.785725075832,-13365.558932629354,-13127.224850747929,-12903.783479431548,-12695.234818680208,-12501.57886849394,-12322.815628872737,-12158.945099816567,-12009.967281325458,-11875.882173399394,-11756.68977603838,-11652.390089242446,-11562.983113011527,-11488.46884734567,-11428.847292244889,-11384.118447709156,-11354.282313738466,-11339.338890332825,-11339.288177492232,-11354.130175216695,-11383.864883506219,-11428.492302360806,-11488.012431780431,-11562.4252717651,-11651.730822314847,-11755.929083429626,-11875.020055109479,-12009.003737354376,-12157.880130164314,-12321.649233539316,-12500.311047479368,-12693.865571984468,-12902.312807054621,-13125.65275268983,-13363.885408890108,-13617.010775655444,-13885.028852985777,-14167.939640881197,-14465.743139341685,-14778.439348367201,-15106.028267957792,-15448.509898113449,-15805.884238834118,-16178.151290119858,-16565.31105197065,-16967.363524386499,-17384.308707367374,-17816.146600913366,-18262.87720502435,-18724.500519700421,-19201.016544941533,-19692.425280747673,-20198.726727118898,-20719.920884055195,-21256.007751556514,-21806.987329622898,-22372.859618254304,-22953.624617450791,-23549.282327212328,-24159.832747538894,-24785.275878430519,-25425.611719887223,-26080.840271908986,-26750.961534495778,-27435.975507647643,-28135.882191364559,-28850.681585646496,-29580.373690493499,-30324.958505905553,-31084.43603188268,-31858.806268424814,-32648.069215532065,-33452.224873204374,-34271.273241441646,-35105.214320244078,-35954.048109611475,-36817.774609543965,-37696.393820041529,-38589.905741104136,-39498.310372731808,-40421.607714924488,-41359.79776768227,-42312.880531005052,-43280.856004892841,-44263.724189345783,-45261.48508436371,-46274.138689946769,-47301.685006094856,-48344.124032807944,-49401.455770086126,-50473.680217929395,-51560.797376337694,-52662.807245311014],[-15846.815033197207,-15497.612030519782,-15163.301738407403,-14843.884156860107,-14539.359285877839,-14249.727125460624,-13974.987675608485,-13715.140936321366,-13470.186907599329,-13240.125589442318,-13024.956981850368,-12824.68108482348,-12639.297898361627,-12468.807422464844,-12313.209657133139,-12172.50460236642,-12046.69225816481,-11935.772624528217,-11839.745701456717,-11758.611488950253,-11692.369987008842,-11641.021195632453,-11604.565114821158,-11583.001744574885,-11576.331084893693,-11584.553135777529,-11607.667897226445,-11645.675369240405,-11698.575551819413,-11766.368444963462,-11849.054048672575,-11946.63236294673,-12059.103387785966,-12186.467123190232,-12328.72356915956,-12485.872725693938,-12657.91459279337,-12844.849170457859,-13046.676458687385,-13263.396457481966,-13495.009166841626,-13741.514586766321,-14002.912717256071,-14279.20355831087,-14570.387109930729,-14876.463372115637,-15197.43234486559,-15533.294028180615,-15884.048422060665,-16249.695526505777,-16630.235341515985,-17025.667867091175,-17435.993103231478,-17861.211049936792,-18301.321707207164,-18756.325075042609,-19226.221153443126,-19711.009942408666,-20210.691441939256,-20725.26565203489,-21254.732572695619,-21799.092203921333,-22358.344545712142,-22932.489598068016,-23521.527360988934,-24125.457834474917,-24744.28101852593,-25377.996913142015,-26026.605518323136,-26690.106834069309,-27368.500860380525,-28061.787597256836,-28769.967044698118,-29493.039202704567,-30231.004071276002,-30983.861650412502,-31751.611940114039,-32534.254940380648,-33331.790651212279,-34144.219072608976,-34971.540204570767,-35813.754047097602,-36670.860600189444,-37542.859863846337,-38429.751838068296,-39331.536522855356,-40248.213918207453,-41179.784024124543,-42126.246840606698,-43087.602367654035,-44063.850605266249,-45054.991553443644,-46061.025212185996,-47081.951581493442,-48117.770661366005,-49168.482451803487,-50234.086952806094,-51314.584164373817,-52409.974086506503,-53520.256719204299],[-15895.178253743621,-15554.248014790608,-15228.210486402699,-14917.065668579813,-14620.813561321969,-14339.454164629187,-14072.987478501464,-13821.413502938794,-13584.732237941171,-13362.943683508607,-13156.04783964108,-12964.044706338633,-12786.934283601231,-12624.716571428857,-12477.391569821564,-12344.959278779315,-12227.419698302117,-12124.772828389967,-12037.018669042875,-11964.157220260851,-11906.188482043866,-11863.112454391932,-11834.929137305066,-11821.638530783215,-11823.240634826445,-11839.735449434742,-11871.122974608059,-11917.403210346447,-11978.576156649879,-12054.641813518389,-12145.600180951924,-12251.451258950521,-12372.195047514168,-12507.83154664287,-12658.36075633664,-12823.782676595443,-13004.097307419304,-13199.304648808216,-13409.404700762183,-13634.397463281206,-13874.28293636528,-14129.061120014418,-14398.732014228603,-14683.29561900782,-14982.751934352109,-15297.100960261441,-15626.342696735852,-15970.477143775277,-16329.504301379789,-16703.424169549315,-17092.236748283918,-17495.942037583576,-17914.540037448307,-18348.030747878081,-18796.4141688729,-19259.690300432747,-19737.859142557663,-20230.920695247638,-20738.874958502638,-21261.721932322747,-21799.4616167079,-22352.094011658082,-22919.619117173315,-23502.036933253599,-24099.347459898934,-24711.550697109356,-25338.646644884779,-25980.63530322531,-26637.516672130834,-27309.290751601467,-27995.957541637086,-28697.517042237814,-29413.969253403622,-30145.314175134496,-30891.551807430333,-31652.682150291243,-32428.705203717203,-33219.620967708222,-34025.429442264307,-34846.130627385457,-35681.724523071716,-36532.211129322939,-37397.590446139191,-38277.862473520574,-39173.027211466935,-40083.084659978493,-41008.034819054948,-41947.877688696499,-42902.613268903122,-43872.241559674781,-44856.762561011463,-45856.17627291329,-46870.482695380117,-47899.681828412038,-48943.773672008916,-50002.758226170903,-51076.635490897905,-52165.405466190008,-53269.068152047235,-54387.623548469426],[-15953.458829661929,-15620.801354433372,-15303.036589769861,-15000.164535671403,-14712.185192138024,-14439.098559169654,-14180.904636766367,-13937.603424928126,-13709.194923654926,-13495.679132946807,-13297.056052803708,-13113.325683225677,-12944.488024212724,-12790.543075764781,-12651.490837881938,-12527.331310564103,-12418.064493811318,-12323.69038762361,-12244.208992000957,-12179.620306943361,-12129.924332450802,-12095.121068523316,-12075.210515160858,-12070.192672363484,-12080.067540131135,-12104.835118463834,-12144.495407361617,-12199.048406824413,-12268.494116852289,-12352.832537445223,-12452.063668603194,-12566.187510326232,-12695.204062614313,-12839.113325467442,-12997.915298885644,-13171.609982868864,-13360.197377417162,-13563.677482530515,-13782.050298208924,-14015.315824452358,-14263.474061260882,-14526.525008634429,-14804.468666573048,-15097.305035076706,-15405.034114145416,-15727.655903779187,-16065.170403978018,-16417.577614741895,-16784.87753607081,-17167.070167964805,-17564.155510423836,-17976.133563447926,-18403.004327037095,-18844.767801191258,-19301.423985910485,-19772.972881194801,-20259.414487044181,-20760.748803458584,-21276.97583043803,-21808.095567982564,-22354.108016092112,-22915.013174766733,-23490.811044006405,-24081.501623811142,-24687.084914180887,-25307.560915115748,-25942.929626615594,-26593.191048680572,-27258.345181310528,-27938.3920245056,-28633.331578265672,-29343.163842590839,-30067.888817481005,-30807.506502936281,-31562.016898956579,-32331.420005541891,-33115.715822692342,-33914.904350407807,-34728.985588688352,-35557.95953753389,-36401.826196944516,-37260.585566920156,-38134.237647460912,-39022.782438566763,-39926.21994023757,-40844.550152473428,-41777.773075274352,-42725.888708640392,-43688.897052571447,-44666.798107067531,-45659.591872128665,-46667.278347754946,-47689.857533946175,-48727.329430702477,-49779.694038023845,-50846.951355910285,-51929.101384361718,-53026.144123378319,-54138.079572959912,-55264.907733106462],[-16021.656760952128,-15697.272049448015,-15387.780048508936,-15093.180758134926,-14813.474178325951,-14548.660309082024,-14298.739150403155,-14063.710702289365,-13843.574964740586,-13638.331937756908,-13447.981621338246,-13272.524015484643,-13111.959120196105,-12966.286935472601,-12835.50746131417,-12719.620697720793,-12618.626644692449,-12532.525302229169,-12461.316670330962,-12405.00074899778,-12363.57753822966,-12337.047038026592,-12325.409248388572,-12328.664169315622,-12346.811800807711,-12379.852142864846,-12427.785195487053,-12490.610958674284,-12568.329432426601,-12660.940616743952,-12768.444511626365,-12890.841117073805,-13028.130433086348,-13180.312459663892,-13347.387196806529,-13529.354644514187,-13726.214802786919,-13937.9676716247,-14164.613251027549,-14406.151540995425,-14662.582541528373,-14933.906252626353,-15220.12267428939,-15521.2318065175,-15837.233649310645,-16168.128202668837,-16513.91546659208,-16874.595441080401,-17250.168126133776,-17640.633521752192,-18045.991627935648,-18466.242444684183,-18901.385971997744,-19351.422209876368,-19816.351158320067,-20296.172817328774,-20790.887186902604,-21300.494267041395,-21824.994057745302,-22364.38655901426,-22918.67177084821,-23487.849693247292,-24071.92032621141,-24670.883669740557,-25284.739723834755,-25913.488488494004,-26557.129963718304,-27215.664149507727,-27889.091045862144,-28577.410652781597,-29280.622970266093,-29998.727998315677,-30731.725736930312,-31479.616186109997,-32242.399345854756,-33020.075216164529,-33812.643797039382,-34620.105088479249,-35442.459090484219,-36279.705803054239,-37131.845226189347,-37998.877359889382,-38880.802204154548,-39777.619758984787,-40689.330024380055,-41615.933000340388,-42557.428686865773,-43513.817083956157,-44485.098191611651,-45471.272009832159,-46472.338538617754,-47488.297777968386,-48519.14972788412,-49564.894388364883,-50625.531759410653,-51701.061841021488,-52791.484633197404,-53896.80013593832,-55017.008349244403,-56152.109273115428],[-16099.772047614235,-15783.660099834549,-15482.440862619904,-15196.114335970295,-14924.680519885775,-14668.1394143663,-14426.491019411867,-14199.735335022493,-13987.872361198153,-13790.902097938872,-13608.824545244675,-13441.639703115494,-13289.347571551392,-13151.948150552325,-13029.441440118328,-12921.827440249366,-12829.10615094547,-12751.277572206613,-12688.341704032817,-12640.298546424066,-12607.148099380407,-12588.89036290177,-12585.525336988176,-12597.053021639636,-12623.473416856166,-12664.786522637747,-12720.992338984368,-12792.090865896054,-12878.082103372777,-12978.966051414578,-13094.742710021435,-13225.412079193293,-13370.974158930263,-13531.428949232246,-13706.7764500993,-13897.016661531406,-14102.149583528566,-14322.175216090765,-14557.093559218025,-14806.904612910346,-15071.608377167717,-15351.204851990156,-15645.694037377621,-15955.075933330172,-16279.350539847739,-16618.517856930368,-16972.577884578037,-17341.5306227908,-17725.376071568608,-18124.114230911397,-18537.745100819346,-18966.268681292269,-19409.684972330258,-19867.993973933331,-20341.19568610147,-20829.290108834597,-21332.277242132834,-21850.157085996114,-22382.929640424416,-22930.594905417798,-23493.152880976239,-24070.603567099723,-24662.946963788258,-25270.183071041858,-25892.311888860466,-26529.333417244168,-27181.247656192907,-27848.054605706704,-28529.754265785596,-29226.346636429436,-29937.831717638379,-30664.209509412416,-31405.480011751533,-32161.643224655621,-32932.69914812479,-33718.647782159038,-34519.489126758301,-35335.223181922651,-36165.849947652008,-37011.369423946409,-37871.781610805956,-38747.086508230459,-39637.28411622002,-40542.374434774669,-41462.357463894383,-42397.233203579191,-43347.001653828964,-44311.662814643794,-45291.216686023734,-46285.663267968695,-47295.002560478679,-48319.234563553808,-49358.359277193893,-50412.376701399087,-51481.286836169333,-52565.089681504571,-53663.785237404903,-54777.373503870338,-55905.854480900736,-57049.228168496164]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="page-columns page-full"><p>So as you can see, we can now explore the probability of our parameter space (at least, in two dimensions). However, in reality, our parameter space has 8 parameters (7 from the RRi-vs-time model and the <img src="https://latex.codecogs.com/png.latex?%5Csigma"> parameter), which increases exponentially the number of computations needed to use grid approximation. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">I don’t have access to a quantum computer to be able to compute the whole probability landscape without my computer bursting into flames</span></div></div>
<p>Some algorithms that are designed to find optimal parameter values, work by maximizing the likelihood of seeing the data for a given set of the parameters (e.g., maximum likelihood estimation, MLE for short). In those cases, some methods might even take advantage of the gradient information similar to HMC methods, like gradient-descent for instance. However, almost all methods require you to able to compute the likelihood of observing the data given a set of parameter values (which is what we just plotted).</p>
<p>Up next, we need to specify (in R code) the vector of partial derivatives we estimated earlier. Let’s remember that this vector of derivatives (of the RRi-vs-time model) will be important to compute the gradient of the log likelihood, which is necessary to update the momentum vector to then update our parameter vector, by simulating our imaginary particle moving throught this parameter space.</p>
<p>Let’s recall our vector of partial derivatives for the RRi-vs-time model:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%20f(t%20%5Cmid%20%5Ctheta_k)%20=%0A%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Calpha%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cbeta%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20c%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Clambda%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cphi%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Ctau%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20f(t%20%5Cmid%20%5Ctheta_k)%7D%7B%5Cpartial%20%5Cdelta%7D%0A%20%20%5Cend%7Bbmatrix%7D%20=%0A%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%201%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%20%20-%20%5Cfrac%7Bc%7D%7B1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%20%5C%5C%0A%20%20%20%20-%20%5Cfrac%7B%5Cbeta%7D%7B1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%20%5C%5C%0A%20%20%20%20-%5Cbeta%20%5Cfrac%7B(t%20-%20%5Ctau)%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%7B(1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D)%5E2%7D%20%5C%5C%0A%20%20%20%20c%5Cbeta(t%20-%20%5Ctau%20-%20%5Cdelta)%20%5Cfrac%7Be%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%7B(1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D)%5E2%7D%20%5C%5C%0A%20%20%20%20%5Cbeta%20%5Clambda%20%5Cfrac%7Be%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D%7D%7B(1%20+%20e%5E%7B%5Clambda%20(t%20-%20%5Ctau)%7D)%5E2%7D%20-%20c%20%5Cbeta%20%5Cphi%20%5Cfrac%7Be%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%7B(1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D)%5E2%7D%20%20%5C%5C%0A%20%20%20%20-c%20%5Cbeta%20%5Cphi%20%5Cfrac%7Be%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D%7B(1%20+%20e%5E%7B%5Cphi%20(t%20-%20%5Ctau%20-%20%5Cdelta)%7D)%5E2%7D%0A%20%20%5Cend%7Bbmatrix%7D%0A"></p>
<p>Yeah… Its a picture hard to erase from memory. Even though this look like ITS A LOT, it truly isn’t. Let’s focus on the implementation of these set of equations in R:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ==============================================</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. Partial Derivatives of the RRi Model</span></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ==============================================</span></span>
<span id="cb5-4">compute_partials <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(t, params) {</span>
<span id="cb5-5">  alpha <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha</span>
<span id="cb5-6">  beta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>beta</span>
<span id="cb5-7">  c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>c</span>
<span id="cb5-8">  lambda <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lambda</span>
<span id="cb5-9">  phi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>phi</span>
<span id="cb5-10">  tau <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>tau</span>
<span id="cb5-11">  delta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>delta</span>
<span id="cb5-12">  </span>
<span id="cb5-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Precompute common terms</span></span>
<span id="cb5-14">  t_tau <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> t <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> tau</span>
<span id="cb5-15">  t_tau_delta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> t <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> tau <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> delta</span>
<span id="cb5-16">  </span>
<span id="cb5-17">  exp_lambda <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t_tau)</span>
<span id="cb5-18">  exp_phi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t_tau_delta)</span>
<span id="cb5-19">  denom1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> exp_lambda)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-20">  denom2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> exp_phi)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-21">  </span>
<span id="cb5-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb5-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d_alpha =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(t)),             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Is constant, so we repeat 1's</span></span>
<span id="cb5-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d_beta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> exp_lambda) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> c<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> exp_phi), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ∂M/∂β</span></span>
<span id="cb5-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d_c =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> exp_phi),             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ∂M/∂c</span></span>
<span id="cb5-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d_lambda =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t_tau <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> exp_lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denom1, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ∂M/∂λ</span></span>
<span id="cb5-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d_phi =</span> c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t_tau_delta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> exp_phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denom2, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ∂M/∂φ</span></span>
<span id="cb5-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d_tau =</span> beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> exp_lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denom1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> exp_phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denom2, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ∂M/∂τ</span></span>
<span id="cb5-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d_delta =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> exp_phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denom2 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ∂M/∂δ</span></span>
<span id="cb5-30">  )</span>
<span id="cb5-31">}</span></code></pre></div>
</details>
</div>
<p>These set of equation only tell us how sensitive is each parameter with regard to the observed error in the predicted RRi. Let’s plot this for further understanding.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">partials <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_partials</span>(t, params) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.table</span>()</span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(partials) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alpha"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"beta"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>, </span>
<span id="cb6-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lambda"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"phi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tau"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"delta"</span>)</span>
<span id="cb6-8"></span>
<span id="cb6-9">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb6-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> t, partials) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt.data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id.vars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>)</span>
<span id="cb6-12"></span>
<span id="cb6-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> variable)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(variable), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free_y"</span>, </span>
<span id="cb6-15">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> label_parsed) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (min)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effect on RRi (ms)"</span>,</span>
<span id="cb6-19">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effect of parameter change on RRi"</span>,</span>
<span id="cb6-20">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in RRi for a unit change for each parameter"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-8-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://bayesically-speaking.com/posts/2025-04-19 heartbeats-pdes-and-other-tales/index_files/figure-html/unnamed-chunk-8-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>In this plot, we can observed the effect of modifying in one unit each parameter on the observed RRi dynamics. This crucial piece of information is obtained thanks to the magic of partial derivatives. It allow us to describe how a system, composed of multiple parameters controlling the behavior of the observed dynamics, change relative to each parameter at a time. In reality, this set of equations describe a richer picture that we are intending to show here (but that’s an adventure for another blog post).</p>
<p>Finally, we now need to implement the gradient of the log likelihood function <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20U(q)">, which let’s recall, it looked like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%20U(q)%20=%0A-%5Cnabla%20%5Clog%20L(q)%20=%0A%20%20-%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Calpha%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Cbeta%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20c%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Clambda%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Cphi%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Ctau%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Cphi%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D%0A%20%20%5Cend%7Bbmatrix%7D%20=%0A%20%20-%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Calpha%7D%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Cbeta%7D%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20c%7D%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Clambda%7D%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Cphi%7D%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Ctau%7D%7D%20%5C%5C%0A%20%20%20%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Csum_%7Bi%20=%201%7D%5E%7BN%7D%7B%20(y_i%20-%20M)%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20M%7D%7B%5Cpartial%20%5Cphi%7D%7D%20%5C%5C%0A%20%20%20%20-%5Cfrac%7BN%7D%7B%5Csigma%7D%20+%20%5Cfrac%7B1%7D%7B%5Csigma%5E3%7D%20%5Csum_%7Bi=1%7D%5E%7BN%7D%7B(y_i%20-%20M)%5E2%7D%0A%20%20%5Cend%7Bbmatrix%7D%0A"></p>
<p>However, most of the work is already done, so we basically need to assemble the functions that take as input our observed data (RRi and time vectors), the named list of parameter values and <img src="https://latex.codecogs.com/png.latex?%5Csigma">.</p>
<p>Let’s see how this implementation looks like:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ==============================================</span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. Gradient of Log-Likelihood (∇U(q))</span></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ==============================================</span></span>
<span id="cb7-4">grad_U <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(y, t, params, sigma) {</span>
<span id="cb7-5">  M <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rr_model</span>(t, params)</span>
<span id="cb7-6">  residuals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> M</span>
<span id="cb7-7">  partials <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_partials</span>(t, params)</span>
<span id="cb7-8">  N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(residuals)</span>
<span id="cb7-9">  </span>
<span id="cb7-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Precompute inverses</span></span>
<span id="cb7-11">  sigma_sq_inv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sigma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb7-12">  sigma_cu_inv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sigma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb7-13">  </span>
<span id="cb7-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradients for model parameters</span></span>
<span id="cb7-15">  grad_params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb7-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(residuals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> partials<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>d_alpha) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma_sq_inv,</span>
<span id="cb7-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(residuals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> partials<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>d_beta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma_sq_inv,</span>
<span id="cb7-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">c =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(residuals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> partials<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>d_c) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma_sq_inv,</span>
<span id="cb7-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(residuals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> partials<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>d_lambda) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma_sq_inv,</span>
<span id="cb7-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">phi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(residuals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> partials<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>d_phi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma_sq_inv,</span>
<span id="cb7-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tau =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(residuals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> partials<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>d_tau) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma_sq_inv,</span>
<span id="cb7-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(residuals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> partials<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>d_delta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma_sq_inv</span>
<span id="cb7-23">  )</span>
<span id="cb7-24">  </span>
<span id="cb7-25">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient for sigma</span></span>
<span id="cb7-26">  grad_sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>N <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sigma) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(residuals<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma_cu_inv</span>
<span id="cb7-27">  </span>
<span id="cb7-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Return -∇logL(q)</span></span>
<span id="cb7-29">  gradLL <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(grad_params, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> grad_sigma))</span>
<span id="cb7-30">  </span>
<span id="cb7-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(gradLL, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x)</span>
<span id="cb7-32">}</span></code></pre></div>
</details>
</div>
<p>It’s important to not forget that the gradient of the potential energy <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20U(q)">, used to update the momentum parameter <img src="https://latex.codecogs.com/png.latex?p"> is itself a vector of gradients for all parameters, including <img src="https://latex.codecogs.com/png.latex?%5Csigma">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%20U(q)%20=%20-%5Cnabla%20%5Clog%20L(q)%20=%20-%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Calpha%7D%20%5C%5C%0A%5Cvdots%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Clog%20L%7D%7B%5Cpartial%20%5Csigma%7D%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>Now that we have our gradient function <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20U(q)">, we’ll need to use it to simulate how our particle moves through the parameter space. The common way to do this is to use what we know as symplectic integrators, which are a special kind of algorithms specifically design to leverage Hamiltonian parameters (<img src="https://latex.codecogs.com/png.latex?p"> and <img src="https://latex.codecogs.com/png.latex?q">) to simulate the evolution of a Hamiltonian system over time. The most famous symplectic integrator used in common Bayesian analysis software is the leapfrog integrator.</p>
<p>I have already described the leapfrog integrator in previous <a href="https://doi.org/10.59350/fa26y-xa178">blog posts</a>, however, for the sake of not interrumpting the flow of the narrative, let me remind you what was about.</p>
<p>In the leapfrog integrator, we start with a random momentum, commonly drawn from a standard normal distribution (with <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%200"> and <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2%20=%201">):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap%20%5Cleftarrow%20%5Cmathcal%7BN%7D(n%20%5Cmid%200,%201),%20%5Ctext%7B%20where:%20%7D%20n%20=%20%5Ctext%7Blength%7D(p)%0A"></p>
<p>However, its important to note that we need to draw a random standard normal vector of the same length of the position parameter vector <img src="https://latex.codecogs.com/png.latex?q">, so that we’ll have a momentum <img src="https://latex.codecogs.com/png.latex?p"> for each value in <img src="https://latex.codecogs.com/png.latex?q">.</p>
<p>Once we start with a random momentum, we need to updated it right away based on the gradient of our parameter space. To do this, let’s recall the form of the rate of change of the momentum paramter <img src="https://latex.codecogs.com/png.latex?p">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Bd%20p%7D%7Bd%20t%7D%20=%20-%5Cfrac%7B%5Cpartial%20H%7D%7B%5Cpartial%20q%7D%20=%20-%5Cnabla%20U(q)%0A"></p>
<p>This means that in order to update <img src="https://latex.codecogs.com/png.latex?p"> we need add the value of the <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20U(q)"> in the opposite direction, analogous to a ball rolling downhill. We manage to do this by “half-updates”:</p>
<div class="page-columns page-full"><p><img src="https://latex.codecogs.com/png.latex?%0Ap_%7Bt+0.5%7D%20%5Cleftarrow%20p_%7Bt%7D%20-%20%5Cnabla%20U(q_%7Bt%7D)%20%5Ccdot%20%5Cfrac%7B%5Ctext%7Bstepsize%7D%7D%7B2%7D%0A"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">First half-step momentum update</span></div></div>
<p>Then, with the updated momentum, we update the position vector <img src="https://latex.codecogs.com/png.latex?q"> like the following:</p>
<div class="page-columns page-full"><p><img src="https://latex.codecogs.com/png.latex?%0Aq_%7Bt+1%7D%20%5Cleftarrow%20q_%7Bt%7D%20+%20p_%7Bt+0.5%7D%20%5Ccdot%20%5Ctext%7Bstepsize%7D%0A"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Full-step position update</span></div></div>
<p>And then, we end up the algorithm by half-updating the momentum again, but this time with the new position:</p>
<div class="page-columns page-full"><p><img src="https://latex.codecogs.com/png.latex?%0Ap_%7Bt+1%7D%20%5Cleftarrow%20p_%7Bt+0.5%7D%20-%20%5Cnabla%20U(q)%20%5Ccdot%20%5Cfrac%7B%5Ctext%7Bstepsize%7D%7D%7B2%7D%0A"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Second half-step momentum update</span></div></div>
<p>And this is the whole algorithm to simulate the movement of the particle through this parameter space. As you see, the complicated stuff is not the algorithm itself, its the process to obtaining the equations to compute such gradients in the first place.</p>
<p>We can compact this algorithm into this tiny R function:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">leapfrog <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(q, p, dt, y, t) {</span>
<span id="cb8-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract sigma and model parameters</span></span>
<span id="cb8-3">  sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>sigma</span>
<span id="cb8-4">  params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(q) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sigma"</span>]</span>
<span id="cb8-5">  </span>
<span id="cb8-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute gradient</span></span>
<span id="cb8-7">  grad <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grad_U</span>(y, t, params, sigma)</span>
<span id="cb8-8">  </span>
<span id="cb8-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update momentum</span></span>
<span id="cb8-10">  p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(grad)</span>
<span id="cb8-11">  </span>
<span id="cb8-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update position</span></span>
<span id="cb8-13">  q_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(q) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p)</span>
<span id="cb8-14">  </span>
<span id="cb8-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recompute gradient at new position</span></span>
<span id="cb8-16">  new_sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q_new<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>sigma</span>
<span id="cb8-17">  new_params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q_new[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(q_new) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sigma"</span>]</span>
<span id="cb8-18">  grad_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grad_U</span>(y, t, new_params, new_sigma)</span>
<span id="cb8-19">  </span>
<span id="cb8-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Final momentum update</span></span>
<span id="cb8-21">  p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(grad_new)</span>
<span id="cb8-22">  </span>
<span id="cb8-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">q =</span> q_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> p)</span>
<span id="cb8-24">}</span></code></pre></div>
</details>
</div>
<p>Now let’s try simulating this bad boy!</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial parameters ----</span></span>
<span id="cb9-2"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Castillo-Aguilar's model</span></span>
<span id="cb9-3">params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb9-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beta =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">c =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb9-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">phi =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tau =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb9-6">)</span>
<span id="cb9-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Parameter for the standard deviation</span></span>
<span id="cb9-8">sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb9-9"></span>
<span id="cb9-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data ----</span></span>
<span id="cb9-11"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Time</span></span>
<span id="cb9-12">t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb9-13"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Observed RRi</span></span>
<span id="cb9-14">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rr_model</span>(t, params) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> sigma)</span>
<span id="cb9-15"></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parameters for simulation ----</span></span>
<span id="cb9-17"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Number of steps</span></span>
<span id="cb9-18">steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span></span>
<span id="cb9-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Stepsize at each step</span></span>
<span id="cb9-20">stepsize <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00025</span></span>
<span id="cb9-21"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Random seed</span></span>
<span id="cb9-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1234</span>)</span>
<span id="cb9-23"></span>
<span id="cb9-24"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Initiate random momentum vector</span></span>
<span id="cb9-25">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-26"></span>
<span id="cb9-27"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Parameter</span></span>
<span id="cb9-28">q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(params, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> sigma))</span>
<span id="cb9-29">out <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"list"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> steps)</span>
<span id="cb9-30"></span>
<span id="cb9-31"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Leapfrog integrator</span></span>
<span id="cb9-32"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (step <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>steps) {</span>
<span id="cb9-33">  out[[step]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">leapfrog</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">q =</span> q, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dt =</span> stepsize, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> t)</span>
<span id="cb9-34">  q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> out[[step]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q</span>
<span id="cb9-35">  p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> out[[step]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p</span>
<span id="cb9-36">}</span></code></pre></div>
</details>
</div>
<p>And that’s it! Now we have to check how well our leapfrog algorithm performed. Here we can leverage the famous Phase-Space plots, which illustrates the Position-vs-Momentum evolution of the system on the parameter space:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">position <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(out, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.table</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q)</span>
<span id="cb10-3">}) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbindlist</span>()</span>
<span id="cb10-4"></span>
<span id="cb10-5">momentum <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(out, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.list</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p)</span>
<span id="cb10-7">}) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbindlist</span>()</span>
<span id="cb10-8"></span>
<span id="cb10-9">position<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>step <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>steps</span>
<span id="cb10-10">momentum<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>step <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>steps</span>
<span id="cb10-11"></span>
<span id="cb10-12">position <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt.data.table</span>(position, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id.vars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"step"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value.name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p"</span>)</span>
<span id="cb10-13">momentum <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt.data.table</span>(momentum, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id.vars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"step"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value.name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q"</span>)</span>
<span id="cb10-14"></span>
<span id="cb10-15">sim_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> position[momentum, on <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"step"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"variable"</span>)]</span>
<span id="cb10-16">sim_data[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">:=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">q =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale</span>(q), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale</span>(p)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(variable)]</span>
<span id="cb10-17"></span>
<span id="cb10-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(sim_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(p, q)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(variable), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> label_parsed) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_path</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> step, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> variable), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Momentum (p)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Position (q)"</span>,</span>
<span id="cb10-22">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Phase Space of RRi Model"</span>,</span>
<span id="cb10-23">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Particle Moving on the Parameter Space"</span>,</span>
<span id="cb10-24">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Values are Standardized For Each Parameter"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-12-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://bayesically-speaking.com/posts/2025-04-19 heartbeats-pdes-and-other-tales/index_files/figure-html/unnamed-chunk-12-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>With this plot, we can already see which parameters behave accordingly to what we should expect (i.e., cyclic behavior like a pendulum) and which doesn’t. At first glance we can see that the <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> parameter didn’t reach a stationary behavior. This could be for a number of different reasons like hyperparameter tuning, and in the same way, we could try to fix it using several methods (e.g., step size, trajectory length). However, that’s another beast for another article.</p>
</section>
<section id="synthesizing-theory-computation-and-cardiovascular-insight" class="level1">
<h1>Synthesizing Theory, Computation, and Cardiovascular Insight</h1>
<p>The intellectual passage from the abstract realm of mathematical derivation to the concrete execution of Hamiltonian Monte Carlo (HMC) code for the Castillo-Aguilar RRi-vs-Time model exemplifies a profound synergy between theoretical exactitude, computational dexterity, and domain-specific biological understanding. This discussion delves into the broader ramifications of this synthesis, acknowledging its inherent limitations while distilling the critical lessons learned for both Bayesian inference methodologies and the intricate modeling of cardiovascular dynamics. Furthermore, it contemplates avenues for enhancing model veracity, computational performance, and the clarity of interpretation.</p>
<p>Perhaps the most significant realization emerging from this exercise is the deep epistemological value derived from the manual derivation of the model’s gradients. While contemporary probabilistic programming frameworks conveniently automate gradient computation through automatic differentiation (AD), the rigorous intellectual effort involved in manually applying the chain rule to a sophisticated formulation like the Castillo-Aguilar equation cultivates an irreplaceable, nuanced intuition. This meticulous process compels the modeler to grapple directly with potential analytical obstacles, such as singularities arising from specific mathematical terms or challenges in parameter identifiability, which automated systems might otherwise mask or silently fail upon. Moreover, dissecting individual gradient components, such as the partial derivative of the model with respect to exercise onset time (<img src="https://latex.codecogs.com/png.latex?%5Ctau">), illuminates the complex interplay of competing physiological forces—exercise versus recovery dynamics—mathematically encoded within the model. This granular understanding directly informs parameter sensitivity analysis and fosters a crucial, well-founded confidence in the inferential outcomes, particularly when confronting complex posterior geometries or apparent non-stationarity in sampling traces, allowing one to distinguish true model behavior from mere artifacts of the inference algorithm or its tuning. This experience strongly advocates for considering hybrid analytical workflows, where the manual derivation of particularly insightful or sensitive gradient components is judiciously combined with the efficiency of AD for others, thus achieving an optimal balance between profound conceptual grasp and practical computational execution, especially pertinent in hierarchical modeling structures.</p>
<p>The remarkable efficiency of HMC, particularly its advantage over gradient-free Markov Chain Monte Carlo techniques like Metropolis-Hastings, is fundamentally predicated on its intelligent exploitation of gradient information to navigate the complex topology of the posterior distribution. Our implementation vividly illustrates this advantage, showcasing HMC’s capacity to circumvent entrapment in local probability maxima—a common failing of random-walk algorithms in high-dimensional spaces. By employing momentum to traverse the parameter landscape, HMC effectively explores correlated parameter spaces, such as the relationship between exercise decay rate (<img src="https://latex.codecogs.com/png.latex?%5Clambda">) and recovery rate (<img src="https://latex.codecogs.com/png.latex?%5Cphi">) in the RRi model, navigating the characteristic ridges of such posteriors far more adeptly than undirected random proposals. This gradient-informed exploration mechanism also confers significant scalability; whereas grid-based evaluations or random walks suffer exponentially from the curse of dimensionality, HMC’s computational cost typically scales polynomially, rendering complex models with numerous parameters computationally tractable. The symplectic nature of the leapfrog integrator further ensures a delicate balance between broad exploration of the parameter space, facilitated by sustained momentum across potentially long trajectories, and detailed exploitation of high-probability regions, maintaining the necessary statistical properties for valid inference. Observing the phase-space dynamics, where stable oscillations for parameters like baseline RRi (<img src="https://latex.codecogs.com/png.latex?%5Calpha">) contrast with divergent behavior for others like exercise magnitude (<img src="https://latex.codecogs.com/png.latex?%5Cbeta">), provides direct diagnostic feedback on the interplay between the model’s geometry and the sampler’s hyperparameters.</p>
<p>Despite the inherent power of HMC, its application invariably surfaces significant challenges, demanding careful consideration. The performance of the sampler is acutely sensitive to the choice of hyperparameters: the step size (<img src="https://latex.codecogs.com/png.latex?%5Cepsilon">), which dictates the granularity of the leapfrog integration; the trajectory length (<img src="https://latex.codecogs.com/png.latex?L">), which determines the extent of exploration in each iteration; and the mass matrix, which adapts the sampler to the local curvature and scale of the posterior. Suboptimal choices, as potentially indicated by the observed behavior of the (<img src="https://latex.codecogs.com/png.latex?%5Cbeta">) parameter in our simulations, can lead to integration instability or inefficient exploration. While adaptive HMC variants like the No-U-Turn Sampler (NUTS) offer automated tuning, they introduce additional algorithmic complexity. Furthermore, the very flexibility of sophisticated mechanistic models like the Castillo-Aguilar formulation can engender issues of parameter identifiability. Parameters governing timing, such as exercise onset (<img src="https://latex.codecogs.com/png.latex?%5Ctau">) and recovery delay (<img src="https://latex.codecogs.com/png.latex?%5Cdelta">), may exhibit strong correlations, leading to elongated, curved posterior distributions that challenge even gradient-based samplers. Addressing this requires thoughtful strategies, including model reparameterization to decouple correlated variables or the incorporation of informative prior distributions derived from existing physiological knowledge. Finally, the computational burden associated with gradient evaluation, scaling linearly with the number of data points, remains a practical constraint, particularly for extensive datasets like continuous, long-term ECG recordings, potentially necessitating the adoption of stochastic gradient methods or hardware acceleration.</p>
<p>This endeavor highlights the persistent, often necessary, tension in Bayesian modeling between achieving high mechanistic fidelity—capturing the nuances of the underlying biological processes—and maintaining computational tractability. The Castillo-Aguilar model, rooted in physiological assumptions about exercise and recovery, offers interpretability but risks misrepresenting the system if the true dynamics deviate significantly from its sigmoidal assumptions. Conversely, purely phenomenological approaches, such as Gaussian processes, provide greater flexibility but often sacrifice direct physiological interpretation. An optimal path may lie in hybrid models that strategically combine mechanistic components for well-understood dynamics with non-parametric elements to capture residual variation or unmodeled effects. Similarly, the simplifying assumption of constant, Gaussian noise (<img src="https://latex.codecogs.com/png.latex?%5Csigma">) overlooks the common physiological reality of heteroscedasticity in RR intervals, where variability often changes with physiological state. Enhancing the model to accommodate time-varying or state-dependent noise would increase realism but inevitably add layers of computational and inferential complexity, demanding a careful cost-benefit analysis guided by the specific research question.</p>
<p>Beyond the technicalities of Bayesian inference, this work resonates with broader challenges and opportunities within the field of computational physiology. The inherent inter-individual heterogeneity in cardiovascular responses is not merely statistical noise but a reflection of genuine biological diversity. Extending models like ours into hierarchical frameworks offers a powerful means to parse this variability, simultaneously estimating population-level trends while tailoring parameters like decay rates (<img src="https://latex.codecogs.com/png.latex?%5Clambda">, <img src="https://latex.codecogs.com/png.latex?%5Cphi">) and timing (<img src="https://latex.codecogs.com/png.latex?%5Ctau">, <img src="https://latex.codecogs.com/png.latex?%5Cdelta">) to individual subjects, thereby paving the way for more personalized physiological assessment. The translation of such theoretical models into practical clinical applications, however, necessitates bridging the gap between offline analysis and real-time monitoring. This requires developing robust prior distributions informed by population data, potentially exploring online HMC algorithms capable of processing streaming data, and ensuring rigorous validation against established clinical metrics. Furthermore, advancing the field responsibly hinges on a commitment to open science and reproducibility, extending beyond code sharing to encompass standardized data formats and the creation of benchmark datasets for objective model comparison.</p>
<p>The trajectory for future work is rich with potential, branching into algorithmic enhancement, model elaboration, and empirical validation. Integrating adaptive samplers like NUTS could automate hyperparameter tuning, while leveraging GPU acceleration or exploring approximate Bayesian methods like Variational Inference could drastically reduce computation times for large-scale applications. Model extensions could incorporate hierarchical structures for population studies, allow key parameters like (<img src="https://latex.codecogs.com/png.latex?%5Clambda">) and (<img src="https://latex.codecogs.com/png.latex?%5Cphi">) to vary dynamically with factors like exercise intensity, or employ more flexible non-Gaussian likelihoods (e.g., log-normal or Gamma distributions) to better capture the statistical properties of RR intervals. Crucially, the clinical relevance of these models must be established through rigorous benchmarking against existing gold-standard physiological measures and validated in intervention studies designed to assess whether estimated parameter shifts accurately reflect responses to therapeutic interventions or training regimens.</p>
<p>In conclusion, the implementation and application of HMC to the Castillo-Aguilar model represent a compelling fusion of art and science. It demands mathematical acuity for gradient derivation, computational proficiency for robust implementation, and deep domain knowledge for meaningful interpretation. The ultimate value, however, transcends these individual components, residing in the synergistic insight generated when mathematical formalism illuminates biological complexity. This journey underscores several core tenets of sophisticated modeling: the indispensable intuition fostered by rigorous derivation, the inescapable necessity of navigating trade-offs between model complexity, inferential accuracy, and computational resources, and the paramount importance of interpreting results within their specific physiological context. The seemingly “monstrous” gradient vector, therefore, is far more than a collection of partial derivatives; it is a high-dimensional map guiding exploration at the confluence of mathematics and biology, promising deeper understanding for those willing to navigate its intricate terrain, one calculated step at a time.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{castillo-aguilar2025,
  author = {Castillo-Aguilar, Matías},
  title = {HMC by {Hand:} {Gradients,} {Heartbeats,} {PDEs} and {Other}
    {Tales}},
  date = {2025-04-19},
  url = {https://bayesically-speaking.com/posts/2025-04-19 heartbeats-pdes-and-other-tales/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-castillo-aguilar2025" class="csl-entry quarto-appendix-citeas">
Castillo-Aguilar, Matías. 2025. <span>“HMC by Hand: Gradients,
Heartbeats, PDEs and Other Tales.”</span> April 19, 2025. <a href="https://bayesically-speaking.com/posts/2025-04-19 heartbeats-pdes-and-other-tales/">https://bayesically-speaking.com/posts/2025-04-19
heartbeats-pdes-and-other-tales/</a>.
</div></div></section></div> ]]></description>
  <category>by-hand</category>
  <category>mcmc</category>
  <category>algorithms</category>
  <category>non-linear</category>
  <category>educational</category>
  <guid>https://bayesically-speaking.com/posts/2025-04-19 heartbeats-pdes-and-other-tales/</guid>
  <pubDate>Sat, 19 Apr 2025 03:00:00 GMT</pubDate>
  <media:content url="https://bayesically-speaking.com/posts/2025-04-19 heartbeats-pdes-and-other-tales/body_1.png" medium="image" type="image/png" height="143" width="144"/>
</item>
<item>
  <title>So, You Think You Can Model a Heartbeat?</title>
  <dc:creator>Matías Castillo-Aguilar</dc:creator>
  <link>https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
CardioCurveR
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://matcasti.github.io/CardioCurveR/"><img style="padding:1rem;" src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/CardioCurveR.png" align="right" height="150" alt="CardioCurveR website"></a></p>
<p>With the mission to aid everyone to be able to use and test our work, we developed and published an <a href="https://matcasti.github.io/CardioCurveR/">R package</a> with easy and out-of-the-box solutions to analyze R-R intervals with dual-logistic behaviour!</p>
<p>Go check it <a href="https://matcasti.github.io/CardioCurveR/">here</a>!</p>
</div>
</div>
<section id="introduction" class="level1 page-columns page-full">
<h1>Introduction</h1>
<p>Let’s talk about your heart. <strong>Not the metaphorical one</strong> that’s still recovering from <em>that</em> season finale of <em>Stranger Things</em>, <strong>but the actual meat-and-potatoes organ</strong> pumping in your chest. You know, the thing that goes haywire when you sprint for the bus or binge-watch <em>Squid Game</em> while eating a family-sized pizza all by yourself (that’s what I call self determination). Turns out, scientists (like yours truly) have been obsessed with <strong>understanding how this biological drum solo responds to exercise</strong>. And let me tell you, it’s not as straightforward as your Fitbit’s cheerful little heart icon would have you believe.</p>
<p>Your heart isn’t just a pump, it’s a <em>poet.</em> Every beat writes a tiny stanza in the epic of your life, and <strong>the R-R interval</strong> is the rhythm of that poetry. Technically, <strong>it’s the time (in milliseconds) between the peaks of consecutive heartbeats on an ECG</strong>, those iconic “R waves” that look like little skyscrapers. <strong>Shorter R-R intervals</strong> mean your heart is drumming faster (hello, panic-induced Zoom meetings), while <strong>longer R-R intervals</strong> mean it’s lounging (Netflix marathons, anyone?). Heart rate (beats per minute) is just the inverse of this: <strong>divide 60,000 by your RR interval</strong>, and voilà, you’ve got your BPM. But here’s the plot twist: your heart isn’t a metronome.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/R-R-Interval.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Example of an electrocardiographic curve, showing your heartbeats; additionally to the time between them, which we denote as R-R intervals.</span></div></div>
<p>Enter <strong>heart rate variability (HRV)</strong>, the hero of cardiac health. HRV measures the subtle variations between those R-R intervals. Think of it as your heart’s improv skills, jazz, not classical. <strong>High HRV means your autonomic nervous system is flexing its adaptability</strong>, seamlessly switching between “fight-or-flight” mode (sympathetic) and “chill-out” mode (parasympathetic). <strong>Low HRV? Your body’s stuck in a stress loop, like a hamster wheel of cortisol</strong>. But traditional HRV metrics average these fluctuations over minutes or hours, turning your heart’s freestyle rap into elevator music.</p>
<p>That’s where <strong>R-R intervals steal the spotlight</strong>. By analyzing them beat-to-beat, we catch the <em>micro-dramas</em>, how your heart panics during a sprint, recovers post-burpee, or <strong>side-eyes your third coffee</strong>.</p>
<p>Now imagine your heart rate during a workout <strong>is like the plot of a Christopher Nolan movie</strong>, full of twists, turns, and moments where you’re not entirely sure what’s going on but <em>feel</em> like it’s profound. Traditional methods for analyzing HRV are <strong>like trying to explain <em>Inception</em> using only a flip phone</strong>: technically possible, but missing <em>all</em> the nuance. For decades, researchers have relied on linear models and aggregated HRV metrics, which are about <strong>as useful for capturing the chaos of exercise-induced heart rhythms as a screen door on a submarine</strong>. Sure, they tell you <em>something</em>, but it’s like summarizing <em>The Lord of the Rings</em> as “some guys walked to a volcano.” Missing the point? Just a bit.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/services.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://www.pexels.com/es-es/foto/sano-mujer-telefono-inteligente-navegando-4436296/">Ketut Subiyanto</a></span></div></div>
<p>But hey! I have good news. We <a href="https://www.researchgate.net/publication/389812477_Enhancing_cardiovascular_monitoring_a_non-linear_model_for_characterizing_RR_interval_fluctuations_in_exercise_and_recovery">developed and published</a> a new non-linear model, <strong>the Tony Stark of cardiac analysis</strong>, flashy, precise, and built in a cave (okay, a lab) with a bunch of math you’ll <em>almost</em> understand. Instead of forcing your heart’s beat-to-beat intervals (lovingly called <em>R-R intervals</em>) into the rigid straightjacket of linear equations, <strong>we’ve embraced the chaos with logistic functions</strong>. Think of it as upgrading from a dial-up modem to 5G. These <strong>logistic functions are the Beyoncé of math</strong>, versatile, dynamic, and capable of handling sudden shifts (like when you go from couch potato to HIIT warrior in 0.2 seconds). <strong>They model the heart’s nosedive during exercise <em>and</em> its slow crawl back</strong> to Netflix-and-chill mode afterward, all while spitting out parameters that actually mean something to your body. “<em>Baseline R-R interval</em>”? That’s your heart’s resting vibe. “<em>Recovery proportion</em>”? How quickly it forgives you for those burpees.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/publised-paper.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Check the paper where we discuss in-depth the model to get all the technicalities. You can visit it <a href="https://www.nature.com/articles/s41598-025-93654-6">here</a>.</span></div></div>
<p>Now, let’s address the elephant in the room: <strong>why should you care?</strong> Well, unless you’re a cyborg (looking at you, Boston Dynamics), <strong>your autonomic nervous system</strong>, the puppet master behind your heart’s rhythm, <strong>is a drama queen</strong>. During exercise, it’s a tug-of-war between the “<em>fight-or-flight</em>” <strong>sympathetic system</strong> (the one yelling <strong>GO!</strong>) and the “<em>chill-out</em>” <strong>parasympathetic system</strong> (the one whispering <em>maybe just one more episode</em>?). Traditional models treat this like a seesaw with one kid glued to the ground. The model that we developed? It’s the entire playground, complete with swing sets, monkey bars, and that one kid who <strong>definitely</strong> ate too much sugar.</p>
<p>Here’s where it gets spicy: <strong>we tested this bad boy on 272 elderly folks</strong>. Why seniors? Because if your heart can handle Zumba at 70, it’s basically the Dwayne Johnson of organs. <em>Spoiler alert</em>: <strong>the model nailed it</strong>. With an R<sup>2</sup> of 0.868 (translation: it’s scarily accurate) and RMSE of 32.6 ms (translation: it’s precise enough to detect your existential crisis during plank holds), <strong>it’s like giving doctors and trainers a cheat code for your cardiovascular health</strong>. Oh, and we used Hamiltonian Monte Carlo for parameter estimation, which sounds like a spell from <em>Harry Potter</em> but is really just math jedi tricks for “we didn’t guess, we <em>calculated</em>”.</p>
<p>But wait, there’s more! Using Sobol <strong>sensitivity analysis</strong> (a fancy way of asking, “<em>Which part of this equation is doing the heavy lifting?</em>”), we discovered that baseline R-R intervals and recovery proportion are the MVPs of heart rate dynamics. Translation: <strong>your heart’s default setting and its ability to bounce back post-workout are the LeBron and Jordan of this game</strong>. The other parameters? They’re the benchwarmers. Useful, but not stealing the spotlight.</p>
<p>Now, let’s talk <strong>real-world applications</strong>. Imagine a future where your smartwatch doesn’t just shame you for sitting too long but actually <em>understands</em> your heart’s tantrums during spin class. Or where <strong>rehab programs are tailored not just to your fitness level but to your autonomic nervous system’s mood swings</strong>. This model isn’t just academic nerdery, it’s a gateway to personalized health tech that doesn’t suck.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/pexels-martabranco-28585010.jpg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://www.pexels.com/es-es/foto/vista-detallada-de-los-equipos-y-lecturas-de-ecg-28585010/">Marta Branco</a>.</span></div></div>
<p>Of course, no hero’s journey is complete without flaws. <strong>Our study’s cohort was mostly elderly women</strong>, which is like testing a new sports car exclusively on retirees driving to bingo night. <strong>Future work?</strong> Let’s throw in some college athletes, sleep-deprived parents, and that one friend who does ultramarathons “for fun”. Also, shoutout to R, the coding language we used to simulate this model. If R were a person, it’d be that friend who’s brilliant but insists on explaining everything in memes.</p>
<p>So, buckle up. In the next sections, <strong>we’ll dive into the code, the curves, and the “aha!” moments</strong> that made this paper possible. Whether you’re a cardio junkie, a data science geek, or just someone who wants to know why your heart hates burpees, <strong>this ride’s for you</strong>. And hey, if you get lost, just remember: it’s not chaos, it’s <em>science</em>.</p>
</section>
<section id="the-math-code-and-cardiac-drama-behind-the-model" class="level1">
<h1>The Math, Code, and Cardiac Drama Behind the Model</h1>
<p>Let’s peel back the layers of this model like it’s an onion, except <strong>instead of tears, you’ll get math</strong>, R code, and a newfound appreciation for your heart’s melodramatic tendencies. Buckle up; we’re going full <em>Sherlock Holmes</em> on this equation.</p>
<section id="the-grand-equation-a-symphony-of-sigmoids" class="level3">
<h3 class="anchored" data-anchor-id="the-grand-equation-a-symphony-of-sigmoids">The Grand Equation: A Symphony of Sigmoids</h3>
<p>At the heart of our model lies this beauty:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7BRRi%7D(t)%20=%20%5Calpha%20+%20%5Cunderbrace%7B%5Cfrac%7B%5Cbeta%7D%7B1%20+%20e%5E%7B%5Clambda(t-%5Ctau)%7D%7D%7D_%7B%5Ctext%7BExercise%7D%7D%20+%20%5Cunderbrace%7B%5Cfrac%7B-c%20%5Ccdot%20%5Cbeta%7D%7B1%20+%20e%5E%7B%5Cphi(t-%5Ctau-%5Cdelta)%7D%7D%7D_%7B%5Ctext%7BRecovery%7D%7D%0A"></p>
<p>This isn’t just alphabet soup. <strong>It’s a carefully orchestrated dance between two logistic functions</strong> (the S-shaped curves you’d recognize from population growth or zombie apocalypse models). Together, they capture your <strong>heart’s journey</strong> from Zen-like rest to exercise-induced panic and back to Netflix mode. <strong>Let’s dissect each term</strong> like it’s a <em>Breaking Bad</em> episode.</p>
<section id="baseline-r-r-interval-alpha-the-calm-before-the-storm" class="level4">
<h4 class="anchored" data-anchor-id="baseline-r-r-interval-alpha-the-calm-before-the-storm">1. Baseline R-R interval (<img src="https://latex.codecogs.com/png.latex?%5Calpha">): The Calm Before the Storm</h4>
<p><img src="https://latex.codecogs.com/png.latex?%5Calpha"> (alpha) <strong>is your heart’s resting state</strong>, the R-R interval when you’re sprawled on the couch debating whether to rewatch <em>The Office</em> again. Mathematically, <strong>it’s the vertical shift of the entire curve</strong>. Think of it as the “neutral” setting of your heart rate, typically around 800–1000 ms for healthy adults. If <img src="https://latex.codecogs.com/png.latex?%5Calpha"> were a person, it’d be that friend who insists on taking “mental health days” every Monday.</p>
<p>In the code, <img src="https://latex.codecogs.com/png.latex?%5Calpha"> is straightforward. When we standardized the RRi data, we centered each individual’s data around their mean (<img src="https://latex.codecogs.com/png.latex?%5Ctext%7BRRi%7D_i">) and scaled it by their standard deviation (<img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7BRRi%7D_i%7D">). <strong>This let us compare Grandma Ethel’s heart rate to Gym Bro Chad’s without bias</strong>. In R, this might look like reversing a z-score. No magic here, just arithmetic to keep everyone’s heart rates in their lane.</p>
<p>Check how the transformed distribution of R-R intervals <strong>maintains its shape but only changes the reference scale</strong>. The standardized scale will always be in terms of standard deviations (also known as Z-score) as unit of measurement:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bayestestR<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distribution_normal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb1-2"></span>
<span id="cb1-3">plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb1-4">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">R-R interval (ms)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> x,</span>
<span id="cb1-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Z-Score (standardized units)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> (x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x)</span>
<span id="cb1-6">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt.data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure.vars =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(plot_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> variable)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> variable, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qual"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-2-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/index_files/figure-html/unnamed-chunk-2-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-panic-parameter-beta-when-exercise-hits-like-a-plot-twist" class="level4">
<h4 class="anchored" data-anchor-id="the-panic-parameter-beta-when-exercise-hits-like-a-plot-twist">2. The Panic Parameter (<img src="https://latex.codecogs.com/png.latex?%5Cbeta">): When Exercise Hits Like a Plot Twist</h4>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbeta"> is where the drama begins. This term controls the <strong>magnitude of the R-R interval drop when you start exercising</strong>. Negative values mean your heart is freaking out, like when you realize you left the stove on mid-workout. The bigger the absolute value of <img src="https://latex.codecogs.com/png.latex?%5Cbeta">, <strong>the steeper the nosedive</strong>. In our study, <img src="https://latex.codecogs.com/png.latex?%5Cbeta%20=%20-345"> ms meant participants’ hearts were basically doing a <em>Free Solo</em> cliff drop during exercise.</p>
<p>The first logistic term, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cbeta%7D%7B1%20+%20e%5E%7B%5Clambda(t-%5Ctau)%7D%7D">, is the <strong>mathematical equivalent of your sympathetic nervous system slamming the gas pedal</strong>. The denominator <img src="https://latex.codecogs.com/png.latex?1%20+%20e%5E%7B%5Clambda(t-%5Ctau)%7D"> ensures the drop isn’t instant, it’s a smooth(ish) transition, like a rollercoaster cresting the first hill.</p>
<p>In R, simulating this is a breeze:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">f1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(t, alpha, beta, lambda, tau) {</span>
<span id="cb2-2">  alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (t <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> tau)))</span>
<span id="cb2-3">}</span></code></pre></div>
</div>
<p>Plug in <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%20860"> ms, <img src="https://latex.codecogs.com/png.latex?%5Cbeta%20=%20-345">, <img src="https://latex.codecogs.com/png.latex?%5Clambda%20=%20-3.05">, and <img src="https://latex.codecogs.com/png.latex?%5Ctau%20=%206.71">, and you’ve got a curve that drops like Bitcoin in 2022.</p>
</section>
<section id="the-drop-rate-lambda-and-timing-tau-how-fast-and-when-the-chaos-unfolds" class="level4">
<h4 class="anchored" data-anchor-id="the-drop-rate-lambda-and-timing-tau-how-fast-and-when-the-chaos-unfolds">3. The Drop Rate (<img src="https://latex.codecogs.com/png.latex?%5Clambda">) and Timing (<img src="https://latex.codecogs.com/png.latex?%5Ctau">): How Fast and When the Chaos Unfolds</h4>
<p><img src="https://latex.codecogs.com/png.latex?%5Clambda"> (lambda) dictates <strong>how steep the R-R interval plummets</strong>. A more negative <img src="https://latex.codecogs.com/png.latex?%5Clambda"> means a sharper drop, picture your heart rate during a sprint versus a leisurely stroll. In our model, <img src="https://latex.codecogs.com/png.latex?%5Clambda%20=%20-3.05"> is like your heart yelling, “ABANDON SHIP!” the moment exercise starts.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctau"> (tau) is the inflection point, <strong>the exact moment the drop begins</strong>. At <img src="https://latex.codecogs.com/png.latex?%5Ctau%20=%206.71"> minutes, it’s the split second your heart realizes you’re not joking about that burpee challenge. This parameter ensures the model doesn’t assume everyone panics at the same time (because let’s face it, some of us start sweating just <em>thinking</em> about exercise).</p>
<p>The code snippet for this term is <strong>deceptively simple</strong>, but the real magic is in the exponent: <img src="https://latex.codecogs.com/png.latex?%5Clambda(t%20-%20%5Ctau)">. This scaling ensures the drop accelerates exponentially <strong>once triggered</strong>, mimicking the body’s all-hands-on-deck response to physical stress.</p>
</section>
<section id="the-recovery-squad-c-phi-delta-redemption-arc-post-exercise" class="level4">
<h4 class="anchored" data-anchor-id="the-recovery-squad-c-phi-delta-redemption-arc-post-exercise">4. The Recovery Squad (<img src="https://latex.codecogs.com/png.latex?c">, <img src="https://latex.codecogs.com/png.latex?%5Cphi">, <img src="https://latex.codecogs.com/png.latex?%5Cdelta">): Redemption Arc Post-Exercise</h4>
<p>After the storm comes the calm, or at least, your heart’s attempt at it. The second logistic term, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B-c%20%5Ccdot%20%5Cbeta%7D%7B1%20+%20e%5E%7B%5Cphi(t%20-%20%5Ctau%20-%20%5Cdelta)%7D%7D">, is where your parasympathetic nervous system (the “rest and digest” crew) steps in to clean up the mess.</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?c">: The <strong>recovery proportion.</strong> If <img src="https://latex.codecogs.com/png.latex?c%20=%200.84">, your heart claws back 84% of the drop. It’s like forgiving a partner for eating your leftovers, <em>most</em> of the damage is undone, but you’re still side-eyeing them.<br>
</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cphi"> (phi): The <strong>speed of recovery</strong>. <img src="https://latex.codecogs.com/png.latex?%5Cphi%20=%20-2.6"> means your heart rebounds faster than a Marvel hero post-snap. The more negative <img src="https://latex.codecogs.com/png.latex?%5Cphi">, the quicker the bounce-back.<br>
</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cdelta"> (delta): <strong>The lag before recovery begins</strong>. <img src="https://latex.codecogs.com/png.latex?%5Cdelta%20=%203.24"> minutes is your heart’s version of “I need a minute to process this” after exercise.</li>
</ul>
<p>In code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">f2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(t, beta, c, phi, delta, tau) {</span>
<span id="cb3-2">  (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> beta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (t <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> tau <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> delta)))</span>
<span id="cb3-3">}</span></code></pre></div>
</div>
<p>This term is essentially <strong>a mirror image of the first logistic curve</strong>, flipped upside down (thanks to the <img src="https://latex.codecogs.com/png.latex?-c%20%5Ccdot%20%5Cbeta">) and delayed by <img src="https://latex.codecogs.com/png.latex?%5Cdelta">. <strong>Together, they form a U-shaped curve</strong> that’s the hallmark of cardiac recovery, like a phoenix rising from the ashes of your HIIT session.</p>
</section>
<section id="the-full-picture-from-rest-to-chaos-to-redemption" class="level4">
<h4 class="anchored" data-anchor-id="the-full-picture-from-rest-to-chaos-to-redemption">5. The Full Picture: From Rest to Chaos to Redemption</h4>
<p>Combine both terms, and you get the complete RRi trajectory, <strong>a symphony of stress and recovery</strong>. The first logistic function models the <em>sympathetic</em> nervous system’s <em>hold my beer</em> moment, while the second captures the <em>parasympathetic</em> system’s <em>I got you, fam</em>.</p>
<p>Plotting this in R is where the magic happens:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">time <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)</span>
<span id="cb4-2">total <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">f1</span>(time, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">860</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">345</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.71</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-3">         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">f2</span>(time, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">345</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.84</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.24</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.71</span>)</span>
<span id="cb4-4"></span>
<span id="cb4-5">plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb4-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time,</span>
<span id="cb4-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total =</span> total</span>
<span id="cb4-8">)</span>
<span id="cb4-9"></span>
<span id="cb4-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(plot_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> total <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">201</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> total <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> total <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> total), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.71</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.71</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.24</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RRi (ms)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (min)"</span>,</span>
<span id="cb4-19">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Your Heart's Epic Journey"</span>,</span>
<span id="cb4-20">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simulated and True RRi Signal"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-5-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/index_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>This plot isn’t just a curve, it’s a story. The dip represents your <strong>heart’s “oh crap” phase during exercise</strong>, while the rebound is its slow return to sanity. The lag (<img src="https://latex.codecogs.com/png.latex?%5Cdelta">) ensures the model doesn’t assume recovery starts the millisecond you stop moving (because let’s be real, your heart needs a breather too).</p>
</section>
<section id="why-logistic-functions-because-your-heart-isnt-basic" class="level4">
<h4 class="anchored" data-anchor-id="why-logistic-functions-because-your-heart-isnt-basic">Why Logistic Functions? Because Your Heart Isn’t Basic</h4>
<p>Linear models are the vanilla ice cream of math, safe, predictable, and kinda boring. <strong>But your heart? It’s more of a salted caramel espresso swirl</strong>. Logistic functions excel here because they handle <em>saturation effects</em>: the idea that <strong>your heart rate can’t drop infinitely</strong> (you’re not The Flash) <strong>or recover instantly</strong> (you’re not Wolverine).</p>
<p>The sigmoid shape of <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B1%20+%20e%5E%7B-x%7D%7D"> is perfect <strong>for modeling transitions between states</strong>. During exercise, it captures the gradual takeover of sympathetic dominance. Post-exercise, the mirrored sigmoid reflects the parasympathetic system’s cautious return. Together, <strong>they’re the yin and yang of cardiac control</strong>, like <em>Thor and Loki</em>, but with fewer explosions and stabbings.</p>
</section>
<section id="from-math-to-medicine-what-these-parameters-really-mean" class="level4">
<h4 class="anchored" data-anchor-id="from-math-to-medicine-what-these-parameters-really-mean">From Math to Medicine: What These Parameters Really Mean</h4>
<ul>
<li><strong>High <img src="https://latex.codecogs.com/png.latex?%5Calpha"></strong>: Your heart’s baseline is chill AF. Maybe you’re a yogi or just really good at naps.<br>
</li>
<li><strong>Low <img src="https://latex.codecogs.com/png.latex?%5Cbeta"></strong>: Your heart panics hard during exercise. Congrats, you’re the <em>Jason Bourne</em> of cardio.<br>
</li>
<li><strong>Sluggish <img src="https://latex.codecogs.com/png.latex?%5Cphi"></strong>: Recovery takes forever. Your parasympathetic system is basically a sloth on Ambien.<br>
</li>
<li><strong>Long <img src="https://latex.codecogs.com/png.latex?%5Cdelta"></strong>: Your heart takes its sweet time to recover. It’s the <em>George R.R. Martin</em> of organs, delays are inevitable.</li>
</ul>
<p>These parameters <strong>aren’t just academic, they’re actionable</strong>. A low <img src="https://latex.codecogs.com/png.latex?c"> (recovery proportion) <strong>could signal poor autonomic resilience</strong>, hinting at conditions like diabetes or hypertension. A wild <img src="https://latex.codecogs.com/png.latex?%5Clambda"> (drop rate) might mean your sympathetic system is overzealous, like a puppy seeing a squirrel.</p>
</section>
<section id="behind-the-curtain-stan-hmc-and-bayesian-jedi-tricks" class="level4">
<h4 class="anchored" data-anchor-id="behind-the-curtain-stan-hmc-and-bayesian-jedi-tricks">Behind the Curtain: Stan, HMC, and Bayesian Jedi Tricks</h4>
<p>Fitting this model isn’t for the faint of heart. We used <strong>Stan</strong> (a probabilistic programming language) and <a href="https://doi.org/10.59350/fa26y-xa178">Hamiltonian Monte Carlo (HMC)</a> to estimate parameters. Think of HMC as a GPS for navigating the jagged terrain of parameter space, it avoids dead ends and U-turns (thanks, <a href="https://doi.org/10.59350/hnk21-ggm53">No-U-Turn Sampler</a>!) to find the optimal values.</p>
<p>Translation: We told Stan, <strong>“Here’s our equation, here’s our data, and please don’t blow up.”</strong> The result? Posterior distributions for each parameter that tell us not just <em>best guesses</em> but <em>uncertainty</em>, like weather forecasts for your heart rate.</p>
</section>
<section id="why-this-matters" class="level4">
<h4 class="anchored" data-anchor-id="why-this-matters">Why This Matters?</h4>
<p>This model <strong>isn’t just a party trick for stats nerds</strong>. It’s a bridge between cold, hard data and the messy reality of human physiology. By linking <strong>parameters to real-world mechanisms</strong>, like sympathetic activation or vagal tone, we can:</p>
<ul>
<li><strong>Personalize rehab</strong>: Tailor exercises to your autonomic “personality.”<br>
</li>
<li><strong>Detect early risks</strong>: Spot sluggish recovery before it becomes a problem.<br>
</li>
<li><strong>Optimize training</strong>: Adjust workout intensity based on real-time heart rate dynamics.</li>
</ul>
<p>Imagine a Fitbit that <strong>doesn’t just count steps</strong> but whispers, <em>“Hey, your <img src="https://latex.codecogs.com/png.latex?%5Cphi"> is low, skip the espresso today.”</em> That’s the future we’re building.</p>
<p>Your heart isn’t a metronome. <strong>It’s a jazz drummer, improvisational, dynamic, and occasionally chaotic</strong>. This model embraces that chaos, using logistic functions to map the rhythm of rest, panic, and recovery. Whether you’re a data scientist, a clinician, or someone who just wants to know why burpees feel like death, remember: <strong>behind every heartbeat is a story</strong>. And now, we’ve got the math to read it.</p>
</section>
</section>
</section>
<section id="implementing-hamiltonian-monte-carlo-hmc" class="level1 page-columns page-full">
<h1>Implementing Hamiltonian Monte Carlo (HMC)</h1>
<p>So, you want to estimate parameters for a fancy heart rate model using HMC? Buckle up, <strong>this is like teaching a self-driving car to navigate a maze</strong>, but instead of a car, it’s math, and instead of a maze, it’s your heart’s chaotic response to exercise. Let’s break it down without the PhD jargon.</p>
<section id="step-1-what-even-is-hmc" class="level4">
<h4 class="anchored" data-anchor-id="step-1-what-even-is-hmc">Step 1: What Even Is HMC?</h4>
<p>Imagine you’re hiking up a mountain (the “<em>posterior distribution</em>” of parameters you want to explore). Traditional methods like <strong>Metropolis-Hastings are like taking random steps blindfolded</strong>, you’ll eventually reach the peak, but it’ll take forever. <strong>HMC? It’s strapping on a jetpack</strong> that uses <em>physics</em> (Hamiltonian dynamics) to glide you smoothly toward high-probability areas.</p>
<p>Here’s the twist:</p>
<ul>
<li><strong>Parameters = Positions</strong>: Your model’s unknowns (like <img src="https://latex.codecogs.com/png.latex?%5Calpha">, <img src="https://latex.codecogs.com/png.latex?%5Cbeta">) are coordinates on a map.<br>
</li>
<li><strong>Momentum = Auxiliary Variables</strong>: Fake “physics” variables that give your jetpack thrust.<br>
</li>
<li><strong>Hamiltonian = Total Energy</strong>: Combines “potential energy” (how badly your model fits the data) and “kinetic energy” (your momentum’s oomph).</li>
</ul>
<p>You simulate <strong>sliding around this energy landscape</strong>, guided by gradients (math’s version of GPS), to find the best parameter values.</p>
</section>
<section id="step-2-the-no-u-turn-sampler-nuts-autopilot-for-hmc" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="step-2-the-no-u-turn-sampler-nuts-autopilot-for-hmc">Step 2: The No-U-Turn Sampler (NUTS): Autopilot for HMC</h4>
<p>HMC’s Achilles’ heel? <strong>Picking the right step size</strong> (<img src="https://latex.codecogs.com/png.latex?%5Cepsilon">) <strong>and number of steps</strong> (<img src="https://latex.codecogs.com/png.latex?L">). Get it wrong, and you’re either crawling or overshooting the peak. Enter <strong>NUTS</strong>, the Marie Kondo of MCMC, it automates tuning so your sampling “sparks joy.”</p>
<p>We have already cover the fundamentals of NUTS in a <a href="https://doi.org/10.59350/hnk21-ggm53">previous post</a>. But, for the sake of time, let’s quickly remember how it works (in case you obviously read my <a href="https://doi.org/10.59350/hnk21-ggm53">previous post on NUTS</a>):</p>
<ol type="1">
<li><strong>Build a Tree</strong>: NUTS grows a binary tree of potential steps forward and backward in time.<br>
</li>
<li><strong>Stop at U-Turns</strong>: If the path starts doubling back (a “U-turn”), it stops. No wasted steps!<br>
</li>
<li><strong>Adapt Step Size</strong>: During warm-up, NUTS adjusts <img src="https://latex.codecogs.com/png.latex?%5Cepsilon"> to hit a ~80% acceptance rate, Goldilocks’ “just right.”</li>
</ol>
<p>In our paper, we used <strong>Stan</strong> (via R’s <code>brms</code> package) to handle this. Stan is like a robot butler that <strong>does the math while you sip coffee</strong> (or <em>mate</em><sup>1</sup>).</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;It’s like coffee but 10 times more intense and face-wrenching</p></div></div></section>
<section id="step-3-defining-the-model-plugging-in-the-equation" class="level4">
<h4 class="anchored" data-anchor-id="step-3-defining-the-model-plugging-in-the-equation">Step 3: Defining the Model, Plugging in the Equation</h4>
<p>Okay, all fun and stuff but what is the model? Let’s remember our paper’s model which is a beast:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7BRRi%7D(t)%20=%20%5Calpha%20+%20%5Cunderbrace%7B%5Cfrac%7B%5Cbeta%7D%7B1%20+%20e%5E%7B%5Clambda(t-%5Ctau)%7D%7D%7D_%7B%5Ctext%7BExercise%7D%7D%20+%20%5Cunderbrace%7B%5Cfrac%7B-c%20%5Ccdot%20%5Cbeta%7D%7B1%20+%20e%5E%7B%5Cphi(t-%5Ctau-%5Cdelta)%7D%7D%7D_%7B%5Ctext%7BRecovery%7D%7D%0A"></p>
<p>In <code>brms</code>, you’d write this as a non-linear formula:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(brms)</span>
<span id="cb5-2">model_formula <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bf</span>(</span>
<span id="cb5-3">  RRi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> tau))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-4">                (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> beta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> tau <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> delta))),</span>
<span id="cb5-5">  alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, tau <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, delta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nl =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb5-7">)</span></code></pre></div>
</div>
<p><strong>Translation</strong>: “Hey Stan, here’s our equation. The parameters are <img src="https://latex.codecogs.com/png.latex?%5Calpha,%20%5Cbeta,%20%5Clambda,%20%5Ctau,%20c,%20%5Cphi,%20%5Cdelta">. Go <em>nuts</em>”.</p>
</section>
<section id="step-4-setting-priors-because-even-math-needs-boundaries" class="level4">
<h4 class="anchored" data-anchor-id="step-4-setting-priors-because-even-math-needs-boundaries">Step 4: Setting Priors, Because Even Math Needs Boundaries</h4>
<p>Priors keep the parameters from going rogue. For example:<br>
- <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> (<strong>exercise-induced drop</strong>) should be negative, no one’s R-R interval <em>increases</em> when sprinting.<br>
- <img src="https://latex.codecogs.com/png.latex?%5Ctau"> (<strong>panic start time</strong>) can’t be negative (unless your heart panics <em>before</em> exercise, which… same).</p>
<p>In <code>brms</code>, you’d set these like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">priors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alpha"</span>),   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Baseline RR ~800 ms</span></span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"beta"</span>),    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Drop magnitude ~-300 ms</span></span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>),      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recovery ~80%</span></span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lambda"</span>),   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Drop rate ~-3</span></span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"phi"</span>),      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recovery rate ~-2</span></span>
<span id="cb6-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tau"</span>),       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Panic starts ~6 min</span></span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"delta"</span>)      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recovery lag ~3 min</span></span>
<span id="cb6-9">)</span></code></pre></div>
</div>
<p>These priors aren’t wild guesses, <strong>they’re based on domain knowledge</strong> (or in this case, the paper’s cohort data).</p>
</section>
<section id="step-5-simulating-data-the-noisier-the-better" class="level4">
<h4 class="anchored" data-anchor-id="step-5-simulating-data-the-noisier-the-better">Step 5: Simulating Data, The Noisier the Better</h4>
<p>In order to illustrate how our model work and how we can estimate parameters from RRi data, we need data in the first place. <strong>Let’s create some fictional RRi data for teaching purposes</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## We create a data.frame with time intervals</span></span>
<span id="cb7-2">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb7-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb7-4">)</span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Then we estimate some arbitrary RRi pattern with added noise</span></span>
<span id="cb7-7">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">within</span>(data, {</span>
<span id="cb7-8">  RRi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> </span>
<span id="cb7-9">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-10">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(time), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb7-12">})</span></code></pre></div>
</div>
<p>And now that we have cooked some data, <strong>let’s see how our simulated RRi pattern looks</strong> like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, RRi)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (min)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RRi (ms)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simulated Heart Mayhem"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-9-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/index_files/figure-html/unnamed-chunk-9-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-6-fitting-the-model-let-stan-do-the-heavy-lifting" class="level4">
<h4 class="anchored" data-anchor-id="step-6-fitting-the-model-let-stan-do-the-heavy-lifting">Step 6: Fitting the Model, Let Stan Do the Heavy Lifting</h4>
<p>With the formula, priors, and data ready, <strong>fitting the model is anticlimactic</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm</span>(</span>
<span id="cb9-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> model_formula,</span>
<span id="cb9-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data,</span>
<span id="cb9-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior =</span> priors,</span>
<span id="cb9-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gaussian</span>(),</span>
<span id="cb9-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chains =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run 4 parallel MCMC chains</span></span>
<span id="cb9-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2000 iterations per chain</span></span>
<span id="cb9-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warmup =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># First 1000 are warmup (tuning)</span></span>
<span id="cb9-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">adapt_delta =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Be extra careful</span></span>
<span id="cb9-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"my_rri_model.RDS"</span></span>
<span id="cb9-11">)</span></code></pre></div>
</div>
<p>Stan will churn through the data, <strong>using HMC (via NUTS) to explore the posterior</strong>. It’s like training a neural network, but instead of cat pictures, it’s heart rate curves.</p>
</section>
<section id="step-7-checking-convergence-is-the-robot-butler-drunk" class="level4">
<h4 class="anchored" data-anchor-id="step-7-checking-convergence-is-the-robot-butler-drunk">Step 7: Checking Convergence, Is the Robot Butler Drunk?</h4>
<p>After sampling, you need to check if the chains (parallel runs) agree. Key diagnostics:<br>
- <strong>R-hat ( <img src="https://latex.codecogs.com/png.latex?%5Chat%7BR%7D"> )</strong>: Should be ≤1.01. If it’s 1.5, your chains are arguing like siblings.<br>
- <strong>Effective Sample Size (ESS)</strong>: Should be &gt;1000. Low ESS? Your jetpack sputtered.</p>
<p>In R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: RRi ~ alpha + beta/(1 + exp(lambda * (time - tau))) + (-c * beta)/(1 + exp(phi * (time - tau - delta))) 
         alpha ~ 1
         beta ~ 1
         lambda ~ 1
         tau ~ 1
         c ~ 1
         phi ~ 1
         delta ~ 1
   Data: data (Number of observations: 201) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
alpha_Intercept    800.75      3.45   794.18   807.53 1.00     3052     2914
beta_Intercept    -291.16     11.52  -314.42  -269.81 1.00     2077     2512
lambda_Intercept    -2.88      0.32    -3.54    -2.30 1.00     3034     2480
tau_Intercept        5.87      0.05     5.77     5.98 1.00     2581     2467
c_Intercept          0.80      0.01     0.79     0.82 1.00     4280     3403
phi_Intercept       -2.02      0.26    -2.57    -1.57 1.00     3172     2514
delta_Intercept      3.17      0.12     2.94     3.39 1.00     2401     2769

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    29.27      1.48    26.59    32.40 1.00     4401     2760

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>Look for <code>Bulk_ESS</code> and <code>Tail_ESS</code> in the output. If they’re solid, proceed. If not, cry (or increase <code>iter</code>).</p>
</section>
<section id="why-this-matters-1" class="level4">
<h4 class="anchored" data-anchor-id="why-this-matters-1">Why This Matters?</h4>
<p>HMC <strong>isn’t just academic flexing</strong>. By leveraging gradients (derivatives of the log-posterior), it efficiently explores complex, high-dimensional spaces. <strong>Traditional methods would get lost</strong>; HMC glides through like it’s on rails.</p>
<p>For the paper, this meant accurately capturing:</p>
<ul>
<li><strong>How quickly</strong> someone’s heart panics (<img src="https://latex.codecogs.com/png.latex?%5Clambda">).<br>
</li>
<li><strong>How much</strong> it recovers (<img src="https://latex.codecogs.com/png.latex?c">).<br>
</li>
<li><strong>When</strong> the panic starts (<img src="https://latex.codecogs.com/png.latex?%5Ctau">).</li>
</ul>
<p>These parameters aren’t just numbers, <strong>they’re biomarkers</strong>. Low <img src="https://latex.codecogs.com/png.latex?c"> could flag poor recovery in heart patients. High <img src="https://latex.codecogs.com/png.latex?%5Clambda"> might indicate hyper-reactive stress responses.</p>
<p>Implementing HMC <strong>is like teaching a robot to dance</strong>. It’s intricate, requires tuning, and occasionally feels like magic. But with tools like Stan and <code>brms</code>, you don’t need to be a physicist, <strong>just a data-savvy human with a problem to solve</strong>.</p>
<p>So next time your heart races during a workout, remember: <strong>there’s an entire universe of math and code</strong> working to understand its tantrums. And that’s kinda beautiful.</p>
</section>
</section>
<section id="visualizing-the-posterior" class="level1 page-columns page-full">
<h1>Visualizing the Posterior</h1>
<p>Let’s face it, <strong>statistics can be drier than a saltine cracker</strong>. But when you visualize the posterior distributions of your model parameters, magic happens. Suddenly, <strong>abstract numbers transform into a story</strong> about your heart’s tantrums, resilience, and secret grudges against burpees. Here’s how to decode the math into physiological insights, complete with R code and plots that <strong>even your cardio-phobic cousin would understand</strong>.</p>
<section id="baseline-r-r-interval-alpha-the-hearts-resting-vibe" class="level4">
<h4 class="anchored" data-anchor-id="baseline-r-r-interval-alpha-the-hearts-resting-vibe">1. Baseline R-R interval (<img src="https://latex.codecogs.com/png.latex?%5Calpha">): The Heart’s Resting Vibe</h4>
<p>We’ll start with the <strong>posterior density plot for <img src="https://latex.codecogs.com/png.latex?%5Calpha"></strong>, the resting R-R interval. Using <code>brms</code> and <code>bayesplot</code>, we can visualize where this parameter likely lives:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(bayesplot)</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb12-3"></span>
<span id="cb12-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract posterior samples</span></span>
<span id="cb12-5">posterior_draws <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_draws_df</span>(fit)</span>
<span id="cb12-6"></span>
<span id="cb12-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot density with 90% credible interval</span></span>
<span id="cb12-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_areas</span>(posterior_draws, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_alpha_Intercept"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Baseline R-R interval (α)"</span>,</span>
<span id="cb12-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R-R interval (ms)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb12-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-12-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/index_files/figure-html/unnamed-chunk-12-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p><strong>What This Means</strong>:</p>
<ul>
<li>A peak around 800 ms suggests a resting heart rate of ~75 bpm (since RRi ≈ 60,000 / heart rate).<br>
</li>
<li>A narrow 90% CI (e.g., 795–805 ms) means little uncertainty.<br>
</li>
<li><strong>Physiological Insight</strong>: Low <img src="https://latex.codecogs.com/png.latex?%5Calpha"> (short R-R intervals) could hint at chronic stress or lower fitness (lower R-R intervals, means faster heart rate). High <img src="https://latex.codecogs.com/png.latex?%5Calpha">? Maybe your participants are fitness pros.</li>
</ul>
</section>
<section id="exercise-panic-beta-and-drop-rate-lambda-the-oh-crap-phase" class="level4">
<h4 class="anchored" data-anchor-id="exercise-panic-beta-and-drop-rate-lambda-the-oh-crap-phase">2. Exercise Panic (<img src="https://latex.codecogs.com/png.latex?%5Cbeta">) and Drop Rate (<img src="https://latex.codecogs.com/png.latex?%5Clambda">): The “Oh Crap” Phase</h4>
<p>Next, let’s plot <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> (drop <strong>magnitude</strong>) and <img src="https://latex.codecogs.com/png.latex?%5Clambda"> (drop <strong>steepness</strong>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine plots</span></span>
<span id="cb13-2">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_areas</span>(posterior_draws, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_beta_Intercept"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exercise-Induced Drop (β)"</span>,</span>
<span id="cb13-4">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Δ R-R interval (ms)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb13-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb13-7"></span>
<span id="cb13-8">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_areas</span>(posterior_draws, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_lambda_Intercept"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Drop Rate (λ)"</span>,</span>
<span id="cb13-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rate (per min)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb13-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb13-13"></span>
<span id="cb13-14">ggpubr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggarrange</span>(p1, p2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-13-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/index_files/figure-html/unnamed-chunk-13-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p><strong>What This Means</strong>:</p>
<ul>
<li>A <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> posterior centered at -290 ms means hearts dropped ~290 ms during exercise, like going from 75 bpm (~800 ms) to 120 bpm (~500 ms).<br>
</li>
<li>A <img src="https://latex.codecogs.com/png.latex?%5Clambda"> of -3 suggests a sharp drop in R-R intervals; it took ~15 seconds to bottom out. Think of it as your heart yelling, “<em>This</em> is happening?!”<br>
</li>
<li><strong>Physiological Insight</strong>: A steeper <img src="https://latex.codecogs.com/png.latex?%5Clambda"> (more negative) implies rapid sympathetic activation, great for athletes, worrisome if paired with poor recovery.</li>
</ul>
</section>
<section id="recovery-parameters-c-phi-delta-the-redemption-arc" class="level4">
<h4 class="anchored" data-anchor-id="recovery-parameters-c-phi-delta-the-redemption-arc">3. Recovery Parameters (<img src="https://latex.codecogs.com/png.latex?c">, <img src="https://latex.codecogs.com/png.latex?%5Cphi">, <img src="https://latex.codecogs.com/png.latex?%5Cdelta">): The Redemption Arc</h4>
<p>Now, the <strong>recovery phase</strong>, where your heart forgives (or doesn’t) your life choices:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot all three</span></span>
<span id="cb14-2">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_areas</span>(posterior_draws, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_c_Intercept"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Recovery Proportion (c)"</span>,</span>
<span id="cb14-4">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Proportion of Drop Recovered"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb14-7"></span>
<span id="cb14-8">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_areas</span>(posterior_draws, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_phi_Intercept"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Recovery Rate (φ)"</span>,</span>
<span id="cb14-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rate (per min)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb14-13"></span>
<span id="cb14-14">p3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_areas</span>(posterior_draws, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_delta_Intercept"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Recovery Lag (δ)"</span>,</span>
<span id="cb14-16">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lag Time (min)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb14-19"></span>
<span id="cb14-20">ggpubr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggarrange</span>(p1, p2, p3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-14-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/index_files/figure-html/unnamed-chunk-14-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p><strong>What This Means</strong>:</p>
<ul>
<li><strong><img src="https://latex.codecogs.com/png.latex?c%20=%200.80"></strong>: Hearts recovered 80% of the exercise drop. The 90% CI (0.79–0.82) means high confidence, which could translate the discussion into autonomic resilience.</li>
<li><strong><img src="https://latex.codecogs.com/png.latex?%5Cphi%20=%20-2"></strong>: Recovery was brisk but not instant (about 20-25 seconds). A more negative <img src="https://latex.codecogs.com/png.latex?%5Cphi"> would mean faster parasympathetic reactivation.</li>
<li><strong><img src="https://latex.codecogs.com/png.latex?%5Cdelta%20=%203.2"></strong> min: Hearts waited ~3 minutes post-exercise to start recovering. Longer lads might indicate autonomic fatigue.<br>
</li>
<li><strong>Physiological Insight</strong>: Low <img src="https://latex.codecogs.com/png.latex?c">, <img src="https://latex.codecogs.com/png.latex?%5Cphi"> or long <img src="https://latex.codecogs.com/png.latex?%5Cdelta"> could flag impaired recovery, common in aging or conditions like diabetes.</li>
</ul>
</section>
<section id="simulating-rri-curves-from-posteriors-to-predictions" class="level4">
<h4 class="anchored" data-anchor-id="simulating-rri-curves-from-posteriors-to-predictions">4. Simulating RRi Curves: From Posteriors to Predictions</h4>
<p><strong>Posteriors aren’t just pretty plots</strong>, they let us simulate <em>real heartbeats</em>. Let’s generate RRi trajectories using parameter samples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get 100 posterior samples</span></span>
<span id="cb15-2">posterior_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> posterior_draws[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample.int</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>),]</span>
<span id="cb15-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(posterior_samples) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(posterior_samples) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^b_"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replacement =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_Intercept$"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replacement =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb15-6"></span>
<span id="cb15-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate RRi curves</span></span>
<span id="cb15-8">simulated_rri <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dfr</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb15-9">  params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> posterior_samples[i, ]</span>
<span id="cb15-10">  tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb15-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>),</span>
<span id="cb15-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">RRi =</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-13">          params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>tau))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-14">          (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>beta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>tau <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>delta))),</span>
<span id="cb15-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sim_id =</span> i</span>
<span id="cb15-16">  )</span>
<span id="cb15-17">})</span>
<span id="cb15-18"></span>
<span id="cb15-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot spaghetti</span></span>
<span id="cb15-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(simulated_rri, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, RRi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> sim_id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"100 Simulated RRi Trajectories"</span>,</span>
<span id="cb15-24">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Compatible with simulated RRi"</span>,</span>
<span id="cb15-25">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (min)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R-R interval (ms)"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-15-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/index_files/figure-html/unnamed-chunk-15-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p><strong>What This Means</strong>:</p>
<ul>
<li>This <strong>“spaghetti” plot</strong> shows the <em>uncertainty</em> in predictions. Thick bands = high confidence. Gaps = “We’re not very sure what happens here.”<br>
</li>
<li>The <strong>U-shape is consistent</strong>: sharp drop, lag, then recovery. But the timing and depth vary, reflecting individual differences. Compare it to the simulated R-R signal.</li>
<li><strong>Physiological Insight</strong>: Wider spreads post-exercise (recovery phase) suggest some hearts struggle to bounce back, highlighting candidates for closer monitoring.</li>
</ul>
</section>
<section id="correlations-between-parameters-the-autonomic-tug-of-war" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="correlations-between-parameters-the-autonomic-tug-of-war">5. Correlations Between Parameters: The Autonomic Tug-of-War</h4>
<p>Finally, let’s explore how parameters interact using a <strong>pairwise correlation plot</strong>:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc_pairs</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_alpha_Intercept"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_beta_Intercept"</span>,</span>
<span id="cb16-2">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_c_Intercept"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_phi_Intercept"</span>),</span>
<span id="cb16-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">diag_fun =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dens"</span>,</span>
<span id="cb16-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">off_diag_fun =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hex"</span>)</span></code></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><a href="index_files/figure-html/unnamed-chunk-16-1.svg" class="lightbox page-columns page-full" data-gallery="quarto-lightbox-gallery-8"><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/index_files/figure-html/unnamed-chunk-16-1.svg" class="img-fluid figure-img column-page" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<p><strong>What This Means</strong>:</p>
<ul>
<li><strong><img src="https://latex.codecogs.com/png.latex?%5Calpha"> vs.&nbsp;<img src="https://latex.codecogs.com/png.latex?%5Cbeta"></strong>: Negative correlation? High resting RRi (chill hearts) might panic harder during exercise.<br>
</li>
<li><strong><img src="https://latex.codecogs.com/png.latex?c"> vs.&nbsp;<img src="https://latex.codecogs.com/png.latex?%5Cphi"></strong>: Positive correlation? Faster recovery (<img src="https://latex.codecogs.com/png.latex?%5Cphi">) often pairs with fuller recovery (<img src="https://latex.codecogs.com/png.latex?c">).<br>
</li>
<li><strong>Physiological Insight</strong>: These relationships hint at <em>autonomic coupling</em>, how sympathetic and parasympathetic systems coordinate.</li>
</ul>
</section>
<section id="why-this-matters-2" class="level4">
<h4 class="anchored" data-anchor-id="why-this-matters-2">Why This Matters?</h4>
<p>These visualizations aren’t just academic eye candy. They’re tools for:<br>
- <strong>Personalized Medicine</strong>: Spotting outliers in <img src="https://latex.codecogs.com/png.latex?%5Calpha"> or <img src="https://latex.codecogs.com/png.latex?c"> could flag at-risk patients.<br>
- <strong>Training Optimization</strong>: Athletes with steeper <img src="https://latex.codecogs.com/png.latex?%5Clambda"> might handle higher intensities.<br>
- <strong>Aging Research</strong>: The paper’s elderly cohort had slower recovery (<img src="https://latex.codecogs.com/png.latex?phi">), comparing to young cohorts could unravel age-related decline.</p>
<p>Imagine a clinic where these plots pop up during a stress test, <strong>guiding real-time interventions</strong>. Or a coach adjusting workouts based on a runner’s recovery lag (<img src="https://latex.codecogs.com/png.latex?%5Cdelta">). <strong>That’s the power of marrying math with physiology</strong>.</p>
<p>Your heart’s story is <strong>written in logistic curves and probability densities</strong>. By visualizing the posteriors, we’re not just crunching numbers, <strong>we’re decoding the language of life itself</strong>. And honestly, that’s way cooler than any Fitbit dashboard.</p>
</section>
</section>
<section id="discussion-the-bigger-picture" class="level1 page-columns page-full">
<h1>Discussion: The Bigger Picture</h1>
<p>Let’s cut to the chase: <strong>hearts are messy. They’re not metronomes, they’re jazz musicians, improvisational, dynamic, and occasionally chaotic</strong>. For decades, we’ve tried to shove their rhythms into neat little boxes labeled “heart rate variability” or “linear models,” like forcing a wild stallion into a petting zoo. This paper’s non-linear model isn’t just a math flex; it’s a rebellion against oversimplification. By embracing the chaos of R-R intervals with logistic functions, <strong>we’re finally acknowledging that your heart’s response to exercise isn’t a straight line, it’s a rollercoaster</strong>. And that matters.</p>
<p>The implications here are bigger than your last Amazon impulse buy. <strong>Traditional HRV metrics</strong>, while useful, are like summarizing <em>War and Peace</em> as “some Russians had feelings.” They <strong>collapse the entire story of your autonomic nervous system into a single number</strong>, losing the plot twists, the moment your sympathetic system slams the gas pedal during a sprint, or the parasympathetic system’s slow-mo victory lap post-exercise. <strong>Our model captures these nuances</strong>, offering a high-definition lens into cardiac dynamics. <strong>For clinicians, this could mean spotting early signs of autonomic dysfunction</strong>, think diabetes or hypertension, before they escalate. For athletes, it’s a roadmap to optimize recovery. For the rest of us? It’s proof that burpees are, in fact, the devil’s exercise.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/joachim-schnurle-eqTmD-baDkU-unsplash.jpg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://unsplash.com/es/@joa70?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Joachim Schnürle</a> in <a href="https://unsplash.com/es/fotos/un-primer-plano-de-un-articulo-medico-con-un-grafico-eqTmD-baDkU?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></span></div></div>
<p>But let’s not pop champagne yet. The <strong>study’s cohort, elderly individuals, mostly women, is like testing a new sports car on a group of golf cart enthusiasts</strong>. While their hearts are marvels of resilience (shoutout to the 70-year-olds out-Zumba-ing millennials), aging inherently alters autonomic function. <strong>Younger hearts</strong>, with their spry vagal tone and metabolic efficiency, <strong>might dance to a different beat</strong>. Imagine applying this model to college athletes: would their recovery lag (<img src="https://latex.codecogs.com/png.latex?%5Cdelta">) be shorter? Would their panic parameter (<img src="https://latex.codecogs.com/png.latex?%5Cbeta">) be more dramatic? We don’t know, and that’s a problem. The model’s current demographic blind spot limits its universal swagger. <strong>Future work needs to throw a wider net</strong>: young adults, elite athletes, sleep-deprived parents, and yes, <strong>even that one friend who does ultramarathons “for fun”</strong>. Only then can we see if this framework is the Swiss Army knife of cardiac analysis or a niche tool for bingo night regulars.</p>
<p>Then there’s <strong>the elephant in the room: real-world noise</strong>. The study’s controlled setting, clean data, preprocessed R-R intervals, is the scientific equivalent of a TikTok dance studio. But <strong>life isn’t a lab</strong>. Stress, caffeine, and that third espresso you shouldn’t have had all jumble the heart’s signals. <strong>Imagine deploying this model in the wild, where wearables battle motion artifacts and Wi-Fi dead zones</strong>. Can it handle the chaos? The paper’s synthetic data tests suggest yes, but until it’s stress-tested on Apple Watches dangling off sweaty wrists during CrossFit hell, we’re cautiously optimistic. Integrating real-time environmental factors, temperature, humidity, cortisol levels, <strong>could turn this model from a neat trick into a clinical powerhouse</strong>.</p>
<p>Speaking of wearables, let’s talk tech. The current Fitbit experience is like having a backseat driver who only knows two phrases: “You’re doing great!” and “Maybe sit down?” Our model could upgrade that to a co-pilot who actually understands your heart’s tantrums. <strong>Imagine your smartwatch whispering, “Your recovery proportion (<img src="https://latex.codecogs.com/png.latex?c">) is low, skip the burpees today,”</strong> or “Your <img src="https://latex.codecogs.com/png.latex?%5Cphi"> is stellar, go crush that PR.” This isn’t sci-fi; it’s the logical next step. But to get there, we need seamless integration with wearable APIs, edge computing to handle real-time analysis, and user interfaces that don’t look like they were designed in Excel. <strong>Oh, and battery life that doesn’t die mid-workout</strong>. Priorities, people.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/saradasish-pradhan-4ZimN_iVwWo-unsplash.jpg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://unsplash.com/es/@saradasish?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Saradasish Pradhan</a> in <a href="https://unsplash.com/es/fotos/un-telefono-movil-que-se-enciende-en-la-oscuridad-4ZimN_iVwWo?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></span></div></div>
<p>Now, let’s address the <strong>model’s Achilles’ heel: interpretability</strong>. Sure, logistic functions are elegant, but <strong>explaining them to a cardiologist over coffee is like teaching quantum physics to a golden retriever</strong>. The parameters, <img src="https://latex.codecogs.com/png.latex?%5Calpha">, <img src="https://latex.codecogs.com/png.latex?%5Cbeta">, <img src="https://latex.codecogs.com/png.latex?%5Clambda">, are meaningful to math nerds, but how do we translate “recovery rate (<img src="https://latex.codecogs.com/png.latex?%5Cphi">) = -2.6” into actionable advice? <strong>The answer: better visualization tools</strong>. Think interactive dashboards where doctors slide parameters and watch simulated heart rate curves morph in real time. Or <strong>apps that gamify autonomic resilience</strong>, turning “improve your <img src="https://latex.codecogs.com/png.latex?c">” into a quest worthy of Zelda. Bridging the gap between equations and empathy is the next frontier.</p>
<p>And what about the autonomic nervous system’s dark corners? <strong>The model assumes a tidy battle between sympathetic and parasympathetic systems, but biology is messy</strong>. Emerging research suggests the “sympathovagal balance” is more of a frenemies dynamic, sometimes they collaborate, sometimes they throw shade <span class="citation" data-cites="storniolo2021symbolic">(Storniolo et al. 2021)</span>. Can the model capture that? Not yet. <strong>Future iterations might need coupled differential equations</strong> or network analysis to untangle the web. Plus, factors like respiratory sinus arrhythmia (where breathing tweaks heart rate) need to be controlled for in this framework. Incorporating these could transform the model from a two-character play into an ensemble drama.</p>
<p>Let’s not forget the <strong>ethical tightrope</strong>. Personalized health data is a goldmine for innovation, and a minefield for privacy. <strong>If your smartwatch knows your heart’s deepest secrets, who else gets a backstage pass?</strong> Insurance companies? Employers? The model’s potential is undeniable, but without robust data ethics, we’re <strong>one leak away from a Black Mirror episode</strong>. Transparency, consent, and encryption aren’t buzzwords, they’re the price of admission.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/maxim-hopman-IayKLkmz6g0-unsplash.jpg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://unsplash.com/es/@nampoh?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Maxim Hopman</a> in <a href="https://unsplash.com/es/fotos/un-grupo-de-personas-de-pie-alrededor-de-una-pantalla-de-video-IayKLkmz6g0?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></span></div></div>
<p>So, where does this leave us? The <a href="https://www.researchgate.net/publication/389812477_Enhancing_cardiovascular_monitoring_a_non-linear_model_for_characterizing_RR_interval_fluctuations_in_exercise_and_recovery">paper</a> <strong>is a leap forward, but the marathon’s just begun</strong>. The road ahead is paved with unanswered questions: <strong>(1)</strong> Can the model predict cardiac events? <strong>(2)</strong> How does it interact with other biomarkers like blood pressure or glucose levels? <strong>(3)</strong> Can it adapt to pathologies like atrial fibrillation? <strong>Each step requires collaboration, mathematicians, clinicians, engineers, and yes, even ethicists</strong>, to turn this from a cool paper into a lifesaving tool.</p>
<p>In the end, <strong>this work isn’t about equations or R<sup>2</sup> values</strong>. It’s about honoring the heart’s complexity. Your heart isn’t a machine; <strong>it’s a storyteller</strong>. Each beat whispers tales of stress, joy, fatigue, and resilience. By listening, <em>truly</em> listening, to its non-linear narrative, we’re not just doing science. <strong>We’re learning a new language</strong>, one that could rewrite the future of healthcare. And honestly, that’s a plot twist worth sticking around for.</p>
</section>



<div id="quarto-appendix" class="default"><section id="appendix" class="level1 appendix"><h2 class="anchored quarto-appendix-heading">Appendix</h2><div class="quarto-appendix-contents">

<p>Check the original paper where the model is presented <a href="https://www.researchgate.net/publication/389812477_Enhancing_cardiovascular_monitoring_a_non-linear_model_for_characterizing_RR_interval_fluctuations_in_exercise_and_recovery">here</a>.</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-storniolo2021symbolic" class="csl-entry">
Storniolo, Jorge L, Beatrice Cairo, Alberto Porta, and Paolo Cavallari. 2021. <span>“Symbolic Analysis of the Heart Rate Variability During the Plateau Phase Following Maximal Sprint Exercise.”</span> <em>Frontiers in Physiology</em> 12: 632883.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{castillo-aguilar2025,
  author = {Castillo-Aguilar, Matías},
  title = {So, {You} {Think} {You} {Can} {Model} a {Heartbeat?}},
  date = {2025-03-24},
  url = {https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/},
  doi = {10.59350/qfn6w-qyt38},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-castillo-aguilar2025" class="csl-entry quarto-appendix-citeas">
Castillo-Aguilar, Matías. 2025. <span>“So, You Think You Can Model a
Heartbeat?”</span> March 24, 2025. <a href="https://doi.org/10.59350/qfn6w-qyt38">https://doi.org/10.59350/qfn6w-qyt38</a>.
</div></div></section></div> ]]></description>
  <category>cardiovascular</category>
  <category>non-linear</category>
  <category>simulation</category>
  <category>educational</category>
  <guid>https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/</guid>
  <pubDate>Mon, 24 Mar 2025 03:00:00 GMT</pubDate>
  <media:content url="https://bayesically-speaking.com/posts/2025-03-24 so-you-think-you-can-model-a-heartbeat/body_1.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Going NUTS: A Step-by-Step Guide to Adaptive Hamiltonian Sampling in R</title>
  <dc:creator>Matías Castillo-Aguilar</dc:creator>
  <link>https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1 page-columns page-full">
<h1>Introduction</h1>
<div class="page-columns page-full"><p>Remember MCMC from our series on these algorithms? Good times. We wandered through probability space <strong>like tourists with outdated maps</strong>, occasionally stumbling upon the good parts of the posterior. Then came <strong>Hamiltonian Monte Carlo</strong> (HMC), which, let’s be honest, felt like finally <strong>getting a GPS</strong>. We could <em>actually</em> explore the posterior, using gradients to guide our journey. It was efficient! It was elegant! It was… still kind of a pain in the neck. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Check our <a href="https://doi.org/10.59350/mxfyk-6av39">first post</a> on MCMC principles and use cases before diving into this post, if you haven’t done it already.</span></div></div>
<section id="why-your-hmc-was-probably-just-running-in-circles" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="why-your-hmc-was-probably-just-running-in-circles">Why Your HMC Was Probably Just Running in Circles</h4>
<div class="page-columns page-full"><p>See, HMC, for all its brilliance, has this one little quirk: <strong>it needs to be told how far to travel in each step</strong>. It’s like having a GPS that only understands instructions in increments of “exactly 5 kilometers”. Want to go 4.8 km? Too bad. Want to go 5.2 km? Tough luck. This “step size” parameter is crucial. <strong>Too small</strong>, and you’re just shuffling around like a confused shopper in a supermarket, making painfully slow progress. <strong>Too large</strong>, and you’re overshooting your target, bouncing around like a pinball, and generally wasting everyone’s time (especially your computer’s). </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Check our <a href="https://doi.org/10.59350/mxfyk-6av39">second post</a> on MCMC, more specifically on HMC, to get a better intuition of what this algorithm is doing.</span></div></div>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/running-circles.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Typical HMC running in circles around the posterior. Photo from <a href="https://www.redlegnation.com/2016/08/15/running-in-circles">Redleg Nation</a>.</span></div></div>
<p>This manual tuning of the step size is about <strong>as fun as watching paint dry</strong>. You fiddle with it, run your sampler, check the results, fiddle some more, run it again… It’s an iterative process that <strong>makes you question your life choices</strong>. You start to wonder if there’s a better way. A way to tell the sampler, <em>“Hey, just go where you need to go, okay?”</em></p>
<p>Enter the <em>No-U-Turn Sampler</em> (NUTS). Yes, it’s a ridiculous name. But it’s also a brilliant solution. NUTS <strong>is like giving your HMC GPS a brain</strong>. It dynamically figures out how far to travel in each step, adapting to the local geometry of the posterior. No more tedious manual tuning! No more endless tweaking! NUTS takes the wheel and drives you straight to the heart of the posterior distribution, <strong>efficiently exploring even the most complex landscapes</strong>.</p>
<p>In this post, we’re going to dive deep into the <strong>inner workings of NUTS</strong>. We’ll explore how it cleverly <strong>avoids those wasteful U-turns</strong> (hence the name), how it builds efficient trajectories, and how you can implement it yourself in R. By the end, you’ll be able to unleash the power of adaptive Hamiltonian sampling on your own Bayesian models, and <strong>finally say goodbye to the tyranny of fixed step sizes</strong>. You’ll learn how to transform your sampling from a tedious chore into a smooth, efficient, and (dare I say) even enjoyable experience. So buckle up, because <strong>we’re about to go NUTS!</strong></p>
</section>
</section>
<section id="when-your-posterior-looks-like-a-jackson-pollock-painting" class="level1 page-columns page-full">
<h1>When Your Posterior Looks Like a Jackson Pollock Painting</h1>
<p>So, we know HMC with fixed step sizes can be a bit… finicky. But <strong>why should we care?</strong> Are there actual problems where this matters? You bet your Bayesian priors there are! <strong>Imagine you’re trying to model something complex</strong>, like the spread of a disease, the performance of a stock portfolio, or the migratory patterns of extremely confused pigeons. These kinds of problems often lead to posterior distributions that are… well, let’s just say <strong>they’re not always nice, well-behaved Gaussians</strong>.</p>
<p>Sometimes, your posterior might have multiple peaks (multimodal), like a mountain range with several summits. Traditional MCMC methods, like Metropolis-Hastings or Gibbs sampling, can get stuck in one peak, completely missing the others. <strong>It’s like trying to find all the best restaurants in a city by only exploring one neighborhood</strong>. You might find a decent burger joint, but you’ll miss out on the amazing sushi place across town.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">my_surface <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(m, p) {</span>
<span id="cb1-2">    alpha <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span></span>
<span id="cb1-3">    ext <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> pi</span>
<span id="cb1-4">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(m) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(p) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(ext <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p)</span>
<span id="cb1-5">}</span>
<span id="cb1-6"></span>
<span id="cb1-7">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>pi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>pi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb1-8">z <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">outer</span>(x, y, my_surface)</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mai =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb1-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mar =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb1-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oma =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">persp</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z,</span>
<span id="cb1-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">phi =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>,</span>
<span id="cb1-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-2-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="The easiest posterior distribution that the average Bayesian analyst tackles in a typical day. Shortly, we’ll see how this banana-shaped distribution is explored with HMC-NUTS algorithm."><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/index_files/figure-html/unnamed-chunk-2-1.svg" class="img-fluid figure-img" alt="The easiest posterior distribution that the average Bayesian analyst tackles in a typical day. Shortly, we’ll see how this banana-shaped distribution is explored with HMC-NUTS algorithm."></a></p>
<figcaption class="margin-caption">The easiest posterior distribution that the average Bayesian analyst tackles in a typical day. Shortly, we’ll see how this banana-shaped distribution is explored with HMC-NUTS algorithm.</figcaption>
</figure>
</div>
</div>
</div>
<p>Fixed-step HMC fares a little better, thanks to its gradient-based exploration. But even it can struggle. <strong>Imagine trying to navigate that same mountain range with a vehicle that can only move in fixed increments</strong>. If the step size is too large, you might overshoot the peaks and bounce around erratically. If it’s too small, you’ll take forever to explore the terrain. And if the terrain is particularly treacherous, say, with narrow valleys and steep cliffs, <strong>you might get stuck altogether</strong>.</p>
<p>A particularly illustrative example is a posterior with a “banana-shaped” density. <strong>This isn’t some exotic fruit we’re talking about; it’s a type of distribution that curves like a banana</strong>. These curved, elongated shapes are common in hierarchical models and other complex statistical models. They present a challenge for fixed-step HMC because the optimal step size varies drastically across the distribution. A small step size might be necessary <strong>in the curved part of the “banana”</strong>, while a much larger step size would be more efficient in the straighter parts.</p>
<p>To make this concrete, let’s consider a simple bivariate Gaussian distribution with a <em>banana-shaped</em> density. We can define this as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Ax%20&amp;%5Csim%20%5Cmathcal%7BN%7D(0,%201)%20%5C%5C%0Ay%20&amp;%5Csim%20%5Cmathcal%7BN%7D(x%5E2,%200.1)%0A%5Cend%7Baligned%7D%0A"></p>
<p>This creates a posterior where <img src="https://latex.codecogs.com/png.latex?y"> is dependent on <img src="https://latex.codecogs.com/png.latex?x%5E2">, resulting in the characteristic banana shape.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">xy_seq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>)</span>
<span id="cb2-2">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand.grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xy_seq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> xy_seq)</span>
<span id="cb2-3">df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>z <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(df, {</span>
<span id="cb2-4">  x_square <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-5">  yx_square <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ((y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_square)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_square <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> yx_square)</span>
<span id="cb2-7">})</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_raster</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> z), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_contour</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#206080"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), </span>
<span id="cb2-13">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish_infinite) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), </span>
<span id="cb2-15">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish_infinite) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_gradient</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#B7CCDC"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Banana distribution, highlighting that some distributions could be difficult to explore."><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img" alt="Banana distribution, highlighting that some distributions could be difficult to explore."></a></p>
<figcaption class="margin-caption">Banana distribution, highlighting that some distributions could be difficult to explore.</figcaption>
</figure>
</div>
</div>
</div>
<p>As you can see, <strong>this posterior is far from a simple, spherical Gaussian</strong>. Trying to efficiently sample from this distribution with a fixed step size is like trying to fit a square peg in a round hole (or, in this case, a banana-shaped hole).</p>
</section>
<section id="how-to-not-get-lost-in-probability-space" class="level1 page-columns page-full">
<h1>How to Not Get Lost in Probability Space</h1>
<p>Now that we understand why fixed-step HMC can struggle, let’s dig into the magic behind NUTS. The core idea is to let the sampler <em>decide</em> <strong>how far to travel in each step</strong>, adapting to the local geometry of the posterior. This involves two key components: (1) adaptive path length and (2) the U-turn criterion.</p>
<section id="adaptive-path-length" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="adaptive-path-length">Adaptive Path Length</h3>
<p>In fixed-step HMC, you predefine a fixed number of leapfrog steps. This determines the length of the trajectory. <strong>But what if the optimal trajectory length varies across the posterior?</strong> What if sometimes you need to take a short stroll and other times a long hike?</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/foot-steps.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Foot steps in representation of the concept of “stepsize”. Photo from <a href="https://unsplash.com/es/@agneska?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">magnezis magnestic</a> in <a href="https://unsplash.com/es/fotos/huellas-en-la-arena-TW62wXQ6Omc?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a>.</span></div></div>
<p>NUTS solves this by <strong>dynamically adjusting the trajectory length</strong>. It starts with a short trajectory (e.g., just one leapfrog step) and then <em>doubles</em> it repeatedly. This doubling process continues <strong>until a certain criterion is met</strong> (which we’ll get to in the next subsection).</p>
<p>Why doubling? Because it’s efficient! It allows NUTS to quickly explore a wide range of trajectory lengths without having to try every single possible length. <strong>It’s like searching for a light switch in a dark room</strong>: you start by checking nearby, then you check a wider area, and so on, doubling your search radius <strong>until you find it</strong>.</p>
<p>Now, let’s consider a 2D example. <strong>Remember our banana-shaped posterior?</strong> With HMC-NUTS, we start with a single leapfrog step in a random direction. Then, we double the trajectory length by taking two steps, then four, and so on. <strong>The trajectory starts to resemble a branching path</strong>, exploring the posterior in ever-widening arcs.</p>
<p>Let’s now see <strong>an interactive animation</strong> of the NUTS dynamics in action over our banana-shaped distribution.</p>
<iframe width="100%" height="500" src="demo-mcmc/app.html" title="MCMC">
</iframe>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">The code for this animation is borrowed from <a href="https://github.com/chi-feng">Chi Feng’s github</a>. You can find the original repository with corresponding code here: <a href="https://github.com/chi-feng/mcmc-demo" class="uri">https://github.com/chi-feng/mcmc-demo</a>.</span></div></div>
<p>This <strong>dynamic doubling of the trajectory length is a crucial part of NUTS’s efficiency</strong>. It allows the sampler to quickly adapt to the local geometry of the posterior, taking long steps when appropriate and short steps when necessary. <strong>But how does NUTS know when to stop doubling?</strong> That’s where the U-turn criterion comes in, which we’ll explore in the next section.</p>
</section>
<section id="the-u-turn-criterion" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-u-turn-criterion">The U-Turn Criterion</h3>
<p>So, we’re doubling the trajectory length, exploring the posterior like eager adventurers. <strong>But how do we know when to stop?</strong> We don’t want to keep doubling indefinitely, wasting computational resources and potentially revisiting already explored regions. <strong>This is where the U-turn criterion comes in</strong>.</p>
<p>The basic idea is simple: if our trajectory starts to double back on itself, making <strong>a “U-turn”, it’s a good sign that we’ve explored the relevant part of the posterior in that direction</strong>. Continuing further would just be redundant. It’s like hiking up a mountain: once you reach the summit and start heading down the other side, you know you’ve gone far enough in that direction. <strong>No need to keep walking</strong> just for the sake of it (unless you’re really into hiking, I guess).</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/u-turn-sign.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://www.ricardosalinas.com/blog/images/no_existe_el_error_solo_lecciones.jpg">Ricardo Salinas’ site</a>.</span></div></div>
<p>Mathematically, a <strong>U-turn is detected by looking at the dot product of the momentum vectors at the beginning and end of the trajectory</strong>. Remember, the momentum vector indicates the direction of travel. If the dot product is negative, it means the two momentum vectors are pointing in roughly opposite directions, a clear sign of a U-turn.</p>
<p>Let’s break this down with a small example. Imagine we’re sampling from a 2D Gaussian. We start at a point <img src="https://latex.codecogs.com/png.latex?q_0"> with momentum <img src="https://latex.codecogs.com/png.latex?p_0">. We take a few leapfrog steps and end up at a point <img src="https://latex.codecogs.com/png.latex?q_T"> with momentum <img src="https://latex.codecogs.com/png.latex?p_T">.</p>
<ul>
<li>If <img src="https://latex.codecogs.com/png.latex?p_0%20%5Ccdot%20p_T%20%3E%200">, the momentum vectors are pointing in roughly the same direction. <strong>No U-turn yet. Keep exploring!</strong></li>
<li>If <img src="https://latex.codecogs.com/png.latex?p_0%20%5Ccdot%20p_T%20%3C%200">, the momentum vectors are pointing in roughly opposite directions. <strong>We’ve made a U-turn! Time to stop doubling the trajectory</strong> in this direction.</li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">q0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-2">p0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-3">epsilon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb3-4">steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span></span>
<span id="cb3-5">Sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diag</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7">xy_seq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-8">dens_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand.grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xy_seq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> xy_seq)</span>
<span id="cb3-9">dens_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>z <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mvtnorm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmvnorm</span>(dens_df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), Sigma)</span>
<span id="cb3-10"></span>
<span id="cb3-11">positions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> steps, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(q0))</span>
<span id="cb3-12">positions[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q0</span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Simplified leapfrog steps</span></span>
<span id="cb3-15">q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q0; p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p0</span>
<span id="cb3-16"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>steps) {</span>
<span id="cb3-17">  p_half <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>q)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Half-step for momentum</span></span>
<span id="cb3-18">  q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p_half           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Full-step for position</span></span>
<span id="cb3-19">  p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_half <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>q)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Second half-step for momentum</span></span>
<span id="cb3-20">  positions[i, ] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q</span>
<span id="cb3-21">}</span>
<span id="cb3-22"></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check U-Turn</span></span>
<span id="cb3-24">uturn_check <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(positions, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(qp) {</span>
<span id="cb3-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((qp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> q0) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p0) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb3-26">})</span>
<span id="cb3-27"></span>
<span id="cb3-28">plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> positions[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb3-29">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> positions[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], </span>
<span id="cb3-30">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">is_uturn =</span> uturn_check)</span>
<span id="cb3-31"></span>
<span id="cb3-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(plot_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_contour</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dens_df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>, </span>
<span id="cb3-34">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> is_uturn), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_path</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> is_uturn, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>, </span>
<span id="cb3-38">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> q0[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> q0[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], </span>
<span id="cb3-39">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> q0[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p0[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> q0[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p0[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], </span>
<span id="cb3-40">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"closed"</span>), </span>
<span id="cb3-41">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linejoin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mitre"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"U-Turn Check"</span>, </span>
<span id="cb3-43">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]), </span>
<span id="cb3-44">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#008080"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#990050"</span>), </span>
<span id="cb3-46">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No U-Turn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"U-Turn"</span>),</span>
<span id="cb3-47">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"U-Turn State"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-4-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Characterization of the trajectory of a particle in a 2D gaussian distribution. You can see that the particle rolls until a U turn is detected."><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/index_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img" alt="Characterization of the trajectory of a particle in a 2D gaussian distribution. You can see that the particle rolls until a U turn is detected."></a></p>
<figcaption class="margin-caption">Characterization of the trajectory of a particle in a 2D gaussian distribution. You can see that the particle rolls until a U turn is detected.</figcaption>
</figure>
</div>
</div>
</div>
<p>This U-turn criterion <strong>is a clever way to prevent NUTS from over-exploring</strong>. It ensures that the sampler focuses its efforts on the relevant regions of the posterior, <strong>leading to more efficient sampling</strong>. Now that we know how NUTS adapts the trajectory length and when to stop, let’s see how it organizes these trajectories into a neat and efficient structure: the binary tree.</p>
</section>
<section id="tree-building-for-sampling" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="tree-building-for-sampling">Tree Building for Sampling</h3>
<p>We now know how NUTS dynamically adjusts the trajectory length and how it uses the U-turn criterion to avoid redundant sampling. <strong>But how does it keep track of all these different trajectories?</strong> The answer is: with a <em>binary tree!</em></p>
<p><strong>Imagine you’re exploring a maze</strong>. You start at the entrance, and at each intersection, you have two choices: <strong>go left or go right</strong>. You keep making choices <strong>until you reach a dead end or decide to turn back</strong>. This is essentially how NUTS builds its binary tree.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/maze.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Picture of a Maze, representing that each choice (either left or right) is an example of binary decision, which represents the binary tree building process. Photo from <a href="https://stock.adobe.com/cl/images/man-entering-a-huge-mysterious-maze-3d-rendering/322713363">Adobe Stock</a>.</span></div></div>
<p>NUTS starts with a single leapfrog step (our initial trajectory). This is the root of our tree. Then, <strong>it doubles the trajectory length by taking two steps: one to the “left” and one to the “right”</strong>. These two trajectories become the children of the root node. This doubling process continues, creating a balanced binary tree.</p>
<p>Why a tree? Because <strong>it’s an efficient way to organize the exploration</strong>. It allows NUTS to quickly explore different parts of the posterior without having to revisit already explored regions (thanks to the U-turn criterion).</p>
<p>Let’s break down the <em>tree-building</em> process:</p>
<ol type="1">
<li><strong>Start with a single leapfrog step:</strong> This is the root node of the tree.</li>
<li><strong>Double the trajectory length:</strong> Create two new trajectories by extending the current trajectory in both directions (forward and backward in time). These are the left and right children of the current node.</li>
<li><strong>Check for U-turns:</strong> Use the U-turn criterion to determine if either of the new trajectories has made a U-turn. If so, stop extending that branch of the tree.</li>
<li><strong>Repeat steps 2 and 3:</strong> Continue doubling the trajectory length and checking for U-turns until a certain stopping criterion is met (e.g., a maximum tree depth).</li>
</ol>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/tree-example.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Binary tree building process. Photo from <a href="https://www.jmlr.org/papers/volume15/hoffman14a/hoffman14a.pdf">J. Mach. Learn. Res., 15(1), 1593-1623</a>.</span></div></div>
<p>Now, <em>how does NUTS use this tree for sampling?</em> It uses a process called <strong>recursive sampling</strong>. It starts at the root node and recursively traverses the tree, choosing either the left or right child at each node. The choice is made probabilistically, <strong>based on the Metropolis-Hastings acceptance criterion</strong>. This ensures that the samples are drawn from the target posterior distribution.</p>
<p>This <strong>tree-building and recursive sampling process</strong> is what makes NUTS so efficient. It allows it to explore the posterior in a structured and organized way, <strong>avoiding redundant sampling</strong> and quickly adapting to the local geometry.</p>
</section>
</section>
<section id="step-by-step-implementation-of-nuts" class="level1">
<h1>Step-by-Step Implementation of NUTS</h1>
<p>Now that we understand the theory behind NUTS, <strong>it’s time to put our knowledge into practice</strong>. In this section, we’ll build a NUTS sampler from scratch in R. Don’t worry, we’ll take it one step at a time (<em>or, should I say, one leapfrog step at a time?</em>).</p>
<section id="setting-things-up" class="level3">
<h3 class="anchored" data-anchor-id="setting-things-up">Setting Things Up</h3>
<p>Before we start building our NUTS engine, we need to gather our tools. This involves defining <strong>(1)</strong> our target distribution, <strong>(2)</strong> its gradient, and <strong>(3)</strong> the leapfrog integration method. We’ll reuse the gradient and leapfrog functions from our <a href="https://doi.org/10.59350/fa26y-xa178">previous HMC implementation</a> (because why reinvent the wheel?).</p>
<p>Let’s consider a simple 2D Gaussian distribution as our target posterior. <strong>This will make it easier to visualize and understand</strong> the behavior of NUTS. We can define the log-posterior as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clog%20p(q)%20=%20-%5Cfrac%7B1%7D%7B2%7Dq%5E%5Ctop%20%5CSigma%5E%7B-1%7D%20q%20-%5Cfrac%7B1%7D%7B2%7D%5Clog(%5Cdet%7B%5CSigma%7D)%20+%20%5Ctext%7Bconstant%7D%0A"></p>
<p>Where <img src="https://latex.codecogs.com/png.latex?q%20=%20(q_1,%20q_2)"> is our position vector and <img src="https://latex.codecogs.com/png.latex?%5CSigma"> is the covariance matrix.</p>
<p>Now, let’s define the <strong>gradient of the log-posterior</strong>:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%20%5Clog%20p(q)%20=%20-%5CSigma%5E%7B-1%7D%20q%0A"></p>
<p>Here’s the R code for the log-posterior and its gradient:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Log-posterior function</span></span>
<span id="cb4-2">log_posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(q, Sigma, mu) {</span>
<span id="cb4-3">  diff <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> mu</span>
<span id="cb4-4">  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(diff) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">solve</span>(Sigma) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> diff <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">det</span>(Sigma))</span>
<span id="cb4-5">}</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Gradient of Log-posterior</span></span>
<span id="cb4-8">grad_log_posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(q, Sigma, mu) {</span>
<span id="cb4-9">  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">solve</span>(Sigma, q <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> mu)</span>
<span id="cb4-10">}</span></code></pre></div>
</div>
<p>Next, we need the <strong>leapfrog integration function</strong>. Here’s a reminder (and the R code) from the <a href="https://doi.org/10.59350/fa26y-xa178">previous HMC blog post</a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Leapfrog integration</span></span>
<span id="cb5-2">leapfrog <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(q, p, grad_func, epsilon, Sigma, mu) {</span>
<span id="cb5-3">  grad_q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grad_func</span>(q, Sigma, mu) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient calculation</span></span>
<span id="cb5-4">  p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> grad_q <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Half-step for momentum</span></span>
<span id="cb5-5">  q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Full-step for position</span></span>
<span id="cb5-6">  grad_q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grad_func</span>(q, Sigma, mu)</span>
<span id="cb5-7">  p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> grad_q <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Half-step for momentum</span></span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">q =</span> q, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> p)</span>
<span id="cb5-9">}</span></code></pre></div>
</div>
<p>With these functions in place, <strong>we’re ready to start implementing the core components of NUTS</strong>. We’ll begin with the initialization step in the next subsection.</p>
<p>Okay, let’s dive into the core steps of NUTS implementation. This will be the most substantial part of the implementation section.</p>
</section>
<section id="core-steps-of-nuts" class="level3">
<h3 class="anchored" data-anchor-id="core-steps-of-nuts">Core Steps of NUTS</h3>
<p>Now that we have our tools ready, <strong>we can start building the core components of the NUTS sampler</strong>. This involves initialization, building the trajectory, checking for U-turns, building the tree, and handling acceptance and termination.</p>
<section id="initialization" class="level4">
<h4 class="anchored" data-anchor-id="initialization">Initialization</h4>
<p>First, we need to <strong>initialize the sampler</strong>. This involves setting the initial position <img src="https://latex.codecogs.com/png.latex?q">, drawing a random momentum <img src="https://latex.codecogs.com/png.latex?p">, and setting the hyperparameters, most importantly, the initial step size <img src="https://latex.codecogs.com/png.latex?%5Cepsilon">.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialization</span></span>
<span id="cb6-2">nuts_init <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(q0, Sigma, mu, epsilon) {</span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb6-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">q =</span> q0, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial position</span></span>
<span id="cb6-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu =</span> mu,</span>
<span id="cb6-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(q0), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial random momentum</span></span>
<span id="cb6-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">epsilon =</span> epsilon <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial step size (this will be adapted later)</span></span>
<span id="cb6-8">  )</span>
<span id="cb6-9">}</span>
<span id="cb6-10"></span>
<span id="cb6-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example initialization</span></span>
<span id="cb6-12">q0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Starting position</span></span>
<span id="cb6-13">mu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Target location</span></span>
<span id="cb6-14">epsilon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step size</span></span>
<span id="cb6-15"></span>
<span id="cb6-16">nuts_state <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nuts_init</span>(q0, Sigma, mu, epsilon)</span></code></pre></div>
</div>
</section>
<section id="build-the-trajectory" class="level4">
<h4 class="anchored" data-anchor-id="build-the-trajectory">Build the Trajectory</h4>
<p>The next step is to <strong>build the trajectory using the leapfrog integrator</strong>. Here’s where the dynamic doubling comes in. We’ll also incorporate the U-turn check here.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># U-turn check (dot product of momentum vectors)</span></span>
<span id="cb7-2">is_uturn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(q_left, q_right, p_left, p_right) {</span>
<span id="cb7-3">  (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((q_right <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> q_left) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p_left) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> </span>
<span id="cb7-4">    (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((q_right <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> q_left) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p_right) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb7-5">}</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Build a trajectory (doubling until U-turn)</span></span>
<span id="cb7-8">build_trajectory <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(q, p, grad_func, epsilon, Sigma, mu) {</span>
<span id="cb7-9">  q_left <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q</span>
<span id="cb7-10">  p_left <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p</span>
<span id="cb7-11">  q_right <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q</span>
<span id="cb7-12">  p_right <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p</span>
<span id="cb7-13">  trajectory <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">q =</span> q, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> p)</span>
<span id="cb7-14">  </span>
<span id="cb7-15">  j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb7-16">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is_uturn</span>(q_left, q_right, p_left, p_right) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) {</span>
<span id="cb7-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) {</span>
<span id="cb7-18">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Expand left</span></span>
<span id="cb7-19">      leapfrog_result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">leapfrog</span>(q_left, p_left, grad_func, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>epsilon, Sigma, mu)</span>
<span id="cb7-20">      q_left <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> leapfrog_result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q</span>
<span id="cb7-21">      p_left <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> leapfrog_result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p</span>
<span id="cb7-22">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb7-23">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Expand right</span></span>
<span id="cb7-24">      leapfrog_result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">leapfrog</span>(q_right, p_right, grad_func, epsilon, Sigma, mu)</span>
<span id="cb7-25">      q_right <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> leapfrog_result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q</span>
<span id="cb7-26">      p_right <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> leapfrog_result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p</span>
<span id="cb7-27">    }</span>
<span id="cb7-28">    trajectory<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(trajectory<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q, leapfrog_result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q)</span>
<span id="cb7-29">    trajectory<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(trajectory<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p, leapfrog_result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p)</span>
<span id="cb7-30">    j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-31">  }</span>
<span id="cb7-32">  index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(trajectory<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">q =</span> trajectory<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q[, index], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> trajectory<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p[, index])</span>
<span id="cb7-34">}</span></code></pre></div>
</details>
</div>
</section>
<section id="tree-building" class="level4">
<h4 class="anchored" data-anchor-id="tree-building">Tree Building</h4>
<p>While the previous function <em>builds</em> the trajectory by doubling it, the actual tree structure is implicit. This is because <strong>NUTS doesn’t explicitly store the entire tree in memory</strong>. It only needs to keep track of the leftmost and rightmost points of the trajectory and use them to sample.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">nsteps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb8-2">positions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nsteps, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb8-3"></span>
<span id="cb8-4">xy_seq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-5">dens_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand.grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xy_seq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> xy_seq)</span>
<span id="cb8-6">dens_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>z <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mvtnorm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmvnorm</span>(dens_df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diag</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb8-7"></span>
<span id="cb8-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb8-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(nsteps)) {</span>
<span id="cb8-10">  positions[i,] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">build_trajectory</span>(</span>
<span id="cb8-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">q =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grad_func =</span> grad_log_posterior,</span>
<span id="cb8-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">epsilon =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb8-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Sigma =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diag</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb8-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb8-17">  )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q</span>
<span id="cb8-18">}</span>
<span id="cb8-19"></span>
<span id="cb8-20">positions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(positions) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-21">  data.table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.table</span>()</span>
<span id="cb8-22"></span>
<span id="cb8-23">positions[V1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, side <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Right"</span>]</span>
<span id="cb8-24">positions[V1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, side <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Left"</span>]</span>
<span id="cb8-25">positions[V1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, side <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Initial Position"</span>]</span>
<span id="cb8-26"></span>
<span id="cb8-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(positions, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> V1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> V2)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_contour</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dens_df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>, </span>
<span id="cb8-29">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> side), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> side), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Binary Tree Trajectory Visualization"</span>, </span>
<span id="cb8-34">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]),</span>
<span id="cb8-35">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tree Side"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rgb</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-37">                                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rgb</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-38">                                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rgb</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb8-39">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Left"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Right"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, </span>
<span id="cb8-41">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> positions[side<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Left"</span>][<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">order</span>(V2), V1],</span>
<span id="cb8-42">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> positions[side<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Left"</span>][<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">order</span>(V2), V2] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-43">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rgb</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, </span>
<span id="cb8-45">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> positions[side<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Right"</span>][<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">order</span>(V1), V1] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>,</span>
<span id="cb8-46">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> positions[side<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Right"</span>][<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">order</span>(V1), V2],</span>
<span id="cb8-47">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rgb</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-9-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/index_files/figure-html/unnamed-chunk-9-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="acceptance-and-termination" class="level4">
<h4 class="anchored" data-anchor-id="acceptance-and-termination">Acceptance and Termination</h4>
<p>Finally, we need to decide whether to accept the new sample from the trajectory. <strong>This is done using the Metropolis-Hastings acceptance criterion</strong>, comparing the joint probability of the initial state and the proposed state. The process is repeated <strong>until the desired number of samples is obtained</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Metropolis-Hastings acceptance probability</span></span>
<span id="cb9-2">acceptance_prob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(current_logp, proposed_logp) {</span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(proposed_logp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> current_logp))</span>
<span id="cb9-4">}</span></code></pre></div>
</div>
<p>We will incorporate this acceptance step into the full NUTS sampler in the next section, along with the complete NUTS algorithm and the adaptive step size procedure.</p>
</section>
<section id="adaptative-step-size" class="level4">
<h4 class="anchored" data-anchor-id="adaptative-step-size">Adaptative Step-Size</h4>
<p>One of the most crucial aspects of NUTS (and HMC in general) is <strong>choosing an appropriate step size</strong>, <img src="https://latex.codecogs.com/png.latex?%5Cepsilon">. A good step size allows the sampler to efficiently explore the posterior distribution. Too small, and the sampler takes tiny, slow steps, <strong>like a snail on a marathon</strong>. Too large, and it overshoots, bouncing around erratically, <strong>like a caffeinated kangaroo on a trampoline</strong>.</p>
<p><strong>NUTS uses an adaptive step size procedure</strong>, especially during the warmup phase, to find a good value for <img src="https://latex.codecogs.com/png.latex?%5Cepsilon">. The goal is <strong>to achieve a target acceptance rate, typically around 0.8</strong>. This indicates that the sampler is neither accepting too many nor too few proposals.</p>
<p>A simple way to adapt the step size is to use the following update rule:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cepsilon%20%5Cleftarrow%20%5Cepsilon%20%5Ccdot%20e%5E%7B%5Cgamma%20%5Ccdot%20%5Cdelta%7D%20%5C%5C%0A"></p>
<p>Where <img src="https://latex.codecogs.com/png.latex?%5Cepsilon"> is the <strong>current step size</strong>; <img src="https://latex.codecogs.com/png.latex?%5Cgamma"> is a tuning parameter that <strong>controls the adaptation rate</strong> (how fast <img src="https://latex.codecogs.com/png.latex?%5Cepsilon"> will adapt); <img src="https://latex.codecogs.com/png.latex?%5Cdelta"> is the difference between the current acceptance rate <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B%5Ctext%7BCA%7D%7D"> and the target acceptance rate <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B%5Ctext%7BTA%7D%7D">, and could be defined like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta%20=%20%5Clambda_%7B%5Ctext%7BCA%7D%7D%20-%20%5Clambda_%7B%5Ctext%7BTA%7D%7D%0A"></p>
<p>This simplified form allow us to <strong>reduce epsilon at each step</strong> as long as the current acceptance rate <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B%5Ctext%7BCA%7D%7D"> is lower than the target acceptance rate <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B%5Ctext%7BTA%7D%7D">. Here’s the R code for this adaptation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">adapt_epsilon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(epsilon, lambda_ca, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda_ta =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gamma =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) {</span>
<span id="cb10-2">  delta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lambda_ca <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> lambda_ta</span>
<span id="cb10-3">  epsilon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(gamma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> delta)</span>
<span id="cb10-4">  epsilon</span>
<span id="cb10-5">}</span></code></pre></div>
</div>
<p>This update rule <strong>adjusts the step size based on the difference between the observed and target acceptance rates</strong>. If the acceptance rate is too low, (<img src="https://latex.codecogs.com/png.latex?%5Cepsilon">) is decreased; if it’s too high, (<img src="https://latex.codecogs.com/png.latex?%5Cepsilon">) is increased. The gamma (<img src="https://latex.codecogs.com/png.latex?%5Cgamma">) parameter controls <strong>how aggressively this adjustment is made</strong>.</p>
<p>To see how this adaptation works in practice, let’s visualize its dynamics:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">epsilons <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb11-2">  accept_rates <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb11-3">  epsilons[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb11-4">  gammas <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>)</span>
<span id="cb11-5">  plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>()</span>
<span id="cb11-6">  </span>
<span id="cb11-7">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(gammas)) {</span>
<span id="cb11-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(epsilons)) {</span>
<span id="cb11-9">      epsilons[j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">adapt_epsilon</span>(</span>
<span id="cb11-10">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">epsilon =</span> epsilons[j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb11-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda_ca =</span> accept_rates[j], </span>
<span id="cb11-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda_ta =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb11-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gamma =</span> gammas[i])</span>
<span id="cb11-14">    }</span>
<span id="cb11-15">    plot_data[[i]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data.table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb11-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iteration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb11-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">epsilon =</span> epsilons,</span>
<span id="cb11-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gamma =</span> gammas[i],</span>
<span id="cb11-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accept_rate =</span> accept_rates</span>
<span id="cb11-20">    )</span>
<span id="cb11-21">  }</span>
<span id="cb11-22">  </span>
<span id="cb11-23">  plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data.table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbindlist</span>(plot_data)</span>
<span id="cb11-24">  </span>
<span id="cb11-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(plot_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> iteration, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> epsilon, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> gamma, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> gamma)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> accept_rate, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> accept_rate)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Step-Size Adaptation"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Iteration"</span>, </span>
<span id="cb11-28">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Epsilon"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adaptation Rate ("</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>gamma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_alpha_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Acceptance Rate"</span>,</span>
<span id="cb11-31">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>(),</span>
<span id="cb11-32">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>), </span>
<span id="cb11-33">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-34">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_linewidth_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>), </span>
<span id="cb11-35">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-36">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-12-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/index_files/figure-html/unnamed-chunk-12-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>As the plot shows, the <strong>adaptation is more aggressive</strong> (epsilon changes more rapidly) <strong>with larger values of</strong> <img src="https://latex.codecogs.com/png.latex?%5Cgamma">. Note that this is a very basic adaptation strategy. More robust methods, such as dual averaging, are typically used in practice, but this simple method illustrates the basic idea.</p>
</section>
</section>
<section id="implementation-strategy" class="level3">
<h3 class="anchored" data-anchor-id="implementation-strategy">Implementation Strategy</h3>
<p>Now that we have all the individual components, it’s time to assemble them into a fully functional NUTS sampler. We’ll also incorporate the adaptive step size tuning, which is crucial for NUTS’s performance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Full NUTS sampler</span></span>
<span id="cb12-2">nuts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(log_posterior, grad_log_posterior, </span>
<span id="cb12-3">                 q0, Sigma, mu, </span>
<span id="cb12-4">                 epsilon, lambda_ta, gamma,</span>
<span id="cb12-5">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_samples =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_warmup =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>) {</span>
<span id="cb12-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialization</span></span>
<span id="cb12-7">  nuts_state <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nuts_init</span>(q0, Sigma, mu, epsilon)</span>
<span id="cb12-8">  samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> n_samples <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> n_warmup, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(q0))</span>
<span id="cb12-9">  </span>
<span id="cb12-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Warmup phase for step size adaptation</span></span>
<span id="cb12-11">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n_warmup) {</span>
<span id="cb12-12">    nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(q0), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Resample momentum</span></span>
<span id="cb12-13">    trajectory <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">build_trajectory</span>(nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q, nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p, grad_log_posterior, nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>epsilon, Sigma, mu)</span>
<span id="cb12-14">    </span>
<span id="cb12-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Metropolis Hastings</span></span>
<span id="cb12-16">    current_logp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_posterior</span>(nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q, Sigma, mu)</span>
<span id="cb12-17">    proposed_logp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_posterior</span>(trajectory<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q, Sigma, mu)</span>
<span id="cb12-18">    </span>
<span id="cb12-19">    acc_rate <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acceptance_prob</span>(current_logp, proposed_logp)</span>
<span id="cb12-20">    </span>
<span id="cb12-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> acc_rate){</span>
<span id="cb12-22">      nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> trajectory<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q</span>
<span id="cb12-23">    }</span>
<span id="cb12-24">    </span>
<span id="cb12-25">    <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Adaptative epsilon</span></span>
<span id="cb12-26">    nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>epsilon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">adapt_epsilon</span>(epsilon, acc_rate, lambda_ta, gamma)</span>
<span id="cb12-27">    </span>
<span id="cb12-28">    samples[i, ] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q</span>
<span id="cb12-29">  }</span>
<span id="cb12-30">  </span>
<span id="cb12-31">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sampling phase</span></span>
<span id="cb12-32">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n_samples) {</span>
<span id="cb12-33">    nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(q0), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Resample momentum</span></span>
<span id="cb12-34">    trajectory <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">build_trajectory</span>(nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q, nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p, grad_log_posterior, nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>epsilon, Sigma, mu)</span>
<span id="cb12-35">    </span>
<span id="cb12-36">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Metropolis Hastings</span></span>
<span id="cb12-37">    current_logp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_posterior</span>(nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q, Sigma, mu)</span>
<span id="cb12-38">    proposed_logp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_posterior</span>(trajectory<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q, Sigma, mu)</span>
<span id="cb12-39">    </span>
<span id="cb12-40">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acceptance_prob</span>(current_logp, proposed_logp)){</span>
<span id="cb12-41">      nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> trajectory<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q</span>
<span id="cb12-42">    }</span>
<span id="cb12-43">    </span>
<span id="cb12-44">    samples[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> n_warmup, ] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nuts_state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q</span>
<span id="cb12-45">  }</span>
<span id="cb12-46">  </span>
<span id="cb12-47">  samples</span>
<span id="cb12-48">}</span></code></pre></div>
</div>
<p>Here’s a breakdown of the full nuts function:</p>
<ol type="1">
<li><strong>Initialization</strong>: We initialize the NUTS state using the <code>nuts_init()</code> function.</li>
<li><strong>Warmup</strong>: The first <code>n_warmup</code> iterations are used for tuning the step size. A very basic adaptation is implemented, increasing the step size in the first half of the warmup and decreasing it in the second half. More sophisticated methods exist (like dual averaging).</li>
<li><strong>Sampling</strong>: The main sampling loop runs for <code>n_samples</code> iterations. In each iteration:
<ul>
<li>We build a trajectory using <code>build_trajectory()</code>.</li>
<li>We perform the Metropolis Hastings step, to accept or reject the new proposed sample</li>
<li>We store the current position in the <code>samples</code> matrix.</li>
</ul></li>
</ol>
<p>This implementation provides a basic but functional NUTS sampler. In the next section, we’ll discuss diagnostics and validation to ensure our sampler is working correctly.</p>
</section>
</section>
<section id="is-our-sampler-behaving-itself" class="level1 page-columns page-full">
<h1>Is Our Sampler Behaving Itself?</h1>
<p>In the following section, we’ll try to estimate the location parameters of a <strong>2-dimensional multivariate normal</strong>, we’ll call them <img src="https://latex.codecogs.com/png.latex?%5Ctheta_1"> and <img src="https://latex.codecogs.com/png.latex?%5Ctheta_2"> respectively. They will have a true values of <img src="https://latex.codecogs.com/png.latex?%5Ctheta_1%20=%201"> and <img src="https://latex.codecogs.com/png.latex?%5Ctheta_2%20=%20-1">, and the variance-covariance matrix (<img src="https://latex.codecogs.com/png.latex?%5CSigma">) will be defined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5CSigma%20=%0A%20%20%5Cbegin%7Bpmatrix%7D%0A%20%20%20%201.0%20&amp;%200.5%20%5C%5C%0A%20%20%20%200.5%20&amp;%201.0%0A%20%20%5Cend%7Bpmatrix%7D%0A"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Initial parameters</span></span>
<span id="cb13-2">q0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Starting positions</span></span>
<span id="cb13-3">mu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Target location of the distribution</span></span>
<span id="cb13-4">epsilon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (Initial) Step size for HMC exploring</span></span>
<span id="cb13-5">lambda_ta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Target acceptance rate</span></span>
<span id="cb13-6">gamma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adaptation rate for epsilon</span></span>
<span id="cb13-7"></span>
<span id="cb13-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variance-Covariance Matrix</span></span>
<span id="cb13-9">Sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(</span>
<span id="cb13-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb13-11">           <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb13-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb13-13">)</span>
<span id="cb13-14"></span>
<span id="cb13-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1234</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Seed for reproducibility</span></span>
<span id="cb13-16"></span>
<span id="cb13-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Our main function ,  HMC-NUTS sampler</span></span>
<span id="cb13-18">samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nuts</span>(</span>
<span id="cb13-19">  log_posterior, grad_log_posterior,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distribution functions</span></span>
<span id="cb13-20">  q0, Sigma, mu,                             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Target parameters</span></span>
<span id="cb13-21">  epsilon, lambda_ta, gamma,</span>
<span id="cb13-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_samples =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_warmup =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sampler hyperparameter</span></span>
<span id="cb13-23">)</span></code></pre></div>
</div>
<p>Now that we have a working NUTS sampler, <strong>we need to make sure it’s actually doing what it’s supposed to do</strong>. This section will cover several diagnostic techniques, both visual and numerical, to <em>validate</em> our sampler.</p>
<section id="visual-diagnostics" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="visual-diagnostics">Visual Diagnostics</h3>
<p>The first step in <strong>diagnosing our sampler is to visualize the results</strong>. This gives us a quick and intuitive understanding of its behavior. Two common visual diagnostics are <em>trace plots</em> and <em>posterior density estimates</em>.</p>
<section id="trace-plots" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="trace-plots">Trace Plots</h4>
<p>Trace plots show <strong>the value of each parameter over the course of the sampling process</strong>. Ideally, trace plots should look like “white noise” (random fluctuations around a stable mean). <strong>This indicates that the sampler is exploring the posterior</strong> well and not getting stuck in any particular region. If you see trends, patterns, or long periods of near-constant values, it could indicate problems with convergence.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">plot_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.table</span>(samples)</span>
<span id="cb14-2">plot_df[, iter <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(.N)]</span>
<span id="cb14-3"></span>
<span id="cb14-4">plot_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt</span>(plot_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id.vars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iter"</span>)</span>
<span id="cb14-5"></span>
<span id="cb14-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(plot_df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(iter, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> variable)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ribbon"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb14-8">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1950</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb14-10">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Burn-in</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> Period"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parameter"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(theta), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Iterations"</span>,</span>
<span id="cb14-14">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Traceplot of Parameter Values"</span>,</span>
<span id="cb14-15">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Over Effective and Burn-in Samples"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rgb</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rgb</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb14-17">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"theta[1]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"theta[2]"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-18">                       scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_parse</span>()()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-15-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Traceplots indicating the evolution and convergence of our model parameters (\theta_1 and \theta_2) over time."><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/index_files/figure-html/unnamed-chunk-15-1.svg" class="img-fluid figure-img" alt="Traceplots indicating the evolution and convergence of our model parameters (\theta_1 and \theta_2) over time."></a></p>
<figcaption class="margin-caption">Traceplots indicating the evolution and convergence of our model parameters (<img src="https://latex.codecogs.com/png.latex?%5Ctheta_1"> and <img src="https://latex.codecogs.com/png.latex?%5Ctheta_2">) over time.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="posterior-density-estimates" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="posterior-density-estimates">Posterior Density Estimates</h4>
<p>These plots show the <strong>estimated density of the samples</strong>, giving us an idea of the shape of the posterior distribution. We can compare these estimates to the true posterior distribution (if we know it) to check if our sampler is capturing the correct shape.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#True density</span></span>
<span id="cb15-2">xy_seq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb15-3">dens_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand.grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xy_seq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> xy_seq)</span>
<span id="cb15-4">dens_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>z <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mvtnorm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmvnorm</span>(dens_df, mu, Sigma)</span>
<span id="cb15-5"></span>
<span id="cb15-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(samples), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> X1, X2))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_contour</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dens_df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z), </span>
<span id="cb15-8">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray40"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_path</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rgb</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(theta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(theta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb15-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Joint Posterior Distribution of"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>theta))</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-16-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Joint posterior distribution of our model parameters (\theta_1 and \theta_2). The samples are connected based on the sampling ordering."><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/index_files/figure-html/unnamed-chunk-16-1.svg" class="img-fluid figure-img" alt="Joint posterior distribution of our model parameters (\theta_1 and \theta_2). The samples are connected based on the sampling ordering."></a></p>
<figcaption class="margin-caption">Joint posterior distribution of our model parameters (<img src="https://latex.codecogs.com/png.latex?%5Ctheta_1"> and <img src="https://latex.codecogs.com/png.latex?%5Ctheta_2">). The samples are connected based on the sampling ordering.</figcaption>
</figure>
</div>
</div>
</div>
<p>By visually inspecting these plots, we can get a good sense of whether our NUTS sampler is working as expected. However, <strong>visual diagnostics are subjective</strong>. We also need numerical diagnostics to provide more objective measures of sampler performance.</p>
</section>
</section>
<section id="numerical-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="numerical-diagnostics">Numerical Diagnostics</h3>
<p>While visual diagnostics provide a valuable qualitative assessment of our sampler’s performance, <strong>we also need quantitative metrics to be more objective</strong>. Two key numerical diagnostics are <em>effective sample size</em> (ESS) and <em>R-hat</em> (<img src="https://latex.codecogs.com/png.latex?%5Chat%7BR%7D">).</p>
<section id="effective-sample-size-ess" class="level4">
<h4 class="anchored" data-anchor-id="effective-sample-size-ess">Effective Sample Size (ESS)</h4>
<p>The ESS measures <strong>the number of <em>independent</em> samples that our sampler has effectively generated</strong>. Because MCMC samples are correlated, the ESS is typically smaller than the actual number of samples. A higher ESS indicates better sampler efficiency. A rule of thumb is that you want an ESS of at least a few hundred for each parameter to have reliable estimates of the posterior.</p>
<p>We can estimate the ESS using various methods. A common approach is to use the <code>effectiveSize()</code> function from the <code>coda</code> package in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate ESS for each parameter</span></span>
<span id="cb16-2">coda<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc</span>(samples, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb16-3">  coda<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">effectiveSize</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    var1     var2 
511.6659 508.3677 </code></pre>
</div>
</div>
</section>
<section id="gelman-and-rubins-convergence-diagnostic-hatr" class="level4">
<h4 class="anchored" data-anchor-id="gelman-and-rubins-convergence-diagnostic-hatr">Gelman and Rubin’s Convergence Diagnostic (<img src="https://latex.codecogs.com/png.latex?%5Chat%7BR%7D">)</h4>
<p>The <img src="https://latex.codecogs.com/png.latex?%5Chat%7BR%7D"> statistic (pronounced “R-hat”) is a convergence diagnostic that <strong>compares the variance within multiple chains to the variance between chains</strong>. If the chains have converged to the same distribution, the within-chain variance should be similar to the between-chain variance, and <img src="https://latex.codecogs.com/png.latex?%5Chat%7BR%7D"> <strong>should be close to 1</strong>. Values of <img src="https://latex.codecogs.com/png.latex?%5Chat%7BR%7D"> much greater than 1 (e.g., above 1.1) indicate that the chains have not converged.</p>
<p>However, to compute <img src="https://latex.codecogs.com/png.latex?%5Chat%7BR%7D"> we need more than one chain, so let’s run our HMC-NUTS model four times to get independent runs or “chains”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">n_chains <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of independent chains</span></span>
<span id="cb18-2"></span>
<span id="cb18-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1234</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Seed for reproducibility</span></span>
<span id="cb18-4"></span>
<span id="cb18-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Our main function within a lapply() statement for looping</span></span>
<span id="cb18-6">nuts_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(n_chains), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb18-7">  samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nuts</span>(</span>
<span id="cb18-8">    log_posterior, grad_log_posterior,</span>
<span id="cb18-9">    q0, Sigma, mu,</span>
<span id="cb18-10">    epsilon, lambda_ta, gamma,</span>
<span id="cb18-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_samples =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_warmup =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span></span>
<span id="cb18-12">  )</span>
<span id="cb18-13">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dimnames&lt;-</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>(samples, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"theta_1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"theta_2"</span>)))</span>
<span id="cb18-14">})</span></code></pre></div>
</div>
<p>We can now calculate <img src="https://latex.codecogs.com/png.latex?%5Chat%7BR%7D"> using the <code>gelman.diag()</code> function from the coda package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate R-hat</span></span>
<span id="cb19-2">nuts_model <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(coda<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>mcmc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2e3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-4">  coda<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcmc.list</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-5">  coda<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gelman.diag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(round,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$psrf
        Point est. Upper C.I.
theta_1      1.003      1.009
theta_2      1.001      1.003

$mpsrf
[1] 1.004</code></pre>
</div>
</div>
<p>As you can see, all <img src="https://latex.codecogs.com/png.latex?%5Chat%7BR%7D"> are well below the 1.1 threshold, <strong>which suggests that the chains are mixing well enough</strong>.</p>
<p>With these visual and numerical diagnostics, we can be confident about the performance of our NUTS sampler. <strong>These tools allow us to assess convergence, efficiency, and overall sampler behavior</strong>, ensuring that we are obtaining reliable samples from our target posterior distribution.</p>
</section>
</section>
</section>
<section id="making-it-sing-in-the-real-world" class="level1 page-columns page-full">
<h1>Making It Sing in the Real World</h1>
<p>Now that we have a basic NUTS sampler, let’s talk about <strong>how to fine-tune it for real-world applications</strong>. Because, let’s face it, toy examples are fun, but real-world problems are where the real challenges (and rewards) lie.</p>
<p>When applying NUTS to <em>real-world</em> problems, there are a few practical considerations to keep in mind: <strong>(1)</strong> choosing an initial step size, <strong>(2)</strong> setting the maximum tree depth, and <strong>(3)</strong> understanding the computational trade-offs.</p>
<section id="choosing-an-initial-step-size" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="choosing-an-initial-step-size">Choosing an Initial Step Size</h3>
<p>While NUTS adapts the step size during warmup, <strong>a good initial step size can significantly improve the efficiency of the adaptation process</strong>. A common approach is to perform a short pilot run (a few hundred iterations) and adjust the initial step size based on the acceptance rate. If the acceptance rate is too low (e.g., below 0.6), decrease the initial step size. If it’s too high (e.g., above 0.9), increase it.</p>
<p>In our implementation, we used a very simple adaptation strategy. In real-world applications, more robust methods like <strong>dual averaging</strong> are used. These methods are <strong>more stable and efficient</strong> at finding a good step size.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/stride-length.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Always be careful on the stepsize you choose! Photo from <a href="https://coachtherun.com/running-training/tips/average-stride-length/">Coach The Run</a>.</span></div></div>
</section>
<section id="setting-the-maximum-tree-depth" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="setting-the-maximum-tree-depth">Setting the Maximum Tree Depth</h3>
<p>The maximum tree depth <strong>limits the maximum trajectory length that NUTS will explore</strong>. A larger tree depth allows for longer trajectories, which <strong>can be beneficial for exploring complex posteriors</strong>. However, it also increases exponentially the computational cost. A common default value is 10, which allows for trajectories up to <img src="https://latex.codecogs.com/png.latex?2%5E%7B10%7D%20=%201024"> leapfrog steps.</p>
<p>It is important to notice that a <strong>too small tree depth can lead to poor exploration of the parameter space</strong>, and a too large tree depth can lead to unnecessary computational burden. Therefore, it is important to choose a tree depth that is appropriate for the problem at hand.</p>
<section id="computational-trade-offs" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="computational-trade-offs">Computational Trade-offs</h4>
<p>NUTS, like other HMC methods, <strong>involves computational trade-offs between memory, runtime, and efficiency</strong>. Longer trajectories (achieved by larger tree depths or smaller step sizes) can lead to better exploration and lower autocorrelation but also increase the runtime and memory usage. It’s important to <strong>find a balance that works for your specific problem</strong> and computational resources.</p>
<p>In practice, <strong>you’ll often need to experiment with different settings to find the optimal balance for your problem</strong>. This might involve running several short test runs with different parameter values and comparing the results.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/computer-smoking.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">My computer on an average Bayesian modeling session. Photo from <a href="https://onesupport.com/computer-overheating/">OneSupport</a>.</span></div></div>
</section>
</section>
<section id="when-things-go-wrong" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="when-things-go-wrong">When Things Go Wrong</h3>
<p>Even with its adaptive nature, <strong>NUTS can sometimes struggle with certain types of posterior distributions</strong>. This subsection will discuss some common pitfalls and techniques to address them.</p>
<section id="pathological-posteriors" class="level4">
<h4 class="anchored" data-anchor-id="pathological-posteriors">Pathological Posteriors</h4>
<p>Certain characteristics of posterior distributions can make sampling challenging for any MCMC method, <strong>including NUTS</strong>. Some of the most common culprits are:</p>
<p><strong>Extreme Curvature</strong>. If the posterior has regions of <em>very</em> high curvature (sharp turns or narrow valleys), NUTS might have trouble navigating these areas. The leapfrog integrator can become inaccurate, leading to poor exploration.</p>
<p><strong>Multimodality</strong>. As we discussed earlier, multimodal posteriors (with multiple peaks) can be <em>difficult</em> for any sampler. NUTS can sometimes get stuck in one mode and fail to explore the others.</p>
<p><strong>Discontinuities or Sharp Changes</strong>. If the posterior has discontinuities or <em>sharp</em> changes in density, the gradient information used by NUTS can be misleading, leading to inefficient sampling.</p>
</section>
<section id="techniques-to-stabilize-nuts" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="techniques-to-stabilize-nuts">Techniques to Stabilize NUTS</h4>
<p>When faced with these challenging posteriors, there are several techniques you can try to stabilize NUTS:</p>
<p><strong>Reparameterization</strong>. Sometimes, reparameterizing the model can make the posterior easier to sample. This involves transforming the parameters of the model to a new set of parameters that result in a smoother or more well-behaved posterior. For example, if you have a parameter that is constrained to be positive, you could reparameterize it using a logarithmic transformation.</p>
<p><strong>Increasing Tree Depth</strong>. Increasing the maximum tree depth can allow NUTS to explore more complex trajectories and potentially escape from narrow valleys or explore different modes. However, this comes at the cost of increased computational cost.</p>
<p><strong>Using a More Robust Step Size Adaptation</strong>. As mentioned before, using more sophisticated methods for step size adaptation, like dual averaging, can significantly improve NUTS’s performance. These methods are less sensitive to the initial step size and can adapt more efficiently to the local geometry of the posterior.</p>
<p><strong>Prior Choice</strong>. In some cases, a carefully chosen prior distribution can help to regularize the posterior and make it easier to sample.</p>
<p>It’s important to remember that <strong>there’s no one-size-fits-all solution</strong> for these problems. You’ll often need to <strong>experiment with different techniques to find what works best for your specific problem</strong>. Careful diagnostics, both visual and numerical, are crucial for identifying potential issues and evaluating the effectiveness of your solutions.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/meme.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://imgflip.com/memegenerator">imgflip</a>.</span></div></div>
</section>
</section>
<section id="taking-it-to-the-next-level" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="taking-it-to-the-next-level">Taking It to the Next Level</h3>
<p>We’ve covered the basics of NUTS implementation and fine-tuning. Now, <strong>let’s explore some advanced tips for using NUTS</strong> in more complex scenarios and leveraging existing tools.</p>
<section id="standing-on-the-shoulders-of-giants" class="level4">
<h4 class="anchored" data-anchor-id="standing-on-the-shoulders-of-giants">Standing on the Shoulders of Giants</h4>
<p>Implementing NUTS from scratch, as we’ve done in this post, is a great way to <strong>understand its inner workings</strong>. However, for most real-world applications, it’s recommended to use well-established probabilistic programming languages that have highly optimized and thoroughly tested NUTS implementations. Some popular choices include:</p>
<p><strong>Stan</strong>. Stan is a powerful probabilistic programming language specifically designed for Bayesian modeling. It features a <strong>highly optimized implementation of NUTS</strong>, along with many other advanced features like automatic differentiation and robust step size adaptation (using dual averaging). <strong>Stan is often the go-to choice for serious Bayesian work</strong>.</p>
<p><strong>PyMC</strong>. PyMC is a Python library for Bayesian statistical modeling. It provides a user-friendly interface for building and fitting Bayesian models, including NUTS sampling. <strong>PyMC is a good option if you prefer working in Python</strong>.</p>
<p><strong>Turing.jl</strong>. Turing.jl is a probabilistic programming language written in Julia. It also provides an efficient implementation of NUTS, and <strong>Julia’s performance makes it a good option for computationally intensive models</strong>.</p>
<p>Using these tools saves you the trouble of implementing NUTS yourself and gives you access to highly optimized and robust implementations.</p>
</section>
<section id="the-future-of-nuts" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="the-future-of-nuts">The Future of NUTS</h4>
<p>The field of Bayesian computation is constantly evolving, and there are several exciting innovations related to NUTS. <strong>Recent research has focused on accelerating NUTS using GPUs</strong> <span class="citation" data-cites="amaral2025fast saltas2025emri_mc">(Amaral et al. 2025; Saltas and Oliveri 2025)</span>. This can significantly speed up sampling, <strong>especially for high-dimensional models</strong>. Libraries like NumPyro (built on JAX) and some developments in Stan are exploring this direction <span class="citation" data-cites="sountsov2024running">(Sountsov, Carroll, and Hoffman 2024)</span>.</p>
<p>Researchers are continually developing more efficient and robust methods for step size adaptation. These methods aim to improve the performance of NUTS in challenging scenarios. There are also <strong>variations of NUTS</strong> that aim to address specific challenges, such as <strong>sampling from posteriors with very high curvature</strong>. These advanced tips can help you take your Bayesian modeling to the next level. Using established tools like <em>Stan</em>, <em>PyMC</em>, or <em>Turing.jl</em> will save you time and provide access to highly optimized implementations.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/looking-horizon.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://1.bp.blogspot.com/-_NVPT4_UIH4/X5-KvuqjLNI/AAAAAAAA_e4/rbsr1Z_C3jM2QdD2HZebogB6M3dayurRACLcBGAsYHQ/s3840/loneliness_alone_sunset_188916_2560x1440.jpg">xfxwallpapers</a>.</span></div></div>
</section>
</section>
</section>
<section id="where-do-we-go-from-here" class="level1">
<h1>Where Do We Go From Here?</h1>
<p>We’ve explored the depths of NUTS, from its underlying principles to its implementation and fine-tuning. But the journey doesn’t end here. NUTS is a powerful tool with broad applicability, and there are still many exciting avenues for exploration and development.</p>
<section id="expanding-the-horizons-of-nuts" class="level3">
<h3 class="anchored" data-anchor-id="expanding-the-horizons-of-nuts">Expanding the Horizons of NUTS</h3>
<p>NUTS truly shines when applied to complex Bayesian models that pose significant challenges for traditional MCMC methods. Here are some key areas where NUTS has proven particularly valuable.</p>
<p><strong>Hierarchical models</strong>, with their nested structures and multiple levels of uncertainty, are notoriously difficult to sample from. NUTS’s ability to efficiently explore high-dimensional spaces and adapt to complex geometries makes it an ideal choice for these models. Whether you’re modeling population dynamics, analyzing clinical trial data, or building complex econometric models, <strong>NUTS can handle the intricate dependencies inherent in hierarchical structures</strong>.</p>
<p>In Bayesian modeling, we often choose conjugate priors for mathematical convenience. However, these priors might not always be the most appropriate for our problem. <strong>Non-conjugate priors</strong>, while more flexible, often lead to intractable posteriors that are difficult to sample from. <strong>NUTS, with its gradient-based approach, can effectively handle these non-conjugate scenarios</strong>, allowing us to use more realistic and flexible priors.</p>
<p>As the number of parameters in our model increases, <strong>the dimensionality of the posterior space grows rapidly</strong>. This can make sampling extremely challenging for traditional MCMC methods. NUTS’s efficient exploration and adaptive trajectory length make it <strong>well-suited for high-dimensional problems</strong>. Whether you’re working with image analysis, genomics data, or large-scale machine learning models, NUTS can help you navigate these vast parameter spaces.</p>
<p>These are just a few examples of the many areas where NUTS can be applied. Its <strong>versatility and efficiency</strong> make it a valuable tool for a wide range of Bayesian modeling tasks.</p>
</section>
<section id="your-turn-to-go-nuts" class="level3">
<h3 class="anchored" data-anchor-id="your-turn-to-go-nuts">Your Turn to Go NUTS!</h3>
<p>Now that you’ve grasped the core concepts and implementation of NUTS, I want to leave you with an open challenge: <strong>how would you adapt NUTS to your own specific problems?</strong></p>
<p><strong>Think about the types of models you work with</strong>. Do you encounter any of the challenges we’ve discussed, such as high dimensionality, complex geometries, or non-conjugate priors? How could you leverage NUTS to improve your sampling efficiency and obtain more reliable results?</p>
<p>Consider this questions:</p>
<ul>
<li><strong>What types of posterior distributions do you typically encounter?</strong> Are they relatively simple and well-behaved, or do they exhibit complex features like multimodality or high curvature?</li>
<li><strong>What are the computational constraints of your problems?</strong> Do you have limited memory or runtime, which might influence your choice of tree depth or other NUTS parameters?</li>
<li><strong>Could reparameterization help to improve sampling in your models?</strong> Are there any transformations you could apply to your parameters to make the posterior smoother or more amenable to NUTS?</li>
<li><strong>Are there any specific adaptations or extensions of NUTS that might be relevant to your work?</strong> For example, if you’re working with very high-dimensional models, you might consider exploring GPU-accelerated NUTS implementations.</li>
</ul>
<p>Don’t be afraid to experiment and try different approaches. <strong>The best way to learn is by doing.</strong> Implement NUTS in your own projects, explore different parameter settings, and carefully analyze the results. You might discover new and creative ways to apply this powerful sampling technique.</p>
</section>
<section id="looking-ahead" class="level3">
<h3 class="anchored" data-anchor-id="looking-ahead">Looking Ahead</h3>
<p>This post has provided a deep dive into the <em>No-U-Turn Sampler</em>, from its theoretical foundations to its practical implementation in R. We’ve seen how <strong>NUTS addresses the limitations of traditional MCMC methods and fixed-step HMC</strong>, offering a powerful and efficient approach to Bayesian inference.</p>
<p>But the world of Bayesian statistics is <em>constantly evolving</em>, and there’s always more to learn, like <strong>Hierarchical Modeling</strong> and demonstrate how NUTS can be effectively applied to these <em>complex</em> structures. Or maybe we can mess around with <strong>Stan code</strong> directly to gain performance.</p>
<p>I hope this post has given you a solid understanding of NUTS and inspired you to explore its potential in your own work. Stay tuned for future posts as we continue to dig into the fascinating world of Bayesian statistics!</p>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="appendix" class="level1 appendix"><h2 class="anchored quarto-appendix-heading">Appendix</h2><div class="quarto-appendix-contents">

<p><a href="hmc-nuts-functions.R">Here</a> is the file with all the R functions used in this blog post. Feel free to use and modify them according to your needs. Happy coding!</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-amaral2025fast" class="csl-entry">
Amaral, Dorian, Shixiao Liang, Juehang Qin, and Christopher Tunnell. 2025. <span>“Fast Bayesian Inference for Neutrino Non-Standard Interactions at Dark Matter Direct Detection Experiments.”</span> <em>Machine Learning: Science and Technology</em>.
</div>
<div id="ref-saltas2025emri_mc" class="csl-entry">
Saltas, Ippocratis, and Roberto Oliveri. 2025. <span>“EMRI_MC: A GPU-Based Code for Bayesian Inference of EMRI Waveforms.”</span> <em>SciPost Physics Codebases</em>, 044.
</div>
<div id="ref-sountsov2024running" class="csl-entry">
Sountsov, Pavel, Colin Carroll, and Matthew D Hoffman. 2024. <span>“Running Markov Chain Monte Carlo on Modern Hardware and Software.”</span> <em>arXiv Preprint arXiv:2411.04260</em>.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{castillo-aguilar2025,
  author = {Castillo-Aguilar, Matías},
  title = {Going {NUTS:} {A} {Step-by-Step} {Guide} to {Adaptive}
    {Hamiltonian} {Sampling} in {R}},
  date = {2025-01-21},
  url = {https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/},
  doi = {10.59350/hnk21-ggm53},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-castillo-aguilar2025" class="csl-entry quarto-appendix-citeas">
Castillo-Aguilar, Matías. 2025. <span>“Going NUTS: A Step-by-Step Guide
to Adaptive Hamiltonian Sampling in R.”</span> January 21, 2025. <a href="https://doi.org/10.59350/hnk21-ggm53">https://doi.org/10.59350/hnk21-ggm53</a>.
</div></div></section></div> ]]></description>
  <category>HMC</category>
  <category>MCMC</category>
  <category>algorithms</category>
  <category>educational</category>
  <guid>https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/</guid>
  <pubDate>Tue, 21 Jan 2025 03:00:00 GMT</pubDate>
  <media:content url="https://bayesically-speaking.com/posts/2025-01-21 hmc-nuts-from-zero/body_1.png" medium="image" type="image/png" height="147" width="144"/>
</item>
<item>
  <title>Decoding the Neuron’s Spark: Building Intuition for Action Potential Dynamics</title>
  <dc:creator>Matías Castillo-Aguilar</dc:creator>
  <link>https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1 page-columns page-full">
<h1>Introduction</h1>
<p>Ever wondered how your brain manages to <strong>tell your hand to grab that slice of pizza</strong> before your roommate does? It’s all thanks to an incredibly complex, yet surprisingly efficient communication network, <strong>your nervous system</strong>. Think of it as the internet of your body, but instead of cat videos and online shopping, it’s buzzing with <strong>urgent messages about survival</strong> (like pizza acquisition) and other important stuff, like not walking into walls.</p>
<p>This network relies on <strong>specialized cells called neurons</strong>, which are basically your body’s tiny gossips. They constantly chatter with each other, passing along information in the form of rapid electrical signals called action potentials <span class="citation" data-cites="drukarch2023thinking">(Drukarch and Wilhelmus 2023)</span>. <strong>These aren’t your grandma’s static shocks</strong>; they’re more like carefully crafted Morse code messages, zipping along neural pathways at impressive speeds. <strong>Imagine each neuron as a tiny town crier</strong>, shouting the latest news (or sensory input) to the next town over.</p>
<p>Now, you might be thinking, <strong>“Electrical signals? Sounds complicated.”</strong> And you’d be right. But fear not! In this post, we’re going to break down the magic behind action potentials using a simplified mathematical model. Think of it as a cheat sheet for understanding how these tiny electrical storms work. <strong>We’ll start with the basics and gradually add complexity</strong>, like adding extra gossip to the town crier’s message, until we have a decent understanding of the dynamics at play. <strong>No PhD in neuroscience required (though a craving for pizza is always helpful)</strong>. So, buckle up, because we’re about to drive into the electrifying world of neuronal communication!</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/action-potential-neuron.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://www.britannica.com/science/action-potential">Encyclopaedia Britannica</a></span></div></div>
</section>
<section id="the-neuron-as-a-simple-circuit-a-first-approximation" class="level1 page-columns page-full">
<h1>The Neuron as a Simple Circuit: A First Approximation</h1>
<p><strong>Let’s imagine our neuron not as a bustling town crier, but as a tiny, slightly bored house</strong>. It’s got walls (the cell membrane), an inside (intracellular fluid), and an outside (extracellular fluid). These fluids are salty solutions, full of charged particles called ions like <strong>sodium, potassium, and chloride (the electrolyte gang you see advertised in sports drinks)</strong>. Now, because these fluids have different concentrations of these ions, there’s a difference in electrical charge between the inside and the outside of the house. <strong>This difference in charge is what we call the <u>membrane potential</u></strong>, measured in millivolts (mV). Think of it like a tiny battery inside the neuron, just waiting to be used.</p>
<p>Normally, this “battery” sits at a <strong>resting voltage of around -70 mV</strong>. Why negative? It’s just a convention: <strong>we define the outside of the cell as zero</strong>, and the inside is negatively charged relative to it. So, our little neuron house is just chilling, with a slight negative charge inside (like a grumpy teenager refusing to get out of bed).</p>
<p>Now, <strong>our neuron’s walls (the membrane) aren’t completely airtight</strong>. They have tiny holes, called <strong><u>leak channels</u></strong>, which allow some ions to slowly trickle in and out. <strong>It’s like having a slightly leaky faucet</strong>, not a major flood, but a constant drip. These leaks are crucial because they maintain that resting membrane potential <span class="citation" data-cites="rubin2021basics">(Rubin 2021)</span>.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/leakage-channels.jpg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://ecampusontario.pressbooks.pub/neurosciencecdn/chapter/anatomy-physiology-the-nervous-system-and-nervous-tissue/">Neuroscience: Canadian 1st Edition</a></span></div></div>
<p>Another important property of the membrane is its <strong>ability to store electrical charge</strong>, much like a capacitor in an electronic circuit. <strong>This is called <u>capacitance</u></strong>. Imagine the membrane as two conductive plates (the inside and outside of the cell) separated by an insulator (the membrane itself). When there’s a difference in charge across the membrane (our membrane potential), <strong>it stores some of that charge</strong> <span class="citation" data-cites="rubin2021basics">(Rubin 2021)</span>. It’s like a tiny electrical reservoir, ready to release its charge when needed.</p>
<p>So, to summarize our lazy neuron house:</p>
<ul>
<li><strong>Membrane potential:</strong> A voltage difference between the inside and outside.</li>
<li><strong>Leak channels:</strong> Tiny holes that allow ions to slowly leak across the membrane, maintaining the resting potential.</li>
<li><strong>Capacitance:</strong> The membrane’s ability to store electrical charge.</li>
</ul>
<section id="expanding-our-intuition-using-math-waking-up-the-sleeping-neuron" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="expanding-our-intuition-using-math-waking-up-the-sleeping-neuron">Expanding our Intuition Using Math: Waking Up the Sleeping Neuron</h4>
<p><strong>Right now, our neuron is basically a zombie</strong>. It’s just sitting there, leaking a bit of charge and generally being a bit of a slacker. No exciting messages, no action potentials, <strong>it’s like a town crier who’s decided to take an eternal nap</strong>. But fear not! Things are about to get much more interesting. We’re about to introduce the real heroes of the story: <strong>voltage-gated ion channels</strong>.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/voltage-dependent-channels.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://ecampusontario.pressbooks.pub/neurosciencecdn/chapter/anatomy-physiology-the-nervous-system-and-nervous-tissue/">Neuroscience: Canadian 1st Edition</a></span></div></div>
<p>Now, <strong>let’s get a little mathematical here</strong> (don’t worry, we’ll keep it fun!). We need a function to describe <strong>how the membrane potential</strong> (<img src="https://latex.codecogs.com/png.latex?V">) <strong>changes over time</strong> (<img src="https://latex.codecogs.com/png.latex?t">) due to all that pesky leakage.</p>
<p>So, what kind of function would you use to describe something that decays gradually, like a deflating balloon? You guessed it! <strong>We need an exponential function</strong>, that classic workhorse of mathematical modeling.</p>
<p>Exponential functions look something like this:</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">input <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span>
<span id="cb1-2"></span>
<span id="cb1-3">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">input =</span> input,</span>
<span id="cb1-4">           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e^x</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(input),</span>
<span id="cb1-5">           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e^x</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(input),</span>
<span id="cb1-6">           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">e^{-x}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>input),</span>
<span id="cb1-7">           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e^{-x}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>input))</span>
<span id="cb1-8"></span>
<span id="cb1-9">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt</span>(df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id.vars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"input"</span>)</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(input, value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> variable, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label_parsed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free_y"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb1-14">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb1-16">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Input"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Output"</span>,</span>
<span id="cb1-18">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exponential Function Dynamics"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-2-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Exponential Function and Common Variations. Here we see how changing a small detail in the original function (in this case a negative sign) can yield dramatically different behavior."><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/index_files/figure-html/unnamed-chunk-2-1.svg" class="img-fluid figure-img" alt="Exponential Function and Common Variations. Here we see how changing a small detail in the original function (in this case a negative sign) can yield dramatically different behavior."></a></p>
<figcaption class="margin-caption"><strong>Exponential Function and Common Variations</strong>. Here we see how changing a small detail in the original function (in this case a negative sign) can yield dramatically different behavior.</figcaption>
</figure>
</div>
</div>
</div>
<p>At first glance, we can see that the bottom variations of the exponential function (the ones with negative exponents) <strong>seem to behave more like a neuron should</strong>. They oscillate nicely, staying within a reasonable range. This function with the negative exponent, <img src="https://latex.codecogs.com/png.latex?e%5E%7B-x%7D">, seems like a good starting point to describe <strong>how the membrane potential gradually returns to its resting state</strong>. It’s like watching a deflating balloon (slow and steady).</p>
</section>
<section id="customizing-it-further-tweaking-the-decay-rate" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="customizing-it-further-tweaking-the-decay-rate">Customizing It Further: Tweaking the Decay Rate</h4>
<p>Now, let’s get a little more creative! <strong>We can tweak this function to control how quickly the membrane potential returns to rest</strong>. Imagine it’s like adjusting the valve on a tire, you can control how fast the air leaks out.</p>
<p>We can do this by adding a “<strong>rate parameter</strong>” to our exponent. Instead of just <img src="https://latex.codecogs.com/png.latex?e%5E%7B-x%7D">, we can use <img src="https://latex.codecogs.com/png.latex?e%5E%7B-x%20%5Ccdot%20%5Clambda%7D">. This <img src="https://latex.codecogs.com/png.latex?%5Clambda"> value acts <strong>like a speed control for the decay</strong>. By changing <img src="https://latex.codecogs.com/png.latex?%5Clambda">, we can adjust how quickly the membrane potential returns to its resting value. It’s like having a dial to control how fast the balloon deflates.</p>
<p>Let’s visualize this change and see how it affects the decay rate!</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">input <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span>
<span id="cb2-2"></span>
<span id="cb2-3">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Input =</span> input, </span>
<span id="cb2-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nsmall =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb2-6">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Output =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>input <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x))</span>
<span id="cb2-7">}) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbindlist</span>()</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Input, Output, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ordered</span>(lambda))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb2-11">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(lambda),</span>
<span id="cb2-14">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(e<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>lambda}),</span>
<span id="cb2-15">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rate Parameter ("</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>lambda<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">") on Output Dynamics"</span>))</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Effect of Rate Parameter on Function Dynamics. Here we see that by altering the rate parameter \lambda we can toy around with “how fast” our exponential function is returning to baseline."><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img" alt="Effect of Rate Parameter on Function Dynamics. Here we see that by altering the rate parameter \lambda we can toy around with “how fast” our exponential function is returning to baseline."></a></p>
<figcaption class="margin-caption"><strong>Effect of Rate Parameter on Function Dynamics</strong>. Here we see that by altering the rate parameter <img src="https://latex.codecogs.com/png.latex?%5Clambda"> we can toy around with “how fast” our exponential function is returning to baseline.</figcaption>
</figure>
</div>
</div>
</div>
<p>Great! <strong>Now we need to give this function a little personality</strong>. Right now, it’s a bit generic. It always starts at 1 and decays towards 0. But <strong>what if we want to start at a different value?</strong> Or maybe we want it to <strong>decay towards a different value than 0?</strong></p>
<p>No problem! We can easily customize this function.</p>
<p>First, let’s give it a starting point. We can add a multiplicative factor (let’s call it <img src="https://latex.codecogs.com/png.latex?b">) to the exponential function. <strong>This is like giving our function a “starting height”</strong>. Now, our function looks like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ab%20%5Ccdot%20e%5E%7B-x%20%5Ccdot%20%5Clambda%7D%0A"></p>
<p>Next, <strong>let’s give it a target value</strong>. We can add a linear factor (let’s call it <img src="https://latex.codecogs.com/png.latex?a">) to shift the entire curve up or down. This is <strong>like setting a new “ground level”</strong> for our function.</p>
<p>With these adjustments, our function now looks like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aa%20+%20b%20%5Ccdot%20e%5E%7B-x%20%5Ccdot%20%5Clambda%7D%0A"></p>
<p><strong>This gives us much more flexibility!</strong> For example, if we set <img src="https://latex.codecogs.com/png.latex?a"> to 0 and <img src="https://latex.codecogs.com/png.latex?b"> to 1, we get our original function. <strong>It’s like having a basic template and then customizing it</strong> to fit our specific needs.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/exponential-function-cartoon.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">In fact, she did use it at the end. Photo from Frank Mariani in <a href="https://www.cartoonistforhire.com/frank-mariani-book-illustration/">Cartoonist for Hire</a></span></div></div>
<p>But wait a minute! We’ve been doing all this math, and <strong>we haven’t even talked about neurons yet!</strong> What was the point of all this mental gymnastics? Well, it turns out that this seemingly random function has a <strong>very real biological meaning</strong>.</p>
<p>Let’s take a look at that equation again, but this time with some real neuron terms:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AV(t)%20=%20E_L%20+%20(V_0%20-%20E_L)%20%5Ccdot%20e%5E%7B-g_L%20%5Ccdot%20t%7D%0A"></p>
<p>Now, this equation starts to make sense. It tells us how the membrane potential (<img src="https://latex.codecogs.com/png.latex?V">) changes over time (<img src="https://latex.codecogs.com/png.latex?t">). It’s like watching a movie of the membrane potential.</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?V(t)">: This is the <strong>membrane potential at any given moment</strong>, the voltage across the cell membrane at that exact instant.</li>
<li><img src="https://latex.codecogs.com/png.latex?E_L">: This is the <strong>“leak reversal potential”</strong>, the magical voltage where the leak channels are perfectly balanced. It’s like the <em>“sweet spot”</em> for the membrane, usually close to the resting membrane potential (around -70 mV). This is the value our function will try to get over time.</li>
<li><img src="https://latex.codecogs.com/png.latex?V_0">: This is the starting point, <strong>the initial membrane potential</strong> at time <img src="https://latex.codecogs.com/png.latex?t%20=%200">. It’s like the starting position in a race.</li>
<li><img src="https://latex.codecogs.com/png.latex?g_L">: This is the <strong>“leak conductance”</strong>, a measure of <em>how easily</em> ions can leak through the membrane. Think of it as how wide the leaky faucet is open. A higher <img src="https://latex.codecogs.com/png.latex?g_L"> means ions leak faster, and the membrane potential changes more quickly.</li>
<li><img src="https://latex.codecogs.com/png.latex?e%5E%7B-g_L%20%5Ccdot%20t%7D">: This is <strong>the exponential decay term</strong>, the engine that drives the change. It ensures that the membrane potential gradually approaches <img src="https://latex.codecogs.com/png.latex?E_L"> over time, like a car slowly coming to a stop.</li>
</ul>
<p>Now, <strong>let’s get a little more mathematical</strong>. If we want to express how the membrane potential changes over time, <strong>we need to find the “rate of change”</strong> of the membrane potential. In math terms, this is called the <em>derivative</em>.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/confused-math.gif" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside"><strong>Average Bayesically-Speaking reader</strong> going through the content on a typical blog post after I say “We’ll start with the basics”. Photo from <a href="https://giphy.com/gifs/producthunt-zach-galifianakis-algorithm-3o6Yg4GUVgIUg3bf7W">Giphy</a></span></div></div>
<p>If we take the derivative of our previous equation (don’t worry, you don’t need to know the calculus!), we get something like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Bd%20V%7D%7Bd%20t%7D%20=%20-g_L%20%5Ccdot%20(V_0%20-%20E_L)%0A"></p>
<p>This equation tells us <strong>how fast the membrane potential is changing</strong> at any given moment.</p>
<p>Let’s break this down:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bd%20V%7D%7Bd%20t%7D">: This fancy term represents the <strong>“rate of change” of the membrane potential</strong>. It tells us how quickly the voltage is rising or falling.</li>
<li><img src="https://latex.codecogs.com/png.latex?g_L">: This is our old friend, the <strong>leak conductance</strong>. A higher <img src="https://latex.codecogs.com/png.latex?g_L"> means the membrane is <em>“more leaky”</em>, and the membrane potential will change more rapidly.</li>
<li><img src="https://latex.codecogs.com/png.latex?(V_0%20-%20E_L)">: This term represents <strong>the “driving force”</strong> for the leak current. The bigger the difference between the current potential and the leak reversal potential, the stronger the <em>“urge”</em> for the membrane potential to return to equilibrium. It’s like a ball rolling down a steep hill, the steeper the hill, the faster it rolls.</li>
</ul>
<p>If the next plot, we’ll see the solution to this equation, <strong>an exponential decay curve</strong>. It’s like watching a ball rolling down a hill, it starts fast but gradually slows down as it approaches the bottom.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parameters</span></span>
<span id="cb3-2">time <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Time vector</span></span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to calculate membrane potential over time</span></span>
<span id="cb3-5">membrane_potential <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(time, V0, g_L, E_L) {</span>
<span id="cb3-6">  V <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (V0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> E_L) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>g_L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> time) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> E_L</span>
<span id="cb3-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(V)</span>
<span id="cb3-8">}</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Starting membrane potentials</span></span>
<span id="cb3-11">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">68</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb3-12">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">membrane_potential</span>(time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">V0 =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">g_L =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">E_L =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>),</span>
<span id="cb3-13">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start_v =</span> x,</span>
<span id="cb3-14">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time)</span>
<span id="cb3-15">         }) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbindlist</span>()</span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the plot using ggplot2</span></span>
<span id="cb3-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> v, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ordered</span>(start_v))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add E_L line</span></span>
<span id="cb3-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb3-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (Arbitrary Units)"</span>,</span>
<span id="cb3-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Membrane Potential (mV)"</span>,</span>
<span id="cb3-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Membrane Potential Decay Due to Leak Current"</span>,</span>
<span id="cb3-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Starting Voltage (mV)"</span></span>
<span id="cb3-27">  )</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-4-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Membrane Potential and Leak Current. Here we can see that the membrane tends to return to its resting potential. This behavior is accomplished by the tweaks we made earlier to our exponential function."><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/index_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img" alt="Membrane Potential and Leak Current. Here we can see that the membrane tends to return to its resting potential. This behavior is accomplished by the tweaks we made earlier to our exponential function."></a></p>
<figcaption class="margin-caption"><strong>Membrane Potential and Leak Current</strong>. Here we can see that the membrane tends to return to its resting potential. This behavior is accomplished by the tweaks we made earlier to our exponential function.</figcaption>
</figure>
</div>
</div>
</div>
<p>For example, if we inject a small current that briefly changes the membrane potential to -60 mV, the membrane potential will decay back to -70 mV, following the equation.</p>
</section>
<section id="too-simple" class="level4">
<h4 class="anchored" data-anchor-id="too-simple">Too Simple?</h4>
<p>This simple model is important because it shows us how the membrane potential would behave <em>passively</em>, <strong>in the absence of any active processes</strong>. It explains how the resting membrane potential is maintained. However, <strong>it <u>doesn’t</u> explain the rapid, dramatic changes we see during an action potential</strong>. Our sleepy neuron is still just leaking and slowly returning to its resting state. It’s like watching paint dry (not exactly thrilling). We need something more to explain the neuron’s “shouting” behavior. <strong>That “something more” is the introduction of <u>voltage-gated ion channels</u></strong>, which we’ll explore in the next section.</p>
<p>Okay, let’s add some simplified equations to represent the voltage-gated channels and incorporate them into our membrane potential equation.</p>
</section>
</section>
<section id="adding-voltage-gated-channels-the-key-to-excitation" class="level1 page-columns page-full">
<h1>Adding Voltage-Gated Channels: The Key to Excitation</h1>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/recording-animation.gif" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://www.humanbiomedia.org/action-potential-media/">Human Bio Media</a></span></div></div>
<p>Okay, let’s get down to the nitty-gritty. <strong>How does this whole “voltage” thing actually work?</strong> Well, picture this: the change in voltage over time (basically how fast the voltage is shifting), <strong>is all about the flow of ions</strong>. You’ve got ions lazily leaking through the membrane (let’s call that the “lazy ion flow”), and then you’ve got the more exciting players: sodium, potassium, and even some other ions that like to join the party.</p>
<p>So, if we want to get fancy, we could say that <strong>the change in voltage over time</strong>, which we can write as <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BdV%7D%7Bdt%7D"> for all you math whizzes out there, <strong>is basically a sum of all these ion flows</strong>. We’ve got the lazy ion flow (<img src="https://latex.codecogs.com/png.latex?I_L">), the sodium party crashers (<img src="https://latex.codecogs.com/png.latex?I_%7BNa%7D">), the potassium crew (<img src="https://latex.codecogs.com/png.latex?I_K">), and any other surprise guests (<img src="https://latex.codecogs.com/png.latex?I_%7B%5Ctext%7Bother%20ions%7D%7D">).</p>
<p>And if we want to put it all together in a fancy equation, we could say that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7BdV%7D%7Bdt%7D%20=%20I_L%20+%20I_%7BNa%7D%20+%20I_K%20+%20%5Cdots%20+%20I_%7B%5Ctext%7Bother%20ions%7D%7D%0A"></p>
<p>So, now we’ve got this “leaky current” (<img src="https://latex.codecogs.com/png.latex?I_L">), which we can basically describe using that fancy equation <img src="https://latex.codecogs.com/png.latex?-g_L%20%5Ccdot%20(V_0%20-%20E_L)">. <strong>But what about those exciting voltage-gated channels?</strong> How do we explain their contribution to the party? To figure that out, we need to dive deeper into the wild world of voltage-gated channel dynamics.</p>
<p><strong>Remember our boring old passive membrane?</strong> It just kind of slumped back to its resting potential, like a deflated balloon. Well, <strong>our active neurons</strong> are a whole different story. They’ve <strong>got these amazing channels that open and close depending on the voltage</strong>, making the whole system much more exciting.</p>
<p><strong>These channels</strong>, especially the sodium (<img src="https://latex.codecogs.com/png.latex?Na%5E+">) and potassium (<img src="https://latex.codecogs.com/png.latex?K%5E+">) channels, <strong>are the real stars of the show</strong>. They’re the ones that cause those dramatic swings in voltage during an action potential.</p>
<p><strong><u>Sodium channels</u></strong> are like little gates. They have an <em>“activation gate”</em> (let’s call it gate <img src="https://latex.codecogs.com/png.latex?m">) that swings <strong>open around -55 mV</strong>. This is like the starting pistol for the race! <strong>Sodium ions flood into the cell, and the voltage skyrockets</strong>. But here’s the catch: these channels also have an <em>“inactivation gate”</em> (let’s call it gate <img src="https://latex.codecogs.com/png.latex?h">) that slams <strong>shut around +30 mV</strong>. It’s like the emergency brakes! This <strong>prevents the cell from exploding with too much sodium</strong>. And don’t worry, <strong>the inactivation gate eventually reopens</strong> when the cell calms down and returns to its resting potential (around -70 mV).</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/sodium-channel-open-state.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Sodium channel in an open state, illustrating its activation and inactivation gates. Photo from <a href="https://www.humanbiomedia.org/action-potential-media/">Human Bio Media</a></span></div></div>
<p>So, if we want to express the sodium current (<img src="https://latex.codecogs.com/png.latex?I_%7BNa%7D">) in all its glory, we could say that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AI_%7BNa%7D%20=%20-g_%7BNa%7D%20%5Ccdot%20m%20%5Ccdot%20h%20%5Ccdot%20(V_0%20-%20E_%7BNa%7D)%0A"></p>
<p>Where:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?g_%7BNa%7D">: <strong>Sodium conductance</strong> (how easily sodium ions flow when channels are open).</li>
<li><img src="https://latex.codecogs.com/png.latex?m">: Sodium <strong>activation gate</strong> (1 = open, 0 = closed).</li>
<li><img src="https://latex.codecogs.com/png.latex?h">: Sodium <strong>inactivation gate</strong> (1 = open, 0 = closed). This gate introduces a delay and helps terminate the sodium current.</li>
<li><img src="https://latex.codecogs.com/png.latex?E_%7BNa%7D">: Sodium <strong>reversal potential</strong>.</li>
</ul>
<p>In contrast, <strong>potassium channels are a bit simpler</strong>. They only have one gate (let’s call it gate <img src="https://latex.codecogs.com/png.latex?n">), which <strong>acts like a slow-opening door</strong>. This gate starts to swing <strong>open around +30mV</strong>, allowing potassium ions to flood out of the cell. This outflow of positive charge <strong>helps bring the voltage back down to resting potential</strong> (a phase we call “repolarization”). But here’s the twist: this gate is a bit slow to close. <strong>It doesn’t fully shut until the voltage dips below -80 mV</strong>, which is even more negative than the resting potential. This creates a slight undershoot before the cell finally settles back down.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/potassium-channel-open-state.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Potassium channel in an open state, with its only voltage-dependent gate. Photo from <a href="https://www.humanbiomedia.org/action-potential-media/">Human Bio Media</a></span></div></div>
<p>Just like we did with the sodium channels, we can express the potassium current (<img src="https://latex.codecogs.com/png.latex?I_K">) as the following:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AI_%7BK%7D%20=%20-g_%7BK%7D%20%5Ccdot%20n%20%5Ccdot%20(V_0%20-%20E_%7BK%7D)%0A"></p>
<p>Where:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?g_K">: Potassium conductance.</li>
<li><img src="https://latex.codecogs.com/png.latex?n">: Potassium activation gate (1 = open, 0 = closed).</li>
<li><img src="https://latex.codecogs.com/png.latex?E_K">: Potassium reversal potential.</li>
</ul>
<p>So now, our updated equation now looks like this:</p>
<div class="page-columns page-full"><p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cfrac%7BdV%7D%7Bdt%7D%20=%20-&amp;g_L%20%5Ccdot%20(V%20-%20E_L)%20+%20%5C%5C%0A-&amp;g_%7BNa%7D%20%5Ccdot%20m%20%5Ccdot%20h%20%5Ccdot%20(V%20-%20E_%7BNa%7D)%20+%20%5C%5C%0A-&amp;g_K%20%5Ccdot%20n%20%5Ccdot%20(V%20-%20E_K)%0A%5Cend%7Baligned%7D%0A"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">To maintain clarity and focus on the core dynamics, we’ll use simplified “on/off” gating variables rather than the full Hodgkin-Huxley equations (which we can explore another time).</span></div></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Simplified Gating: A Key Simplification
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In the real world, these gating variables (<code>m</code>, <code>h</code>, and <code>n</code>) are described by some seriously complex equations in the full <strong>Hodgkin-Huxley model</strong> <span class="citation" data-cites="yao2023dynamic">(see Yao et al. 2023)</span>. It’s like trying to understand the inner workings of a Swiss watch!</p>
<p>But for our simplified model, we’re going to take a shortcut. We’ll assume these gates simply snap open and shut based on the voltage. It’s like we’re replacing that intricate Swiss watch with a simple on/off switch. <strong>This simplification helps us grasp the fundamental principles</strong> of action potential generation without getting bogged down in a sea of equations.</p>
</div>
</div>
</div>
<p>With these additions, our model finally starts to show some exciting behavior! If the membrane potential reaches a certain <em>“trigger point”</em> (called the threshold), <strong>the sodium channels swing open</strong> wide (<img src="https://latex.codecogs.com/png.latex?m"> = 1). It’s like a floodgate opening! <strong>Sodium ions rush into the cell</strong>, causing a rapid spike in voltage, that’s our action potential!</p>
<p>But then, the sodium inactivation gate slams shut (<img src="https://latex.codecogs.com/png.latex?h"> = 0), and the <strong>potassium channels finally open their doors</strong> (<img src="https://latex.codecogs.com/png.latex?n"> = 1). <strong>Potassium ions rush out of the cell</strong>, bringing the voltage back down to normal, that’s the “repolarization” phase.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/ion-channels.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Voltage-gated channels for sodium (Na<sup>+</sup>) and potassium (K<sup>+</sup>). ECF, extracellular fluid; ICF, intracellular fluid. Photo from <a href="https://www.humanbiomedia.org/action-potential-media/">Human Bio Media</a></span></div></div>
<p>Now, <strong>let’s put this model into action</strong>! We’ll use something called the <em>Euler method</em>, which is basically a fancy way of <strong>numerically solving our equation</strong>. This will allow us to see how the membrane potential changes over time in response to a stimulus. <strong>It’s like running a simulation</strong> to see how our “neuron” behaves in the real world.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About the Hodgkin-Huxley Model
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The <em>Hodgkin-Huxley equations</em> <span class="citation" data-cites="hodgkin1939action">(see Hodgkin and Huxley 1939)</span>, developed in the mid-20th century, <strong>revolutionized our understanding of how neurons fire</strong>. These complex equations, initially derived from meticulous experiments on the giant squid axon, <strong>accurately model the intricate interplay of ion channels</strong> that generate the action potential.</p>
<p>Okay but, why it matters today? Well, for many reasons like:</p>
<ul>
<li><strong>Foundation for modern neuroscience:</strong> The <em>Hodgkin-Huxley model</em> remains a cornerstone of computational neuroscience, providing a framework for understanding the electrical behavior of neurons.</li>
<li><strong>Drug development:</strong> Researchers use these equations to study the effects of drugs and toxins on neuronal activity, aiding in the development of new medications for neurological disorders.</li>
<li><strong>Artificial intelligence:</strong> Inspired by the <em>Hodgkin-Huxley model</em>, researchers are developing biologically realistic artificial neurons for use in neuromorphic computing, a promising area of artificial intelligence.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="simulating-an-action-potential-bringing-the-model-to-life" class="level1 page-columns page-full">
<h1>Simulating an Action Potential: Bringing the Model to Life</h1>
<p>Alright, <strong>let’s get this show on the road!</strong> Now that we have our simplified mathematical model of the neuron, it’s time to bring it to life. We’ll use R, a powerful programming language, <strong>to simulate our model</strong> and watch how the membrane potential changes over time.</p>
<p>We’ll use a technique called the <em>Euler method</em>, which is basically like taking tiny little steps to solve our equation. It’s a bit like trying to reach a destination <strong>by taking a series of small hops</strong> instead of jumping straight there.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/wojak-meme.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside"><strong>Average Bayesically-Speaking reader</strong> when is asked about their knowledge on voltage-gated channels. Photo from <a href="https://wojak-studio.com">Wojak-Studio</a></span></div></div>
<section id="setting-the-stage-defining-the-parameters" class="level4">
<h4 class="anchored" data-anchor-id="setting-the-stage-defining-the-parameters">Setting the Stage: Defining the Parameters</h4>
<p>First, <strong>we need to define the parameters of our model</strong>. These parameters represent the <strong>properties of our neuron</strong>, such as how <em>“leaky”</em> the membrane is and the properties of the sodium and potassium channels. We also need to define <strong>the time step</strong> (<code>dt</code>), which determines how often we <em>“take a picture”</em> of the membrane potential during our simulation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parameters</span></span>
<span id="cb4-2">params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb4-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">g_L =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">E_L =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>,   <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Leak Channels</span></span>
<span id="cb4-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">g_Na =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">E_Na =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Sodium Channels</span></span>
<span id="cb4-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">g_K =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">E_K =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,   <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Potassium Channels</span></span>
<span id="cb4-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dt =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span></span>
<span id="cb4-7">)</span></code></pre></div>
</div>
<p>Here:</p>
<ul>
<li><code>g_L</code>: Leak conductance.</li>
<li><code>E_L</code>: Leak reversal potential (resting potential).</li>
<li><code>g_Na</code>: Sodium conductance.</li>
<li><code>E_Na</code>: Sodium reversal potential.</li>
<li><code>g_K</code>: Potassium conductance.</li>
<li><code>E_K</code>: Potassium reversal potential.</li>
<li><code>dt</code>: Time step (0.001 ms).</li>
</ul>
</section>
<section id="the-sodium-activation-gate-the-onoff-switch" class="level4">
<h4 class="anchored" data-anchor-id="the-sodium-activation-gate-the-onoff-switch">The Sodium Activation Gate: The On/Off Switch</h4>
<p>The <strong>sodium activation</strong> gate (<code>m</code>) is like the <em>“on”</em> switch for sodium channels. When the membrane potential (<code>V_prev</code>) reaches a critical point, around -55 mV, <strong>this gate swings open instantly</strong>, allowing sodium ions to flood in. It’s like someone yelling <em>“Go!”</em> at a starting line.</p>
<p>In our simplified model, <strong>we’re making a big assumption</strong>: this gate is an <em>all-or-nothing</em> switch. Either it’s completely open (<code>m</code> becomes 1) or completely closed (<code>m</code> is 0). <strong>This is a simplification</strong>, but it helps us capture the essence of the rapid rise of the action potential.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">update_m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(V_prev) {</span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(V_prev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb5-3">}</span></code></pre></div>
</div>
<p>This function takes the previous membrane potential (<code>V_prev</code>) as input <strong>and tells us whether the sodium activation gate is open or closed</strong>.</p>
</section>
<section id="the-sodium-inactivation-gate-the-emergency-brake" class="level4">
<h4 class="anchored" data-anchor-id="the-sodium-inactivation-gate-the-emergency-brake">The Sodium Inactivation Gate: The Emergency Brake</h4>
<p>The <strong>sodium inactivation gate</strong> (<code>h</code>) is like the emergency brake for the sodium channels. It starts open (<code>h</code> = 1) at rest, but when the membrane depolarizes and sodium channels open wide (<code>m</code> = 1), this gate slowly starts to close (<code>h</code> transitions towards 0). This <strong>is crucial to prevent a runaway influx of sodium</strong>.</p>
<p>However, the <strong>inactivation gate only starts to close when the membrane potential is sufficiently positive</strong> (around +20 mV). It’s like the brake only engages when the car is going fast enough.</p>
<p>Conversely, when the membrane repolarizes and <strong>the sodium channels close</strong> (<code>m</code> = 0), the inactivation gate slowly reopens (<code>h</code> transitions towards 1). But <strong>this recovery only happens when the membrane potential is sufficiently negative</strong> (around -70 mV). It’s like the brake only releases when the car has slowed down significantly.</p>
<p>This conditional behavior is implemented in the following function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">update_h <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(m_current, V_prev, h_prev) {</span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(</span>
<span id="cb6-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> m_current <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> V_prev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, </span>
<span id="cb6-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yes =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb6-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">no =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(</span>
<span id="cb6-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> m_current <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> V_prev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, </span>
<span id="cb6-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yes =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb6-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">no =</span> h_prev</span>
<span id="cb6-9">    )</span>
<span id="cb6-10">  )</span>
<span id="cb6-11">}</span></code></pre></div>
</div>
<p>This function takes the current value of <code>m</code> (<code>m_current</code>), the previous membrane potential (<code>V_prev</code>), and the previous value of <code>h</code> (<code>h_prev</code>) as inputs and <strong>returns the updated value of <code>h</code></strong>.</p>
</section>
<section id="the-potassium-activation-gate-the-slow-and-steady-door" class="level4">
<h4 class="anchored" data-anchor-id="the-potassium-activation-gate-the-slow-and-steady-door">The Potassium Activation Gate: The Slow and Steady Door</h4>
<p>The <strong>potassium activation gate</strong> (<code>n</code>) is like a slow-opening door. It <strong>starts to open when the membrane potential reaches a sufficiently positive value</strong> (around +20 mV). But unlike the sodium gate, it’s a bit sluggish.</p>
<p>There’s also a bit of <em>“<a href="https://en.wikipedia.org/wiki/Hysteresis">hysteresis</a>”</em> here. This means that the potassium gate <strong>only closes when the membrane potential becomes extremely negative</strong> (around -80 mV) and it was already open in the previous time step. <strong>It’s like the door is reluctant to close once it’s been opened</strong>. This hysteresis ensures that the membrane repolarizes completely before the potassium channels fully close.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">update_n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(V_prev, n_prev) {</span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(</span>
<span id="cb7-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> V_prev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, </span>
<span id="cb7-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yes =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb7-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">no =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(</span>
<span id="cb7-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> V_prev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> n_prev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb7-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yes =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb7-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">no =</span> n_prev</span>
<span id="cb7-9">    )</span>
<span id="cb7-10">  )</span>
<span id="cb7-11">}</span></code></pre></div>
</div>
<p>This function takes the previous membrane potential (<code>V_prev</code>) and the previous value of <code>n</code> (<code>n_prev</code>) as input and <strong>returns the updated value of <code>n</code></strong>.</p>
</section>
<section id="calculating-the-ion-flows-the-grand-finale" class="level4">
<h4 class="anchored" data-anchor-id="calculating-the-ion-flows-the-grand-finale">Calculating the Ion Flows: The Grand Finale</h4>
<p>This function calculates the flow of ions across the membrane. We have three main players:</p>
<ul>
<li><strong>The Leaky Current:</strong> This is the <em>“background”</em> current, where ions slowly leak through the membrane.</li>
<li><strong>The Sodium Current:</strong> This is where the action happens! It’s influenced by the sodium activation gate (<code>m</code>) and the inactivation gate (<code>h</code>).</li>
<li><strong>The Potassium Current:</strong> This current is controlled by the potassium activation gate (<code>n</code>).</li>
</ul>
<p>To calculate each current, we use a simple formula: <img src="https://latex.codecogs.com/png.latex?I%20=%20g%20%5Ccdot%20(V%20-%20E)">. <strong>It’s like calculating the flow of water through a pipe</strong>, where <img src="https://latex.codecogs.com/png.latex?g"> represents the size of the pipe, <img src="https://latex.codecogs.com/png.latex?V"> is the pressure difference, and <img src="https://latex.codecogs.com/png.latex?E"> is a kind of “equilibrium point.”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">calculate_currents <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb8-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(V_prev, m, h, n, params) {</span>
<span id="cb8-3">    </span>
<span id="cb8-4">  l_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>g_L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (V_prev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>E_L)</span>
<span id="cb8-5">  na_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>g_Na <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> h <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (V_prev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>E_Na)</span>
<span id="cb8-6">  k_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>g_K <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (V_prev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>E_K)</span>
<span id="cb8-7">  </span>
<span id="cb8-8">  output <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l_current =</span> l_current, </span>
<span id="cb8-9">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na_current =</span> na_current, </span>
<span id="cb8-10">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">k_current =</span> k_current)</span>
<span id="cb8-11">  </span>
<span id="cb8-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(output)</span>
<span id="cb8-13">}</span></code></pre></div>
</div>
<p>This function takes the previous membrane potential (<code>V_prev</code>), the gating variables (<code>m</code>, <code>h</code>, <code>n</code>), and the parameters (<code>params</code>) as input and <strong>returns a list containing the calculated currents</strong>.</p>
</section>
<section id="simulating-neurons-in-action-bringing-it-all-together" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="simulating-neurons-in-action-bringing-it-all-together">Simulating Neurons in Action: Bringing it All Together!</h4>
<p>This is the grand finale! <strong>This function brings all the pieces together</strong> to simulate how our neuron actually behaves. It takes the <u>model parameters</u>, a <u>time vector</u> (which tells us how long to run the simulation), and a <u>stimulus current</u> (like an external input to the neuron) as input.</p>
<p>Then, <strong>it iterates through each time step</strong>, updating the gating variables (those pesky “m,” “h,” and “n” gates) and <strong>calculating how the membrane potential changes</strong> using the Euler method. It’s like watching a movie frame-by-frame, seeing how the neuron responds to the different inputs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">simulate_ap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(params, time, stimulus_current) {</span>
<span id="cb9-2">  n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(time)</span>
<span id="cb9-3">  V <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>E_L, n) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize Membrane potential</span></span>
<span id="cb9-4">  m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize Sodium Activation</span></span>
<span id="cb9-5">  h <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize Sodium Inactivation</span></span>
<span id="cb9-6">  n_inf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize Potassium Activation</span></span>
<span id="cb9-7">  l_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize Leak Current</span></span>
<span id="cb9-8">  na_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize Sodium Current</span></span>
<span id="cb9-9">  k_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize Potassium Current</span></span>
<span id="cb9-10">  </span>
<span id="cb9-11">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n) {</span>
<span id="cb9-12">    <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Updates the state of each channel's gates</span></span>
<span id="cb9-13">    m[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_m</span>(V[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb9-14">    h[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_h</span>(m[i], V[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], h[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb9-15">    n_inf[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_n</span>(V[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], n_inf[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb9-16">    </span>
<span id="cb9-17">    <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Compute the current </span></span>
<span id="cb9-18">    currents <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculate_currents</span>(</span>
<span id="cb9-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">V_prev =</span> V[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb9-20">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> m[i], </span>
<span id="cb9-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> h[i], </span>
<span id="cb9-22">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_inf[i], </span>
<span id="cb9-23">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">params =</span> params</span>
<span id="cb9-24">    )</span>
<span id="cb9-25">    </span>
<span id="cb9-26">    l_current[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> currents<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>l_current</span>
<span id="cb9-27">    na_current[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> currents<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>na_current</span>
<span id="cb9-28">    k_current[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> currents<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>k_current</span>
<span id="cb9-29">    </span>
<span id="cb9-30">    <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Sum each current contribution to the overall voltage change</span></span>
<span id="cb9-31">    dVdt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb9-32">      l_current[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-33">      na_current[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-34">      k_current[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-35">      stimulus_current[i]</span>
<span id="cb9-36">    </span>
<span id="cb9-37">    <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Update the Voltage based on current net flow</span></span>
<span id="cb9-38">    V[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb9-39">      V[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dVdt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>dt</span>
<span id="cb9-40">  }</span>
<span id="cb9-41">  </span>
<span id="cb9-42">  output <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Time =</span> time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Voltage =</span> V)</span>
<span id="cb9-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(output)</span>
<span id="cb9-44">}</span></code></pre></div>
</div>
<p>This function gets the party started! <strong>It initializes the membrane potential and all those gating variables</strong> (“m,” “h,” and “n”) to their starting values. Then, it enters a loop, <strong>stepping through time</strong> and updating these variables at each step. It’s like watching a movie play out <em>frame-by-frame</em>, observing how the membrane potential changes in response to the shifting currents.</p>
<p>Now, <strong>let’s run this simulation and see what happens!</strong> We’ll visualize the results to get a better understanding of how the neuron behaves.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulation time</span></span>
<span id="cb10-2">time <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>dt)</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Stimulus</span></span>
<span id="cb10-5">stimulus_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(time))</span>
<span id="cb10-6">stimulus_current[time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the simulation</span></span>
<span id="cb10-9">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_ap</span>(params, time, stimulus_current)</span>
<span id="cb10-10"></span>
<span id="cb10-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting</span></span>
<span id="cb10-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Time, Voltage)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (ms)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Membrane Potential (mV)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simplified Action Potential Model"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-11-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Simplified Action Potential Model. Here we can see that after taking into account each contribution to the overall voltage dynamics over time (based on net current flow), we can see something more alike to a real action potential curve."><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/index_files/figure-html/unnamed-chunk-11-1.svg" class="img-fluid figure-img" alt="Simplified Action Potential Model. Here we can see that after taking into account each contribution to the overall voltage dynamics over time (based on net current flow), we can see something more alike to a real action potential curve."></a></p>
<figcaption class="margin-caption"><strong>Simplified Action Potential Model</strong>. Here we can see that after taking into account each contribution to the overall voltage dynamics over time (based on net current flow), we can see something more alike to a real action potential curve.</figcaption>
</figure>
</div>
</div>
</div>
<!-- Systematically vary key parameters, such as: -->
</section>
</section>
<section id="tweaking-the-knobs-sensitivity-analysis" class="level1 page-columns page-full">
<h1>Tweaking the Knobs: Sensitivity Analysis</h1>
<p>Now that we have our neuron simulation up and running, let’s see what happens when we start tinkering with the settings. This is called <em>sensitivity analysis</em>. <strong>We’ll systematically change one parameter at a time and see how it affects the neuron’s behavior</strong>. It’s like tweaking the knobs on a radio to see how it changes the sound.</p>
<p>This analysis is <strong>crucial for understanding how our model works</strong> and figuring out which parameters have the biggest impact on the action potential. It’s like trying to figure out <strong>which ingredients are most important</strong> for baking the perfect cake.</p>
<p>To make this process easier, we’ll create a special function called <code>sensitivity_analysis</code>. This function takes the model parameters, the time vector, the stimulus current, the name of the parameter we want to change (<code>param_name</code>), and a list of values we want to test for that parameter (<code>values</code>) as input. It then <strong>runs the simulation for each value in the list</strong>, stores the results, and combines them all into a single, organized data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">sensitivity_analysis <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb11-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(params, time, stimulus_current, param_name, values) {</span>
<span id="cb11-3">  </span>
<span id="cb11-4">    results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"list"</span>)</span>
<span id="cb11-5">    </span>
<span id="cb11-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (value <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> values) {</span>
<span id="cb11-7">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modify the parameter value</span></span>
<span id="cb11-8">      modified_params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params</span>
<span id="cb11-9">      modified_params[[param_name]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> value </span>
<span id="cb11-10">      </span>
<span id="cb11-11">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the simulation</span></span>
<span id="cb11-12">      df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_ap</span>(modified_params, time, stimulus_current) </span>
<span id="cb11-13">      </span>
<span id="cb11-14">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add a column to track the parameter value</span></span>
<span id="cb11-15">      df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ParameterValue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> value</span>
<span id="cb11-16">      </span>
<span id="cb11-17">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Store the results</span></span>
<span id="cb11-18">      results[[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(value)]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df</span>
<span id="cb11-19">    }</span>
<span id="cb11-20">    </span>
<span id="cb11-21">    output <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbindlist</span>(results)</span>
<span id="cb11-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(output) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine all data.tables into one</span></span>
<span id="cb11-23">}</span></code></pre></div>
</div>
<p>Inside the function, we do the following:</p>
<ol type="1">
<li><strong>Create an empty list:</strong> We create an empty list called <code>results</code> to store the output of each simulation. Think of it as an empty box to store all our simulation results.</li>
<li><strong>Loop through the values:</strong> We loop through each value in the list of values we want to test. It’s like trying different settings on a machine one by one.</li>
<li><strong>Make a copy:</strong> We create a copy of our original parameters called <code>modified_params</code>. This is crucial to avoid messing up the original settings.</li>
<li><strong>Tweak the parameter:</strong> We modify the specific parameter (<code>param_name</code>) in our <code>modified_params</code> copy to the current value from our list.</li>
<li><strong>Run the simulation:</strong> We run our <code>simulate_ap</code> function with these modified parameters to see how the neuron behaves.</li>
<li><strong>Add a label:</strong> We add a new column called <code>ParameterValue</code> to the results to keep track of which parameter value we used for that simulation. It’s like labeling each experiment.</li>
<li><strong>Store the results:</strong> We store the results of this simulation in our <code>results</code> list, using the parameter value as a label for easy reference.</li>
<li><strong>Combine the results:</strong> Finally, we use a special function called <code>rbindlist</code> to neatly combine all the individual data frames in our <code>results</code> list into one big data frame. This gives us a complete overview of how the neuron behaves with different parameter settings.</li>
</ol>
<section id="the-plotting-function-seeing-the-results" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="the-plotting-function-seeing-the-results">The Plotting Function: Seeing the Results</h4>
<p>Now, let’s visualize our results! We’ll create a special function called <code>plot_sensitivity</code> to do this. This function takes the combined results data frame and the name of the parameter we were analyzing as input. It then generates a plot that shows how the membrane potential changes over time <strong>for each of the parameter values we tested</strong>. It’s like creating a visual story of how the neuron behaves under different conditions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">plot_sensitivity <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(results, param_name) {</span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(results, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Time, Voltage, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(ParameterValue))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (ms)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Membrane Potential (mV)"</span>, </span>
<span id="cb12-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_parse</span>()(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sensitivity~Analysis~of~"</span>, param_name))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_ordinal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_parse</span>()(param_name))</span>
<span id="cb12-8">}</span></code></pre></div>
</div>
<p>This function creates a line plot using <code>ggplot2</code>, where the x-axis represents time, the y-axis represents the membrane potential, and <strong>different colors represent different values of the varied parameter</strong>. The <code>factor()</code> function is used to treat the <code>ParameterValue</code> as a categorical variable, ensuring that each value gets a distinct color in the plot.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/math-confused-girl.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Your face after I told you that we’re going to see the basics and it turned out not so basic after all. Photo from <a href="https://cl.pinterest.com/pin/800022321283732215/">Pinteres</a></span></div></div>
</section>
<section id="setting-the-stage-for-simulations" class="level4">
<h4 class="anchored" data-anchor-id="setting-the-stage-for-simulations">Setting the Stage for Simulations</h4>
<p>Before we dive into the nitty-gritty of sensitivity analysis, we need to set the stage for our simulations.</p>
<ul>
<li><strong>Time:</strong> We define the simulation time, which tells us how long to run the experiment. We’ll run the simulation from 0 to 8 milliseconds (ms).</li>
<li><strong>Time Step:</strong> We need to decide how often we “take a picture” of the membrane potential. This is determined by the <code>dt</code> parameter in our <code>params</code> list.</li>
<li><strong>Stimulus:</strong> We’ll create a brief stimulus current, like a little jolt of electricity, that’s applied between 0.5 and 1.0 milliseconds.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulation time and stimulus</span></span>
<span id="cb13-2">time <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> params<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>dt)</span>
<span id="cb13-3">stimulus_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(time))</span>
<span id="cb13-4">stimulus_current[time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span></code></pre></div>
</div>
</section>
<section id="assessing-the-effect-of-sodium-conductance-g_na-turning-up-the-heat" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="assessing-the-effect-of-sodium-conductance-g_na-turning-up-the-heat">Assessing the Effect of Sodium Conductance (<img src="https://latex.codecogs.com/png.latex?g_%7BNa%7D">): Turning Up the Heat</h4>
<p>Now, let’s see what happens when we tweak the sodium conductance (<img src="https://latex.codecogs.com/png.latex?g_%7BNa%7D">). This is like adjusting the heat on a stove.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run sensitivity analysis for g_Na</span></span>
<span id="cb14-2">gna_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb14-3"></span>
<span id="cb14-4">gna_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sensitivity_analysis</span>(params, time, stimulus_current, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g_Na"</span>, gna_values)</span>
<span id="cb14-5"></span>
<span id="cb14-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_sensitivity</span>(gna_results, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g[Na]"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-15-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Effect of Sodium Conductance in Potential Dynamics. Here we can see the overall effect of changing the sodium conductance on membrane potential dynamics."><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/index_files/figure-html/unnamed-chunk-15-1.svg" class="img-fluid figure-img" alt="Effect of Sodium Conductance in Potential Dynamics. Here we can see the overall effect of changing the sodium conductance on membrane potential dynamics."></a></p>
<figcaption class="margin-caption"><strong>Effect of Sodium Conductance in Potential Dynamics</strong>. Here we can see the overall effect of changing the sodium conductance on membrane potential dynamics.</figcaption>
</figure>
</div>
</div>
</div>
<p>By running our <code>sensitivity_analysis</code> function and then plotting the results, we can clearly see how <strong>changing <img src="https://latex.codecogs.com/png.latex?g_%7BNa%7D"> affects the action potential</strong>. It’s like watching how turning up the heat affects how quickly water boils. As expected, increasing <img src="https://latex.codecogs.com/png.latex?g_%7BNa%7D"> makes the depolarization much faster and more dramatic.</p>
</section>
<section id="assessing-the-effect-of-potassium-conductance-g_k-controlling-the-cool-down" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="assessing-the-effect-of-potassium-conductance-g_k-controlling-the-cool-down">Assessing the Effect of Potassium Conductance (<img src="https://latex.codecogs.com/png.latex?g_%7BK%7D">): Controlling the Cool-Down</h4>
<p>Next, let’s see how changing the potassium conductance (<img src="https://latex.codecogs.com/png.latex?g_%7BK%7D">) affects things. This is like adjusting the thermostat, <strong>it controls the cool-down period</strong>.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run sensitivity analysis for g_K</span></span>
<span id="cb15-2">gk_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb15-3"></span>
<span id="cb15-4">gk_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sensitivity_analysis</span>(params, time, stimulus_current, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g_K"</span>, gk_values)</span>
<span id="cb15-5"></span>
<span id="cb15-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_sensitivity</span>(gk_results, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g[K]"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-16-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Effect of Potassium Conductance in Potential Dynamics. Here we can see the overall effect of changing the potassium conductance on membrane potential dynamics."><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/index_files/figure-html/unnamed-chunk-16-1.svg" class="img-fluid figure-img" alt="Effect of Potassium Conductance in Potential Dynamics. Here we can see the overall effect of changing the potassium conductance on membrane potential dynamics."></a></p>
<figcaption class="margin-caption"><strong>Effect of Potassium Conductance in Potential Dynamics</strong>. Here we can see the overall effect of changing the potassium conductance on membrane potential dynamics.</figcaption>
</figure>
</div>
</div>
</div>
<p>Again, using our handy functions, we can easily see how <img src="https://latex.codecogs.com/png.latex?g_%7BK%7D"> impacts the action potential. Increasing <img src="https://latex.codecogs.com/png.latex?g_%7BK%7D"> <strong>makes the repolarization phase much faster and more pronounced</strong>. It’s like adding more ice to a hot drink, it cools down much quicker. This structured approach allows us to efficiently explore how <strong>different parameters affect our model</strong> and gain a deeper understanding of its dynamics.</p>
</section>
</section>
<section id="so-you-think-you-know-how-a-neuron-fires-think-again" class="level1 page-columns page-full">
<h1>So, You Think You Know How a Neuron Fires? Think Again!</h1>
<p>Okay, let’s be honest, this <em>“action potential”</em> business is a bit overhyped. It’s basically just a fancy term for a <strong>sudden influx of sodium ions followed by a swift efflux of potassium</strong>. Really, who needs all those fancy textbooks and intimidating equations? (Kidding! We need them).</p>
<p>Our little model here? Yeah, it’s basically a <em>“neuron for beginners”</em>. <strong>We stripped it down to the essentials</strong>, ignoring the nitty-gritty details like how ion channels actually open and close and the subtle ways different potassium channels interact. <strong>Who needs that level of detail, right?</strong><sup>1</sup></p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;In fact we do! But that much level of detail is reserved for another blog post</p></div></div><p>Now, let’s get real for a second. Real neurons? They’re not this simple. Oh no. <strong>They have a whole zoo of ion channels</strong>, each with its own quirks and preferences for voltage <span class="citation" data-cites="drukarch2023thinking">(Drukarch and Wilhelmus 2023)</span>. Sodium channels? Potassium channels? Please, <strong>it’s more like a neurochemical orchestra!</strong> And don’t even get me started on the calcium-dependent potassium channels…</p>
<p>But hey, our little <em>“dumbed-down”</em> neuron serves a purpose. It’s like, the <em>“Cliff’s Notes”</em> of neurophysiology. You get the main idea, <strong>you understand the basic principles of membrane excitability</strong>. And that, my friends, is enough to impress at your next cocktail party.</p>
<p>Now, <strong>let’s talk about drugs</strong>. Oh boy, drugs. You know, those pesky little molecules that interfere with neuronal signaling? Well, guess what? <strong>They love to target these ion channels</strong>. Lidocaine? Blocks sodium channels, basically shutting down the neuron. Potassium channel blockers? Well, let’s just say they can make neurons go wild. <strong>Our model? It can predict these effects</strong>, to a certain extent. Of course, it’s not exactly a perfect predictor of pharmacological outcomes. But hey, it’s a start.</p>
<p>And finally, <strong>let’s talk about the big picture</strong>. Communication. You know, how your brain actually <em>does</em> stuff? Well, <strong>it all starts with these action potentials</strong>. They’re like, the brain’s version of Morse code. But instead of dots and dashes, it’s a symphony of electrical impulses, traveling along axons and <strong>triggering the release of neurotransmitters</strong>. And our little model? It gives us a glimpse into this mysterious world of neuronal chatter.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/multipolar-neurons.jpg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Motor Neurons (Multipolar) with many Processes (mostly Dendrites). Photo from <a href="https://www.neurologyadvisor.com/news/spinal-cord-gray-matter-atrophy-post-polio-syndrome-functional-decline/">Neurology Advisor</a></span></div></div>
</section>
<section id="hasta-la-vista-baby" class="level1 page-columns page-full">
<h1>Hasta la Vista Baby</h1>
<p>So, there you have it. Our <em>“simplified”</em> action potential model. Not exactly a perfect mirror of reality, but hey, it’s a good start. Now go forth and <strong>explore the wonders of neuroscience!</strong> Dive deeper into the hows and whys of <strong>ion channel behavior</strong>, uncover the secrets of synaptic transmission, and maybe even contribute to the next big breakthrough in neuroscience! <strong>The human brain is an incredibly complex machine</strong>, and understanding its workings is a journey of endless fascination.</p>
<div class="page-columns page-full"><p>Just remember, this is <strong>just the tip of the iceberg</strong>. Real neurons are far more sophisticated than our little model. They’re a tornado of activity, a symphony of ions, and a constant dance of electrical signals. But hey, at least <strong>now you have a basic understanding of how these amazing cells work</strong>. </p><div class="no-row-height column-margin column-container"><span class="margin-aside"><strong>Disclaimer</strong>: This model is for entertainment purposes only. Please do not attempt to perform any neurological procedures based on the information presented here (or maybe try it, but don’t mention my name).</span></div></div>
<p>Now go forth and <strong>amaze your friends with your newfound knowledge of neurophysiology</strong>. Just don’t get carried away and start diagnosing everyone with <em>“abnormal neuronal activity”</em>. And most importantly, remember to have fun! Neuroscience is a fascinating field, and there’s always something new to learn.</p>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-drukarch2023thinking" class="csl-entry">
Drukarch, Benjamin, and Micha MM Wilhelmus. 2023. <span>“Thinking about the Action Potential: The Nerve Signal as a Window to the Physical Principles Guiding Neuronal Excitability.”</span> <em>Frontiers in Cellular Neuroscience</em> 17: 1232020.
</div>
<div id="ref-hodgkin1939action" class="csl-entry">
Hodgkin, Alan L, and Andrew F Huxley. 1939. <span>“Action Potentials Recorded from Inside a Nerve Fibre.”</span> <em>Nature</em> 144 (3651): 710–11.
</div>
<div id="ref-rubin2021basics" class="csl-entry">
Rubin, Devon I. 2021. <span>“Basics of Neurophysiology.”</span> <em>Clinical Neurophysiology</em>, 9.
</div>
<div id="ref-yao2023dynamic" class="csl-entry">
Yao, Wei, Yingchen Li, Zhihao Ou, Mingzhu Sun, Qiongxu Ma, and Guanghong Ding. 2023. <span>“Dynamic Analysis of Neural Signal Based on Hodgkin–Huxley Model.”</span> <em>Mathematical Methods in the Applied Sciences</em> 46 (4): 4676–87.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{castillo-aguilar2025,
  author = {Castillo-Aguilar, Matías},
  title = {Decoding the {Neuron’s} {Spark:} {Building} {Intuition} for
    {Action} {Potential} {Dynamics}},
  date = {2025-01-06},
  url = {https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/},
  doi = {10.59350/e3kv7-20r70},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-castillo-aguilar2025" class="csl-entry quarto-appendix-citeas">
Castillo-Aguilar, Matías. 2025. <span>“Decoding the Neuron’s Spark:
Building Intuition for Action Potential Dynamics.”</span> January 6,
2025. <a href="https://doi.org/10.59350/e3kv7-20r70">https://doi.org/10.59350/e3kv7-20r70</a>.
</div></div></section></div> ]]></description>
  <category>non-linear</category>
  <category>neuroscience</category>
  <category>educational</category>
  <guid>https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/</guid>
  <pubDate>Mon, 06 Jan 2025 03:00:00 GMT</pubDate>
  <media:content url="https://bayesically-speaking.com/posts/2025-01-06 simulating-action-potential/body_1.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Modeling Lymphocyte Dynamics: Agent-Based Simulations and Non-Linear Equations</title>
  <dc:creator>Matías Castillo-Aguilar</dc:creator>
  <link>https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1 page-columns page-full">
<h1>Introduction</h1>
<section id="the-immunological-challenge" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="the-immunological-challenge">The Immunological Challenge</h4>
<p>Let’s face it, the <strong>immune system</strong> is a bit of a drama queen (or king, depending on the situation). It’s constantly patrolling our bodies, <strong>acting as a vigilant security force</strong>, looking for trouble (like invading pathogens, damaged cells, or rogue cancer cells). When it finds something suspicious, it <strong>initiates a complex and tightly regulated immune response</strong> (a carefully orchestrated), multi-cellular reaction of activation, proliferation, differentiation, and effector functions (like killing infected cells). It’s not just a party; <strong>it’s a meticulously planned military operation</strong>. But like any complex system, things can go wrong.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/innate-and-adaptative.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">The principal mechanisms of innate immunity and adaptive immunity. NK, natural killer. Figure from Robbins Basic Pathology, 10th Edition</span></div></div>
<p><strong>Take cancer immunotherapy</strong>, for example. These therapies, like immune checkpoint blockade, aim to harness and <strong>enhance the immune system’s natural ability to fight cancer</strong>. The basic idea behind checkpoint blockade is to <strong>block inhibitory signals</strong> (immune checkpoints) that tumors exploit <strong>to evade immune destruction</strong> <span class="citation" data-cites="liu2022clinical">(Liu et al. 2022)</span>. These checkpoints are crucial for preventing autoimmunity (the immune system attacking the body’s own tissues), but <strong>tumors hijack them</strong> to create an immunosuppressive microenvironment <span class="citation" data-cites="chang2015metabolic">(Chang et al. 2015)</span>. <strong>By blocking these checkpoints</strong>, the “brakes” on anti-tumor immunity are released, <strong>allowing T cells</strong> (and other immune cells) <strong>to attack the cancer</strong> cells more effectively. Sounds simple in theory, right?</p>
<div class="page-columns page-full"><p>Well, <strong>not quite</strong>. Predicting who will respond to these therapies and who won’t <strong>is a significant challenge</strong> in the field of immuno-oncology. Why? Because the interactions between <strong>tumor cells and immune cells</strong> (especially lymphocytes, which include T cells and other important players like NK cells) are incredibly <strong>complex</strong> and <strong>context-dependent</strong>. It’s not just about counting the number of T cells present in a tumor (although that’s important); it’s about <strong>understanding their dynamic behavior</strong>: how they traffic to the tumor, how they get <strong>activated</strong> within the tumor microenvironment, <strong>how they interact</strong> with tumor cells (e.g., recognizing tumor-associated antigens), how they interact with other immune cells (both <strong>promoting and suppressing the immune response</strong>), and how they eventually either effectively <strong>eliminate the tumor or become exhausted</strong> (losing their effector functions). It’s a dynamic and multifaceted system, not a static snapshot <span class="citation" data-cites="taefehshokr2022cancer">(Taefehshokr et al. 2022)</span>. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Factors like tumor heterogeneity, the presence of immunosuppressive cells (like myeloid-derived suppressor cells or regulatory T cells), and the tumor’s mutational burden also play critical roles in determining the outcome of immunotherapy.</span></div></div>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/naive-to-t-cell-by-apc.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Differentiation of naive T cells in response to stimuli present at the time of antigen recognition. APC, antigen-presenting cells; T<sub>H</sub>, Helper T cells. Figure from Robbins Basic Pathology, 10th Edition</span></div></div>
</section>
<section id="because-straight-lines-are-for-geometry-not-biology" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="because-straight-lines-are-for-geometry-not-biology">Because Straight Lines are for Geometry, Not Biology</h4>
<p>Traditional methods of studying the immune system, like <strong>taking a single blood sample</strong> and counting cell types (a bit like taking a census of a bustling city at one specific time), are <strong>useful for getting a basic snapshot</strong>. They tell us <em>who</em> is present, but not <em>what</em> they are doing. <strong>Similar to taking a single still photograph of a bustling city</strong>, you might see how many buildings and people are there, but <strong>you’d miss all the action</strong>, the traffic jams, the hustle and bustle of people going about their day, the dynamic flow of life. You’d miss the whole story.</p>
<div class="page-columns page-full"><p><strong>Biological systems</strong>, especially complex ones like the immune system, <strong>rarely behave in a linear</strong>, predictable fashion. <strong>A small change</strong> in one factor (say, a slight increase in the concentration of a signaling molecule) can have a huge, disproportionate, and often <strong>unexpected effect</strong> on the overall response. <img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/cdc-unsplash.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://unsplash.com/es/@cdc?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">CDC</a> in <a href="https://unsplash.com/es/fotos/juguete-de-plastico-negro-y-amarillo-OZcQIhidMTw?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></span></div></div>
<div class="page-columns page-full"><p>The first reason is <u><strong>feedback loops</strong></u>. These are like the thermostats of biological systems. A <strong>positive feedback loop amplifies a signal</strong> (like a snowball rolling downhill, getting bigger and bigger), while <strong>a negative feedback loop dampens a signal</strong> (like a thermostat turning off the heating when the desired temperature is reached). These feedback loops create complex, dynamic <strong>behaviors that can’t be captured by simple straight lines</strong>. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">It’s like trying to describe the stock market with a straight line, you’d miss all the booms and busts.</span></div></div>
<div class="page-columns page-full"><p>Additionally, there’s something called <u><strong>saturation effect</strong></u>. This occur <strong>when a system reaches its maximum capacity</strong>. Imagine a sponge soaking up water, it can only hold so much. Similarly, a biological response might increase with a stimulus <strong>up to a certain point</strong>, after which further increases in the stimulus have little or no additional effect. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">It’s like turning up the volume on your stereo, past a certain point, it just gets louder, not clearer.</span></div></div>
<div class="page-columns page-full"><p>Similarly, biological systems tends to function based on <u><strong>threshold responses</strong></u>. These are like <strong>all-or-nothing switches</strong>. A response only occurs <strong>after a certain level</strong> of stimulus is reached. In the immune system, this might mean that a certain concentration of antigen is required <strong>to trigger T cell activation</strong>. It’s not a gradual increase in activation; it’s a sudden jump <span class="citation" data-cites="joglekar2021t">(Joglekar and Li 2021)</span>. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Think of a light switch: you can press it lightly, and nothing happens, but once you press it hard enough, the light turns on.</span></div></div>
<p>Trying to <strong>model these non-linear phenomena</strong> with simple straight lines (like in basic linear regression) is like trying to <strong>describe a roller coaster ride with a ruler</strong>, you’d miss all the exciting ups and downs, the twists and turns. It just doesn’t work. We need <strong>models that can capture these non-linear relationships</strong>, models that can bend and curve to fit complex biological systems. That’s where the <a href="https://en.wikipedia.org/wiki/Hill_equation_(biochemistry)">Hill function</a> and logistic growth equations come into play <span class="citation" data-cites="li2023intercellular">(Li et al. 2023)</span>, they’re our tools for <strong>capturing these essential curves</strong> in our cellular stories.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/national-institute-of-allergy-and-infectious-diseases-unsplash.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from the <a href="https://unsplash.com/es/@niaid?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">National Institute of Allergy and Infectious Diseases</a> in <a href="https://unsplash.com/es/fotos/un-primer-plano-de-una-celula-animal-con-una-sustancia-purpura-IQVsSGGWOKg?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></span></div></div>
</section>
</section>
<section id="simulating-cellular-mayhem" class="level1 page-columns page-full">
<h1>Simulating Cellular Mayhem</h1>
<section id="digital-petri-dishes-and-tiny-cellular-actors" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="digital-petri-dishes-and-tiny-cellular-actors">Digital Petri Dishes and Tiny Cellular Actors</h4>
<p>This is where agent-based modeling (ABM) swoops in like a superhero. <strong>ABM lets us create a virtual world filled with individual “agents”</strong>, but in our case, these actors are lymphocytes. Each agent gets its own set of rules, like a tiny cellular script to follow, dictating how it behaves and reacts to its environment <span class="citation" data-cites="azarov2019role">(Azarov et al. 2019)</span>.</p>
<p>ABMs offer a powerful tool for <strong>studying lymphocyte dynamics</strong>, allowing us to explore how factors like clonal expansion, contraction, and differentiation are influenced by <strong>antigen exposure and immune system</strong> regulation <span class="citation" data-cites="an2021challenges">(An et al. 2021)</span>.</p>
<div class="page-columns page-full"><p>The fun part is that we can then <strong>sit back and watch the cellular drama unfold</strong>, observing how these agents interact with each other and their digital surroundings over time (just like a movie!). It’s something like building a digital petri dish, <strong>a virtual stage where we can run experiments</strong> that would be impossible (given monetary or ethical reasons), or just plain messy to perform in real life. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">imagine trying to track the movement of millions of individual cells in a living organism, not exactly a walk in the park</span></div></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advantages of Agent-Based Modeling and Inference
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The real beauty of ABM, in comparison to traditional modeling approaches, lies in its ability to:</p>
<p><u><strong>Account for heterogeneity</strong></u>. Not all lymphocytes are exact copies of each other. <strong>They come in different flavors</strong>, with different functions, activation states, and responses to stimuli. By simulating virtual cells, <strong>we can represent this cellular diversity</strong>, giving each cell its own unique personality (or at least its own set of parameters).</p>
<p><u><strong>Simulate stochasticity</strong></u>. Biology is <strong>inherently noisy</strong>. Random events, chance encounters, and <strong>unpredictable fluctuations</strong> can play a significant role in immune responses. <strong>ABM allows us to incorporate this randomness</strong>, making our simulations much more realistic.</p>
<p><u><strong>Model inter-individual interactions</strong></u>. We can define <strong>rules</strong> (as complicate as we want them to be) that determines <strong>how lymphocytes interact with each other</strong>, with other cell types (like antigen-presenting cells or tumor cells), and with signaling molecules (like cytokines, the cellular equivalent of social media posts). We can <strong>simulate complex communication networks</strong>, feedback loops, and other intricate interactions that drive immune responses.</p>
</div>
</div>
</div>
<p>And what’s absolutely essential for making these interactions realistic to the one of biological systems? You guessed it: <strong>non-linear equations</strong>. They allow us to define those <strong>complex biological processes</strong> with far <strong>greater accuracy than simple linear</strong> relationships ever could. It’s like using a finely tuned paintbrush to capture the subtle shades of a sunset, rather than just using a single, broad stroke of color.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/thisisengineering-unsplash.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from <a href="https://unsplash.com/es/@thisisengineering?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">ThisisEngineering</a> in <a href="https://unsplash.com/es/fotos/mujer-con-camisa-negra-de-manga-larga-GzDrm7SYQ0g?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></span></div></div>
</section>
<section id="r-as-a-tool-for-immunological-simulation" class="level4">
<h4 class="anchored" data-anchor-id="r-as-a-tool-for-immunological-simulation">R as a Tool for Immunological Simulation</h4>
<p>R, the beloved <strong>language of statisticians</strong>, data scientists, and now immunologists (at least for this blog post!), is the perfect <strong>tool for building these ABM simulations</strong>. It’s powerful, flexible, and comes with a treasure of packages specifically designed for <strong>statistical computing</strong>, <strong>simulation</strong>, and <strong>data visualization</strong>. Plus, it’s open-source, which means it’s free (always a welcome bonus), especially if you’re on a student budget or just like free stuff. With <strong>powerful visualization packages</strong> like <code>ggplot2</code>, we can create stunningly beautiful and informative visualizations of our simulation results, transforming <strong>raw data into compelling stories</strong> that are easy to understand. It’s like turning a jumbled mess of numbers into a captivating infographic.</p>
<p>In this post, we’ll swim in oceans of <strong>lymphocyte dynamics</strong> by building a simplified ABM simulation in R. We’ll harness the power of non-linear equations to model key processes like <strong>lymphocyte activation</strong>, <strong>proliferation</strong>, and <strong>apoptosis</strong>. We’ll start with simple, easy-to-digest examples and gradually add more complexity, showing you <strong>step-by-step how to implement these models</strong> in R and, crucially, how to interpret the results. By the end of this post, you’ll have a solid understanding of how ABM, combined with the magic of non-linear equations, <strong>can provide valuable insights</strong> into the inner workings of the immune system. Think of it as a <strong>crash course in digital immunology</strong>, minus the lab coats, the pipettes, and the actual petri dishes (but with plenty of code, insightful explanations, and, of course, some cool plots!).</p>
</section>
</section>
<section id="from-code-to-cellular-chaos" class="level1 page-columns page-full">
<h1>From Code to Cellular Chaos</h1>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/national-cancer-institute-unsplash.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from the <a href="https://unsplash.com/es/@nci?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">National Cancer Institute</a> in <a href="https://unsplash.com/es/fotos/pintura-abstracta-en-blanco-y-negro-wUg8xhJ3aBs?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></span></div></div>
<p>Now that <strong>we’ve established why we need to go beyond simple linear models</strong> to understand the immune system’s intricate dance, <strong>let’s get our hands dirty with some code</strong> and build our own lymphocyte simulation in R. Don’t worry if you’re not an immunologist; <strong>we’ll keep the biology simple</strong> and focus on the modeling aspects.</p>
<section id="setting-the-stage-for-cellular-action" class="level4">
<h4 class="anchored" data-anchor-id="setting-the-stage-for-cellular-action">Setting the Stage for Cellular Action</h4>
<p>Our model will focus on a <strong>simplified scenario involving T lymphocytes</strong> (a type of white blood cell crucial for adaptive immunity). We’ll consider two main types of T cells:</p>
<ul>
<li><strong>Naive T cells:</strong> These are the rookies of the immune system, waiting for their marching orders. They haven’t encountered their specific target (an antigen) yet.</li>
<li><strong>Activated T cells:</strong> These are the seasoned warriors, ready to fight after being activated by encountering their specific antigen.</li>
</ul>
<p>We’ll also include a representation of the antigen, which is <strong>any substance that can trigger an immune response</strong> (like a piece of a virus or a bacterial protein). We won’t explicitly model other cell types (like antigen-presenting cells) in <strong>this simplified version</strong>, but we’ll account for their role in the activation process.</p>
</section>
<section id="the-rules-of-engagement-from-intuition-to-equations" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="the-rules-of-engagement-from-intuition-to-equations">The Rules of Engagement: From Intuition to Equations</h4>
<p>Here’s where the magic of non-linearity comes in. We’ll use a few key equations to dictate the behavior of our T cell agents.</p>
<p>The <strong>activation of a naive T cell</strong> upon encountering an antigen <strong>isn’t a simple binary event</strong>; it’s not just “on” or “off,” like a light switch. Instead, <strong>it’s a graded response</strong>, much like a dimmer switch. The more antigen a T cell encounters, the higher the chance it gets activated <span class="citation" data-cites="joglekar2021t">(Joglekar and Li 2021)</span>. But <strong>this increase in activation probability isn’t perfectly linear</strong>. There’s often a threshold effect: at low antigen concentrations, not much happens, but above a certain concentration, the activation probability shoots up dramatically. This “switch-like” behavior is what equations used in biochemistry like the <a href="https://en.wikipedia.org/wiki/Hill_equation_(biochemistry)">Hill function</a> elegantly captures.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/naive-to-efector.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Checkpoints that regulate T cell response from their naive state to their final differentiated state. This shows how distinct mechanisms, including quiescence/ignorance, anergy, exhaustion/senescence, and various forms of cell death, act at T cell development and activation. Figure from <a href="https://www.nature.com/articles/s41577-020-00454-2">Nature Reviews Immunology 21, 257–267 (2021)</a></span></div></div>
</section>
<section id="activation-function-the-on-switch" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="activation-function-the-on-switch">Activation Function: The “On” Switch</h4>
<p>Let’s build up the intuition behind this function. Imagine a <strong>T cell receptor</strong> (TCR) on the surface of a T cell. For simplicity, let’s consider that the <strong>interaction of the TCR with the antigen is a complex process</strong> that can involve multiple steps and interactions <span class="citation" data-cites="dushek2011antigen">(Dushek et al. 2011)</span>. While we might imagine that <img src="https://latex.codecogs.com/png.latex?n"> antigen molecules <strong>are required to bind for full activation</strong>, the Hill equation doesn’t directly represent this exact number of binding sites. Instead, it <strong>describes the overall cooperativity</strong> of the binding process <span class="citation" data-cites="stefan2013cooperative">(Stefan and Le Novère 2013)</span>.</p>
<p>Now, let’s think about the <strong>probability of activation as a function of antigen concentration</strong>. If the antigen concentration is low, the probability of any productive interaction between the antigen and TCR is low, and therefore, the probability of activation is also low. <strong>As the antigen concentration increases, the probability of productive interactions also increases</strong>. This increase is often non-linear, with a steeper rise at certain concentrations <span class="citation" data-cites="dushek2011antigen">(Dushek et al. 2011)</span>. This non-linearity is captured by the concept of <em>cooperativity</em>: the <strong>binding of one antigen molecule can influence the likelihood of subsequent binding events</strong> or downstream signaling events, leading to a more pronounced response.</p>
<p>This intuition leads us to the Hill function:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5CPr(%5Ctext%7BActivation%7D)%20=%20%5Cfrac%7B%5Ctext%7B%5BAntigen%5D%7D%5En%7D%7BK%5En%20+%20%5Ctext%7B%5BAntigen%5D%7D%5En%7D%0A"></p>
<p>Let’s break down this equation piece by piece, connecting it to our intuitive understanding:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5CPr(%5Ctext%7BActivation%7D)"> is the <strong>probability that a naive T cell becomes activated</strong>. It ranges from 0 (no activation) to 1 (certain activation).</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7B%5BAntigen%5D%7D"> represents <strong>the concentration of the antigen</strong>. The more antigen present, the higher the chance of binding and activation.</p>
<p><img src="https://latex.codecogs.com/png.latex?n"> is the <strong>Hill coefficient</strong>. It is a phenomenological parameter that describes the <em>steepness</em> or <em>cooperativity</em> of the response. A higher <img src="https://latex.codecogs.com/png.latex?n"> indicates a steeper curve and a more switch-like response. It reflects <strong>how much the binding of one antigen influences the binding of subsequent antigens</strong> or the downstream signaling events.</p>
<p><img src="https://latex.codecogs.com/png.latex?K"> is the <strong>dissociation constant</strong>. It represents <strong>the antigen concentration at which the probability of activation is 50%</strong>. It’s a measure of the affinity between the antigen and the TCR. A smaller <img src="https://latex.codecogs.com/png.latex?K"> means a higher affinity (stronger binding), meaning that less antigen is needed to achieve 50% activation. You can think of <img src="https://latex.codecogs.com/png.latex?K"> as the <strong>“difficulty” of binding</strong>, a smaller <img src="https://latex.codecogs.com/png.latex?K"> means it’s easier to bind.</p>
<section id="how-does-this-equation-capture-the-switch-like-behavior" class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="how-does-this-equation-capture-the-switch-like-behavior">How Does this Equation Capture the Switch-Like Behavior?</h5>
<p>Okay but, how does this equation capture the switch-like behavior? Let’s see how:</p>
<ul>
<li>At <strong>very low antigen concentrations</strong> (<img src="https://latex.codecogs.com/png.latex?%5Ctext%7B%5BAntigen%5D%7D%20%3C%3C%20K">), the term <img src="https://latex.codecogs.com/png.latex?%5Ctext%7B%5BAntigen%5D%7D%5En"> is much smaller than <img src="https://latex.codecogs.com/png.latex?K%5En">, so the <strong>probability of activation is close to zero</strong>.</li>
<li>At <strong>very high antigen concentrations</strong> (<img src="https://latex.codecogs.com/png.latex?%5Ctext%7B%5BAntigen%5D%7D%20%3E%3E%20K">), the term <img src="https://latex.codecogs.com/png.latex?%5Ctext%7B%5BAntigen%5D%7D%5En"> dominates, and <strong>the probability of activation approaches 1</strong>.</li>
</ul>
<p>The transition between these two extremes is sharper when <img src="https://latex.codecogs.com/png.latex?n"> is larger. This steep transition is what we refer to as the “switch-like” behavior.</p>
<p>It’s crucial to understand that <img src="https://latex.codecogs.com/png.latex?n"> is an <em>effective</em> or <em>apparent</em> <strong>cooperativity coefficient</strong>. It describes the overall <strong>cooperativity of the binding process</strong>, which can be influenced by multiple factors beyond just the number of binding sites. It can reflect complex downstream signaling events or allosteric effects.</p>
<p>Here’s the R function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">activation_probability <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(antigen, K, n) {</span>
<span id="cb1-2">  (antigen<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (K<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> antigen<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>n)</span>
<span id="cb1-3">}</span></code></pre></div>
</div>
<p>This R function is a <strong>direct translation of the Hill equation</strong>. It takes the antigen concentration (<code>antigen</code>), the dissociation constant (<code>K</code>), and the Hill coefficient (<code>n</code>) as inputs and <strong>returns the calculated activation probability</strong>. It’s our little digital “activation calculator.”</p>
<p>And a quick visualization to show the effect of the Hill coefficient:</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">antigen_conc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>)</span>
<span id="cb2-2"></span>
<span id="cb2-3">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.2"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.5"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb2-4">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.0"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.0"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, </span>
<span id="cb2-5">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4.0"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.0</span>), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb2-6">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb2-7">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Pr =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">activation_probability</span>(antigen_conc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">K =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> x),</span>
<span id="cb2-8">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Antigen =</span> antigen_conc</span>
<span id="cb2-9">           )</span>
<span id="cb2-10">         }) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbindlist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">idcol =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hill coefficient"</span>)</span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Antigen, Pr)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Hill coefficient</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Antigen Concentration"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probability of Activation"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hill Coefficient"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effect of Hill Coefficient on Activation Probability"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_ordinal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Hill coefficient (n) on T cell activation. When n = 1, the response is nearly linear. However, as n increases (n = 2, n = 4), the activation curve becomes increasingly steep, demonstrating enhanced cooperativity and a more pronounced threshold effect. This highlights how small changes in antigen concentration can trigger large changes in activation probability when cooperativity is high. It’s like comparing a gentle slope to a cliff, a small step can make a big difference when you’re near the edge of the cliff (high n)."><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img" alt="Hill coefficient (n) on T cell activation. When n = 1, the response is nearly linear. However, as n increases (n = 2, n = 4), the activation curve becomes increasingly steep, demonstrating enhanced cooperativity and a more pronounced threshold effect. This highlights how small changes in antigen concentration can trigger large changes in activation probability when cooperativity is high. It’s like comparing a gentle slope to a cliff, a small step can make a big difference when you’re near the edge of the cliff (high n)."></a></p>
<figcaption class="margin-caption"><strong>Hill coefficient (<code>n</code>) on T cell activation</strong>. When <code>n = 1</code>, the response is nearly linear. However, as n increases (<code>n = 2</code>, <code>n = 4</code>), the activation curve becomes increasingly steep, demonstrating enhanced cooperativity and a more pronounced threshold effect. This highlights how small changes in antigen concentration can trigger large changes in activation probability when cooperativity is high. It’s like comparing a gentle slope to a cliff, a small step can make a big difference when you’re near the edge of the cliff (high <code>n</code>).</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="proliferation-the-population-explosion" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="proliferation-the-population-explosion">Proliferation: The Population Explosion</h4>
<p>Once a T cell is activated, <strong>it’s time for action</strong> (and lots of it). This action comes <strong>in the form of proliferation</strong>, where a single activated T cell divides and creates many identical copies of itself, building an army to fight the infection <span class="citation" data-cites="kumar2012robbins">(Kumar, Abbas, and Aster 2012)</span>. <strong>If there were no limits, this growth would be exponential</strong> (like compound interest in a bank account), but with cells instead of money. Imagine starting with one cell, and it doubles every hour. After just a day, you’d have millions!</p>
<p>But, of course, <strong>in the real world</strong> (and even in our digital one), such <strong>unrestrained growth is impossible</strong>. There are limited resources: space, nutrients, signaling molecules, all the things a T cell needs to survive and multiply. Eventually, the <strong>growth must slow down and plateau</strong>. This is where the logistic growth equation comes in, providing a much more realistic model of population dynamics.</p>
<p>Let’s start with the continuous form of the logistic growth equation:</p>
<div class="page-columns page-full"><p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7BdN%7D%7Bdt%7D%20=%20rN%20%5Cleft(1-%20%5Cfrac%7BN%7D%7BK%7D%5Cright)%0A"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">This equation has previously been used to model T cell dynamics in both mouse and human models <span class="citation" data-cites="morris2019tissue">(Morris, Farber, and Yates 2019)</span>. Additionally, it’s commonly used to model cell growth in general in discrete-time approximations <span class="citation" data-cites="jin2018extended">(Jin, McCue, and Simpson 2018)</span>.</span></div></div>
<p>Let’s break down this equation and connect it to our intuitive understanding of population growth:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20N%7D%7B%5Cpartial%20t%7D">: This term represents the <strong>rate of change in the number of T cells</strong> (<img src="https://latex.codecogs.com/png.latex?N">) over time (<img src="https://latex.codecogs.com/png.latex?t">). It’s how quickly the population is growing or shrinking. Think of it as the “speedometer” of our population.</li>
<li><img src="https://latex.codecogs.com/png.latex?r">: This is the <strong>intrinsic growth rate</strong>, sometimes called the per capita growth rate. It represents how quickly the population <em>would</em> grow if there were no limitations. It’s the “ideal” growth rate, like the speed limit on a highway.</li>
<li><img src="https://latex.codecogs.com/png.latex?N">: This represents the <strong>current number of T cells</strong>. It’s the current “position” of our population.</li>
<li><img src="https://latex.codecogs.com/png.latex?K">: This is the <strong>carrying capacity</strong>. It represents the maximum number of T cells that the environment can sustain. It’s the “maximum occupancy” of our battlefield, there’s only so much room for T cells to operate.</li>
</ul>
<p>Now, let’s see how this equation captures the idea of limited growth.</p>
<p><u><strong>At low population densities (N &lt;&lt; K)</strong></u>, when the number of T cells (<img src="https://latex.codecogs.com/png.latex?N">) is much smaller than the carrying capacity (<img src="https://latex.codecogs.com/png.latex?K">), the term <img src="https://latex.codecogs.com/png.latex?(1%20-%20%5Cfrac%7BN%7D%7BK%7D)"> is close to 1. The equation then simplifies to <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20N%7D%7B%5Cpartial%20t%7D%20=%20rN">, <strong>which is the equation for exponential growth</strong>. This makes sense: when there are plenty of resources and space, the population grows rapidly, like those initial rabbits in a wide open field.</p>
<p><u><strong>At high population densities (N ≈ K)</strong></u>, as the number of T cells (<img src="https://latex.codecogs.com/png.latex?N">) approaches the carrying capacity (<img src="https://latex.codecogs.com/png.latex?K">), the term <img src="https://latex.codecogs.com/png.latex?(1%20-%20%5Cfrac%7BN%7D%7BK%7D)"> approaches 0. This causes the rate of change <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20N%7D%7B%5Cpartial%20t%7D"> to also approach 0, meaning the <strong>population growth slows down and eventually stops</strong>. This also makes sense, given that as the battlefield becomes crowded, resources become scarce, and the T cell population can’t grow much more.</p>
<p>Since <strong>our simulation is discrete-time</strong> (we update the population at specific intervals, not continuously), we use a discrete-time approximation of the logistic growth equation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AN(t+1)%20=%20N(t)%20+%20r%20*%20N(t)%20*%20%5Cleft(1%20-%20%5Cfrac%7BN(t)%7D%7BK%7D%20%5Cright)%0A"></p>
<p>This equation tells us <strong>how to calculate the number of T cells at the <em>next</em> time step</strong> (<img src="https://latex.codecogs.com/png.latex?N(t+1)">) based on the current number of T cells (<img src="https://latex.codecogs.com/png.latex?N(t)">), the growth rate (<img src="https://latex.codecogs.com/png.latex?r">), and the carrying capacity (<img src="https://latex.codecogs.com/png.latex?K">). It’s <strong>like taking snapshots of the population at regular intervals</strong> and updating the numbers based on the growth equation.</p>
<p>Here’s the R function that implements this discrete-time approximation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">proliferation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(N, r, K) {</span>
<span id="cb3-2">  N <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> N <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> N <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> K)</span>
<span id="cb3-3">}</span></code></pre></div>
</div>
<p>This R function takes <code>N</code>, <code>r</code>, and <code>K</code> as inputs and <strong>returns the updated number of T cells</strong>. It’s our digital “population updater,” simulating the growth and eventual stabilization of the T cell army.</p>
<p>And here’s a visualization of the proliferation behavior of our function implementation:</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Function to simulate cell proliferation</span></span>
<span id="cb4-2">proliferating_cells <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(n_steps, n_cells, r, k) {</span>
<span id="cb4-3">  cells <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n_steps)</span>
<span id="cb4-4">  cells[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n_cells</span>
<span id="cb4-5">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (t <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n_steps) {</span>
<span id="cb4-6">    cells[t] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">proliferation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">N =</span> cells[t<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> r, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">K =</span> k)</span>
<span id="cb4-7">  }</span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(n_steps), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Cells =</span> cells)</span>
<span id="cb4-9">}</span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Testing different Rate values</span></span>
<span id="cb4-12">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb4-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">proliferating_cells</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb4-14">}) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbindlist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">idcol =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rate"</span>)</span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Pretty labels for plotting</span></span>
<span id="cb4-17">df[, Rate <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ordered</span>(Rate, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>))]</span>
<span id="cb4-18"></span>
<span id="cb4-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## ggplot2 plot</span></span>
<span id="cb4-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Time, Cells, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Rate)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>, </span>
<span id="cb4-22">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Steps"</span>,</span>
<span id="cb4-25">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Cells"</span>, </span>
<span id="cb4-26">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simulation of Cell Proliferation over Time"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-5-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Dynamics of T cell proliferation using the logistic growth model. Simulations with varying growth rates (r) show that faster proliferation leads to a more rapid initial increase in cell numbers. However, the carrying capacity (K = 200) acts as a limiting factor, causing all populations to eventually reach a plateau, highlighting the constraint of resources on cell growth. It’s like a race between different rabbit populations, the faster breeders get to the maximum population size quicker, but they all eventually hit the limit of their field."><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/index_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img" alt="Dynamics of T cell proliferation using the logistic growth model. Simulations with varying growth rates (r) show that faster proliferation leads to a more rapid initial increase in cell numbers. However, the carrying capacity (K = 200) acts as a limiting factor, causing all populations to eventually reach a plateau, highlighting the constraint of resources on cell growth. It’s like a race between different rabbit populations, the faster breeders get to the maximum population size quicker, but they all eventually hit the limit of their field."></a></p>
<figcaption class="margin-caption"><strong>Dynamics of T cell proliferation using the logistic growth model</strong>. Simulations with varying growth rates (r) show that faster proliferation leads to a more rapid initial increase in cell numbers. However, the carrying capacity (K = 200) acts as a limiting factor, causing all populations to eventually reach a plateau, highlighting the constraint of resources on cell growth. It’s like a race between different rabbit populations, the faster breeders get to the maximum population size quicker, but they all eventually hit the limit of their field.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="apoptosis-constant-probability-the-programmed-exit" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="apoptosis-constant-probability-the-programmed-exit">Apoptosis (Constant Probability): The Programmed Exit</h4>
<p>Even the most valiant <strong>soldiers can’t fight forever</strong>. T cells, <strong>like all living cells, have a finite lifespan</strong>. They eventually undergo apoptosis, a process of <strong>programmed cell death</strong>. It’s like a built-in self-destruct mechanism that ensures cells don’t become a burden or pose a risk to the organism. In our model, <strong>we’ll represent apoptosis with a constant probability</strong>. This means that at each time step, every activated T cell has the same chance of undergoing apoptosis, regardless of how long it’s been activated or what it’s been doing.</p>
<p>Let’s represent this with a simple equation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5CPr(%5Ctext%7Bapoptosis%7D)%20=%20p_%7B%5Ctext%7Bapoptosis%7D%7D%0A"></p>
<p>This equation is pretty straightforward:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5CPr(%5Ctext%7Bapoptosis%7D)">: This represents the <strong>probability that a single activated T cell will undergo apoptosis during a given time step</strong>. It’s a number between 0 (no chance of apoptosis) and 1 (certain apoptosis).</li>
<li><img src="https://latex.codecogs.com/png.latex?p_%7B%5Ctext%7Bapoptosis%7D%7D">: This is the <strong>constant probability of apoptosis</strong>. It’s a parameter of our model that we can set to represent different rates of cell death.</li>
</ul>
<p>This constant probability <strong>model assumes that apoptosis is a random event that occurs independently for each cell</strong> (which is a simplication of real-life biological systems). It’s like each cell flipping a weighted coin at every time step. If the coin lands on “heads” (with a probability of <img src="https://latex.codecogs.com/png.latex?p_%7B%5Ctext%7Bapoptosis%7D%7D">), the cell undergoes apoptosis.</p>
<p>Now, let’s translate this into R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">apoptosis <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(N, p_apoptosis) {</span>
<span id="cb5-2">  n_apoptosis <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbinom</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, N, p_apoptosis) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of cells undergoing apoptosis</span></span>
<span id="cb5-3">  N <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> n_apoptosis</span>
<span id="cb5-4">}</span></code></pre></div>
</div>
<p>This function <strong>simulates apoptosis</strong>. It takes two arguments: <code>N</code> (the current number of T cells) and <code>p_apoptosis</code> (the probability of apoptosis). It uses <code>rbinom(1, N, p_apoptosis)</code> to generate a random number of cells that undergo apoptosis. <code>rbinom()</code> simulates a binomial distribution, which is perfect for modeling the number of “successes” (apoptosis events) in a given number of “trials” (cells). <strong>It’s like rolling a bunch of dice, where each die has a probability <code>p_apoptosis</code> of landing on “apoptosis”</strong>. The function then returns the remaining number of cells after apoptosis.</p>
<p>And here’s a visualization simulating the effect of different <code>p_apoptosis</code> values on the total number of cells over time:</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Function to simulate cell dead</span></span>
<span id="cb6-2">apoptotic_cells <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(n_steps, n_cells, p) {</span>
<span id="cb6-3">  cells <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n_steps)</span>
<span id="cb6-4">  cells[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n_cells</span>
<span id="cb6-5">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (t <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n_steps) {</span>
<span id="cb6-6">    cells[t] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apoptosis</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">N =</span> cells[t<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p_apoptosis =</span> p)</span>
<span id="cb6-7">  }</span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(n_steps), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Cells =</span> cells)</span>
<span id="cb6-9">}</span>
<span id="cb6-10"></span>
<span id="cb6-11"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Testing different Rate values</span></span>
<span id="cb6-12">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb6-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apoptotic_cells</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, x)</span>
<span id="cb6-14">}) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbindlist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">idcol =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probability"</span>)</span>
<span id="cb6-15"></span>
<span id="cb6-16"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Pretty labels for plotting</span></span>
<span id="cb6-17">df[, Probability <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ordered</span>(Probability, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>))]</span>
<span id="cb6-18"></span>
<span id="cb6-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## ggplot2 plot</span></span>
<span id="cb6-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Time, Cells, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Probability)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>, </span>
<span id="cb6-22">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Steps"</span>,</span>
<span id="cb6-25">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Cells"</span>, </span>
<span id="cb6-26">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simulation of Cell Apoptosis over Time"</span>,</span>
<span id="cb6-27">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(P[Apoptosis]))</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-7-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Effect of apoptosis probability on cell population size over time. Simulations show that increasing the probability of apoptosis (p_{    ext{apoptosis}}) results in a more rapid decrease in the number of cells, illustrating the direct relationship between apoptosis rate and population decline. It’s like watching a sandcastle being washed away by the tide, the stronger the tide (higher p_apoptosis), the faster the sandcastle disappears."><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/index_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img" alt="Effect of apoptosis probability on cell population size over time. Simulations show that increasing the probability of apoptosis (p_{    ext{apoptosis}}) results in a more rapid decrease in the number of cells, illustrating the direct relationship between apoptosis rate and population decline. It’s like watching a sandcastle being washed away by the tide, the stronger the tide (higher p_apoptosis), the faster the sandcastle disappears."></a></p>
<figcaption class="margin-caption"><strong>Effect of apoptosis probability on cell population size over time</strong>. Simulations show that increasing the probability of apoptosis (<img src="https://latex.codecogs.com/png.latex?p_%7B%20%20%20%20ext%7Bapoptosis%7D%7D">) results in a more rapid decrease in the number of cells, illustrating the direct relationship between apoptosis rate and population decline. It’s like watching a sandcastle being washed away by the tide, the stronger the tide (higher <code>p_apoptosis</code>), the faster the sandcastle disappears.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="setting-up-the-simulation" class="level1 page-columns page-full">
<h1>Setting Up the Simulation</h1>
<p>Before we launch our digital immune response, <strong>we need to set the stage</strong>. This means <strong>defining the initial conditions and parameters for our simulation</strong>. Think of it as setting up a virtual battlefield where our T cells will fight their digital battles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## T Cell population</span></span>
<span id="cb7-2">n_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of time steps</span></span>
<span id="cb7-3">n_naive <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial number of naive T cells</span></span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## T Cell activation function</span></span>
<span id="cb7-6">antigen_level <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Antigen concentration</span></span>
<span id="cb7-7">K_activation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dissociation constant for activation</span></span>
<span id="cb7-8">n_hill <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hill coefficient for activation</span></span></code></pre></div>
</div>
<p>Here’s what we’re setting up:</p>
<ul>
<li><code>n_steps</code>: This is the <strong>number of time steps our simulation will run for</strong>. Think of it as the duration of the battle. We’ve chosen 100 time steps, but you can adjust this to simulate longer or shorter periods.</li>
<li><code>n_naive</code>: This is the <strong>initial number of naive T cells we start with</strong>. These are our fresh recruits, eager to join the fight. We’re starting with 100 naive T cells.</li>
<li><code>antigen_level</code>: This is the <strong>concentration of the antigen</strong>, the enemy our T cells are fighting against. It’s like the strength of the enemy army. We’ve set it to 0.2, but you can change this to simulate different infection scenarios.</li>
<li><code>K_activation</code>: This is the <strong>dissociation constant for activation</strong>, a parameter of the Hill function. Remember, this determines how strongly the antigen binds to the T cell receptor.</li>
<li><code>n_hill</code>: This is the <strong>Hill coefficient</strong>, which controls the steepness of the activation curve. A higher n_hill means a more switch-like response.</li>
</ul>
<p>These parameters are like the initial settings of our simulation, <strong>determining the starting conditions</strong> of our virtual immune response.</p>
<section id="simulating-activation-and-early-response-lighting-the-fire" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="simulating-activation-and-early-response-lighting-the-fire">Simulating Activation and Early Response: Lighting the Fire</h4>
<p>Now that we have our equations and R functions ready, <strong>let’s simulate the initial activation of naive T cells in response to antigen</strong>. This section will focus on the early stages of the immune response, where naive T cells are first encountering the antigen and transitioning into their activated state. <strong>It’s like the first spark that ignites the immune fire</strong>, turning our rookie T cells into seasoned warriors.</p>
<p>To simulate the activation and early response of T cells, we will implement the following function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Simulation function</span></span>
<span id="cb8-2">sim_t_activation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(n_steps, n_naive, antigen_level, K_activation, n_hill) {</span>
<span id="cb8-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize data structures</span></span>
<span id="cb8-4">  naive_t_cells <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n_steps)</span>
<span id="cb8-5">  activated_t_cells <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n_steps)</span>
<span id="cb8-6">  </span>
<span id="cb8-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial number of naive T cells</span></span>
<span id="cb8-8">  naive_t_cells[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n_naive</span>
<span id="cb8-9">  </span>
<span id="cb8-10">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Probability of activation</span></span>
<span id="cb8-11">  prob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">activation_probability</span>(antigen_level, K_activation, n_hill)</span>
<span id="cb8-12">  </span>
<span id="cb8-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop of activation cycle</span></span>
<span id="cb8-14">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (t <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n_steps) {</span>
<span id="cb8-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Probabilistic Activation of T cells</span></span>
<span id="cb8-16">    n_activated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb8-17">    n_activated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> naive_t_cells[t<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> prob)</span>
<span id="cb8-18">    </span>
<span id="cb8-19">    <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Update population of T cells</span></span>
<span id="cb8-20">    naive_t_cells[t] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> naive_t_cells[t<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> n_activated</span>
<span id="cb8-21">    activated_t_cells[t] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> activated_t_cells[t<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> n_activated</span>
<span id="cb8-22">  }</span>
<span id="cb8-23">  </span>
<span id="cb8-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Preparing the data from the simulation</span></span>
<span id="cb8-25">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(n_steps), </span>
<span id="cb8-26">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Naive =</span> naive_t_cells, </span>
<span id="cb8-27">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Activated =</span> activated_t_cells)</span>
<span id="cb8-28">  </span>
<span id="cb8-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># In long format</span></span>
<span id="cb8-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt</span>(df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id.vars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time"</span>)</span>
<span id="cb8-31">}</span></code></pre></div>
</div>
<p>Let’s break down what’s happening inside this function:</p>
<ol type="1">
<li><p><u><strong>Initializing Data Structures</strong></u>: <code>naive_t_cells &lt;- numeric(n_steps)</code> and <code>activated_t_cells &lt;- numeric(n_steps)</code> <strong>create empty vectors to store the number of naive and activated T cells</strong> at each time step. It’s like setting up empty scoreboards to track the progress of the battle.</p></li>
<li><p><u><strong>Setting Initial Conditions</strong></u>: <code>naive_t_cells[1L] &lt;- n_naive</code> <strong>sets the initial number of naive T cells at the beginning of the simulation</strong> (time step 1). This is where we deploy our initial batch of rookie T cells onto the battlefield.</p></li>
<li><p><u><strong>Calculating Activation Probability</strong></u>: <code>prob &lt;- activation_probability(antigen_level, K_activation, n_hill)</code> <strong>calculates the probability of activation</strong> using our previously defined Hill function. This is like assessing the likelihood of our T cells encountering and recognizing the enemy.</p></li>
<li><p><u><strong>The Activation Loop (The Battle Begins!)</strong></u>: The <code>for (t in 2:n_steps)</code> loop <strong>simulates the passage of time</strong>, with each iteration representing a time step. Inside this loop, we have:</p>
<ul>
<li><u><strong>Probabilistic Activation</strong></u>: <code>n_activated &lt;- sum(runif(n = naive_t_cells[t-1]) &lt; prob)</code> is <strong>where the magic of stochastic activation happens</strong>. For each naive T cell at the previous time step, we generate a random number between 0 and 1 using <code>runif()</code>. If this random number is less than the calculated activation probability (<code>prob</code>), the T cell is considered activated. It’s like each T cell flipping a weighted coin – the higher the probability, the more likely they are to “win” and become activated. The <code>sum()</code> function counts how many T cells were activated in this time step.</li>
<li><u><strong>Updating Cell Populations</strong></u>: <code>naive_t_cells[t] &lt;- naive_t_cells[t-1] - n_activated</code> and <code>activated_t_cells[t] &lt;- activated_t_cells[t-1] + n_activated</code> <strong>update the number of naive and activated T cells</strong>. The number of naive T cells decreases as they become activated, and the number of activated T cells increases accordingly. It’s like tracking the casualties and new recruits on both sides of the battle.</li>
</ul></li>
<li><p><u><strong>Preparing Data for Plotting</strong></u>: The code then prepares the simulation results into a data frame suitable for plotting using <code>data.table</code> and <code>melt</code>.</p></li>
</ol>
<p>Now, let’s visualize the results:</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sim_t_activation</span>(n_steps, n_naive, antigen_level, K_activation, n_hill)</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> variable)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Early T Cell Activation Response"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Steps"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Cells"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cell Type"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-10-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Early stages of T cell activation in response to antigen. The simulation demonstrates a decline in the naive T cell population coupled with a corresponding rise in the activated T cell population, reflecting the transition from naive to activated state. It’s like turning up the heat on the battlefield, the stronger the enemy (higher antigen level), the quicker our T cells get mobilized."><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/index_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img" alt="Early stages of T cell activation in response to antigen. The simulation demonstrates a decline in the naive T cell population coupled with a corresponding rise in the activated T cell population, reflecting the transition from naive to activated state. It’s like turning up the heat on the battlefield, the stronger the enemy (higher antigen level), the quicker our T cells get mobilized."></a></p>
<figcaption class="margin-caption"><strong>Early stages of T cell activation in response to antigen</strong>. The simulation demonstrates a decline in the naive T cell population coupled with a corresponding rise in the activated T cell population, reflecting the transition from naive to activated state. It’s like turning up the heat on the battlefield, the stronger the enemy (higher antigen level), the quicker our T cells get mobilized.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="simulating-proliferation-and-population-dynamics-the-army-grows" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="simulating-proliferation-and-population-dynamics-the-army-grows">Simulating Proliferation and Population Dynamics: The Army Grows</h4>
<p>Now that we have some activated T cells itching for action, let’s simulate their proliferation, <strong>the process where they multiply like, well, like very enthusiastic cells</strong>. We’ll extend our simulation and incorporate the logistic growth equation to keep things realistic (no infinite armies here!).</p>
<p>First, let’s define some parameters that control the proliferation dynamics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## T Cell Proliferation and Apoptosis</span></span>
<span id="cb10-2">r_proliferation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Proliferation rate</span></span>
<span id="cb10-3">K_carrying <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Carrying capacity</span></span></code></pre></div>
</div>
<ul>
<li><code>r_proliferation</code>: This is the <strong>proliferation rate</strong>, which determines how quickly the activated T cell population grows. It’s like the “birth rate” of our T cell army. A higher r_proliferation means faster growth.</li>
<li><code>K_carrying</code>: This is the <strong>carrying capacity</strong>, which represents the maximum number of activated T cells that the environment can support. It’s like the size of the battlefield, there’s only so much space and resources available.</li>
</ul>
<p>Let’s visualize the results:</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sim_t_activation</span>(n_steps, n_naive, antigen_level, K_activation, n_hill, r_proliferation, K_carrying)</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> variable)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T Cell Activation and Proliferation"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Steps"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Cells"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cell Type"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-13-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Combined processes of T cell activation and proliferation. Following initial activation driven by antigen (as seen by the decrease in naive T cells and increase in activated T cells), the activated population undergoes logistic growth. This is characterized by an initial phase of rapid, near-exponential expansion, which then slows down as the population approaches the carrying capacity (K = 150), demonstrating resource limitation. It’s like a population of rabbits in a field, they multiply quickly at first, but eventually, they run out of space and resources, and the population stabilizes."><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/index_files/figure-html/unnamed-chunk-13-1.svg" class="img-fluid figure-img" alt="Combined processes of T cell activation and proliferation. Following initial activation driven by antigen (as seen by the decrease in naive T cells and increase in activated T cells), the activated population undergoes logistic growth. This is characterized by an initial phase of rapid, near-exponential expansion, which then slows down as the population approaches the carrying capacity (K = 150), demonstrating resource limitation. It’s like a population of rabbits in a field, they multiply quickly at first, but eventually, they run out of space and resources, and the population stabilizes."></a></p>
<figcaption class="margin-caption"><strong>Combined processes of T cell activation and proliferation</strong>. Following initial activation driven by antigen (as seen by the decrease in naive T cells and increase in activated T cells), the activated population undergoes logistic growth. This is characterized by an initial phase of rapid, near-exponential expansion, which then slows down as the population approaches the carrying capacity (<code>K = 150</code>), demonstrating resource limitation. It’s like a population of rabbits in a field, they multiply quickly at first, but eventually, they run out of space and resources, and the population stabilizes.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="combining-processes-a-full-simulation" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="combining-processes-a-full-simulation">Combining Processes: A Full Simulation</h4>
<p>Now, the moment we’ve all been waiting for! <strong>Let’s combine all the processes we’ve discussed</strong> (activation, proliferation, and apoptosis) into a single, more complete simulation. <strong>This will give us a more realistic picture</strong> of how T cell populations behave during an immune response.</p>
<p>We’ll also <strong>make a couple of tweaks</strong>: we’ll set the apoptosis probability to 10% at each time step and increase our initial number of naive T cells to 300 and a carrying capacity of 500, <strong>because a bigger army is always more fun to simulate</strong>.</p>
<p>And the final visualization:</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Parameters</span></span>
<span id="cb12-2">p_apoptosis <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Probability of apoptosis</span></span>
<span id="cb12-3">n_naive <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of initial naive T cells</span></span>
<span id="cb12-4">K_carrying <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Carrying capacity</span></span>
<span id="cb12-5">r_proliferation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Proliferation rate</span></span>
<span id="cb12-6"></span>
<span id="cb12-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulation loop with activation, proliferation, and apoptosis</span></span>
<span id="cb12-8">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sim_t_activation</span>(n_steps, n_naive, antigen_level, K_activation, n_hill, r_proliferation, K_carrying, p_apoptosis)</span>
<span id="cb12-9"></span>
<span id="cb12-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the full simulation</span></span>
<span id="cb12-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> variable)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Full T Cell Dynamics: Activation, Proliferation, and Apoptosis"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Steps"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Cells"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cell Type"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-15-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Integration of all key T cell processes: activation, proliferation, and apoptosis. Following antigen-driven activation, activated T cells proliferate, reaching a peak population size. Subsequently, apoptosis leads to a decline in the activated T cell population, demonstrating the dynamic balance between expansion and contraction of the immune response. It’s like watching a battle unfold, there’s an initial surge of troops, but eventually, attrition takes its toll, and the battle either reaches a stalemate or one side prevails."><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/index_files/figure-html/unnamed-chunk-15-1.svg" class="img-fluid figure-img" alt="Integration of all key T cell processes: activation, proliferation, and apoptosis. Following antigen-driven activation, activated T cells proliferate, reaching a peak population size. Subsequently, apoptosis leads to a decline in the activated T cell population, demonstrating the dynamic balance between expansion and contraction of the immune response. It’s like watching a battle unfold, there’s an initial surge of troops, but eventually, attrition takes its toll, and the battle either reaches a stalemate or one side prevails."></a></p>
<figcaption class="margin-caption"><strong>Integration of all key T cell processes: activation, proliferation, and apoptosis</strong>. Following antigen-driven activation, activated T cells proliferate, reaching a peak population size. Subsequently, apoptosis leads to a decline in the activated T cell population, demonstrating the dynamic balance between expansion and contraction of the immune response. It’s like watching a battle unfold, there’s an initial surge of troops, but eventually, attrition takes its toll, and the battle either reaches a stalemate or one side prevails.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="what-happens-if-we-tweak-the-knobs" class="level1 page-columns page-full">
<h1>What Happens if We Tweak the Knobs?</h1>
<p>A crucial step in any modeling study is sensitivity analysis. <strong>It’s like playing with the knobs and dials of your model to see how it responds</strong>. We want to understand how changes in our input parameters (like the Hill coefficient or the carrying capacity) affect the outputs of our simulation (like the number of activated T cells). This helps us <strong>identify which parameters have the biggest influence on the model’s behavior</strong>, which knobs are the most important to turn if we want to change the outcome.</p>
<p>For instance, we can show a quick example of sensitivity analysis by <strong>varying the Hill coefficient</strong> (<img src="https://latex.codecogs.com/png.latex?n">), which, as we know, controls how switch-like the activation is:</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sensitivity analysis for Hill coefficient</span></span>
<span id="cb13-2">n_hill <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n = 1"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n = 2"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n = 3"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n = 4"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb13-3">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(n_hill, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb13-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sim_t_activation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_steps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_naive =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>, </span>
<span id="cb13-5">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">antigen_level =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">K_activation =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_hill =</span> x, </span>
<span id="cb13-6">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r_proliferation =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">K_carrying =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p_apoptosis =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.10</span>)</span>
<span id="cb13-7">}) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbindlist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">idcol =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_hill"</span>)</span>
<span id="cb13-8"></span>
<span id="cb13-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> variable)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ordered</span>(n_hill)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sensitivity Analysis for Hill Coefficient"</span>, </span>
<span id="cb13-12">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Steps"</span>, </span>
<span id="cb13-13">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Activated Cells"</span>, </span>
<span id="cb13-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Carrying Capacity"</span>, </span>
<span id="cb13-15">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hill Coefficient"</span>,</span>
<span id="cb13-16">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"With [Antigen] = 10, and K = 25"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-16-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Impact of the Hill coefficient on the dynamics of T cell activation and recruitment. By varying n from 1 to 4, we observe a transition from a gradual, almost linear response (n=1) to a highly switch-like response (n=4)."><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/index_files/figure-html/unnamed-chunk-16-1.svg" class="img-fluid figure-img" alt="Impact of the Hill coefficient on the dynamics of T cell activation and recruitment. By varying n from 1 to 4, we observe a transition from a gradual, almost linear response (n=1) to a highly switch-like response (n=4)."></a></p>
<figcaption class="margin-caption"><strong>Impact of the Hill coefficient on the dynamics of T cell activation and recruitment</strong>. By varying n from 1 to 4, we observe a transition from a gradual, almost linear response (<code>n=1</code>) to a highly switch-like response (<code>n=4</code>).</figcaption>
</figure>
</div>
</div>
</div>
<p>Here’s a closer look at what’s going on behind the scenes of this code.</p>
<p>The resulting plot is where we see the fruits of our labor. It shows how the dynamics of the activated T cell population and <strong>the recruitment of naive T cells change depending on the Hill coefficient</strong>. Tipically, higher values of <img src="https://latex.codecogs.com/png.latex?n"> lead to a more rapid and pronounced increase in activated T cells. However, this is only true when <img src="https://latex.codecogs.com/png.latex?%5Ctext%7B%5BAntigen%5D%7D"> are above the <img src="https://latex.codecogs.com/png.latex?K"> threshold.</p>
<p><strong>In this case this relationship is inverted</strong> (recall the plot of the hill function we saw earlier), which might seem counterintuitive at first, but remember that the Hill coefficient affects the <em>steepness</em> of the activation curve. A <strong>higher Hill coefficient</strong> is like a very sharp switch, a small increase in antigen concentration leads to a big jump in activation after the <img src="https://latex.codecogs.com/png.latex?K"> threshold is surpassed. Conversely, a <strong><em>lower</em> Hill coefficient</strong> is like a more gradual dimmer switch.</p>
<p>This <strong>sensitivity analysis</strong> is incredibly valuable because it helps us understand just how important are the parameters in the equation <strong>controlling how T cells get activated</strong>. It shows that this parameter can significantly impact the overall immune response. By <strong>playing with these parameters</strong>, we can get a much better feel for <strong>how the immune system works</strong> and how it might react to different challenges, it’s like fine-tuning an instrument to get the perfect sound.</p>
</section>
<section id="so-what-did-our-digital-cells-actually-do" class="level1 page-columns page-full">
<h1>So, What Did Our Digital Cells Actually Do?</h1>
<p>Now that we’ve <strong>unleashed our digital immune system</strong> and watched our simulated lymphocytes playing out in the digital petri dish, <strong>let’s take a step back and figure out what it all means</strong>. Did we just waste a bunch of CPU cycles, or did we actually learn something?</p>
<section id="biological-interpretation-and-relevance-decoding-the-digital-chatter" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="biological-interpretation-and-relevance-decoding-the-digital-chatter">Biological Interpretation and Relevance: Decoding the Digital Chatter</h4>
<p>Our simplified model, while admittedly a bit of a caricature of the real thing, <strong>manages to capture some fundamental aspects of how lymphocytes behave</strong>.</p>
<p>The <em>Hill function</em> for activation, that fancy equation with the exponents, perfectly <strong>illustrates the importance of cooperative binding</strong> and threshold responses in kicking off an immune response <span class="citation" data-cites="dushek2011antigen stefan2013cooperative">(Dushek et al. 2011; Stefan and Le Novère 2013)</span>. It’s like a party, one person arriving might not start a dance floor, <strong>but once a few more join in, suddenly everyone’s grooving</strong>. That’s cooperativity!</p>
<p>The <em>logistic growth equation</em>, our population-limiting equation, <strong>shows how limited resources</strong> (like space, food, and Wi-Fi in the body) <strong>put a limit on lymphocyte proliferation</strong>, preventing them from turning into an unstoppable, resource-devouring horde <span class="citation" data-cites="morris2019tissue jin2018extended">(Morris, Farber, and Yates 2019; Jin, McCue, and Simpson 2018)</span>. The addition of stochasticity (randomness), that sprinkle of randomness we added, is a reminder that <strong>biological systems are inherently noisy</strong>. Even with identical starting conditions, the outcome of a real immune response can vary, it’s like two identical twins might react differently to the same flu virus.</p>
<p>For example, let’s consider what happens <strong>when we change the antigen level</strong>. In our simulation, a <strong>higher antigen concentration</strong> (more enemies on the battlefield) leads to a <strong>faster and stronger activation of T cells</strong>. This, in turn, drives a larger proliferative response (up to the carrying capacity, the maximum number of T cells the body can support). This makes perfect sense biologically: <strong>a larger invasion requires a larger counterattack</strong>. It’s like sending in more troops when facing a bigger enemy army. Similarly, the Hill coefficient (<img src="https://latex.codecogs.com/png.latex?n">) plays a crucial role. <strong>A higher Hill coefficient implies a more sensitive response to changes in antigen concentration</strong>. It’s like having a hair-trigger alarm, a tiny change in antigen concentration sets off a massive response from the T cells.</p>
<p>Now, let’s bring this back to our initial motivation: <strong>cancer immunotherapy</strong>. Our model suggests that the <strong>effectiveness of checkpoint blockade therapies</strong> (which unleash the immune system against cancer cells) <strong>might depend</strong> not only on the number of T cells hanging around in the tumor but also <strong>on factors like the local antigen concentration</strong> (how recognizable the cancer cells are) and the sensitivity of T cells to that antigen (represented by our Hill coefficient). So, <strong>it’s not just about having enough soldiers</strong>; it’s also about making sure they can see and react to the enemy properly.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/hero-t-cell.png" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Photo from Richard C. Smith in <a href="https://cen.acs.org/articles/92/i40/Immune-System-Fights-Back.html">CE&amp;N</a></span></div></div>
</section>
<section id="where-our-digital-cells-fall-short" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="where-our-digital-cells-fall-short">Where Our Digital Cells Fall Short</h4>
<p>It’s crucial to acknowledge the <strong>limitations of our simplified model</strong>. We’ve made some necessary simplifications to make it manageable for this post (<strong>and to prevent my computer from melting down</strong>). Think of it as drawing a cartoon of a person, it captures the basic idea, but it’s not a photorealistic portrait.</p>
<div class="page-columns page-full"><p><u><strong>Simplified cell types</strong></u>. We’ve only considered two types of T cells (naive and activated), which is a gross oversimplification. <strong>The real immune system has a whole alphabet soup of immune cells</strong> (B cells, dendritic cells, regulatory T cells, and many more), <strong>each with its own specialized role</strong>. Incorporating more cell types would allow us to model more complex interactions and immune responses, like teamwork between different parts of the immune system. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">It’s like modeling a sports team with only two types of players, you’re missing a lot of the strategic complexity.</span></div></div>
<div class="page-columns page-full"><p><u><strong>No spatial dynamics</strong></u>. Our model <strong>doesn’t account for the spatial organization of the immune system</strong>. In reality, immune cells move around the body, interacting in specific locations like lymph nodes or tissues. Modeling the movement of cells within tissues would add another layer of realism. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Similar to simulating a battle without considering the terrain, where the fight happens matters!</span></div></div>
<div class="page-columns page-full"><p><u><strong>Simplified interactions</strong></u>. We’ve only modeled a few key processes (activation, proliferation, apoptosis). In reality, <strong>there are countless interactions between immune cells</strong>, including cytokine signaling (chemical messages between cells) and direct cell-cell contact. Modeling cytokine networks and other signaling molecules would allow us to simulate more complex feedback loops and interactions. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">It’s like trying to recreate a conversation with only three words, you’re missing a lot of detail.</span></div></div>
<div class="page-columns page-full"><p><u><strong>Constant parameters</strong></u>. We’ve assumed that parameters like the growth rate and apoptosis probability are constant over time. In reality, <strong>these parameters can change depending on various factors in the cell’s environment</strong>. Modeling these parameters as dependent on the cell environment would allow us to simulate more realistic biological scenarios. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Similar assuming that a car’s speed is always constant, regardless of whether it’s going uphill or downhill.</span></div></div>
<p><strong>These simplifications are necessary for a blog post</strong> (and to avoid a complete descent into computational madness), but they mean our model <strong>doesn’t capture the full complexity of the real immune system</strong>. More complex models, incorporating these missing elements, could be used to address a wider range of immunological questions, from predicting vaccine efficacy to designing personalized immunotherapies.</p>
</section>
<section id="from-pixels-to-patients" class="level4">
<h4 class="anchored" data-anchor-id="from-pixels-to-patients">From Pixels to Patients</h4>
<p>In this post, we’ve taken a wild tour around the topic of <strong>agent-based modeling and non-linear equations in R</strong>, showing how they can be used to simulate the dynamic world of <strong>lymphocyte populations</strong>. We’ve built a simplified model that captures key processes like activation, proliferation, and apoptosis, and we’ve seen <strong>how these processes interact</strong> to shape the overall immune response.</p>
<p>While <strong>our model is a simplified representation of reality</strong> (a digital doodle compared to a biological masterpiece), it provides a valuable framework for <strong>understanding the fundamental principles of lymphocyte dynamics</strong>. It demonstrates the power of computational modeling in immunology, offering <strong>a way to explore complex biological systems</strong> in a way that would be difficult or impossible with traditional experimental methods alone. By building these digital models, we can gain insights that <strong>could eventually lead to more effective treatments</strong> and interventions for a wide range of diseases, bringing us closer to a future where digital cells translate into real-world impact for patients.</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-an2021challenges" class="csl-entry">
An, Li, Volker Grimm, Abigail Sullivan, BL Turner Ii, Nicolas Malleson, Alison Heppenstall, Christian Vincenot, et al. 2021. <span>“Challenges, Tasks, and Opportunities in Modeling Agent-Based Complex Systems.”</span> <em>Ecological Modelling</em> 457: 109685.
</div>
<div id="ref-azarov2019role" class="csl-entry">
Azarov, Ivan, Kirill Peskov, Gabriel Helmlinger, and Yuri Kosinsky. 2019. <span>“Role of t Cell-to-Dendritic Cell Chemoattraction in t Cell Priming Initiation in the Lymph Node: An Agent-Based Modeling Study.”</span> <em>Frontiers in Immunology</em> 10: 1289.
</div>
<div id="ref-chang2015metabolic" class="csl-entry">
Chang, Chih-Hao, Jing Qiu, David O’Sullivan, Michael D Buck, Takuro Noguchi, Jonathan D Curtis, Qiongyu Chen, et al. 2015. <span>“Metabolic Competition in the Tumor Microenvironment Is a Driver of Cancer Progression.”</span> <em>Cell</em> 162 (6): 1229–41.
</div>
<div id="ref-dushek2011antigen" class="csl-entry">
Dushek, Omer, Milos Aleksic, Richard J Wheeler, Hao Zhang, Shaun-Paul Cordoba, Yan-Chun Peng, Ji-Li Chen, et al. 2011. <span>“Antigen Potency and Maximal Efficacy Reveal a Mechanism of Efficient t Cell Activation.”</span> <em>Science Signaling</em> 4 (176): ra39–39.
</div>
<div id="ref-jin2018extended" class="csl-entry">
Jin, Wang, Scott W McCue, and Matthew J Simpson. 2018. <span>“Extended Logistic Growth Model for Heterogeneous Populations.”</span> <em>Journal of Theoretical Biology</em> 445: 51–61.
</div>
<div id="ref-joglekar2021t" class="csl-entry">
Joglekar, Alok V, and Guideng Li. 2021. <span>“T Cell Antigen Discovery.”</span> <em>Nature Methods</em> 18 (8): 873–80.
</div>
<div id="ref-kumar2012robbins" class="csl-entry">
Kumar, Vinay, Abul K Abbas, and Jon C Aster. 2012. <em>Robbins Basic Pathology e-Book</em>. Elsevier Health Sciences.
</div>
<div id="ref-li2023intercellular" class="csl-entry">
Li, Long, Jing Ji, Fan Song, and Jinglei Hu. 2023. <span>“Intercellular Receptor-Ligand Binding: Effect of Protein-Membrane Interaction.”</span> <em>Journal of Molecular Biology</em> 435 (1): 167787.
</div>
<div id="ref-liu2022clinical" class="csl-entry">
Liu, Chenglong, Mengxuan Yang, Daizhou Zhang, Ming Chen, and Di Zhu. 2022. <span>“Clinical Cancer Immunotherapy: Current Progress and Prospects.”</span> <em>Frontiers in Immunology</em> 13: 961805.
</div>
<div id="ref-morris2019tissue" class="csl-entry">
Morris, Sinead E, Donna L Farber, and Andrew J Yates. 2019. <span>“Tissue-Resident Memory t Cells in Mice and Humans: Towards a Quantitative Ecology.”</span> <em>The Journal of Immunology</em> 203 (10): 2561–69.
</div>
<div id="ref-stefan2013cooperative" class="csl-entry">
Stefan, Melanie I, and Nicolas Le Novère. 2013. <span>“Cooperative Binding.”</span> <em>PLoS Computational Biology</em> 9 (6): e1003106.
</div>
<div id="ref-taefehshokr2022cancer" class="csl-entry">
Taefehshokr, Sina, Aram Parhizkar, Shima Hayati, Morteza Mousapour, Amin Mahmoudpour, Liliane Eleid, Dara Rahmanpour, Sahand Fattahi, Hadi Shabani, and Nima Taefehshokr. 2022. <span>“Cancer Immunotherapy: Challenges and Limitations.”</span> <em>Pathology-Research and Practice</em> 229: 153723.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{castillo-aguilar2024,
  author = {Castillo-Aguilar, Matías},
  title = {Modeling {Lymphocyte} {Dynamics:} {Agent-Based} {Simulations}
    and {Non-Linear} {Equations}},
  date = {2024-12-23},
  url = {https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/},
  doi = {10.59350/aqa1r-e2v59},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-castillo-aguilar2024" class="csl-entry quarto-appendix-citeas">
Castillo-Aguilar, Matías. 2024. <span>“Modeling Lymphocyte Dynamics:
Agent-Based Simulations and Non-Linear Equations.”</span> December 23,
2024. <a href="https://doi.org/10.59350/aqa1r-e2v59">https://doi.org/10.59350/aqa1r-e2v59</a>.
</div></div></section></div> ]]></description>
  <category>non-linear</category>
  <category>simulation</category>
  <category>biology</category>
  <category>educational</category>
  <guid>https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/</guid>
  <pubDate>Mon, 23 Dec 2024 03:00:00 GMT</pubDate>
  <media:content url="https://bayesically-speaking.com/posts/2024-12-23 modeling-lymphocyte-dynamics/body_1.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Non-linear models: A Case for Synaptic Plasticity</title>
  <dc:creator>Matías Castillo-Aguilar</dc:creator>
  <link>https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1 page-columns page-full">
<h1>Introduction</h1>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">If you missed the <a href="https://doi.org/10.59350/r62fn-8h720">first edition</a> of this series of non-linear models posts, go see it now!</span></div></div>
<p>The human brain is a show-off, really. It’s constantly <strong>rewiring itself</strong>, adapting to new challenges, and making you forget where you put your keys (all at the same time). This remarkable ability, called <strong>neuronal plasticity</strong>, is the brain’s way of saying, “Don’t worry, I can learn, unlearn, and even relearn, if necessary.” <strong>Imagine a guitarist practicing a tricky solo</strong>. With each attempt (and many failed ones), the neurons involved in mastering that melody become like overzealous gym buddies: stronger, faster, and annoyingly efficient. That’s plasticity in action.</p>
<p>But <strong>capturing this in a model?</strong> Oh, that’s another story. Modeling neuronal plasticity is like <strong>trying to explain a teenager’s mood swings</strong> (messy, non-linear, and full of unexpected spikes). The process involves sharp changes in synaptic strength, calcium signaling thresholds that act like overly jealous gatekeepers, and dynamics so complex <strong>they make rocket science look like child’s play</strong>. Traditional models just shrug and wave the white flag.</p>
<p>Let’s welcome the <strong>non-linear models</strong>, the superheroes of mathematical modeling. In this post, we’ll take a closer look at how these models, specifically <strong>logistic growth equations</strong>, can tame the chaos of neuronal plasticity. We’ll demystify the biology, <strong>turn it into manageable math</strong>, and then buckle up to simulate it all in R. Yes, R… the land of syntax errors and endless parentheses, but don’t worry, I’ll guide you.</p>
<p>By the end of this journey, you’ll not only appreciate the elegance of neuronal plasticity but also see how non-linear modeling can turn <strong>brain mysteries into manageable equations</strong>. So whether you’re a neuroscience nerd, or someone who just likes the idea of <strong>bossing around neurons via code</strong>, this post has something for you. Let’s dive in, and don’t forget to pack your sense of humor. You’re going to need it!</p>
<p class="page-columns page-full"><a href="neurons-firing-2.webp" class="lightbox page-columns page-full" data-gallery="quarto-lightbox-gallery-1"><img src="https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/neurons-firing-2.webp" class="column-screen img-fluid" style="width:100.0%"></a></p>
</section>
<section id="understanding-neuronal-plasticity" class="level1 page-columns page-full">
<h1>Understanding Neuronal Plasticity</h1>
<p><strong>Neuronal plasticity</strong> is the brain’s way of being a multitasking genius or (depending on your perspective), a workaholic control freak. At its heart, it’s the <strong>neurons’ ability to adapt</strong> their structure and function, responding to experiences, activity, <strong>or the occasional existential crisis</strong>. This adaptability powers the brain’s greatest hits: learning, memory, and <strong>even bouncing back from injuries</strong>. This concept, stating that neuronal connections can be remodeled by experience, is also known as <a href="https://www.sciencedirect.com/topics/neuroscience/hebbian-theory">Hebbian Theory</a>, and its behind many studied mechanisms by which plastic changes occurs at the synapse-level <span class="citation" data-cites="scott2023adaptive">(Scott and Frank 2023)</span>. Think of it as the neural equivalent of turning your spare bedroom into a home gym, if neurons are adaptable, why shouldn’t you be?</p>
<section id="the-role-of-synaptic-strength" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="the-role-of-synaptic-strength">The Role of Synaptic Strength</h4>
<p>Plasticity does its magic at the <strong>synapse</strong>, that microscopic handshake where one neuron whispers (or yells) to another. The strength of this connection, aptly named <strong>synaptic strength</strong>, determines how effectively neurons gossip. Strengthening these connections, a process grandiosely called <strong>Long-Term Potentiation (LTP)</strong>, makes neural communication as smooth as butter on warm toast <span class="citation" data-cites="malenka2003long">(Malenka 2003)</span>. On the flip side, <strong>Long-Term Depression (LTD)</strong> weakens connections, pruning the neural network like a gardener trimming overzealous hedges. Goodbye, redundant pathways; hello, optimization.</p>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/ltp-ltd-synapse.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Long-Term Potentiation (LTP) and Long-Term Depression (LTD) occurs <strong>as a function of synapse communication</strong>. This is what makes some brain pathways stronger or weaker over time, contributing to both the acquiring and loosing cognitive functions and motor skills. Source: <a href="https://openstax.org/books/biology/pages/35-2-how-neurons-communicate">Biology 2e. OpenStax</a>.</span></div></div>
</section>
<section id="calcium-the-master-regulator" class="level4">
<h4 class="anchored" data-anchor-id="calcium-the-master-regulator">Calcium: The Master Regulator</h4>
<p>If synaptic strength is the party, <strong>calcium ions</strong> (<img src="https://latex.codecogs.com/png.latex?Ca%5E%7B2+%7D">) are the overzealous DJ deciding whether to pump up the volume or call it a night. Calcium levels dictate <strong>whether the synapse becomes stronger or weaker</strong>, essentially flipping the plasticity switches:</p>
<ul>
<li><strong>High</strong> calcium levels? Cue the <strong>LTP rave</strong>, connections strengthen, neurons fire happily ever after.</li>
<li><strong>Low</strong> calcium levels? Time for the <strong>LTD chill-out session</strong>, synapses quiet down and pathways are pruned.</li>
</ul>
<p>The drama <strong>lies in the thresholds</strong>. Calcium must hit the sweet spot: too high, and it’s all systems go for strengthening; too low, and the neuron gets out its metaphorical scissors. <strong>Anything in between is neural purgatory</strong> (synaptic strength stays stable), which is another way of saying, “Meh, let’s just keep things as they are.”</p>
</section>
<section id="dynamic-and-non-linear-nature" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="dynamic-and-non-linear-nature">Dynamic and Non-Linear Nature</h4>
<p>Here’s where things get tricky: <strong>the relationship between calcium levels and synaptic strength isn’t linear</strong>, because why would the brain ever take the easy route? A tiny nudge in calcium concentration can tip the balance dramatically, depending on whether those pesky thresholds are crossed. <strong>Feedback loops ensure that synaptic adjustments don’t spiral out of control</strong>, think of them as neural quality control, keeping things proportional and adaptive <span class="citation" data-cites="lisman2012mechanisms yasuda2022camkii">(Lisman, Yasuda, and Raghavachari 2012; Yasuda, Hayashi, and Hell 2022)</span>.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define calcium levels and thresholds</span></span>
<span id="cb1-2">calcium_levels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulated calcium levels (arbitrary units)</span></span>
<span id="cb1-3">ltp_threshold <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Threshold for LTP activation</span></span>
<span id="cb1-4">ltd_threshold <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Threshold for LTD activation</span></span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define synaptic strength change based on calcium</span></span>
<span id="cb1-7">synaptic_strength_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(calcium, ltp_thresh, ltd_thresh) {</span>
<span id="cb1-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Non-linear responses for LTP and LTD</span></span>
<span id="cb1-9">  ltp_response <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(calcium <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ltp_thresh, (calcium <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ltp_thresh)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-10">  ltd_response <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(calcium <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> ltd_thresh, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>(ltd_thresh <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> calcium)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-11">  ltp_response <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ltd_response</span>
<span id="cb1-12">}</span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute synaptic strength changes</span></span>
<span id="cb1-15">strength_changes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">synaptic_strength_change</span>(calcium_levels, ltp_threshold, ltd_threshold)</span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a data frame for plotting</span></span>
<span id="cb1-18">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb1-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Calcium =</span> calcium_levels,</span>
<span id="cb1-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">StrengthChange =</span> strength_changes</span>
<span id="cb1-21">)</span>
<span id="cb1-22"></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot</span></span>
<span id="cb1-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Calcium, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> StrengthChange)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> ltp_threshold, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> ltd_threshold, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ltp_threshold <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LTP Threshold"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ltd_threshold <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LTD Threshold"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb1-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Non-Linear Relationship Between Calcium and Synaptic Strength"</span>,</span>
<span id="cb1-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Calcium Levels (arbitrary units)"</span>,</span>
<span id="cb1-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in Synaptic Strength"</span></span>
<span id="cb1-34">  )</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-2-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Here, the relationship between calcium levels and the change in synaptic strength is simplified to illustrate the relationship between calcium dynamics and synaptic plasticity."><img src="https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/index_files/figure-html/unnamed-chunk-2-1.svg" class="img-fluid figure-img" alt="Here, the relationship between calcium levels and the change in synaptic strength is simplified to illustrate the relationship between calcium dynamics and synaptic plasticity."></a></p>
<figcaption class="margin-caption">Here, the relationship between calcium levels and the change in synaptic strength is simplified to illustrate the relationship between calcium dynamics and synaptic plasticity.</figcaption>
</figure>
</div>
</div>
</div>
<p>This <strong>delicate dance</strong> between calcium signaling, thresholds, and synaptic strength <strong>is the essence of neuronal plasticity’s beauty</strong>. It’s also the reason why modeling this process is <strong>as tricky as explaining quantum physics</strong> to a toddler. But don’t worry; the non-linear models we’ll tackle next will help demystify this wild ride.</p>
</section>
</section>
<section id="the-challenge-of-modeling-neuronal-plasticity" class="level1 page-columns page-full">
<h1>The Challenge of Modeling Neuronal Plasticity</h1>
<p>Modeling neuronal plasticity is like <strong>trying to choreograph a dance for cats</strong>: dynamic, unpredictable, and prone to sudden chaos. The brain doesn’t play by the simple rules of linear systems. Instead, it thrives on thresholds, feedback loops, and behaviors that emerge <strong>as if neurons decided to collectively say, “Let’s make this interesting.”</strong></p>
<section id="the-complexity-of-biological-systems" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="the-complexity-of-biological-systems">The Complexity of Biological Systems</h4>
<div class="page-columns page-full"><p><img src="https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/synapse.jpeg" class="img-fluid" style="width:100.0%"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Depiction of the step-by-step communication between neurons at the synapse-level through calcium signaling at the presynaptic neuron, responsible for neurotransmitter releasing and neuron depolarization. Source: <a href="https://openstax.org/books/biology/pages/35-2-how-neurons-communicate">Biology 2e. OpenStax</a>.</span></div></div>
<p>Neuronal plasticity isn’t just complex, it’s a web of biochemical drama. Take <strong>calcium concentration dynamics</strong>, these levels don’t just sit still like a well-behaved variable. <strong>They oscillate wildly</strong>, influenced by synaptic activity and timing, like calcium’s trying out for a rhythm section. <strong>These oscillations trigger intracellular signaling cascades</strong> that either crank up the volume or dial it down, depending on the situation. And then there’s <strong>synaptic change over time</strong>, a gradual process, <strong>often following a sigmoid or exponential curve</strong>. In other words, synaptic strength doesn’t just flick a switch; it warms up, stretches, and then decides if it’s going to do some serious lifting.</p>
<p>Linear models? They try their best but are basically out of their depth here. Sure, they can hint at early synaptic changes, but when feedback mechanisms, thresholds, and saturation effects enter the chat, <strong>linear models might as well pack up and go home</strong>.</p>
</section>
<section id="threshold-dependent-behavior" class="level4">
<h4 class="anchored" data-anchor-id="threshold-dependent-behavior">Threshold-Dependent Behavior</h4>
<p>Calcium thresholds are where the real drama unfolds. Picture this: when <img src="https://latex.codecogs.com/png.latex?Ca%5E%7B2+%7D"> crosses the high threshold (<img src="https://latex.codecogs.com/png.latex?C_%7B%5Ctext%7BLTP%7D%7D">), <strong>synaptic strength goes into overdrive</strong>, climbing exponentially until it maxes out like a hiker who’s finally reached the summit. But if <img src="https://latex.codecogs.com/png.latex?Ca%5E%7B2+%7D"> drops below the low threshold (<img src="https://latex.codecogs.com/png.latex?C_%7B%5Ctext%7BLTD%7D%7D">), <strong>it’s pruning time</strong>, and synaptic strength takes a sharp nosedive to the baseline. These thresholds create <strong>non-linearity</strong>, where tiny calcium fluctuations can flip the synaptic switch from party mode to shutdown in a heartbeat.</p>
</section>
<section id="feedback-and-regulation" class="level4">
<h4 class="anchored" data-anchor-id="feedback-and-regulation">Feedback and Regulation</h4>
<p>If thresholds are the stage, feedback mechanisms are the stagehands, constantly adjusting the scene. <strong>Positive feedback</strong> amplifies responses, with <strong>LTP inviting more calcium to the party</strong> and reinforcing synaptic strengthening. <strong>Negative feedback</strong>, on the other hand, keeps <strong>LTD from going full demolition crew by dialing down activity</strong> and avoiding unnecessary pruning. Together, these loops keep the system both chaotic and oddly balanced, a testament to biological ingenuity (or masochism).</p>
</section>
<section id="variability-and-noise" class="level4">
<h4 class="anchored" data-anchor-id="variability-and-noise">Variability and Noise</h4>
<p>And let’s not forget the noise. <strong>Neurons are the original rebels</strong>, no two behave identically. Calcium concentrations fluctuate, <strong>receptors show wildly different sensitivities</strong>, and neurotransmitter release has a habit of being unpredictable. Stochastic effects at the molecular level add another layer of randomness, making modeling this system <strong>akin to predicting the stock market in a thunderstorm</strong>.</p>
</section>
<section id="why-non-linear-models" class="level4">
<h4 class="anchored" data-anchor-id="why-non-linear-models">Why Non-Linear Models?</h4>
<p>Non-linear models, like logistic growth equations, come to the rescue with their ability to handle the brain’s antics. They’re perfect for capturing <strong>threshold-dependent</strong> dynamics, <strong>saturation</strong> effects, and <strong>time-dependent</strong> changes, all while leaving room for noise and feedback. It’s as if these models were built specifically for <strong>taming the wild world of neuronal plasticity</strong>.</p>
<p>In the next section, we’ll get ready the magic of non-linear modeling, focusing on <strong>logistic growth equations</strong>. Spoiler: these equations are like cheat codes for understanding synaptic strength changes. Let’s see them in action!</p>
</section>
</section>
<section id="introducing-the-non-linear-model" class="level1">
<h1>Introducing the Non-Linear Model</h1>
<p>To simulate the dynamics of neuronal plasticity, <strong>we need a model that doesn’t crumble under the weight of complexity</strong>. Let me introduce you the <strong>logistic growth model</strong>, our mathematical hero. This model elegantly captures the key ingredients of synaptic changes:</p>
<ul>
<li><strong>Threshold behavior</strong>: Synaptic strength only changes when stimulation crosses a “Do Not Disturb” threshold.<br>
</li>
<li><strong>Saturation</strong>: Synaptic strength doesn’t keep growing forever (because even neurons know their limits).<br>
</li>
<li><strong>Time-dependence</strong>: Synaptic changes are gradual, like making sourdough bread. Patience is key.</li>
</ul>
<p>Logistic equations are pretty simple at its core, they all follow the same structure.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(x)%20=%20%5Cfrac%7B1%7D%7B1%20+%20e%5E%7B-x%7D%7D%0A"></p>
<p>This kind of equations will (in general) yield the following behavior.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">logistic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) { <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x)) }</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> logistic, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"f(x) == frac(1,1 + e^{-x})"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Asymptotic Behavior of Logistic Functions"</span>,</span>
<span id="cb2-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">italic</span>(f)(x)),</span>
<span id="cb2-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">italic</span>(x)))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>This logistic growth model <strong>is widely used in biology</strong> to describe systems where growth starts slow, accelerates, and then hits a plateau (also called, asymptotes). In our case, it’s the perfect candidate for <strong>modeling synaptic strength</strong> during LTP and LTD, <strong>all while looking deceptively simple</strong>.</p>
<section id="looking-into-the-model" class="level4">
<h4 class="anchored" data-anchor-id="looking-into-the-model">Looking into the model</h4>
<p>If we tweak the forementioned logistic equation, we get something like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS(t)%20=%20S_%7B%5Ctext%7Bmin%7D%7D%20+%20%5Cfrac%7BS_%7B%5Ctext%7Bmax%7D%7D%20-%20S_%7B%5Ctext%7Bmin%7D%7D%7D%7B1%20+%20e%5E%7B-%5Clambda%20(t%20-%20t_0)%7D%7D%0A"></p>
<p>Let’s break it down without making your eyes glaze over:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?S(t)">: Synaptic strength at time <img src="https://latex.codecogs.com/png.latex?t">. This is what we’re modeling.<br>
</li>
<li><img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bmin%7D%7D">: The baseline synaptic strength, think of it as the starting line.<br>
</li>
<li><img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bmax%7D%7D">: The upper limit of synaptic strength after all the excitement of LTP.<br>
</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Clambda">: The rate of change, or how quickly the synapse is building muscle.<br>
</li>
<li><img src="https://latex.codecogs.com/png.latex?t_0">: The starting point of stimulation, shifting the curve along the time axis.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pedagogic convenience
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Using synaptic strength is simpler and more abstract, making it <strong>easier to fit and interpret</strong> in many contexts, especially when data on calcium dynamics is unavailable.</p>
<p>Explicitly modeling calcium dynamics and thresholds can provide deeper biological insights but <strong>at the cost of added complexity</strong>.</p>
</div>
</div>
</div>
<p>Here’s why this logistic structure is very convenient:</p>
<ol type="1">
<li>Synaptic strength starts close to <img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bmin%7D%7D"> when time is still warming up (<img src="https://latex.codecogs.com/png.latex?t%20%5Cll%20t_0">).<br>
</li>
<li>It ramps up as <img src="https://latex.codecogs.com/png.latex?t"> approaches <img src="https://latex.codecogs.com/png.latex?t_0">, because neurons love to make a dramatic entrance.<br>
</li>
<li>Growth slows as <img src="https://latex.codecogs.com/png.latex?S(t)"> nears <img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bmax%7D%7D">, reflecting the biological saturation point (like most physiological processes).</li>
</ol>
</section>
<section id="modeling-ltp-the-big-boost" class="level4">
<h4 class="anchored" data-anchor-id="modeling-ltp-the-big-boost">Modeling LTP: The Big Boost</h4>
<p>In <strong>Long-Term Potentiation (LTP)</strong>, the synapse gets a power-up, causing a rapid and lasting increase in strength. Using the logistic growth model:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bmin%7D%7D"> is the baseline <strong>before</strong> stimulation.<br>
</li>
<li><img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bmax%7D%7D"> is the exciting new level of strength <strong>after LTP has worked</strong> its magic.</li>
</ul>
<p>Tweaking <img src="https://latex.codecogs.com/png.latex?%5Clambda"> and <img src="https://latex.codecogs.com/png.latex?t_0"> lets us control <strong>how quickly and when the synapse gets its boost</strong>, perfect for simulating the effects of different stimuli.</p>
</section>
<section id="modeling-ltd-the-great-decline" class="level4">
<h4 class="anchored" data-anchor-id="modeling-ltd-the-great-decline">Modeling LTD: The Great Decline</h4>
<p>In <strong>Long-Term Depression (LTD)</strong>, the synapse doesn’t throw a party, it hits the brakes instead. For this, we flip the logistic equation on its head, <strong>changing the sign on the logistic part</strong> of the function:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS(t)%20=%20S_%7B%5Ctext%7Bmax%7D%7D%20-%20%5Cfrac%7BS_%7B%5Ctext%7Bmax%7D%7D%20-%20S_%7B%5Ctext%7Bmin%7D%7D%7D%7B1%20+%20e%5E%7B-%5Clambda%20(t%20-%20t_0)%7D%7D%0A"></p>
<p>Here:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bmax%7D%7D"> is where the synaptic strength starts <strong>before LTD</strong> brings it down a notch.<br>
</li>
<li><img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bmin%7D%7D"> is the new baseline <strong>after the synapse gets reorganized</strong>.</li>
</ul>
<p>It’s like a reverse LTP (same logistics), but with a <strong>focus on pruning rather than boosting</strong>.</p>
</section>
<section id="combining-ltp-and-ltd-the-balancing-act" class="level4">
<h4 class="anchored" data-anchor-id="combining-ltp-and-ltd-the-balancing-act">Combining LTP and LTD: The Balancing Act</h4>
<p>Neurons aren’t simple creatures. They often experience <strong>LTP and LTD simultaneously</strong>, like trying to watch a movie while your neighbor is mowing the lawn. To capture this, we combine two logistic equations into one glorious model:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS(t)%20=%20S_%7B%5Ctext%7Bbaseline%7D%7D%20+%20%5Cfrac%7B%5CDelta%20S_%7B%5Ctext%7BLTP%7D%7D%7D%7B1%20+%20e%5E%7B-%5Clambda_%7B%5Ctext%7BLTP%7D%7D%20(t%20-%20t_%7B%5Ctext%7BLTP%7D%7D)%7D%7D%20-%20%5Cfrac%7B%5CDelta%20S_%7B%5Ctext%7BLTD%7D%7D%7D%7B1%20+%20e%5E%7B-%5Clambda_%7B%5Ctext%7BLTD%7D%7D%20(t%20-%20t_%7B%5Ctext%7BLTD%7D%7D)%7D%7D%0A"></p>
<p>I know what you’re thinking… it seems like its too much. However, for sanity sakes lets break it down:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bbaseline%7D%7D">: The synaptic strength before anything exciting happens.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5CDelta%20S_%7B%5Ctext%7BLTP%7D%7D%20=%20S_%7B%5Ctext%7Bmax%7D%7D%20-%20S_%7B%5Ctext%7Bbaseline%7D%7D">: The increase due to LTP.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5CDelta%20S_%7B%5Ctext%7BLTD%7D%7D%20=%20S_%7B%5Ctext%7Bbaseline%7D%7D%20-%20S_%7B%5Ctext%7Bmin%7D%7D">: The decrease due to LTD.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B%5Ctext%7BLTP%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B%5Ctext%7BLTD%7D%7D">: Rates of change for LTP and LTD (i.e., the “how quickly” part).</li>
<li><img src="https://latex.codecogs.com/png.latex?t_%7B%5Ctext%7BLTP%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?t_%7B%5Ctext%7BLTD%7D%7D">: Onset times for LTP and LTD (i.e., the “when” part).</li>
</ul>
<p>This combined model lets us handle real-world complexity, where <strong>strengthening and weakening signals overlap</strong> like a neural tug-of-war.</p>
</section>
<section id="why-two-logistic-functions" class="level4">
<h4 class="anchored" data-anchor-id="why-two-logistic-functions">Why Two Logistic Functions?</h4>
<p>You might wonder <strong>why we bother with two logistic functions</strong> instead of just one that switches direction halfway. The answer: <strong>biology loves chaos</strong>.</p>
<ul>
<li>LTP and LTD <strong>aren’t mutually exclusive</strong>. They can overlap, fight, or ignore each other altogether.<br>
</li>
<li>Their onset times (<img src="https://latex.codecogs.com/png.latex?t_%7B%5Ctext%7BLTP%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?t_%7B%5Ctext%7BLTD%7D%7D">) and rates (<img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B%5Ctext%7BLTP%7D%7D">, <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B%5Ctext%7BLTD%7D%7D">) often vary, making a single equation woefully inadequate.</li>
</ul>
<p>Of course, we could have just used a single logistic function. However, in most real-world scenarios, beyond the pedagogic convenience, <strong>simple models are just the initial phase of any model building process</strong>.</p>
<p>Despite any complexity we could add to the model, we must always remember that <strong>any model is always “an approximation to reality”</strong> at best. Or, as the famous George Box would say:</p>
<blockquote class="blockquote">
<p>“Essentially all models are wrong, but some are useful”</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
LTP and LTD at the Same Time?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In some fascinating scenarios, neurons manage to pull off the ultimate balancing act: <strong>inducing both LTP and LTD simultaneously</strong>. This can happen when synaptic inputs are spatially separated, allowing different synapses on the same neuron to independently engage in potentiation or depression <strong>based on local calcium dynamics</strong> <span class="citation" data-cites="scott2023adaptive">(Scott and Frank 2023)</span>. It’s like a multi-tasking maniac performing two distinct solos at once. Similarly, in <strong>spike-timing-dependent plasticity</strong> (discussed up ahead), complex spike-timing patterns <strong>can produce overlaps in the conditions for LTP and LTD</strong>, with some synapses “winning” in one direction and others in the opposite.</p>
<p>Sometimes, the brain’s calcium dynamics get a little wild, <strong>oscillating between the ranges required for LTP and LTD</strong> due to the convergence of excitatory and inhibitory inputs. Throw in a dash of neuromodulation (like dopamine or acetylcholine tweaking thresholds) and some synapses might lean toward strengthening while others favor weakening. This interplay can also occur when synapses start in different states: <strong>stronger synapses may undergo LTD</strong> to maintain homeostasis, while <strong>weaker ones are busy potentiating</strong> <span class="citation" data-cites="scott2023adaptive">(Scott and Frank 2023)</span>. Interestingly, experimental protocols designed to study synaptic plasticity in mood disorders often force these conditions, with pharmacological interventions inducing <strong>concurrent LTP and LTD</strong> in some brain areas <span class="citation" data-cites="krystal2024ketamine">(Krystal, Kavalali, and Monteggia 2024)</span>.</p>
</div>
</div>
</div>
<p>Two logistic functions give us the flexibility to capture these dynamics <strong>without assuming biology plays nice</strong>.</p>
<p>In the next section, we’ll fire up R and use these equations <strong>to simulate synaptic strength changes</strong>. Spoiler: it’s going to be visually satisfying, so stick around!</p>
</section>
</section>
<section id="simulating-synaptic-plasticity-in-r" class="level1">
<h1>Simulating Synaptic Plasticity in R</h1>
<p>Now that we’ve got our fancy non-linear model ready to roll, it’s <strong>time to turn theory into practice</strong> (or, more specifically, into code). Let’s use R to simulate synaptic changes over time. Think of <strong>this as our chance to play neuroscientific alchemist</strong>, blending math, biology, and programming into a beautiful plot. Spoiler alert: things will go up, things will go down, and everything will make sense… eventually.</p>
<section id="step-1-defining-the-model" class="level4">
<h4 class="anchored" data-anchor-id="step-1-defining-the-model">Step 1: Defining the Model</h4>
<p>First, <strong>we need to teach R how to think like a synapse</strong>. We’ll define our logistic functions for LTP and LTD, then combine them to model the overall synaptic strength. <strong>It’s like giving R its own brain</strong>, except this one follows your rules and doesn’t forget where it put the car keys.</p>
<p>The logistic function describes <strong>how synaptic strength changes with time</strong>. For LTP, strength rises from a baseline to a maximum. For LTD, the opposite happens: it’s the digital equivalent of neurons ghosting each other.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the logistic function</span></span>
<span id="cb3-2">logistic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(t, t_onset, lambda, delta_S) {</span>
<span id="cb3-3">  delta_S <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (t <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t_onset)))</span>
<span id="cb3-4">}</span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the combined model</span></span>
<span id="cb3-7">synaptic_strength <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(t, S_baseline, t_LTP, lambda_LTP, delta_LTP,</span>
<span id="cb3-8">                               t_LTD, lambda_LTD, delta_LTD) {</span>
<span id="cb3-9">  </span>
<span id="cb3-10">  ltp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logistic</span>(t, t_LTP, lambda_LTP, delta_LTP)</span>
<span id="cb3-11">  ltd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logistic</span>(t, t_LTD, lambda_LTD, delta_LTD)</span>
<span id="cb3-12">  strength <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> S_baseline <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ltp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ltd</span>
<span id="cb3-13">  </span>
<span id="cb3-14">  data.table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb3-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Time =</span> t, </span>
<span id="cb3-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LTP =</span> ltp,</span>
<span id="cb3-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LTD =</span> ltd,</span>
<span id="cb3-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LTP + LTD</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> strength</span>
<span id="cb3-19">  )</span>
<span id="cb3-20">}</span></code></pre></div>
</details>
</div>
<p>Notice how LTP and LTD are <strong>modeled as separate entities</strong> but combine their forces (or opposing forces) in the overall strength equation. It’s teamwork, or in this case, team tug-of-war.</p>
</section>
<section id="step-2-setting-the-stage" class="level4">
<h4 class="anchored" data-anchor-id="step-2-setting-the-stage">Step 2: Setting the Stage</h4>
<p>Next, we’ll define some parameters. Think of this as <strong>setting up your neural experiment in a lab</strong>, but with fewer pipettes and a lot more debugging.</p>
<p>We’ll start with baseline <strong>synaptic strength set to 1</strong> (for our convenience), simulate <strong>LTP kicking in at time 5</strong>, and introduce <strong>LTD at time 10</strong>. Each process has its own speed (<img src="https://latex.codecogs.com/png.latex?%5Clambda">) and magnitude (<img src="https://latex.codecogs.com/png.latex?%5CDelta%20S">).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parameters for the simulation</span></span>
<span id="cb4-2">S_baseline <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-3">t_LTP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb4-4">lambda_LTP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-5">delta_LTP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-6">t_LTD <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb4-7">lambda_LTD <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-8">delta_LTD <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-9"></span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Time range for simulation</span></span>
<span id="cb4-11">time <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb4-12"></span>
<span id="cb4-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute synaptic strength over time</span></span>
<span id="cb4-14">S <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">synaptic_strength</span>(time, S_baseline, t_LTP, lambda_LTP, delta_LTP,</span>
<span id="cb4-15">                       t_LTD, lambda_LTD, delta_LTD)</span>
<span id="cb4-16"></span>
<span id="cb4-17"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Format the resulting simulation into a convenient plotting format for later</span></span>
<span id="cb4-18">S <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data.table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt</span>(S, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id.vars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time"</span>)</span></code></pre></div>
</details>
</div>
<p>By now, <strong>we’ve turned R into a synaptic storyteller</strong>, weaving tales of LTP, LTD, and the epic battle for dominance over synaptic strength.</p>
</section>
<section id="step-3-plotting-the-results" class="level4">
<h4 class="anchored" data-anchor-id="step-3-plotting-the-results">Step 3: Plotting the Results</h4>
<p>It’s time for the <em>pièce de résistance</em>: visualization! Using <code>ggplot2</code>, we’ll craft a plot that shows <strong>how synaptic strength evolves</strong>. Imagine this as the biologist’s equivalent of putting your art project on the fridge.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the synaptic strength</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(S, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> variable, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free_y"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> variable), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Synaptic Strength Over Time"</span>,</span>
<span id="cb5-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (arbitrary units)"</span>,</span>
<span id="cb5-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Synaptic Strength"</span>) </span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-6-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/index_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>The resulting plot reveals that the <strong>resulting synaptic strength</strong> is the result of the simultaneously <strong>gradual rise in synaptic strength</strong> thanks to LTP, <strong>followed by a dip as LTD gets its turn</strong> (plus the constant that determines the baseline strength). It’s like a see-saw, but the laws of biochemistry decide who gets to go up or down.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What do the units of synaptic strength means?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The synaptic strength (<img src="https://latex.codecogs.com/png.latex?S">) in the model is <strong>dimensionless</strong>. It represents a normalized value that captures the <strong>relative magnitude of potentiation or depression</strong> of a synapse, typically scaled between <img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bmin%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bmax%7D%7D"> (e.g., 0.5 to 1.5 in the upcoming extended model). This normalization <strong>simplifies the model</strong> by abstracting away specific biophysical units, such as conductance (<img src="https://latex.codecogs.com/png.latex?%5Cmu%20S">) or post-synaptic current (<img src="https://latex.codecogs.com/png.latex?pA">), to <strong>focus on the dynamics</strong> of synaptic changes.</p>
<p>If needed, <strong>the model could be adapted to use specific units</strong>, like synaptic conductance, by rescaling <img src="https://latex.codecogs.com/png.latex?S"> and its parameters to reflect <strong>actual physiological measurements</strong>. For instance, calcium oscillation amplitudes and the associated logistic functions would need to be parameterized <strong>according to empirical data</strong> from experiments measuring synaptic responses.</p>
</div>
</div>
</div>
</section>
<section id="step-4-playing-with-parameters" class="level4">
<h4 class="anchored" data-anchor-id="step-4-playing-with-parameters">Step 4: Playing with Parameters</h4>
<p>This is where things get really fun. <strong>By tweaking parameters</strong>, you can explore different scenarios, like what happens if neurons get hyped with LTP or slack off on LTD. For example, cranking up the LTP magnitude to 1.5 (from 0.5) while leaving LTD at 0.3 <strong>results in a net strengthening</strong> of the synapse.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example: Modify LTP magnitude</span></span>
<span id="cb6-2">delta_LTP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recompute synaptic strength</span></span>
<span id="cb6-5">data_modified <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(delta_LTP, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb6-6">  strength <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">synaptic_strength</span>(time, S_baseline, t_LTP, lambda_LTP, x,</span>
<span id="cb6-7">                                t_LTD, lambda_LTD, delta_LTD)</span>
<span id="cb6-8">  strength<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>delta_ltp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x</span>
<span id="cb6-9">  strength</span>
<span id="cb6-10">}) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbindlist</span>()</span>
<span id="cb6-12"></span>
<span id="cb6-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the modified synaptic strength</span></span>
<span id="cb6-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(data_modified, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LTP + LTD</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ordered</span>(delta_ltp))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Modified Synaptic Strength (Stronger LTP)"</span>,</span>
<span id="cb6-17">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (arbitrary units)"</span>,</span>
<span id="cb6-18">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Synaptic Strength"</span>,</span>
<span id="cb6-19">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(Delta<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S"</span>[LTP]))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-7-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/index_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>This flexibility lets you conduct <strong>virtual experiments</strong>, saving you from lab-induced caffeine dependency while still yielding <strong>valuable insights</strong>.</p>
<p>In the next section, we’ll explore the <strong>implications of these simulations</strong> and explore how tweaking parameters can reveal deeper truths about <strong>neuronal plasticity</strong>. Stay tuned because in science, even the tiniest tweak can lead to a plot twist.</p>
</section>
</section>
<section id="extending-the-model-to-include-ltp-and-ltd-dynamics" class="level1">
<h1>Extending the Model to Include LTP and LTD Dynamics</h1>
<p><strong>Our model so far is like a sturdy bicycle</strong>: simple, reliable, and great for short trips. But neuroscience is a highway with twists, turns, and occasional potholes, so it’s time to upgrade to a more dynamic model, think of this as <strong>strapping a rocket engine to that bike</strong>. Synaptic plasticity isn’t just about changes in strength; timing, saturation, and other nuances come into play. Let’s extend our model to capture some of these <strong>complexities</strong>.</p>
<section id="incorporating-temporal-dependencies" class="level4">
<h4 class="anchored" data-anchor-id="incorporating-temporal-dependencies">Incorporating Temporal Dependencies</h4>
<p><strong>Timing is everything</strong> in neuroscience. In the world of synapses, when <strong>presynaptic</strong> and <strong>postsynaptic</strong> neurons fire relative to each other determines <strong>whether you get LTP or LTD</strong>. It’s a bit like a dance: if one partner steps too late, the magic is lost, and the audience (synaptic strength) is unimpressed.</p>
<p>This timing phenomenon, called <strong>spike-timing-dependent plasticity</strong> (STDP), hinges on <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t"> (the interval between pre- and postsynaptic spikes). <strong>LTP loves when presynaptic spikes lead the way</strong>, while LTD thrives when postsynaptic spikes take the lead <span class="citation" data-cites="scott2023adaptive">(Scott and Frank 2023)</span>.</p>
<p>To capture this, we introduce exponential decay functions for the magnitudes of LTP and LTD:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5CDelta%20S_%7B%5Ctext%7BLTP%7D%7D%20&amp;=%20A_%7B%5Ctext%7BLTP%7D%7D%20%5Ccdot%20e%5E%7B-%5Cfrac%7B%5CDelta%20t%7D%7B%5Ctau_%7B%5Ctext%7BLTP%7D%7D%7D%7D%20%5C%5C%0A%5CDelta%20S_%7B%5Ctext%7BLTD%7D%7D%20&amp;=%20A_%7B%5Ctext%7BLTD%7D%7D%20%5Ccdot%20e%5E%7B-%5Cfrac%7B%5CDelta%20t%7D%7B%5Ctau_%7B%5Ctext%7BLTD%7D%7D%7D%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>Here, <img src="https://latex.codecogs.com/png.latex?A_%7B%5Ctext%7BLTP%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?A_%7B%5Ctext%7BLTD%7D%7D"> are the <strong>maximum amplitudes of change in synaptic strength</strong>, equivalent to <img src="https://latex.codecogs.com/png.latex?%5CDelta%20S"> (the size of the “dance move”), and <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B%5Ctext%7BLTP%7D%7D">, <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B%5Ctext%7BLTD%7D%7D"> are time constants that govern <strong>how quickly the effect of time between spikes (<img src="https://latex.codecogs.com/png.latex?%5CDelta%20t">) fades</strong>. If you’ve ever tried to tell a joke but botched the timing, you already understand how crucial these constants are.</p>
<p>Now, let’s see how each of these parameters affects the synaptic choreography. If <img src="https://latex.codecogs.com/png.latex?A_%7B%5Ctext%7BLTP%7D%7D"> (the amplitude of the LTP move) is cranked up, the presynaptic dancer delivers an eye-catching performance, resulting in a stronger synapse. A <strong>higher amplitude</strong> here means even a moderately timed spike can still <strong>significantly strengthen the synapse</strong>. However, if <img src="https://latex.codecogs.com/png.latex?A_%7B%5Ctext%7BLTD%7D%7D"> takes center stage, the postsynaptic dancer has the spotlight, <strong>weakening the synapse more dramatically</strong>. Reducing either amplitude dulls their impact; it’s like both dancers are phoning it in, leaving the synapse barely moved, regardless of the timing.</p>
<p>Now, consider <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B%5Ctext%7BLTP%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B%5Ctext%7BLTD%7D%7D">, the time constants that <strong>control how forgiving the synapse is about timing</strong>. A large <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B%5Ctext%7BLTP%7D%7D"> means <strong>the presynaptic dancer gets more leeway</strong>; even if the moves are slightly late, the synapse is still impressed, leading to a <strong>broader window for LTP</strong>. In contrast, a smaller <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B%5Ctext%7BLTP%7D%7D"> <strong>signals a pickier synapse</strong>, <strong>rewarding only perfectly timed presynaptic spikes</strong>. Similarly, a long <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B%5Ctext%7BLTD%7D%7D"> gives the postsynaptic neuron plenty of room to weaken the synapse, tolerating more variability in timing. With a shorter <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B%5Ctext%7BLTD%7D%7D">, the postsynaptic dancer must hit the perfect beat to have any meaningful impact.</p>
<p>The plot below illustrates the STDP model, showing <strong>how the magnitude of synaptic changes depends on the timing</strong> (<img src="https://latex.codecogs.com/png.latex?%5CDelta%20t">). Positive <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t"> corresponds to presynaptic spikes leading, favoring LTP, while negative <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t"> corresponds to postsynaptic spikes leading, favoring LTD.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parameters for STDP</span></span>
<span id="cb7-2">A_LTP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maximum potentiation amplitude</span></span>
<span id="cb7-3">tau_LTP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LTP time constant</span></span>
<span id="cb7-4">A_LTD <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maximum depression amplitude (negative)</span></span>
<span id="cb7-5">tau_LTD <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LTD time constant</span></span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to compute LTP and LTD effects</span></span>
<span id="cb7-8">STDP_effect <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(delta_t) {</span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(delta_t <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-10">         A_LTP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>delta_t <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> tau_LTP),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LTP for positive delta_t</span></span>
<span id="cb7-11">         A_LTD <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(delta_t <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> tau_LTD))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LTD for negative delta_t</span></span>
<span id="cb7-12">}</span>
<span id="cb7-13"></span>
<span id="cb7-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate data</span></span>
<span id="cb7-15">delta_t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-16">synaptic_changes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(delta_t, STDP_effect)</span>
<span id="cb7-17"></span>
<span id="cb7-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a data frame for plotting</span></span>
<span id="cb7-19">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(delta_t, synaptic_changes)</span>
<span id="cb7-20"></span>
<span id="cb7-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the STDP curve</span></span>
<span id="cb7-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> delta_t, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> synaptic_changes)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spike-Timing-Dependent Plasticity (STDP) Curve"</span>,</span>
<span id="cb7-25">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Difference (Δt, ms)"</span>,</span>
<span id="cb7-26">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Synaptic Change (ΔS)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LTP Zone"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LTD Zone"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-8-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/index_files/figure-html/unnamed-chunk-8-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>This plot captures <strong>the essence of STDP</strong>. It extends the model by introducing <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t"> as a critical parameter, <strong>linking the timing</strong> of neural activity directly <strong>to the direction and magnitude</strong> of synaptic changes. It bridges abstract mathematical functions with tangible biological timing phenomena, making the model more representative of <strong>real neural processes</strong>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Addressing Saturation Effects
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Synaptic strength isn’t infinite, it has <strong>physiological constraints</strong>. However, in the current model, <strong>this limitation is already handled</strong> effectively by the logistic framework and STDP parameters. The logistic function naturally ensures that synaptic strength asymptotes at biologically meaningful <strong>upper and lower bounds</strong>, dictated by parameters like <img src="https://latex.codecogs.com/png.latex?A_%7B%5Ctext%7BLTP%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?A_%7B%5Ctext%7BLTD%7D%7D">. These parameters <strong>cap the magnitude of synaptic changes</strong>, avoiding unbounded potentiation or depression.</p>
<p>Introducing additional saturation mechanisms, such as hard boundaries on <img src="https://latex.codecogs.com/png.latex?S(t)">, would be <strong>redundant in this context</strong>. The plateau behavior of the logistic function inherently <strong>aligns with physiological observations</strong>, maintaining synaptic changes within plausible limits without requiring explicit constraints. This reflects the elegance of using non-linear models: the <strong>boundaries are built into the system’s behavior</strong>, reducing the need for arbitrary external adjustments.</p>
</div>
</div>
</div>
</section>
<section id="simulating-the-extended-model" class="level4">
<h4 class="anchored" data-anchor-id="simulating-the-extended-model">Simulating the Extended Model</h4>
<p>Let’s see these concepts in action using R. By adding the timing-dependent amplitudes and enforcing strength limits, we <strong>upgrade our model</strong> to reflect these new dynamics.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parameters for STDP-based dynamics</span></span>
<span id="cb8-2">A_LTP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb8-3">tau_LTP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb8-4">A_LTD <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb8-5">tau_LTD <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span></span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># STDP-based amplitude functions</span></span>
<span id="cb8-8">amplitude_LTP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(delta_t, A_LTP, tau_LTP) {</span>
<span id="cb8-9">  A_LTP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(delta_t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> tau_LTP)</span>
<span id="cb8-10">}</span>
<span id="cb8-11"></span>
<span id="cb8-12">amplitude_LTD <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(delta_t, A_LTD, tau_LTD) {</span>
<span id="cb8-13">  A_LTD <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(delta_t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> tau_LTD)</span>
<span id="cb8-14">}</span>
<span id="cb8-15"></span>
<span id="cb8-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extended model with saturation effects</span></span>
<span id="cb8-17">extended_synaptic_strength <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(t, S_baseline, </span>
<span id="cb8-18">                                       t_LTP, lambda_LTP, A_LTP, tau_LTP, </span>
<span id="cb8-19">                                       t_LTD, lambda_LTD, A_LTD, tau_LTD, </span>
<span id="cb8-20">                                       delta_t) {</span>
<span id="cb8-21">  S_baseline <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-22">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">amplitude_LTP</span>(delta_t, A_LTP, tau_LTP) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>lambda_LTP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (t <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t_LTP))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb8-23">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">amplitude_LTD</span>(delta_t, A_LTD, tau_LTD) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>lambda_LTD <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (t <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t_LTD)))</span>
<span id="cb8-24">}</span>
<span id="cb8-25"></span>
<span id="cb8-26">delta_t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example time difference between spikes</span></span>
<span id="cb8-27"></span>
<span id="cb8-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate the extended model</span></span>
<span id="cb8-29">S_extended <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(delta_t, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb8-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta_t =</span> x, </span>
<span id="cb8-31">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time,</span>
<span id="cb8-32">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strength =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extended_synaptic_strength</span>(time, S_baseline, </span>
<span id="cb8-33">                                                   t_LTP, lambda_LTP, A_LTP, tau_LTP, </span>
<span id="cb8-34">                                                   t_LTD, lambda_LTD, A_LTD, tau_LTD, </span>
<span id="cb8-35">                                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta_t =</span> x) )</span>
<span id="cb8-36">}) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbindlist</span>()</span></code></pre></div>
</details>
</div>
<p>With this setup, our model now considers both the <strong>timing of spikes</strong> and the <strong>physiological constraints</strong> on synaptic strength.</p>
</section>
<section id="visualizing-the-extended-model" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-the-extended-model">Visualizing the Extended Model</h4>
<p>Let’s plot the extended model to visualize these added dynamics.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the extended synaptic strength</span></span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(S_extended, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> strength, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ordered</span>(delta_t))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> delta_t), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Extended Synaptic Strength with Dynamics"</span>,</span>
<span id="cb9-6">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (arbitrary units)"</span>,</span>
<span id="cb9-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Synaptic Strength"</span>,</span>
<span id="cb9-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(Delta<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">italic</span>(t)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Between Spikes"</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-10-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/index_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>The plot reveals two key features:</p>
<ol type="1">
<li><strong>STDP Influence</strong>: LTP and LTD magnitudes decay and flow based on spike timing (<img src="https://latex.codecogs.com/png.latex?%5CDelta%20t">), showing how temporal precision can shape neural connections.</li>
<li><strong>Saturation Effects</strong>: Synaptic strength remains bounded thanks to parameters like <img src="https://latex.codecogs.com/png.latex?A_%7B%5Ctext%7BLTP%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?A_%7B%5Ctext%7BLTD%7D%7D">, showcasing the physiological checks and balances that prevent runaway excitation or extreme depression.</li>
</ol>
</section>
<section id="further-extensions" class="level4">
<h4 class="anchored" data-anchor-id="further-extensions">Further Extensions</h4>
<p>What’s next? We could incorporate <strong>frequency-dependent plasticity</strong> to explore how high-frequency stimulation turbocharges LTP or how low-frequency inputs foster LTD. Or we could unleash this model on a <strong>network of neurons</strong> to study how multiple synapses interact. The possibilities are endless!</p>
<p>By extending the model, we’re not just adding bells and whistles. We’re <strong>crafting a tool</strong> that captures the messy, dynamic beauty of real-world synaptic plasticity.</p>
</section>
</section>
<section id="exploring-parameter-effects" class="level1 page-columns page-full">
<h1>Exploring Parameter Effects</h1>
<p>Our extended model is like a well-equipped chemistry set for the brain, where <strong>each parameter represents a crucial ingredient</strong> in the recipe of synaptic plasticity. By varying these parameters, we can simulate <strong>how neurons behave under different conditions</strong>, from hyperactive learning states to subdued inhibition. This section focus on how key parameters influence the model’s behavior, explores their <strong>biological significance</strong>, and demonstrates how to experiment with them in R to uncover fascinating insights.</p>
<section id="sensitivity-analysis" class="level4">
<h4 class="anchored" data-anchor-id="sensitivity-analysis">Sensitivity Analysis</h4>
<p>Sensitivity analysis is a systematic way of tweaking the model’s parameters <strong>to observe their impact on synaptic strength</strong>. It’s <strong>akin to turning the dials on a stereo system</strong> to find the perfect sound balance, adjusting bass, treble, and volume to craft the desired output. In our case, the knobs control properties like <strong>calcium dynamics</strong>, <strong>synaptic decay rates</strong>, and <strong>baseline strength</strong>. These adjustments not only refine the model but also provide valuable biological insights into how real-life neurons might behave in various scenarios, <strong>from learning and memory</strong> formation to <strong>neurological disorders</strong>.</p>
<p>Here’s an example of how you can experiment with the parameters in R to visualize their effects:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define a range of parameter values</span></span>
<span id="cb10-2">lambda_LTP_vals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example: Steepness of LTP</span></span>
<span id="cb10-3">lambda_LTD_vals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example: Steepness of LTD</span></span>
<span id="cb10-4"></span>
<span id="cb10-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate model for different parameters</span></span>
<span id="cb10-6">results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand.grid</span>(</span>
<span id="cb10-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">S_baseline =</span> S_baseline, </span>
<span id="cb10-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t_LTP =</span> t_LTP, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda_LTP =</span> lambda_LTP_vals, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">A_LTP =</span> A_LTP, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tau_LTP =</span> tau_LTP,</span>
<span id="cb10-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t_LTD =</span> t_LTD, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda_LTD =</span> lambda_LTD_vals, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">A_LTD =</span> A_LTD, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tau_LTD =</span> tau_LTD,</span>
<span id="cb10-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta_t =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb10-11">)</span>
<span id="cb10-12">results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>strength <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mapply</span>(extended_synaptic_strength, </span>
<span id="cb10-13">                           results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time, results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>S_baseline,</span>
<span id="cb10-14">                           results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>t_LTP, results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lambda_LTP, results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>A_LTP, results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>tau_LTP,</span>
<span id="cb10-15">                           results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>t_LTD, results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lambda_LTD, results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>A_LTD, results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>tau_LTD,</span>
<span id="cb10-16">                           results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>delta_t)</span>
<span id="cb10-17"></span>
<span id="cb10-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot sensitivity to lambda parameters</span></span>
<span id="cb10-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(results, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> strength)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ordered</span>(lambda_LTD, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> lambda_LTD_vals, </span>
<span id="cb10-21">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LTD Growth Rate = "</span>, lambda_LTD_vals)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ordered</span>(lambda_LTP)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sensitivity Analysis: Impact of LTP and LTP Rate"</span>,</span>
<span id="cb10-24">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (arbitrary units)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Synaptic Strength"</span>,</span>
<span id="cb10-25">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LTP Decay Rate"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-11-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/index_files/figure-html/unnamed-chunk-11-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="from-model-parameters-to-biological-applications" class="level4">
<h4 class="anchored" data-anchor-id="from-model-parameters-to-biological-applications">From Model Parameters to Biological Applications</h4>
<p>The calcium oscillation amplitude, <img src="https://latex.codecogs.com/png.latex?A_%7B%5Ctext%7BLTP%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?A_%7B%5Ctext%7BLTD%7D%7D">, <strong>dictates the maximum strength</strong> of synaptic potentiation and depression. <strong>Imagine these amplitudes as the size of a neuron’s emotional response</strong>, whether it leaps for joy (LTP) or sighs deeply in despair (LTD). Increasing <img src="https://latex.codecogs.com/png.latex?A_%7B%5Ctext%7BLTP%7D%7D"> simulates a brain on overdrive, as in heightened learning states, while lowering it mirrors synaptic inhibition or even neurodegeneration.</p>
<p>The decay constants, <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B%5Ctext%7BLTP%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Ctau_%7B%5Ctext%7BLTD%7D%7D">, add a temporal layer to this story. These parameters determine <strong>how quickly the effects of potentiation and depression fade over time</strong>, similar to how fast a good mood or a bad one dissipates. <strong>Short decay constants</strong> are like fleeting bursts of inspiration, ideal for circuits needing rapid adaptation, such as the visual system. In contrast, <strong>long decay constants</strong> suit processes like memory consolidation in the hippocampus, where stability over time is crucial.</p>
<p>Growth rates, denoted by <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B%5Ctext%7BLTP%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B%5Ctext%7BLTD%7D%7D">, control <strong>how steeply synaptic strength transitions in response to stimuli</strong>. Think of these as the sensitivity of a neuron’s accelerator pedal. <strong>A steep curve</strong> means the synapse reacts instantly to changes, akin to a sprinter’s quick start. <strong>Shallow growth rates</strong>, on the other hand, are like a marathon runner pacing themselves, better reflecting gradual changes in long-term neural adaptation.</p>
<p>Finally, the baseline synaptic strength, <img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bbaseline%7D%7D">, <strong>sets the initial tone of the model</strong>. This parameter represents the synapse’s “default mood” <strong>before any plasticity occurs</strong>. Adjusting <img src="https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7Bbaseline%7D%7D"> allows us to model different <strong>starting conditions</strong>, from a highly potentiated synapse involved in an established skill to a depressed one, such as in the aging brain or during neurodegeneration.</p>
</section>
<section id="further-applications" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="further-applications">Further Applications</h4>
<p>Exploring these parameters <strong>is not just a theoretical exercise</strong>; it has practical applications in neuroscience research and beyond. Researchers can use sensitivity analysis <strong>to design experiments</strong> or predict neuronal responses to stimuli. Educators can use these <strong>simulations as teaching tools</strong> to demonstrate the complexity of synaptic plasticity. Clinicians might find such models useful for <strong>exploring the effects of treatments</strong> targeting synaptic mechanisms, providing insights into potential therapies for conditions like Alzheimer’s disease or epilepsy.</p>
<p>Ultimately, parameter exploration transforms our model into a versatile tool for <strong>understanding the dynamic interplay of synaptic mechanisms</strong>. It serves as a gateway to uncovering the mysteries of <strong>learning, memory, and neurological disorders</strong> while offering practical insights into experimental and therapeutic approaches.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define a range of parameter values</span></span>
<span id="cb11-2">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1234</span>)</span>
<span id="cb11-4">vals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb11-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">synapse_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(n),</span>
<span id="cb11-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">S_baseline =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>),</span>
<span id="cb11-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t_LTP =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>),</span>
<span id="cb11-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t_LTD =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>),</span>
<span id="cb11-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda_LTP =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>),</span>
<span id="cb11-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda_LTD =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>),</span>
<span id="cb11-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">A_LTP =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>),</span>
<span id="cb11-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">A_LTD =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>),</span>
<span id="cb11-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tau_LTP =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>),</span>
<span id="cb11-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tau_LTD =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb11-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta_t =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb11-16">)</span>
<span id="cb11-17"></span>
<span id="cb11-18">vals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> vals[vals[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> time), synapse_id], on <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"synapse_id"</span>]</span>
<span id="cb11-19"></span>
<span id="cb11-20">vals[, synapse_strength <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extended_synaptic_strength</span>(</span>
<span id="cb11-21">  t, S_baseline, t_LTP, lambda_LTP, A_LTP, tau_LTP, </span>
<span id="cb11-22">  t_LTD, lambda_LTD, A_LTD, tau_LTD, delta_t</span>
<span id="cb11-23">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(t), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>), synapse_id]</span>
<span id="cb11-24"></span>
<span id="cb11-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot sensitivity to lambda parameters</span></span>
<span id="cb11-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(vals, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> t, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> synapse_strength)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> synapse_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray85"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray20"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_summary</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"line"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simulating Many Synapses: Stochastic Processes"</span>,</span>
<span id="cb11-32">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (arbitrary units)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Synaptic Strength"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LTP"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LTD"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-12-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Orange line denotes the mean synaptic strength over time. Horizontal dashed line denotes the zero-change value associated with no variations in synaptic strength. LTP, long-term potentiation; LTD, long-term depression."><img src="https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/index_files/figure-html/unnamed-chunk-12-1.svg" class="img-fluid figure-img" alt="Orange line denotes the mean synaptic strength over time. Horizontal dashed line denotes the zero-change value associated with no variations in synaptic strength. LTP, long-term potentiation; LTD, long-term depression."></a></p>
<figcaption class="margin-caption">Orange line denotes the mean synaptic strength over time. Horizontal dashed line denotes the zero-change value associated with no variations in synaptic strength. LTP, long-term potentiation; LTD, long-term depression.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="final-remarks" class="level1 page-columns page-full">
<h1>Final Remarks</h1>
<p>Embarking on this journey through non-linear modeling of <strong>neuronal plasticity</strong>, we’ve uncovered the intricate dynamics of <strong>how synaptic strength shifts over time</strong> under the competing forces of LTP and LTD. By leveraging <strong>coupled logistic functions</strong>, we’ve illuminated the non-linear and time-sensitive nature of synaptic changes, emphasizing the <strong>crucial role of calcium oscillations</strong> as the molecular metronomes orchestrating these processes.</p>
<p>Throughout this exploration, <strong>several pivotal lessons can be drawn</strong>. Logistic functions proved to be elegant tools for <strong>capturing the threshold-dependent behavior</strong> of synaptic transitions, moving beyond gradual shifts to reveal the tipping points <strong>inherent in plasticity</strong>. Moreover, we’ve seen how <strong>tweaking parameters</strong> like calcium amplitude or decay rates <strong>can profoundly alter synaptic behavior</strong>, echoing the biological reality where minor molecular adjustments yield vastly different functional outcomes. Finally, the extended model demonstrated its robustness by integrating dynamic <strong>temporal dependencies</strong> and <strong>saturation effects</strong>, offering a nuanced depiction of synaptic adaptation to stimuli.</p>
<p>This is but the tip of the iceberg. The framework we’ve developed invites exploration into <strong>countless other physiological processes</strong> where non-linear dynamics reign supreme. Consider <strong>extending these concepts to other forms of plasticity</strong>, such as structural changes in dendrites or the fine-tuning of synaptic homeostasis. Similar models can be applied to <strong>cardiac autonomic modulation</strong><sup>1</sup>, where the balance of sympathetic and parasympathetic activity <strong>echoes the interplay of LTP and LTD</strong>. Or consider the feedback loops governing hormonal or metabolic regulation, fertile grounds for non-linear interactions.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;A big surprise in this regard is coming up for the next post!!</p></div></div><p>For the intrepid explorer of neuronal plasticity, <strong>there’s much to be done</strong>. Experiment with the model’s parameters, simulate pathological scenarios, or <strong>challenge the boundaries of its assumptions</strong>. With each iteration, you’ll not only refine your understanding of synaptic plasticity but also contribute to the broader pursuit of understanding life’s complexities <strong>through mathematics and computation</strong>.</p>
<p>Neuroscience (or science in general) thrives at the nexus of <strong>theory, experimentation, and computation</strong>. Non-linear models are indispensable in <strong>bridging these fields</strong>, revealing the brain’s staggering capacity for adaptation and resilience. Whether you’re a scientist, student, or curious mind, there’s always room to stay inquisitive, tinker with ideas, and <strong>push the boundaries of what we know</strong>.</p>
<p>So, grab your equations, fire up R, and <strong>let curiosity lead the way</strong>. Biology and mathematics are waiting to converge in ways that can transform how we understand the very essence of life. Stay curious, and <strong>never stop exploring</strong>!</p>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-krystal2024ketamine" class="csl-entry">
Krystal, John H, Ege T Kavalali, and Lisa M Monteggia. 2024. <span>“Ketamine and Rapid Antidepressant Action: New Treatments and Novel Synaptic Signaling Mechanisms.”</span> <em>Neuropsychopharmacology</em> 49 (1): 41–50.
</div>
<div id="ref-lisman2012mechanisms" class="csl-entry">
Lisman, John, Ryohei Yasuda, and Sridhar Raghavachari. 2012. <span>“Mechanisms of CaMKII Action in Long-Term Potentiation.”</span> <em>Nature Reviews Neuroscience</em> 13 (3): 169–82.
</div>
<div id="ref-malenka2003long" class="csl-entry">
Malenka, Robert C. 2003. <span>“The Long-Term Potential of LTP.”</span> <em>Nature Reviews Neuroscience</em> 4 (11): 923–26.
</div>
<div id="ref-scott2023adaptive" class="csl-entry">
Scott, Daniel N, and Michael J Frank. 2023. <span>“Adaptive Control of Synaptic Plasticity Integrates Micro-and Macroscopic Network Function.”</span> <em>Neuropsychopharmacology</em> 48 (1): 121–44.
</div>
<div id="ref-yasuda2022camkii" class="csl-entry">
Yasuda, Ryohei, Yasunori Hayashi, and Johannes W Hell. 2022. <span>“CaMKII: A Central Molecular Organizer of Synaptic Plasticity, Learning and Memory.”</span> <em>Nature Reviews Neuroscience</em> 23 (11): 666–82.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{castillo-aguilar2024,
  author = {Castillo-Aguilar, Matías},
  title = {Non-Linear Models: {A} {Case} for {Synaptic} {Plasticity}},
  date = {2024-12-14},
  url = {https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/},
  doi = {10.59350/mgpv2-d5e33},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-castillo-aguilar2024" class="csl-entry quarto-appendix-citeas">
Castillo-Aguilar, Matías. 2024. <span>“Non-Linear Models: A Case for
Synaptic Plasticity.”</span> December 14, 2024. <a href="https://doi.org/10.59350/mgpv2-d5e33">https://doi.org/10.59350/mgpv2-d5e33</a>.
</div></div></section></div> ]]></description>
  <category>non-linear</category>
  <category>educational</category>
  <category>neuroscience</category>
  <guid>https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/</guid>
  <pubDate>Sat, 14 Dec 2024 03:00:00 GMT</pubDate>
  <media:content url="https://bayesically-speaking.com/posts/2024-12-10 a-case-for-synaptic-plasticity/body_1.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Non-linear models: Pharmacokinetics and Indomethacin</title>
  <dc:creator>Matías Castillo-Aguilar</dc:creator>
  <link>https://bayesically-speaking.com/posts/2024-08-05 non-linear-models part 1/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Let’s be honest, being a statistician or a scientist <strong>isn’t just about crunching numbers all day</strong>. It’s more like being a detective, a problem solver, and yeah, throwing in some math for good measure. When we get into <strong>non-linear models</strong>, things really start to get interesting. We’re not just drawing straight lines anymore; we’re wrestling with curves, untangling complicated relationships, and trying to figure out <strong>what’s really going on behind the scenes</strong>.</p>
<p>Take pharmacokinetics, for example. Sounds fancy, right? But at the core, it’s just about what happens to a drug inside the body, and for us, that’s where the real statistical fun begins. Predicting how a <strong>drug’s concentration changes</strong> in the bloodstream over time isn’t just about plotting some points and calling it a day. It’s about <strong>understanding how the data dances with biology</strong>, and then figuring out the best way to describe that dance. And let’s not forget the little thrill of choosing your weapon: Frequentist or Bayesian? It’s like deciding between coffee or mate (and let’s be real, I’m down for both). Each one has its perks, but the choice depends on the situation, and maybe how you’re feeling that day.</p>
<p>In this post, we’re going to roll up our sleeves and dig into <strong>building a non-linear model</strong> to predict how something, let’s say, a drug disappears from the bloodstream. But we’re not stopping there. Nope, we’re also going to throw in a showdown between two big players: the frequentist and Bayesian methods. Think of it like a friendly face-off between two old rivals, each with its own style, strengths, and die-hard fans.</p>
<p>But here’s the thing: this <strong>isn’t just about which method wins on paper</strong>. It’s about the real-life, day-to-day grind of working with data. It’s about those moments when you’re staring at your screen, trying to make sense of a stubborn parameter that just won’t cooperate. It’s about knowing when to trust the numbers and when to rely on your gut, your experience, and maybe even a bit of luck.</p>
<p>So whether you’re a seasoned pro who’s been around the block or someone just dipping their toes into the world of applied stats, this post is for you. We’re going to dive in, compare, and yeah, maybe even have a little fun along the way. Because in the world of science and stats, the journey is half the adventure.</p>
</section>
<section id="a-drug-example" class="level1">
<h1>A drug example</h1>
<p>Traditionally, when using frequentist tools for inference, we often focus on estimating a single effect of interest. For example, let’s consider <strong>estimating the plasma concentrations</strong> of the anti-inflammatory drug indomethacin <strong>over several hours</strong>. We observe the following behavior</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(Indometh)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(Indometh, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, conc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> Subject)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plasma levels (mcg/ml)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (hours)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-2-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://bayesically-speaking.com/posts/2024-08-05 non-linear-models part 1/index_files/figure-html/unnamed-chunk-2-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Even though this is clearly a non-linear problem, just for the sake of learning and illustrating how would it look, we’ll fit a <strong>simple linear model</strong> to the data. For this, even though is a simple linear model, we still need to specify the model we are fitting <strong>to understand what the model is implying</strong> about the relationship:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Ay_i%20&amp;%5Csim%20%5Cmathcal%7BN%7D(%5Cmu_i,%20%5Csigma)%20%5C%5C%0A%5Cmu_i%20&amp;=%20%5Cbeta_0%20+%20%5Cbeta_1%20%5Ccdot%20time_i%0A%5Cend%7Baligned%7D%0A"></p>
<p>This is a the standard linear model, in which we are assuming that for each observation <img src="https://latex.codecogs.com/png.latex?i">, indomethacin plasma levels <img src="https://latex.codecogs.com/png.latex?y_i"> comes from a normal distribution with mean <img src="https://latex.codecogs.com/png.latex?%5Cmu_i">, and standard deviation <img src="https://latex.codecogs.com/png.latex?%5Csigma">. Additionally, the intercept <img src="https://latex.codecogs.com/png.latex?%5Cbeta_0"> indicates the plasma levels when time is zero. The <img src="https://latex.codecogs.com/png.latex?%5Cbeta_1"> coefficient indicates the slope at which the pass of time changes the plasma levels in indomethacin, <strong>assuming the change is linear and constant through time</strong> (which by the previous plot, we can assure is not linear).</p>
<p>All models can replicate in some approximate manner the data generation process by which we observe many phenomena in real world scenarios. This is a good thing about writing down your models in equations; it becomes clear <strong>what the data generation process is</strong>, whether is correct or not.</p>
<p>In addition, we need to be very thoughtful about the not-so-obvious implications of a model when trying to force the data to fit the model. That’s why we should always think to <strong>fit our models to the data and not the data to the models</strong>. But, of course, that is harder given that it require of us to think harder about the problems we are intending to solve, instead to only reporting significant results in order to publish.</p>
<p>One thing that you might noted from the previous model notation, is that we have a <img src="https://latex.codecogs.com/png.latex?%5Cmu"> for each observation but only one <img src="https://latex.codecogs.com/png.latex?%5Csigma"> for the whole <img src="https://latex.codecogs.com/png.latex?y_i">. This implies that the dispersion must be equal for all expected plasma levels <img src="https://latex.codecogs.com/png.latex?%5Cmu_i">, which it could be more or less realistic depending of type the problem you are working with.</p>
<p>Let’s look to the fit of the linear model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">lm_freq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(conc <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> Indometh)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(lm_freq)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = conc ~ 1 + time, data = Indometh)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.5902 -0.2787 -0.1014  0.1579  1.6474 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.11820    0.08542  13.090  &lt; 2e-16 ***
time        -0.18237    0.02258  -8.077 2.36e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4486 on 64 degrees of freedom
Multiple R-squared:  0.5048,    Adjusted R-squared:  0.497 
F-statistic: 65.23 on 1 and 64 DF,  p-value: 2.361e-11</code></pre>
</div>
</div>
<p>This linear model is telling us that the baseline plasma levels of indomethacin at time 0 (<img src="https://latex.codecogs.com/png.latex?%5Cbeta_0">) is 1.12 mcg/ml, which not seems very realistic, specially given that initially, most of the subjects had from 1.6 to 2.4 mcg/ml. The slope for time (<img src="https://latex.codecogs.com/png.latex?%5Cbeta_1">) indicates that for every additional hour, there is a linear decrease in 0.18 mcg/ml in plasma levels of the drug. Let’s see how it looks when we try to fit the model to the original data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">lm_predict <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(cbind, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(lm_freq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se.fit =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,))</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(Indometh, lm_predict), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, conc)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Subject) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plasma levels (mcg/ml)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (hours)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> Subject), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> Subject), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> fit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> se.fit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>), </span>
<span id="cb4-9">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> fit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> se.fit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.975</span>), </span>
<span id="cb4-10">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Subject), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-4-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://bayesically-speaking.com/posts/2024-08-05 non-linear-models part 1/index_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Clearly, our linear model is not doing a good job capturing the non-linear nature of our data (as expected). Up next, we’ll try some non-linear modeling using a more thoughtful approach.</p>
<section id="designing-a-solution" class="level2">
<h2 class="anchored" data-anchor-id="designing-a-solution">Designing a solution</h2>
<p>It appears that the concentration of indomethacin decreases according to an <strong>exponential function</strong> of time. We can model this relationship with:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Ay_i%20&amp;%5Csim%20%5Cmathcal%7BN%7D(%5Cmu_i,%20%5Csigma)%20%5C%5C%0A%5Cmu_i%20&amp;=%20%5Calpha%20+%20%5Cbeta%20%5Ccdot%20%5Cexp(%5Clambda%20%5Ccdot%20time_i)%0A%5Cend%7Baligned%7D%0A"></p>
<p>In this model, <img src="https://latex.codecogs.com/png.latex?%5Clambda"> represents the rate of decay in the plasma concentration of indomethacin (<img src="https://latex.codecogs.com/png.latex?y_i">), starting from a baseline concentration (<img src="https://latex.codecogs.com/png.latex?%5Cbeta">). The term <img src="https://latex.codecogs.com/png.latex?%5Calpha"> estimates the minimum plasma concentration level over the observed time frame. We assume that the variance is constant across expected indomethacin plasma concentrations (<img src="https://latex.codecogs.com/png.latex?%5Cmu">) for each subject (<img src="https://latex.codecogs.com/png.latex?i">).</p>
<p>However, given that we have repeated measurements from multiple individuals, we need to account for variability in the initial plasma concentrations across subjects. To address this, we introduce a random effect (<img src="https://latex.codecogs.com/png.latex?%5Cphi_i">) into the model:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cmu_i%20&amp;=%20%5Calpha%20+%20(%5Cbeta%20+%20%5Cphi_i)%20%5Ccdot%20%5Cexp(%5Clambda%20%5Ccdot%20time_i)%0A%5Cend%7Baligned%7D%0A"></p>
<p>Here, <img src="https://latex.codecogs.com/png.latex?%5Cphi_i"> represents the deviation from the baseline plasma level (<img src="https://latex.codecogs.com/png.latex?%5Cbeta">) for subject <img src="https://latex.codecogs.com/png.latex?i">. We keep <img src="https://latex.codecogs.com/png.latex?%5Clambda"> and <img src="https://latex.codecogs.com/png.latex?%5Calpha"> fixed because we’re interested in estimating population parameters to describe the pharmacokinetics of the drug.</p>
</section>
<section id="nlme-approach" class="level2">
<h2 class="anchored" data-anchor-id="nlme-approach"><code>nlme</code> approach</h2>
<p>Let’s dive into fitting a non-linear model using the <code>nlme</code> R package, which allows us to specify custom model forms:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">nlm_freq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nlme<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nlme</span>(</span>
<span id="cb5-2">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Model previously described</span></span>
<span id="cb5-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> conc <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> phi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> time),</span>
<span id="cb5-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> Indometh,</span>
<span id="cb5-5">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Fixed effects</span></span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixed =</span> alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-7">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Random effects</span></span>
<span id="cb5-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">random =</span> phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> Subject, </span>
<span id="cb5-9">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Starting proposal values</span></span>
<span id="cb5-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixed =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb5-11"></span>
<span id="cb5-12"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Confidence intervals for fixed effects</span></span>
<span id="cb5-13">nlme<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intervals</span>(nlm_freq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">which =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fixed"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Approximate 95% confidence intervals

 Fixed effects:
             lower       est.      upper
alpha   0.09050133  0.1311638  0.1718262
beta    2.36887258  2.8249635  3.2810543
lambda -1.77509197 -1.6140483 -1.4530047</code></pre>
</div>
</div>
<p>Let’s kick things off by looking at where we stand with indomethacin’s plasma levels. At time zero, we’re seeing baseline concentrations hovering around 2.74 mcg/ml. Not too shabby, right? But this little molecule doesn’t stick around for long, our decay rate clocks in at about <img src="https://latex.codecogs.com/png.latex?%5Cexp(-1.61)%20%5Capprox%200.20">, which translates to a swift 80% drop in those levels each hour. Eventually, the levels bottom out at around 0.13 mcg/ml, where the decline takes a bit of a breather.</p>
<p>Now, if you were paying close attention to the code, you might have noticed something interesting: when we’re playing in the frequentist sandbox, particularly with non-linear models, <strong>we’ve got to give the algorithm a little nudge with some starting values</strong>. It’s like setting up the board for a game, these initial values are where the algorithm begins its quest through the likelihood landscape, hunting down the most likely parameters that explain our data. Remember that <a href="https://doi.org/10.59350/fa26y-xa178">previous post about Hamiltonian Monte Carlo?</a> Well, this is a bit like rolling a ball down a hill of parameter space, <strong>but here we’re aiming to land on the single spot</strong> that maximizes our chances of observing the data we have.</p>
<p>But enough with the theory, let’s dive back into our non-linear model and see how these predicted plasma levels measure up against the real-world data we’ve got in hand:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">freq_pred <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(nlm_freq)</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(Indometh, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pred =</span> freq_pred), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, conc)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Subject) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plasma levels (mcg/ml)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (hours)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> Subject), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> pred, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> Subject), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-6-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://bayesically-speaking.com/posts/2024-08-05 non-linear-models part 1/index_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Our model does a decent job fitting the observed data. But what’s the story beyond standard errors? How do we quantify uncertainty in our model parameters? What’s the likelihood of observing a specific decay rate or baseline level? With frequentist methods, our insights are somewhat limited to point estimates and standard errors. We need a broader view.</p>
</section>
<section id="brms-approach" class="level2">
<h2 class="anchored" data-anchor-id="brms-approach"><code>brms</code> approach</h2>
<p>To harness the power of the Bayesian framework, we need to not only define our model but also incorporate prior beliefs about the parameters. Let’s revisit our parameters:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Calpha">: Minimum plasma levels of the drug.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cbeta">: Baseline plasma levels at time zero.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cphi">: Subject-specific deviation from the population <img src="https://latex.codecogs.com/png.latex?%5Cbeta">.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Clambda">: The amount of exponential decay.</li>
</ul>
<p>We’ll assign prior distributions based on prior knowledge and results from our frequentist model. Here’s the prior setup:</p>
<ul>
<li>For <img src="https://latex.codecogs.com/png.latex?%5Calpha">, we’ll use a normal distribution centered around 0.1 mcg/ml with a standard deviation of 0.5 mcg/ml. We’ll truncate this prior at zero, since negative plasma levels aren’t physically meaningful.</li>
<li>For <img src="https://latex.codecogs.com/png.latex?%5Cbeta">, we’ll specify a normal distribution centered around 2.5 mcg/ml with a standard deviation of 3 mcg/ml to avoid overly restricting the parameter space. We’ll also set a lower bound of zero.</li>
<li>For <img src="https://latex.codecogs.com/png.latex?%5Cphi">, we’ll use a normal prior centered on 0.5 mcg/ml with a moderate standard deviation of 2 mcg/ml to capture variability around baseline levels.</li>
<li>For <img src="https://latex.codecogs.com/png.latex?%5Clambda">, we’ll set a weakly informative prior centered around -1 with a standard deviation of 3. This reflects our expectation of a negative decay rate, with the upper bound fixed at zero to prevent increases in plasma levels.</li>
</ul>
<p>The priors for our model parameters are:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Calpha%20&amp;%5Csim%20%5Cmathcal%7BN%7D(0.1,%200.5)%20%5C%5C%0A%5Cbeta%20&amp;%5Csim%20%5Cmathcal%7BN%7D(2.5,%203.0)%20%5C%5C%0A%5Cphi%20&amp;%5Csim%20%5Cmathcal%7BN%7D(0.5,%202.0)%20%5C%5C%0A%5Clambda%20&amp;%5Csim%20%5Cmathcal%7BN%7D(-1.0,%203.0)%20%5C%5C%0A%5Cend%7Baligned%7D%0A"></p>
<p>So now that we have what we need we can already proceed to fit our bayesian non-linear model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">nlme_brms <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm</span>(</span>
<span id="cb8-2">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Formula</span></span>
<span id="cb8-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bf</span>(conc <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> phi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> time),</span>
<span id="cb8-4">               alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> Subject,</span>
<span id="cb8-5">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nl =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb8-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> Indometh,</span>
<span id="cb8-7">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Priors</span></span>
<span id="cb8-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alpha"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lb =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"beta"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lb =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"phi"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lambda"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ub =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb8-12">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## MCMC hyperparameters</span></span>
<span id="cb8-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chains =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4000</span>, </span>
<span id="cb8-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warmup =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb8-15">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## More flexible exploration parameters</span></span>
<span id="cb8-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">adapt_delta =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>, </span>
<span id="cb8-17">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_treedepth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>),</span>
<span id="cb8-18">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## For reproducibility</span></span>
<span id="cb8-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1234</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nlme_brms.RDS"</span></span>
<span id="cb8-20">)</span>
<span id="cb8-21"></span>
<span id="cb8-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fixef</span>(nlme_brms)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Estimate  Est.Error        Q2.5      Q97.5
alpha_Intercept   0.1346163 0.02173654  0.09162845  0.1768141
beta_Intercept    2.6519527 1.44843180  0.24992601  5.7345653
lambda_Intercept -1.6448947 0.09467393 -1.83556844 -1.4659436
phi_Intercept     0.2150963 1.44471628 -2.84981889  2.6512578</code></pre>
</div>
</div>
<p>In this Bayesian model, we get not just point estimates but full distributions for each parameter. This approach allows us to explore the probable range of parameter values and answer probabilistic questions. But first, let’s see how well our Bayesian model fits the observed data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">bmrs_pred <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(nlme_brms)</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(Indometh, bmrs_pred), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, conc)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Subject) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plasma levels (mcg/ml)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (hours)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> Subject), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Estimate, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> Subject), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> Q2<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> Q97<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Subject), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-8-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://bayesically-speaking.com/posts/2024-08-05 non-linear-models part 1/index_files/figure-html/unnamed-chunk-8-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>The Bayesian model’s fitted effects align nicely with the observed data, and the uncertainty around the expected plasma concentrations is well-represented. To explore the range of parameters compatible with our data, we can <strong>plot the posterior distributions</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(nlme_brms, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^b_"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regex =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-9-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://bayesically-speaking.com/posts/2024-08-05 non-linear-models part 1/index_files/figure-html/unnamed-chunk-9-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>These plots reveal a spectrum of parameter values that fit the observed data. For the decay parameter <img src="https://latex.codecogs.com/png.latex?%5Clambda">, we can expect a 78% (<img src="https://latex.codecogs.com/png.latex?1%20-%20%5Cexp(-1.5)">) to 83% (<img src="https://latex.codecogs.com/png.latex?1%20-%20%5Cexp(-1.8)">) decrease in indomethacin plasma concentrations per hour.</p>
<p>We can further explore the posterior distributions. For example, transforming the <img src="https://latex.codecogs.com/png.latex?%5Clambda"> parameter into a percentage decay scale:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">posterior_dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_draws_df</span>(nlme_brms, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b_lambda_Intercept"</span>)</span>
<span id="cb12-2">posterior_dist<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prob_decay <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(posterior_dist<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>b_lambda_Intercept))</span>
<span id="cb12-3"></span>
<span id="cb12-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(posterior_dist, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> prob_decay)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-5">  tidybayes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_halfeye</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Decay of plasma levels per hour (%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-10-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://bayesically-speaking.com/posts/2024-08-05 non-linear-models part 1/index_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>This flexibility in the Bayesian framework allows us to interpret the decay rate in more intuitive terms, reflecting a range of plausible rates consistent with our data. We can now communicate the percent decay of indomethacin plasma levels in a more accessible manner, considering the variability captured by our model.</p>
</section>
<section id="comparing-models" class="level2">
<h2 class="anchored" data-anchor-id="comparing-models">Comparing models</h2>
<p>Now that we’ve implemented linear, non-linear, and Bayesian non-linear models, it’s time to compare their performances. It’s important to remember that each model has its own set of performance metrics, which can make direct comparisons tricky. However, by calculating the root mean square error (RMSE), we can get a sense of the <strong>average error each model makes when predicting plasma levels</strong>. RMSE gives us a tangible measure of error on the same scale as our predictor, helping us gauge how well each model is performing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb13-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lm =</span> performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance_rmse</span>(lm_freq),</span>
<span id="cb13-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlme =</span> performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance_rmse</span>(nlm_freq),</span>
<span id="cb13-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">brms =</span> performance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">performance_rmse</span>(nlme_brms)</span>
<span id="cb13-5">)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         lm      nlme      brms
1 0.4417804 0.1080546 0.1077213</code></pre>
</div>
</div>
<p>Here, we can see that <strong>both the frequentist and Bayesian non-linear models outperformed the simple linear model</strong> by a significant margin. The lower RMSE values indicate a better overall fit. Interestingly, the Bayesian model edged out the frequentist model by a tiny margin, with a difference of just 0.000402 mcg/ml in RMSE (<img src="https://latex.codecogs.com/png.latex?%5Ctext%7BRMSE%7D(M_%7Bnlme%7D)%20-%20%5Ctext%7BRMSE%7D(M_%7Bbrms%7D)">). Given that the standard deviation of the plasma levels is 0.63 mcg/ml, this difference is practically negligible and unlikely to be meaningful in a real-world context.</p>
</section>
</section>
<section id="final-remarks" class="level1">
<h1>Final Remarks</h1>
<p>After fitting three different models (two of which were non-linear) it becomes apparent that model selection isn’t just a mechanical task; <strong>it’s a deliberate and thoughtful process that requires us to deeply consider the scientific meaning behind the equations we use</strong>. This is where the art of modeling comes into play. Simply plugging numbers into an algorithm can give you results, but those results are only as meaningful as the assumptions underpinning them.</p>
<p>When we lay down equations, we’re not just scribbling mathematical symbols; we’re making statements about how we believe the world works. In the case of indomethacin, <strong>our model reflects the assumption that its plasma levels decay exponentially over time</strong>, a reasonable assumption based on pharmacokinetic principles. But it’s also crucial to remember that every equation carries with it a set of assumptions, some explicit and others hidden beneath layers of mathematical complexity. Recognizing and challenging these assumptions is where the real insight lies.</p>
<p>Historically, the evolution of statistical modeling has been shaped by this very tension between complexity and clarity. Think back to the early days of regression analysis in the 19th century when pioneers like <a href="https://doi.org/10.1080/10691898.2001.11910537">Francis Galton and Karl Pearson</a> were laying the groundwork for modern statistics. They weren’t just crunching numbers, they were developing tools to describe the relationships they observed in the natural world. Their work was as much about understanding the data as it was about interpreting the equations they devised.</p>
<p>Fast forward to today, and the principles remain the same, even as our tools have become more sophisticated. The move from linear to non-linear models mirrors our growing understanding of the world’s complexities. We know now that relationships aren’t always straight lines; they can bend, twist, and curve in ways that linear models can’t capture. Yet, <strong>with this power comes responsibility</strong>. Non-linear models, while more flexible, <strong>also require us to be more vigilant about the assumptions we’re making</strong>.</p>
<p>As we’ve seen with our indomethacin example, the choice of model has a profound impact on the conclusions we draw. The frequentist and Bayesian approaches each bring their own perspectives, but <strong>neither is inherently superior</strong>. Instead, the best approach depends on the context of the problem and the nature of the data. In the end, the goal isn’t to find the “right” model but <strong>to find a model that best captures the underlying reality we’re trying to understand</strong>.</p>
<p>So, as we continue to develop and apply statistical models, let’s do so with a sense of curiosity and caution. Let’s appreciate the historical context that brought us here, and let’s always be aware of the assumptions we’re making, because in the world of statistics, those assumptions shape the stories we tell.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{castillo-aguilar2024,
  author = {Castillo-Aguilar, Matías},
  title = {Non-Linear Models: {Pharmacokinetics} and {Indomethacin}},
  date = {2024-08-20},
  url = {https://bayesically-speaking.com/posts/2024-08-05 non-linear-models part 1/},
  doi = {10.59350/r62fn-8h720},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-castillo-aguilar2024" class="csl-entry quarto-appendix-citeas">
Castillo-Aguilar, Matías. 2024. <span>“Non-Linear Models:
Pharmacokinetics and Indomethacin.”</span> August 20, 2024. <a href="https://doi.org/10.59350/r62fn-8h720">https://doi.org/10.59350/r62fn-8h720</a>.
</div></div></section></div> ]]></description>
  <category>non-linear</category>
  <category>educational</category>
  <category>inference</category>
  <guid>https://bayesically-speaking.com/posts/2024-08-05 non-linear-models part 1/</guid>
  <pubDate>Tue, 20 Aug 2024 03:00:00 GMT</pubDate>
  <media:content url="https://bayesically-speaking.com/posts/2024-08-05 non-linear-models part 1/body_1.webp" medium="image" type="image/webp"/>
</item>
<item>
  <title>The Good, The Bad, and Hamiltonian Monte Carlo</title>
  <dc:creator>Matías Castillo-Aguilar</dc:creator>
  <link>https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1 page-columns page-full">
<h1>Introduction</h1>
<p>Hey there, fellow science enthusiasts and stats geeks! Welcome back to the wild world of Markov Chain Monte Carlo (MCMC) algorithms. This is <strong>part two</strong> of my series on the <strong>powerhouse behind Bayesian Inference</strong>. If you missed the first post, no worries! Just hop on over <a href="https://doi.org/10.59350/mxfyk-6av39">here</a> and catch up before we dive deeper into the MCMC madness. Today, we’re exploring the notorious <strong>Hamiltonian Monte Carlo (HMC)</strong>, a special kind of MCMC algorithm that taps into the dynamics of <strong>Hamiltonian mechanics</strong>.</p>
<section id="stats-meets-physics" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="stats-meets-physics">Stats Meets Physics?</h4>
<p>Hold up, did you say Hamiltonian mechanics? What in the world do mechanics and physics have to do with Bayesian stats? I get it, it sounds like a mashup of your wildest nightmares. But trust me, this algorithm sometimes feels <strong>like running a physics simulation in a statistical playground</strong>. Remember our chat from the <a href="https://doi.org/10.59350/mxfyk-6av39">last post</a>? In Bayesian stats, <strong>we’re all about estimating the shape of a parameter space</strong>, aka the posterior distribution.</p>
<aside>
Fun fact: There’s this whole field called <strong>statistical mechanics</strong> where scientists mix stats and physics to solve cool problems, mostly related to <strong>thermodynamics and quantum mechanics</strong>.
</aside>
</section>
<section id="a-particle-rolling-through-stats-land" class="level4">
<h4 class="anchored" data-anchor-id="a-particle-rolling-through-stats-land">A Particle Rolling Through Stats Land</h4>
<p>Picture this: You drop a tiny particle down a cliff, and it rolls naturally along the landscape’s curves and slopes. Easy, right? <strong>Now, swap out the real-world terrain for a funky high-dimensional probability function</strong>. That same little particle? It’s cruising through this wild statistical landscape like a boss, all thanks to the rules of <strong>Hamiltonian mechanics</strong>.</p>
<div style="text-align: center;">
<iframe width="100%" height="500" src="mcmc-demo-master/app.html" title="MCMC">
</iframe>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About the animation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The previous animation illustrate the <strong>Hamiltonian dynamics of a particle traveling</strong> a two-dimensional parameter space. The code for this animation is borrowed from <a href="https://github.com/chi-feng">Chi Feng’s github</a>. You can find the original repository with corresponding code here: <a href="https://github.com/chi-feng/mcmc-demo" class="uri">https://github.com/chi-feng/mcmc-demo</a></p>
</div>
</div>
</div>
</section>
</section>
<section id="hamiltonian-mechanics-a-childs-play" class="level1 page-columns page-full">
<h1>Hamiltonian Mechanics: A Child’s Play?</h1>
<p>Let’s break down Hamiltonian dynamics <strong>in terms of position and momentum</strong> with a fun scenario: <strong>Imagine you’re on a swing</strong>. When you hit the highest point, you slow down, right? <strong>Your momentum’s almost zero</strong>. But here’s the kicker: You know <strong>you’re about to pick up speed on the way down</strong>, gaining momentum in the opposite direction. That moment when you’re at the top, almost motionless? That’s when you’re losing <strong>kinetic energy</strong> and gaining <strong>potential energy</strong>, thanks to gravity getting ready to pull you back down.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="swing-animation.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Swing Animation"><img src="https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/swing-animation.gif" class="img-fluid figure-img" style="width:100.0%" alt="Swing Animation"></a></p>
<figcaption class="margin-caption">Swing Animation</figcaption>
</figure>
</div>
<p>So, in this analogy, <strong>when your kinetic energy</strong> (think swing momentum) goes up, <strong>your potential energy</strong> (like being at the bottom of the swing) <strong>goes down</strong>. And vice versa! When your kinetic energy drops (like when you’re climbing back up), your potential energy shoots up, waiting for gravity to do its thing.</p>
<p>This <strong>energy dance</strong> is captured by the <strong>Hamiltonian</strong> (<img src="https://latex.codecogs.com/png.latex?H(q,%20p)">), which sums up the <strong>total energy in the system</strong>. It’s the sum of kinetic energy (<img src="https://latex.codecogs.com/png.latex?K(p)">) and potential energy (<img src="https://latex.codecogs.com/png.latex?U(q)">):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AH(q,%20p)%20=%20K(p)%20+%20U(q)%0A"></p>
<p>At its core, Hamiltonian Monte Carlo (HMC) borrows from <strong>Hamiltonian dynamics</strong>, a fancy term for the rules that govern <strong>how physical systems evolve in phase space</strong>. In Hamiltonian mechanics, a system’s all about its position (<img src="https://latex.codecogs.com/png.latex?q">) and momentum (<img src="https://latex.codecogs.com/png.latex?p">), and <strong>their dance is choreographed by Hamilton’s equations</strong>. Brace yourself, things are about to get a little mathy:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cfrac%7B%7Bdq%7D%7D%7B%7Bdt%7D%7D%20&amp;=%20%5Cfrac%7B%7B%5Cpartial%20H%7D%7D%7B%7B%5Cpartial%20p%7D%7D%20%5C%5C%0A%5Cfrac%7B%7Bdp%7D%7D%7B%7Bdt%7D%7D%20&amp;=%20-%5Cfrac%7B%7B%5Cpartial%20H%7D%7D%7B%7B%5Cpartial%20q%7D%7D%0A%5Cend%7Balign%7D%0A"></p>
<section id="wrapping-our-heads-around-the-math" class="level4">
<h4 class="anchored" data-anchor-id="wrapping-our-heads-around-the-math">Wrapping Our Heads Around the Math</h4>
<p>Okay, I know <strong>Hamiltonian dynamics</strong> can be a real <strong>brain-buster</strong>, trust me, it took me a hot minute to wrap my head around it. But hey, I’ve got an analogy that might just make it click. Let’s revisit <strong>our swing scenario</strong>: remember our picture of a kid on a swing, right? <strong>The swing’s angle</strong> from the vertical (<img src="https://latex.codecogs.com/png.latex?q">) tells us <strong>where the kid is</strong>, and momentum (<img src="https://latex.codecogs.com/png.latex?p">) is <strong>how fast</strong> the swing’s moving.</p>
<p>Now, let’s break down those equations:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%7Bdq%7D%7D%7B%7Bdt%7D%7D%20=%20%5Cfrac%7B%7B%5Cpartial%20H%7D%7D%7B%7B%5Cpartial%20p%7D%7D%0A"></p>
<p>This one’s like peeking into the future to see <strong>how the angle</strong> (<img src="https://latex.codecogs.com/png.latex?q">) <strong>changes over time</strong>. And guess what? <strong>It’s all about momentum</strong> (<img src="https://latex.codecogs.com/png.latex?p">). The faster the swing’s going, the quicker it swings back and forth, simple as that!</p>
<p>Next up:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%7Bdp%7D%7D%7B%7Bdt%7D%7D%20=%20-%5Cfrac%7B%7B%5Cpartial%20H%7D%7D%7B%7B%5Cpartial%20q%7D%7D%0A"></p>
<p>Now, this beauty tells us <strong>how momentum</strong> (<img src="https://latex.codecogs.com/png.latex?p">) <strong>changes over time</strong>. It’s all about the energy game here, specifically, <strong>how the swing’s position</strong> (<img src="https://latex.codecogs.com/png.latex?q">) <strong>affects its momentum</strong>. When the swing’s at the highest point, gravity’s pulling hardest, ready to send him back down.</p>
<p>So, picture this:</p>
<ul>
<li>The kid swings forward, so the angle (<img src="https://latex.codecogs.com/png.latex?q">) goes up thanks to the momentum (<img src="https://latex.codecogs.com/png.latex?p">) building until bam, top of the swing.</li>
<li>At the top, the swing’s momentarily still, but gravity’s pulling to send him flying back down, hence, he is accumulating potential energy.</li>
<li>Zoom! Back down it goes, picking up speed in the opposite direction, and so, the potential energy is then transferred into kinetic energy.</li>
</ul>
<p>All the while, the Hamiltonian (<img src="https://latex.codecogs.com/png.latex?H">) is keeping tabs <strong>on the swing’s total energy</strong>, whether it’s zooming at the bottom (high kinetic energy <img src="https://latex.codecogs.com/png.latex?K(p)">, as a function of momentum <img src="https://latex.codecogs.com/png.latex?p">) or pausing at the top (high potential energy <img src="https://latex.codecogs.com/png.latex?U(q)">, as a function of position <img src="https://latex.codecogs.com/png.latex?q">).</p>
<p>This <strong>dance between kinetic and potential energy</strong> is what we care within <strong>Hamiltonian mechanics</strong>, and also what we mean when we refer to the <em>phase space</em>, which it’s nothing more than <strong>the relationship between position and momentum</strong>.</p>
</section>
</section>
<section id="visualizing-hamiltons-equations" class="level1 page-columns page-full">
<h1>Visualizing Hamilton’s Equations</h1>
<p>Okay, I know we’re diving into some <strong>physics territory</strong> here <strong>in a stats blog</strong>, but trust me, understanding these concepts <strong>is key to unlocking what HMC’s all about</strong>. So, let’s take a little side trip and get a feel for Hamilton’s equations with a different example. <strong>Check out the gif below</strong>, see that weight on a string? It’s doing this cool back-and-forth dance thanks to the tug-of-war between the string pulling up and gravity pulling down.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="oscillator.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Simple harmonic oscillator. Within this example we could expect that the potential energy U(q) is the greatest at the bottom or top positions q, primarely because is in these positions that the force exerted by the string is greater, affecting in consequence the kinetic energy K(p) of the mass attached at the bottom of the string."><img src="https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/oscillator.gif" class="img-fluid figure-img" style="width:100.0%" alt="Simple harmonic oscillator. Within this example we could expect that the potential energy U(q) is the greatest at the bottom or top positions q, primarely because is in these positions that the force exerted by the string is greater, affecting in consequence the kinetic energy K(p) of the mass attached at the bottom of the string."></a></p>
<figcaption class="margin-caption">Simple harmonic oscillator. Within this example we could expect that the potential energy <img src="https://latex.codecogs.com/png.latex?U(q)"> is the greatest at the bottom or top positions <img src="https://latex.codecogs.com/png.latex?q">, primarely because is in these positions that the force exerted by the string is greater, affecting in consequence the kinetic energy <img src="https://latex.codecogs.com/png.latex?K(p)"> of the mass attached at the bottom of the string.</figcaption>
</figure>
</div>
<p>Now, let’s get a little hands-on with some code. We’re gonna simulate <strong>a simple harmonic oscillator</strong> (you know, like that weight on a string) and <strong>watch how it moves through phase space</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the potential energy function (U) and its derivative (dU/dq)</span></span>
<span id="cb1-2">U <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(q) {</span>
<span id="cb1-3">  k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spring constant</span></span>
<span id="cb1-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> k <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> q<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-5">}</span>
<span id="cb1-6"></span>
<span id="cb1-7"></span>
<span id="cb1-8">dU_dq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(q) {</span>
<span id="cb1-9">  k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spring constant</span></span>
<span id="cb1-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(k <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> q)</span>
<span id="cb1-11">}</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Kinetic energy (K) used for later</span></span>
<span id="cb1-14">K <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(p, m) {</span>
<span id="cb1-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m))</span>
<span id="cb1-16">}</span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Introduce a damping coefficient</span></span>
<span id="cb1-19">b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Damping coefficient</span></span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up initial conditions</span></span>
<span id="cb1-22">q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial position</span></span>
<span id="cb1-23">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial momentum</span></span>
<span id="cb1-24">m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mass</span></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Time parameters</span></span>
<span id="cb1-27">t_max <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb1-28">dt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb1-29">num_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(t_max <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> dt)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure num_steps is an integer</span></span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize arrays to store position and momentum values over time</span></span>
<span id="cb1-32">q_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(num_steps)</span>
<span id="cb1-33">p_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(num_steps)</span>
<span id="cb1-34"></span>
<span id="cb1-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform time integration using the leapfrog method</span></span>
<span id="cb1-36"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>num_steps) {</span>
<span id="cb1-37">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Store the current values</span></span>
<span id="cb1-38">  q_values[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q</span>
<span id="cb1-39">  p_values[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p</span>
<span id="cb1-40">  </span>
<span id="cb1-41">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Half step update for momentum with damping</span></span>
<span id="cb1-42">  p_half_step <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dU_dq</span>(q) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> m)</span>
<span id="cb1-43">  </span>
<span id="cb1-44">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Full step update for position using the momentum from the half step</span></span>
<span id="cb1-45">  q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (p_half_step <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> m)</span>
<span id="cb1-46">  </span>
<span id="cb1-47">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Another half step update for momentum with damping using the new position</span></span>
<span id="cb1-48">  p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_half_step <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dU_dq</span>(q) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p_half_step <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> m)</span>
<span id="cb1-49">}</span></code></pre></div>
</div>
<aside>
<p><strong>In this code:</strong></p>
<ul>
<li><code>U</code> is the <strong>potential energy</strong> function, kinda like how much energy’s stored in that spring, if you will.</li>
<li><code>K</code> is the <strong>kinetic energy</strong> function, telling us how much energy’s tied up in the speed of the weight.</li>
<li><code>dU_dq</code> is telling us about <strong>how the potential energy changes</strong> with the weight’s position, aka the force.</li>
<li><code>b</code> is just a fancy way of saying <strong>how much energy the system loses</strong> over time.</li>
<li><code>q</code> and <code>p</code> are the weight’s <strong>position</strong> and <strong>momentum</strong>, respectively.</li>
<li><code>m</code> is the <strong>weight’s mass</strong>, nothing fancy.</li>
<li><code>dt</code> is the time step, and <code>num_steps</code>? Well, that’s just <strong>how long we’re gonna keep</strong> this simulation running.</li>
<li>Oh, and that <strong>leapfrog integration</strong>? It’s like stepping through time, updating the momentum, then the position, and back again, but don’t worry about it, we’ll see it shortly.</li>
</ul>
</aside>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">harmonic_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Position (q)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> q_values, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Momentum (p)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> p_values)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(harmonic_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Position (q)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Momentum (p)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_path</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> harmonic_data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Phase Space Trajectory of Hamiltonian Dynamics"</span>,</span>
<span id="cb2-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accounting for Energy Loss"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<aside>
Check out this funky <strong>phase space</strong> trajectory <strong>of a simple harmonic oscillator</strong>! At the furthest points, the <strong>potential energy</strong> is the highest, that’s what’s driving the oscillator back and forth. But in the middle? That’s where the <strong>kinetic energy’s</strong> taking over, keeping things moving, like our example of a kid on a swing!
</aside>
<p>Now, take a look at that graphic. See how the <strong>position</strong> (<img src="https://latex.codecogs.com/png.latex?q">) is all about <strong>where the oscillator’s</strong> hanging out, and <strong>momentum</strong> (<img src="https://latex.codecogs.com/png.latex?p">)? Well, that’s just <strong>how fast the weight’s swinging</strong>. Put them together, and you’ve got what we call the <em>phase space</em>. Basically, it’s like peeking into the dance floor of these mechanical systems through the lenses of Hamiltonian dynamics.</p>
<p>Now, in a perfect world, there’d be <strong>no energy lost over time</strong>. But hey, we like to keep it real, so we added a little something called <strong>damping effect</strong> (think of it <strong>like energy leaking out of the system over time</strong>). In the real world, that makes sense, but <strong>in our statistical playground, we want to keep that energy</strong> locked in tight. After all, losing energy means we’re losing precious info about our target distribution, and nobody wants that.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">hamiltonian <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> harmonic_data[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Total energy</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">U</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Position (q)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">K</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Momentum (p)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, m),</span>
<span id="cb3-2">                                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Kinetic energy</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">K</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Momentum (p)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, m), </span>
<span id="cb3-3">                                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Potential energy</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">U</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Position (q)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>))]</span>
<span id="cb3-4">hamiltonian <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt</span>(hamiltonian, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure.vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total energy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kinetic energy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Potential energy"</span>)) </span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(hamiltonian, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> variable)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Energy"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time"</span>,</span>
<span id="cb3-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fluctuation of the Total Energy in the Oscillator"</span>,</span>
<span id="cb3-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"As a Function of Kinetic and Potential Energy"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qual"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-4-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/index_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<aside>
Check out this energy rollercoaster! This graph’s showing us how the <strong>total energy</strong> (made up of <strong>kinetic and potential energy</strong>) changes over time. And yep, that damping effect? It’s keeping things realistic, but in stats land, we’re all about conserving that energy for our exploration.
</aside>
<p>So, what’s the big takeaway here? Well, whether it’s a <strong>ball rolling down a hill</strong> or a sampler hunting for <strong>model coefficients</strong>, this framework’s got us covered. In Bayesian land, think of <strong>our model’s parameters as position coordinates</strong> <img src="https://latex.codecogs.com/png.latex?q"> in some space, and <img src="https://latex.codecogs.com/png.latex?p"> is the momentum helping us navigate the twists and turns of this parameter space. And with Hamiltonian dynamics leading the way, we’re guaranteed to find our path through this statistical dimension, one step at a time.</p>
</section>
<section id="building-our-own-hamiltonian-monte-carlo" class="level1 page-columns page-full">
<h1>Building our own Hamiltonian Monte Carlo</h1>
<p>Now that we got some intuition about Hamiltonian mechanics, it’s time we build our own HMC sampler. To accomplish this, imagine that we’re diving into some data to figure out <strong>how an independent variable</strong> (<img src="https://latex.codecogs.com/png.latex?x">) <strong>and a dependent variable</strong> (<img src="https://latex.codecogs.com/png.latex?y">) are related. We’re talking about <strong>linear regression</strong> (you know, trying to draw a line through those scattered data points to make sense of it all). But hey, <strong>this is Bayesian territory</strong>, so we’re not just throwing any ol’ line on that plot. No, sir! We’re exploring the parameter space of those regression coefficients (that’s the slope and intercept). Then, when the data rolls in, we’re smashing together that likelihood and those priors <strong>using Bayes’ theorem</strong> to cook up a posterior distribution (<strong>a fancy way of saying</strong> our updated beliefs <strong>about those coefficients</strong> after we’ve seen the data).</p>
<section id="cooking-up-some-data" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="cooking-up-some-data">Cooking Up Some Data</h4>
<p>But before we dive into the statistical kitchen, <strong>let’s whip up some synthetic data</strong>. Picture this: we’re mimicking a real-world scenario where relationships between variables are as murky as a foggy morning. So, we’re gonna <strong>conjure up a batch of data</strong> with a simple linear relationship, jazzed up with a sprinkle of noise. Oh, and <strong>let’s keep it small</strong> (just 20 subjects), ’cause, hey, <strong>science “loves” a manageable sample size</strong>.</p>
<aside>
Emphasis on double quotes on “loves”.
</aside>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set seed for reproducibility</span></span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the number of data points and the range of independent variable 'x'</span></span>
<span id="cb4-4">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb4-5">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> n)</span></code></pre></div>
</div>
<p>Okay, so now let’s get down to business and fit ourselves a nice, cozy <strong>linear relationship</strong> between an independent variable (<img src="https://latex.codecogs.com/png.latex?x">) and a dependent variable (<img src="https://latex.codecogs.com/png.latex?y">). We’re talking about laying down <strong>a straight line</strong> that best describes how <img src="https://latex.codecogs.com/png.latex?y"> changes with <img src="https://latex.codecogs.com/png.latex?x">.</p>
<p>So, what’s our equation look like? Well, it’s pretty simple:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Ay_i%20&amp;%5Csim%20%5Cmathcal%7BN%7D(%5Cmu_i,%20%5Csigma%5E2)%20%5C%5C%0A%5Cmu_i%20&amp;=%20%5Cbeta_0%20+%20%5Cbeta_1%20%5Ccdot%20x_i%20%5C%5C%0A%5Cend%7Baligned%7D%0A"></p>
<p>Hold on, let’s break it down. We’re saying that each <img src="https://latex.codecogs.com/png.latex?y"> value (<img src="https://latex.codecogs.com/png.latex?y_i">) is chillin’ around a mean (<img src="https://latex.codecogs.com/png.latex?%5Cmu_i">), like a bunch of friends at a party. And guess what? <strong>They’re all acting like good ol’ normal folks</strong>, hanging out with a variance (<img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2">) that tells us <strong>how spread out they are</strong>. Now, the cool part is how we define <img src="https://latex.codecogs.com/png.latex?%5Cmu_i">. It’s <strong>just a simple sum</strong> of an intercept (<img src="https://latex.codecogs.com/png.latex?%5Cbeta_0">) and the slope (<img src="https://latex.codecogs.com/png.latex?%5Cbeta_1">) times <img src="https://latex.codecogs.com/png.latex?x_i">. Think of it like plotting points on graph paper, each <img src="https://latex.codecogs.com/png.latex?x_i"> tells us where we are on the <img src="https://latex.codecogs.com/png.latex?x">-axis, and multiplying by <img src="https://latex.codecogs.com/png.latex?%5Cbeta_1"> <strong>gives us the corresponding height on the line</strong>.</p>
<p>Now, let’s talk numbers. We’re <strong>setting</strong> <img src="https://latex.codecogs.com/png.latex?%5Cbeta_0"> <strong>to 2</strong> because, hey, every relationship needs a starting point, right? And for <img src="https://latex.codecogs.com/png.latex?%5Cbeta_1">, <strong>we’re going with 3</strong> (<strong>that’s the rate of change</strong> we’re expecting for every unit increase in <img src="https://latex.codecogs.com/png.latex?x">. Oh, and let’s not forget about <img src="https://latex.codecogs.com/png.latex?%5Csigma">), that’s just a fancy way of saying how much our <img src="https://latex.codecogs.com/png.latex?y"> values <strong>are allowed to wiggle around</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the true parameters of the linear model and the noise level</span></span>
<span id="cb5-2">true_intercept <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-3">true_slope <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb5-4">sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span></code></pre></div>
</div>
<p>With our model all set up, <strong>it’s time to create some data points</strong> for our <img src="https://latex.codecogs.com/png.latex?y"> variable. We’ll do this using the <code>rnorm()</code> function, which is like a magical data generator for <strong>normally distributed variables</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate the dependent variable 'y' with noise</span></span>
<span id="cb6-2">mu_i <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> true_intercept <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> true_slope <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x</span>
<span id="cb6-3">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n, mu_i, sigma)</span></code></pre></div>
</div>
</section>
<section id="choosing-a-target-distribution" class="level4">
<h4 class="anchored" data-anchor-id="choosing-a-target-distribution">Choosing a Target Distribution</h4>
<p>Alright, now that we’ve got our hands on some data, it’s time to dive into the <strong>nitty-gritty of Bayesian stuff</strong>. First up, we’re gonna need our trusty <strong>log likelihood function</strong> for our <strong>linear model</strong>. This function’s like the Sherlock Holmes of statistics, it figures out <strong>the probability of seeing our data</strong> given a specific set of parameters (you know, the intercept and slope we’re trying to estimate).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the log likelihood function for linear regression</span></span>
<span id="cb7-2">log_likelihood <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(intercept, slope, x, y, sigma) {</span>
<span id="cb7-3">  </span>
<span id="cb7-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We estimate the predicted response</span></span>
<span id="cb7-5">  y_pred <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> intercept <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> slope <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x </span>
<span id="cb7-6">  </span>
<span id="cb7-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Then we see how far from the observed value we are</span></span>
<span id="cb7-8">  residuals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_pred</span>
<span id="cb7-9">  </span>
<span id="cb7-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Then we estimate the likelihood associated with that error from a distribution</span></span>
<span id="cb7-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># with no error (mean = 0)</span></span>
<span id="cb7-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (this is the function that we are trying to maximize)</span></span>
<span id="cb7-13">  log_likelihood <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(residuals, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> sigma, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) )</span>
<span id="cb7-14">  </span>
<span id="cb7-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(log_likelihood)</span>
<span id="cb7-16">}</span></code></pre></div>
</div>
<p>So, what’s the deal with <strong>priors</strong>? Well, think of them as the background music to our data party. <strong>They’re like our initial hunches</strong> about what the parameters could be before we’ve even glanced at the data. To keep things simple, <strong>we’ll go with flat priors</strong> (no favoritism towards any particular values). It’s like saying, “Hey, let’s give everyone a fair shot!”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the log prior function for the parameters</span></span>
<span id="cb8-2">log_prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(intercept, slope) {</span>
<span id="cb8-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assuming flat priors for simplicity</span></span>
<span id="cb8-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (the log of 0 is 1, so it has no effect)</span></span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) </span>
<span id="cb8-6">}</span></code></pre></div>
</div>
<p>Now, here’s where the real magic kicks in. <strong>We bring our likelihood and priors together</strong> in a beautiful dance to reveal the superstar of Bayesian statistics: <strong>the posterior distribution!</strong> This bad boy tells us everything we wanna know <strong>after we’ve taken the data into account</strong>. This allow us to take into account previous knowledge (like past research, and the observed data) let’s say, samples from a new experiment.</p>
<p>The posterior it’s nothing more than the <strong>probability associated with our parameters</strong> of interest (aka. the slope and intercept), <strong>given the observed data</strong>. We represent this posterior distribution as the following:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AP(%5Ctext%7BX%7D%7C%5Ctext%7BData%7D)%20%5Cpropto%20P(%5Ctext%7BData%7D%7C%5Ctext%7BX%7D)%20%5Ccdot%20P(%5Ctext%7BX%7D)%0A"></p>
<p>Which <strong>is the same</strong> as saying:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7BPosterior%7D%20%5Cpropto%20%5Ctext%7BLikelihood%7D%20%5Ccdot%20%5Ctext%7BPrior%7D%0A"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine log likelihood and log prior to get log posterior</span></span>
<span id="cb9-2">log_posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(intercept, slope, x, y, sigma) {</span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_likelihood</span>(intercept, slope, x, y, sigma) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_prior</span>(intercept, slope))</span>
<span id="cb9-4">}</span></code></pre></div>
</div>
</section>
<section id="building-the-hmc-sampler" class="level4">
<h4 class="anchored" data-anchor-id="building-the-hmc-sampler">Building the HMC sampler</h4>
<p>Alright, now that we have everything ready, let’vs dig into the guts of HMC and how we put it to work. Remember how HMC <strong>takes inspiration from the momentum and potential energy</strong> dance in physics? Well, in practice, it’s like having a GPS for our parameter space, guiding us to new spots that are more likely than others.</p>
<p>But here’s the thing: <strong>our parameter space isn’t some smooth highway</strong> we can cruise along endlessly. Nope, it’s more like a rugged terrain full of twists and turns. So, how do we navigate this space? Enter the <strong>leapfrog integration method</strong>, the backbone of HMC.</p>
</section>
<section id="leapfrog-integration" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="leapfrog-integration">Leapfrog Integration</h4>
<p>So, <strong>leapfrog integration</strong> is basically this cool math trick we use in HMC <strong>to play out how a system moves over time</strong> using discrete steps, <strong>so we don’t have to compute every single</strong> value along the way. This integration method also is advantageous by not allowing energy leaks out of the system (remember the Hamiltonian?) which is super important if you don’t want to get stuck in this statistical dimension mid exploration.</p>
<p>Here’s how it works in HMC-lingo: we use leapfrog integration <strong>to move around the parameter space in discrete steps</strong> (rather than sliding through a continuum), and <strong>grabbing samples from the posterior distribution</strong>. The whole process goes like this:</p>
<ol type="1">
<li>We give the <strong>momentum</strong> <img src="https://latex.codecogs.com/png.latex?p"> a little nudge by leveraging on the <strong>gradient info</strong> (<img src="https://latex.codecogs.com/png.latex?%5Cnabla">). The <strong>gradient or slope</strong> of the position (<img src="https://latex.codecogs.com/png.latex?%5Cnabla%20U(q)">) in this parameter space will <strong>determine by how much our momentum will change</strong>. Like when we are in the top position in the swing, the potential energy then transfers to kinetic energy (aka. momentum).</li>
<li>We adjust the <strong>position</strong> (or parameters) based on the <strong>momentum</strong> boost.</li>
<li>Then we <strong>update the momentum</strong> based on the gradient on that <strong>new position</strong>.</li>
<li>We repeat the cycle for as many “jumps” we are doing, for each sample of the posterior we intend to draw.</li>
</ol>
<p><strong>Picture a frog hopping from one lily pad to another</strong>, that’s where the name “leapfrog” comes from. It helps us <strong>explore new spots</strong> in the parameter space by <strong>discretizing the motion</strong> of this imaginary particle by using Hamiltonian dynamics, using the slope information (<img src="https://latex.codecogs.com/png.latex?%5Cnabla%20U(q)">) of the current position <img src="https://latex.codecogs.com/png.latex?q"> to gain/loss momentum <img src="https://latex.codecogs.com/png.latex?p"> and move to another position <img src="https://latex.codecogs.com/png.latex?q"> in the parameter space.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="frog-jumping.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="A frog jumping, with a fixed step size, from one point in the phase space into another."><img src="https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/frog-jumping.gif" class="img-fluid figure-img" style="width:100.0%" alt="A frog jumping, with a fixed step size, from one point in the phase space into another."></a></p>
<figcaption class="margin-caption">A frog jumping, with a fixed step size, from one point in the phase space into another.</figcaption>
</figure>
</div>
<p>We prefer leapfrogging over simpler methods like Euler’s method because it <strong>keeps errors low</strong>, both locally and globally. This stability is key, especially when we’re dealing with big, complicated systems. Plus, <strong>it’s a champ at handling high-dimensional spaces</strong>, where keeping energy in check is a must for the algorithm to converge.</p>
</section>
<section id="tuning-those-hamiltonian-gears" class="level4">
<h4 class="anchored" data-anchor-id="tuning-those-hamiltonian-gears">Tuning Those Hamiltonian Gears</h4>
<p>Now, to get our HMC sampler purring like a kitten, we’ve got to <strong>fine-tune a few gears</strong>. Think of these as the knobs and dials on your favorite sound system – adjust them just right, and you’ll be <strong>grooving to the perfect beat</strong>.</p>
<p>First up, we’ve got the <strong>number of samples</strong>. This determines how many times our sampler will take a peek at the parameter space before calling it a day.</p>
<p>Next, we’ve got the <strong>step size</strong> (<img src="https://latex.codecogs.com/png.latex?%5Cepsilon">). Imagine this as the stride length for our leapfrog integrator. Too short, and we’ll be tiptoeing; too long, and we’ll be taking giant leaps – neither of which gets us where we want to go. It’s all about finding that sweet spot.</p>
<p>Then, there’s the <strong>number of steps for the leapfrog</strong> to make. Too few, and we risk missing key spots; too many, and we might tire ourselves out.</p>
<p>Lastly, we need <strong>an initial guess for the intercept and slope</strong>. This is like dropping a pin on a map – it gives our sampler a starting point to begin its journey through the parameter space.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialization of the sampler</span></span>
<span id="cb10-2">num_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of samples</span></span>
<span id="cb10-3">epsilon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Leapfrog step size</span></span>
<span id="cb10-4">num_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of leapfrog steps</span></span>
<span id="cb10-5">init_intercept <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial guess for intercept</span></span>
<span id="cb10-6">init_slope <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial guess for slope</span></span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Placeholder for storing samples</span></span>
<span id="cb10-9">params_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> num_samples, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
</div>
</section>
<section id="starting-the-sampler" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="starting-the-sampler">Starting the Sampler</h4>
<p>Alright, let’s fire up this Hamiltonian engine and get this party started. Here’s the game plan:</p>
<ol type="1">
<li><strong>Create a Loop:</strong> We’ll set up a loop to simulate our little particle moving around the parameter space.</li>
<li><strong>Integrate Its Motion:</strong> Using our trusty leapfrog integrator, we’ll keep track of how our particle moves.</li>
<li><strong>Grab a Sample:</strong> Once our particle has finished its dance, we’ll grab a sample at its final position.</li>
<li><strong>Accept or Reject:</strong> We’ll play a little game of accept or reject – if the new position looks promising, we’ll keep it; if not, we’ll stick with the old one. It’s like Tinder for parameters.</li>
<li><strong>Repeat:</strong> We’ll rinse and repeat this process until we’ve collected as many samples as we need.</li>
</ol>
<p>Now, <strong>to kick things off</strong>, we’ll give our imaginary particle <strong>a random speed and direction</strong> to start with, and drop it down somewhere in the parameter space. This initial kick sets the stage for our parameter exploration, the rest is up to the physics.</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>num_samples) {</span>
<span id="cb11-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Start with a random momentum of the particle</span></span>
<span id="cb11-3">  momentum_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-4">  </span>
<span id="cb11-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># And set the initial position of the particle</span></span>
<span id="cb11-6">  params_proposed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(init_intercept, init_slope) </span>
<span id="cb11-7">  </span>
<span id="cb11-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Next, we will simulate the particle's motion using</span></span>
<span id="cb11-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># leapfrog integration.</span></span>
<span id="cb11-10">  ...</span></code></pre></div>
<aside>
Here, I’m using the concept of a particle moving through a probability space. But remember, in reality, we’re talking about the parameter space, where each coefficient in a model parameter or any other parameter that we can represent in this way then becomes a coordinate, therefore, a position <img src="https://latex.codecogs.com/png.latex?q"> in this statistical space.
</aside>
</section>
<section id="simulating-the-particles-motion" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="simulating-the-particles-motion">Simulating the Particle’s Motion</h4>
<p>Now that our imaginary particle is all geared up with an <strong>initial momentum and position</strong>, it’s time to let it loose and see where it goes in this <strong>parameter playground</strong>. We know we’re using Hamiltonian mechanics, but to make it computationally feasible, we’re bringing in our trusty leapfrog integrator. We’ve already seen that this bad boy <strong>discretizes the motion of our particle</strong>, making it manageable to track its journey without breaking our computers.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="canica.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Marble rolling over a surface. In a perfect world, we’d love to follow our particle smoothly gliding through the parameter space, but hey, computing that would take ages. So instead, we chunk its movement into smaller steps, kind of like a flipbook, to keep tabs on its position."><img src="https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/canica.gif" class="img-fluid figure-img" style="width:100.0%" alt="Marble rolling over a surface. In a perfect world, we’d love to follow our particle smoothly gliding through the parameter space, but hey, computing that would take ages. So instead, we chunk its movement into smaller steps, kind of like a flipbook, to keep tabs on its position."></a></p>
<figcaption class="margin-caption">Marble rolling over a surface. In a perfect world, we’d love to follow our particle smoothly gliding through the parameter space, but hey, computing that would take ages. So instead, we chunk its movement into smaller steps, kind of like a flipbook, to keep tabs on its position.</figcaption>
</figure>
</div>
<p>So, here’s the lowdown on what our leapfrog integrator is up to:</p>
<ol type="1">
<li><strong>Estimating the Slope:</strong> We start off with an initial position and estimate the slope of the terrain at that point.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%20U(q)%20=%20%5Cfrac%7B%5Cpartial%20U%7D%7B%5Cpartial%20q%7D%0A"></p>
<aside>
Here, we calculate the gradient <img src="https://latex.codecogs.com/png.latex?%5Cnabla"> with respect of the current position <img src="https://latex.codecogs.com/png.latex?q">
</aside>
<ol start="2" type="1">
<li><strong>Adjusting Momentum:</strong> This slope is like the potential energy, dictating whether our particle speeds up or slows down. So, we tweak the momentum accordingly based on this slope.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap%20%5Cleftarrow%20p%20-%20%5Cfrac%7B%5Cepsilon%7D%7B2%7D%20%5Ccdot%20%5Cnabla%20U(q)%0A"></p>
<aside>
Then, we update the momentum <img src="https://latex.codecogs.com/png.latex?p"> with the gradient <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20U(q)"> by half step (<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cepsilon%7D%7B2%7D">)
</aside>
<ol start="3" type="1">
<li><strong>Taking a Step:</strong> With this momentum tweak, we move the particle for a set distance <img src="https://latex.codecogs.com/png.latex?%5Cepsilon">, updating its position from the starting point.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0Aq%20%5Cleftarrow%20q%20+%20%5Cepsilon%20%5Ccdot%20p%0A"></p>
<ol start="4" type="1">
<li><strong>Repeat:</strong> Now that our particle has a new spot, we rinse and repeat – estimating the slope and adjusting momentum.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap%20%5Cleftarrow%20p%20-%20%5Cfrac%7B%5Cepsilon%7D%7B2%7D%20%5Ccdot%20%5Cnabla%20U(q)%0A"></p>
<aside>
Here, we update momentum <img src="https://latex.codecogs.com/png.latex?p"> by the other half step size on the new position <img src="https://latex.codecogs.com/png.latex?q">
</aside>
<ol start="5" type="1">
<li><strong>Keep Going:</strong> We keep this cycle going for as many steps as we want to simulate, tracking our particle’s journey through the parameter space.</li>
</ol>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>num_steps) {</span>
<span id="cb12-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient estimation</span></span>
<span id="cb12-3">    grad <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb12-4">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of the intercept of X: -sum(residuals / variance)</span></span>
<span id="cb12-5">      ...</span>
<span id="cb12-6">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of the slope of X: -sum(residuals * X / variance)</span></span>
<span id="cb12-7">      ...</span>
<span id="cb12-8">    )</span>
<span id="cb12-9">    </span>
<span id="cb12-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Momentum half update</span></span>
<span id="cb12-11">    momentum_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> momentum_current <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> grad <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb12-12">    </span>
<span id="cb12-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Full step update for parameters</span></span>
<span id="cb12-14">    params_proposed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params_proposed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> momentum_current</span>
<span id="cb12-15">    </span>
<span id="cb12-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recalculate gradient for another half step update for momentum</span></span>
<span id="cb12-17">    grad <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb12-18">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of the intercept of X: -sum(residuals / variance)</span></span>
<span id="cb12-19">      ...</span>
<span id="cb12-20">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of the slope of X: -sum(residuals * X / variance)</span></span>
<span id="cb12-21">      ...</span>
<span id="cb12-22">    )</span>
<span id="cb12-23">    </span>
<span id="cb12-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Final half momentum update</span></span>
<span id="cb12-25">    momentum_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> momentum_current <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> grad <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb12-26">  }</span></code></pre></div>
</section>
<section id="sample-evaluation-and-acceptance" class="level4">
<h4 class="anchored" data-anchor-id="sample-evaluation-and-acceptance">Sample Evaluation and Acceptance</h4>
<p>After our particle has taken its fair share of steps through the parameter space, it’s decision time – <strong>should we accept or reject its proposed new position?</strong> We can’t just blindly accept every move it makes; we’ve got to be smart about it.</p>
<p>That’s where the <strong>Metropolis acceptance criteria</strong> come into play. This handy rule determines whether a proposed new position <strong>is a good fit or not</strong>. The idea is to weigh the probability of the new position against the probability of the current one. <strong>If the new spot looks promising, we’ll move there with a certain probability</strong>, ensuring that our samples accurately reflect the shape of the distribution we’re exploring. But if it’s not a better fit, we’ll stick with where we are.</p>
<p>The <strong>formula</strong> for this acceptance probability (<img src="https://latex.codecogs.com/png.latex?A(q',%20q)">) when transitioning from the current position (<img src="https://latex.codecogs.com/png.latex?q">) to a proposed position (<img src="https://latex.codecogs.com/png.latex?q'">) is straightforward:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA(q',q)%20=%20min(1,%5Cfrac%7Bp(q')%7D%7Bp(q)%7D)%0A"></p>
<p>Here, <img src="https://latex.codecogs.com/png.latex?p(q')"> is the probability density of the <strong>proposed position</strong> <img src="https://latex.codecogs.com/png.latex?q'">, and <img src="https://latex.codecogs.com/png.latex?p(q)"> is the probability density of the <strong>current position</strong> <img src="https://latex.codecogs.com/png.latex?q">. We’re essentially <strong>comparing the fitness of the proposed spot against where we’re currently at</strong>. If the proposed position offers a higher probability density, we’re more likely to accept it. This ensures that our samples accurately represent the target distribution.</p>
<p>However, when dealing with very small probability values, <strong>we might run into numerical underflow issues</strong>. That’s where using the <strong>log posterior</strong> probabilities comes in handy. By taking the logarithm of the probabilities, we convert the ratio into a difference, making it <strong>easier to manage</strong>. Here’s how the acceptance criteria look with logarithms:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Calpha%20&amp;=%20%5Clog(p(q'))%20-%20%5Clog(p(q))%20%5C%5C%0AA(q',q)%20&amp;=%20min(1,exp(%5Calpha))%0A%5Cend%7Baligned%7D%0A"></p>
<p><strong>This formulation is equivalent to the previous one</strong> but helps us avoid numerical headaches, especially when working with complex or high-dimensional data. We’re still comparing the fitness of the proposed position with our current spot, just in a more <strong>log-friendly way</strong>.</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate log posteriors and acceptance probability</span></span>
<span id="cb13-2">log_posterior_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_posterior</span>( ...current parameters... )</span>
<span id="cb13-3">log_posterior_proposed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_posterior</span>( ...proposed parameters... )</span>
<span id="cb13-4"></span>
<span id="cb13-5">alpha <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(log_posterior_proposed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> log_posterior_current))</span>
<span id="cb13-6"></span>
<span id="cb13-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Accept or reject the proposal</span></span>
<span id="cb13-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> alpha) {</span>
<span id="cb13-9">  init_intercept <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb13-10">  init_slope <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb13-11">}</span></code></pre></div>
</section>
<section id="mixing-all-toghether" class="level4">
<h4 class="anchored" data-anchor-id="mixing-all-toghether">Mixing All Toghether</h4>
<p>Now that we’ve broken down each piece of our HMC puzzle, it’s time <strong>to put them all together</strong> and see how the full algorithm works.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>num_samples) {</span>
<span id="cb14-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Randomly initialize momentum</span></span>
<span id="cb14-3">  momentum_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb14-4">  </span>
<span id="cb14-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make a copy of the current parameters</span></span>
<span id="cb14-6">  params_proposed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(init_intercept, init_slope)</span>
<span id="cb14-7">  </span>
<span id="cb14-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform leapfrog integration</span></span>
<span id="cb14-9">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>num_steps) {</span>
<span id="cb14-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Half step update for momentum</span></span>
<span id="cb14-11">    grad <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb14-12">      <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sigma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb14-13">      <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sigma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb14-14">    )</span>
<span id="cb14-15">    momentum_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> momentum_current <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> grad <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb14-16">    </span>
<span id="cb14-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Full step update for parameters</span></span>
<span id="cb14-18">    params_proposed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params_proposed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> momentum_current</span>
<span id="cb14-19">    </span>
<span id="cb14-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recalculate gradient for another half step update for momentum</span></span>
<span id="cb14-21">    grad <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb14-22">      <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sigma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb14-23">      <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sigma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb14-24">    )</span>
<span id="cb14-25">    momentum_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> momentum_current <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> epsilon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> grad <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb14-26">  }</span>
<span id="cb14-27">  </span>
<span id="cb14-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the log posterior of the current and proposed parameters</span></span>
<span id="cb14-29">  log_posterior_current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_posterior</span>(init_intercept, init_slope, x, y, sigma)</span>
<span id="cb14-30">  log_posterior_proposed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log_posterior</span>(params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], x, y, sigma)</span>
<span id="cb14-31">  </span>
<span id="cb14-32">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the acceptance probability</span></span>
<span id="cb14-33">  alpha <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(log_posterior_proposed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> log_posterior_current))</span>
<span id="cb14-34">  </span>
<span id="cb14-35">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Accept or reject the proposal</span></span>
<span id="cb14-36">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> alpha) {</span>
<span id="cb14-37">    init_intercept <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb14-38">    init_slope <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> params_proposed[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb14-39">  }</span>
<span id="cb14-40">  </span>
<span id="cb14-41">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save the sample</span></span>
<span id="cb14-42">  params_samples[i, ] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(init_intercept, init_slope)</span>
<span id="cb14-43">}</span></code></pre></div>
</div>
</section>
</section>
<section id="visualizing-the-final-result" class="level1">
<h1>Visualizing the Final Result</h1>
<p>Alright, folks, let’s wrap this up with a peek at how our little algorithm fared in estimating the true intercept and slope of our linear model.</p>
<section id="samples-of-intercept-and-slope" class="level4">
<h4 class="anchored" data-anchor-id="samples-of-intercept-and-slope">Samples of Intercept and Slope</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(params_samples) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intercept"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slope"</span>)</span>
<span id="cb15-2">posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.table</span>(params_samples)</span>
<span id="cb15-3">posterior[, sample <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(.N)]</span>
<span id="cb15-4">melt_posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt</span>(posterior, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id.vars =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>)</span>
<span id="cb15-5"></span>
<span id="cb15-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(melt_posterior, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(sample, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> variable)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(variable), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free_y"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb15-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hline =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(true_intercept, true_slope),</span>
<span id="cb15-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intercept"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slope"</span>)</span>
<span id="cb15-12">  ), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> hline), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Samples"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb15-14">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Convergence of parameter values"</span>,</span>
<span id="cb15-15">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Traceplot of both the Intercept and Slope"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qual"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-13-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/index_files/figure-html/unnamed-chunk-13-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>In this plot, we’re tracking the <strong>evolution of the intercept and slope parameters over the course of our sampling process</strong>. Each line represents a different sample from the posterior distribution, showing how these parameters fluctuate over time. The dashed lines mark the <strong>true values</strong> of the <strong>intercept</strong> and <strong>slope</strong> that we used to generate the data. Ideally, we’d like to see the samples converging around these true values, <strong>indicating that our sampler is accurately capturing the underlying structure</strong> of the data.</p>
</section>
<section id="data-with-true-and-estimated-regression-line" class="level4">
<h4 class="anchored" data-anchor-id="data-with-true-and-estimated-regression-line">Data with True and Estimated Regression Line</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> posterior[,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(sample, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)]</span>
<span id="cb16-2"></span>
<span id="cb16-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> posterior<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Slope[ids], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> posterior<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Intercept[ids], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steelblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> true_slope, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> true_intercept, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data with Regression Line"</span>,</span>
<span id="cb16-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"True and HMC-estimated parameter values"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-14-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/index_files/figure-html/unnamed-chunk-14-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>This plot gives us a bird’s-eye view of our data, overlaid with both the <strong>true regression line</strong> (in white) and the <strong>estimated regression lines</strong> from our HMC sampler (in blue). The true regression line represents the ground truth relationship between our independent and dependent variables, while <strong>the estimated regression lines are sampled from the accepted values</strong> of the intercept and slope parameters sampled from the posterior distribution. By comparing these two, we can assess <strong>how well our model has captured the underlying trend</strong> in the data.</p>
</section>
<section id="posterior-samples-of-intercept-and-slope" class="level4">
<h4 class="anchored" data-anchor-id="posterior-samples-of-intercept-and-slope">Posterior Samples of Intercept and Slope</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(posterior, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Slope, Intercept)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density2d_filled</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">contour_var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"density"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> true_intercept, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> true_slope, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_d</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-15-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/index_files/figure-html/unnamed-chunk-15-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>In this plot, we’re visualizing the <strong>joint posterior density</strong> of the <strong>intercept</strong> and <strong>slope</strong> parameters sampled from our model. The contours represent regions of higher density, with <strong>brighter zones indicating areas where more samples are concentrated</strong>. The white dashed lines mark the true values of the intercept and slope used to generate the data, providing a reference for comparison. Ideally, we’d like to see <strong>the contours align closely with these true values</strong>, indicating that our sampler has accurately captured the underlying distribution of the parameters.</p>
</section>
</section>
<section id="wrapping-it-up" class="level1">
<h1>Wrapping It Up</h1>
<p>So, let’s take a moment to marvel at the marvels of Hamiltonian Monte Carlo (HMC). It’s not every day you see <strong>physics rubbing shoulders with statistics</strong>, but here we are, with HMC straddling both worlds like a boss.</p>
<section id="bridging-physics-and-stats" class="level4">
<h4 class="anchored" data-anchor-id="bridging-physics-and-stats">Bridging Physics and Stats</h4>
<p>What makes HMC so darn fascinating is how it <strong>borrows tools from physics to tackle complex problems in statistics</strong>. It’s like watching two old pals team up to solve a mystery, each bringing their own unique skills to the table. With HMC, we’re not just crunching numbers; we’re <strong>tapping into the underlying principles that govern the physical world</strong>. I mean, seriously, it gives me goosebumps just thinking about it.</p>
<p>But it’s not just HMC that’s shaking up the stats scene. Nope, the whole world of science is pivoting towards <strong>simulation-based statistics</strong> and <strong>Bayesian methods</strong> faster than you can say “p-value.” Why? Because in today’s data-rich landscape, traditional methods just can’t keep up. We need tools like HMC <strong>to navigate the choppy waters of high-dimensional data</strong>, to tease out the subtle patterns hiding in the noise.</p>
<p>Now, here’s the kicker: <strong>understanding how HMC works isn’t just some academic exercise</strong>. Oh no, it’s the key to unlocking the true power of Bayesian inference. Sure, <strong>you can run your models without ever peeking under the hood</strong>, but where’s the fun in that? Knowing how HMC works gives you this intuitive grasp of what your model is up to, what might be tripping it up, and how to <strong>steer it back on course</strong> when things go sideways.</p>
<p>So, here’s to HMC, one of the <strong>big algorithms of modern statistics</strong>, blurring the lines between physics and stats, and paving the way for a brave new world of <strong>simulation-based inference</strong>. Cheers to the leapfrogging pioneers of Bayesian stats, charting new territories and uncovering hidden truths, <em>sliding one simulated step at a time</em>.</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{castillo-aguilar2024,
  author = {Castillo-Aguilar, Matías},
  title = {The {Good,} {The} {Bad,} and {Hamiltonian} {Monte} {Carlo}},
  date = {2024-05-15},
  url = {https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/},
  doi = {10.59350/fa26y-xa178},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-castillo-aguilar2024" class="csl-entry quarto-appendix-citeas">
Castillo-Aguilar, Matías. 2024. <span>“The Good, The Bad, and
Hamiltonian Monte Carlo.”</span> May 15, 2024. <a href="https://doi.org/10.59350/fa26y-xa178">https://doi.org/10.59350/fa26y-xa178</a>.
</div></div></section></div> ]]></description>
  <category>mcmc</category>
  <category>algorithms</category>
  <category>inference</category>
  <guid>https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/</guid>
  <pubDate>Wed, 15 May 2024 03:00:00 GMT</pubDate>
  <media:content url="https://bayesically-speaking.com/posts/2024-05-15 mcmc part 2/body_1.png" medium="image" type="image/png" height="128" width="144"/>
</item>
<item>
  <title>Markov Chain Monte What?</title>
  <dc:creator>Matías Castillo-Aguilar</dc:creator>
  <link>https://bayesically-speaking.com/posts/2024-04-14 mcmc part 1/</link>
  <description><![CDATA[ 





<section id="introduction" class="level1 page-columns page-full">
<h1>Introduction</h1>
<p>Alright, folks, let’s dive into the wild world of statistics and data science! Picture this: you’re knee-deep in data, trying to make sense of the chaos. But here’s the kicker, sometimes the chaos is just <strong>too darn complex</strong>. With tons of variables flying around, getting a grip on uncertainty can feel like <strong>trying to catch smoke with your bare hands</strong>.</p>
<p>Please, have in your consideration that the kind of problems that we’re dealing with, it’s not solely related to the number of dimensions, it’s mostly related to <strong>trying to estimate something that we can’t see in full beforehand</strong>. For instance, consider the following banana distribution (shown below). How could we map this simple two dimensional surface without computing it all at once?</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">dbanana <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb1-2">  a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>;</span>
<span id="cb1-3">  b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>;</span>
<span id="cb1-4">  </span>
<span id="cb1-5">  y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> a</span>
<span id="cb1-6">  y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> (a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> a<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-7">}</span>
<span id="cb1-8"></span>
<span id="cb1-9">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>)</span>
<span id="cb1-10"></span>
<span id="cb1-11">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbanana</span>(x)</span>
<span id="cb1-12"></span>
<span id="cb1-13">z <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> MASS<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kde2d</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lims =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>))</span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_ly</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>z)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_surface</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">style</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hoverinfo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f992f02237a38d1d23ad" style="width:100%;height:454px;"></div>
<script type="application/json" data-for="htmlwidget-f992f02237a38d1d23ad">{"x":{"visdat":{"6e087294a19e":["function () ","plotlyVisDat"]},"cur_data":"6e087294a19e","attrs":{"6e087294a19e":{"x":[-10,-9.7979797979797976,-9.5959595959595951,-9.3939393939393945,-9.191919191919192,-8.9898989898989896,-8.7878787878787872,-8.5858585858585865,-8.3838383838383841,-8.1818181818181817,-7.9797979797979792,-7.7777777777777777,-7.5757575757575761,-7.3737373737373737,-7.1717171717171713,-6.9696969696969697,-6.7676767676767682,-6.5656565656565657,-6.3636363636363633,-6.1616161616161618,-5.9595959595959593,-5.7575757575757578,-5.5555555555555554,-5.3535353535353538,-5.1515151515151514,-4.9494949494949498,-4.7474747474747474,-4.5454545454545459,-4.3434343434343434,-4.1414141414141419,-3.9393939393939394,-3.7373737373737379,-3.5353535353535355,-3.333333333333333,-3.1313131313131315,-2.9292929292929291,-2.7272727272727275,-2.5252525252525251,-2.3232323232323235,-2.1212121212121211,-1.9191919191919187,-1.717171717171718,-1.5151515151515156,-1.3131313131313131,-1.1111111111111107,-0.90909090909091006,-0.70707070707070763,-0.50505050505050519,-0.30303030303030276,-0.10101010101010033,0.10101010101010033,0.30303030303030276,0.50505050505050519,0.70707070707070763,0.90909090909090828,1.1111111111111107,1.3131313131313131,1.5151515151515156,1.7171717171717162,1.9191919191919187,2.1212121212121211,2.3232323232323235,2.5252525252525242,2.7272727272727266,2.9292929292929291,3.1313131313131315,3.3333333333333339,3.5353535353535346,3.737373737373737,3.9393939393939394,4.1414141414141419,4.3434343434343425,4.545454545454545,4.7474747474747474,4.9494949494949498,5.1515151515151505,5.3535353535353529,5.5555555555555554,5.7575757575757578,5.9595959595959584,6.1616161616161627,6.3636363636363633,6.565656565656564,6.7676767676767682,6.9696969696969688,7.171717171717173,7.3737373737373737,7.5757575757575744,7.7777777777777786,7.9797979797979792,8.1818181818181799,8.3838383838383841,8.5858585858585847,8.787878787878789,8.9898989898989896,9.1919191919191903,9.3939393939393945,9.5959595959595951,9.7979797979797993,10],"y":[-2.6000000000000001,-2.3717171717171719,-2.1434343434343432,-1.915151515151515,-1.6868686868686869,-1.4585858585858587,-1.2303030303030302,-1.0020202020202018,-0.77373737373737361,-0.54545454545454541,-0.31717171717171722,-0.088888888888888573,0.13939393939393963,0.36767676767676782,0.59595959595959647,0.82424242424242466,1.0525252525252529,1.2808080808080811,1.5090909090909093,1.7373737373737375,1.9656565656565657,2.1939393939393947,2.4222222222222229,2.6505050505050511,2.8787878787878793,3.1070707070707075,3.3353535353535357,3.5636363636363639,3.791919191919193,4.0202020202020208,4.2484848484848499,4.4767676767676772,4.7050505050505063,4.9333333333333336,5.1616161616161627,5.38989898989899,5.6181818181818191,5.8464646464646481,6.0747474747474755,6.3030303030303045,6.5313131313131318,6.7595959595959609,6.98787878787879,7.2161616161616173,7.4444444444444464,7.6727272727272737,7.9010101010101028,8.1292929292929301,8.3575757575757592,8.5858585858585883,8.8141414141414156,9.0424242424242447,9.270707070707072,9.4989898989899011,9.7272727272727284,9.9555555555555575,10.183838383838387,10.412121212121214,10.640404040404043,10.86868686868687,11.096969696969699,11.325252525252527,11.553535353535356,11.781818181818183,12.010101010101012,12.238383838383841,12.466666666666669,12.694949494949498,12.923232323232325,13.151515151515154,13.379797979797981,13.608080808080809,13.836363636363638,14.064646464646467,14.292929292929296,14.521212121212125,14.749494949494951,14.97777777777778,15.206060606060609,15.434343434343438,15.662626262626263,15.890909090909092,16.11919191919192,16.347474747474749,16.575757575757578,16.804040404040403,17.032323232323233,17.260606060606062,17.488888888888891,17.71717171717172,17.945454545454545,18.173737373737374,18.402020202020203,18.630303030303033,18.858585858585858,19.086868686868687,19.315151515151516,19.543434343434345,19.771717171717174,20],"z":[[2.1482756687185296e-08,3.0001056799343143e-08,4.1564156471006346e-08,5.7134958355176481e-08,7.7938338219217766e-08,1.055196632137958e-07,1.4181308057014566e-07,1.8922049384206424e-07,2.5070210362536834e-07,3.2987932821264972e-07,4.3115083734433362e-07,5.5982233023024582e-07,7.2225056904180171e-07,9.2600204326763542e-07,1.1800264911564514e-06,1.494845344594615e-06,1.8827549958969951e-06,2.3580446117991382e-06,2.9372280439776787e-06,3.6392892090725469e-06,4.4859401366185623e-06,5.5018907124889506e-06,6.7151289801841305e-06,8.1572107041574874e-06,9.8635567497831629e-06,1.1873756694821219e-05,1.4231876958472801e-05,1.6986771617372593e-05,2.019239397405284e-05,2.3908106853334102e-05,2.8198989526441374e-05,3.3136139101975282e-05,3.8796964177632055e-05,4.5265468517052595e-05,5.263252250252041e-05,6.0996120116282199e-05,7.0461619220507974e-05,8.1141962937022533e-05,9.315787997011067e-05,0.00010663806176298616,0.00012171931441876993,0.00013854668332563769,0.00015727354835534907,0.00017806168726371539,0.00020108130434313962,0.00022651102016325706,0.0002545378158762633,0.00028535692122273146,0.00031917162774305766,0.00035619299583682139,0.00039663940350955976,0.00044073585241292317,0.00048871289907746122,0.00054080501212223659,0.0005972480671501473,0.00065827558084849717,0.00072411316143979119,0.00079497053001792537,0.00087103037373878174,0.00095243326625191996,0.0010392579805760475,0.0011314967728577462,0.0012290256682330936,0.0013315704413587412,0.0014386698221252494,0.0015496383912158968,0.0016635325351582804,0.0017791235519114435,0.0018948823782611519,0.0020089803184808216,0.0021193095121794349,0.0022235256808447726,0.0023191140061456228,0.0024034769576291243,0.0024740406976277302,0.0025283745763059998,0.0025643164292020728,0.0025800951259893753,0.002574441271595541,0.0025466772406584964,0.0024967788590178701,0.0024254029619747946,0.0023338775964219806,0.0022241545532998767,0.002098726927810649,0.0019605172004785463,0.0018127436267166522,0.0016587742869993533,0.0015019788397502452,0.0013455877914630523,0.0011925680137779048,0.0010455214477294316,0.00090661166251773434,0.00077752043908024208,0.00065943409046092031,0.00055305704652816828,0.00045864850176024005,0.00037607676422968277,0.00030488538986780305,0.00024436520749199616],[3.7397664866866132e-08,5.206915328033695e-08,7.1916380488664182e-08,9.8548832210438193e-08,1.3400399836134455e-07,1.8083977936687558e-07,2.4224140656431706e-07,3.2214400728545908e-07,4.2537183322766317e-07,5.5779502682728516e-07,7.2650462705263897e-07,9.4000631685553169e-07,1.2084331937613371e-06,1.5437776075469092e-06,1.9601418596965851e-06,2.4740073033622644e-06,3.1045211246744297e-06,3.8737998308562314e-06,4.807248221590652e-06,5.9338923808552059e-06,7.2867249998114768e-06,8.9030611296655225e-06,1.0824902268610598e-05,1.3099306510564896e-05,1.5778762326657014e-05,1.8921563414268369e-05,2.2592181933685063e-05,2.6861637359627945e-05,3.1807858104541507e-05,3.7516033022798463e-05,4.4078949880028977e-05,5.1597317869566403e-05,6.0180071278307925e-05,6.9944651446722392e-05,8.101726423170123e-05,9.3533110265524861e-05,0.00010763658540804093,0.00012348144890991168,0.00014123095693842886,0.00016105795925613512,0.00018314495697112942,0.00020768411936652949,0.00023487725780679003,0.00026493575449959106,0.00029808044325894826,0.00033454143800226455,0.00037455790189204453,0.00041837774476351355,0.00046625722712589403,0.00051846043313935066,0.00057525854910706043,0.00063692884369017115,0.00070375318596569434,0.00077601585231212562,0.00085400025921196217,0.00093798411683246644,0.0010282323357508033,0.0011249868560779218,0.001228452439048516,0.0013387774162312604,0.0014560284934655744,0.0015801590205087488,0.0017109707144593851,0.001848069682322641,0.0019908186887500142,0.0021382888566304232,0.0022892152056529676,0.0024419614193888321,0.0025944997692586751,0.0027444120321753925,0.0028889164075547786,0.0030249238555446292,0.0031491250336159095,0.0032581062917349302,0.0033484902614085198,0.0034170937511461136,0.0034610932621411791,0.0034781867604767591,0.0034667396230625511,0.0034259030594297282,0.0033556948311082319,0.00325703464903551,0.0031317300095153942,0.002982412110996536,0.0028124254909565696,0.0026256787270008694,0.0024264665804029284,0.0022192760211455888,0.002008589471380739,0.0017986982837858876,0.0015935380146061045,0.0013965546621986214,0.0012106080155482031,0.0010379149380271727,0.00088003214872412535,0.00073787516845534541,0.00061176781051555218,0.00050151506572210193,0.00040649150700476194,0.00032573737831066002],[6.4303555632304541e-08,8.9260942429647916e-08,1.2290624199299372e-07,1.6789504987039316e-07,2.275726526303074e-07,3.0611765021846112e-07,4.0870664381888738e-07,5.4170125175746146e-07,7.1285847568303754e-07,9.3156515500516142e-07,1.2090969260684969e-06,1.5589017518809667e-06,1.996907717311611e-06,2.5418544027684263e-06,3.2156467654860985e-06,4.0437300800941712e-06,5.0554841265367973e-06,6.2846344699597149e-06,7.7696783589217234e-06,9.5543224790774756e-06,1.1687929542074227e-05,1.4225970465629939e-05,1.7230478711680881e-05,2.0770503195586584e-05,2.4922556060711023e-05,2.9771051529001338e-05,3.5408731988972965e-05,4.1937077467122081e-05,4.9466694646418312e-05,5.8117681645238334e-05,6.8019964850804667e-05,7.9313604211662939e-05,9.2149063532580904e-05,0.00010668744248091035,0.00012310066720414687,0.00014157163667204048,0.0001622943220905696,0.00018547381698574746,0.00021132633581695607,0.00024007915924235758,0.00027197052440428222,0.00030724945879427324,0.00034617555632585165,0.00038901869405522728,0.00043605868729989768,0.00048758487927059985,0.00054389565798932077,0.00060529788694618574,0.00067210622463756019,0.00074464228879082676,0.00082323358940809995,0.00090821210506669616,0.00099991230240365978,0.0010986682924060403,0.0012048096737923113,0.0013186554331088777,0.001440505062292286,0.0015706258410842571,0.0017092350567618681,0.0018564758610905535,0.0020123855753646927,0.0021768556353753501,0.0023495830903456803,0.0025300146621801082,0.0027172857933134469,0.0029101587355409146,0.0031069653449600451,0.003305561574721819,0.0035033014073675207,0.0036970378931527347,0.0038831579054962239,0.0040576551660487436,0.004216243149730267,0.0043545059062314396,0.0044680809826393858,0.0045528649160971749,0.0046052286129336702,0.004622227733241082,0.0046017922672787906,0.0045428800099594725,0.0044455806479312245,0.0043111605409607151,0.0041420427167134328,0.0039417216847229897,0.0037146179044666799,0.0034658815809422861,0.0032011594149124038,0.0029263406101799607,0.0026472995912160159,0.002369652441445616,0.0020985421453091307,0.0018384645747055361,0.0015931431897606423,0.0013654560764104168,0.0011574146756424953,0.00097018977817627341,0.00080417737719215706,0.00065909498309923693,0.0005340980716378713,0.00042790640294147715],[1.092133094471333e-07,1.5114500225408011e-07,2.0747798232711572e-07,2.8253751336794234e-07,3.8174496689409112e-07,5.1183745945736058e-07,6.8111729319802357e-07,8.9973237081224291e-07,1.1799883020627112e-06,1.5366924109934954e-06,1.9875293055326994e-06,2.5534671001841834e-06,3.259192804485002e-06,4.1335748207663635e-06,5.2101499490344219e-06,6.5276317869641284e-06,8.1304369490987871e-06,1.006922511878612e-05,1.2401448594044242e-05,1.5191906697052366e-05,1.851330018701836e-05,2.244678064703611e-05,2.7082489705410363e-05,3.2520082898318879e-05,3.8869232980747728e-05,4.6250107543353691e-05,5.4793815891222627e-05,6.4642820283375806e-05,7.5951306816341409e-05,8.8885511458201149e-05,0.00010362399699827705,0.00012035787696904401,0.00013929098291787001,0.00016063997175361935,0.00018463437026368292,0.00021151655428701779,0.00024154166043423593,0.00027497742866148953,0.00031210397442355242,0.00035321348954081984,0.00039860987129280767,0.00044860827955462871,0.00050353462194094745,0.00056372496675782303,0.00062952488279579947,0.00070128870310307066,0.00077937870594298512,0.00086416419864041266,0.00095602047651969135,0.0010553276059300342,0.0011624689421381135,0.0012778292325676501,0.0014017920648997258,0.0015347362888842781,0.0016770308631750641,0.001829027352679163,0.0019910490377708289,0.0021633753223012924,0.0023462198950022109,0.002539700988343874,0.0027438021934661607,0.0029583227423351627,0.0031828170555591767,0.0034165247220522212,0.0036582938832284873,0.0039065030846412623,0.0041589887613219072,0.0044129872824572799,0.0046651015119020854,0.0049113018073396551,0.0051469700686872111,0.0053669928154860122,0.0055659054761958921,0.0057380854400113325,0.0058779864208163869,0.0059804018587131264,0.0060407409971068573,0.0060552984323713659,0.006021496738177117,0.0059380824559635854,0.0058052583574663402,0.0056247392517392043,0.0053997243502203118,0.0051347857726952344,0.0048356795191158639,0.004509091459779806,0.0041623359738564474,0.0038030282884753295,0.0034387530241220018,0.0030767508504757094,0.0027236426448397836,0.0023852064721703631,0.0020662175723033705,0.0017703559290087115,0.0015001804954555566,0.0012571642849976924,0.001041780707212511,0.00085362898327798133,0.00069158529172023086,0.00055396640005163117],[1.8322327546477192e-07,2.5280884257131105e-07,3.4596897872860437e-07,4.6965784781831806e-07,6.325475913562263e-07,8.4535868050413201e-07,1.121231239646105e-06,1.4761379524217821e-06,1.9293383722426531e-06,2.503873615967927e-06,3.2270995494630263e-06,4.1312557059447106e-06,5.2540663400440047e-06,6.6393692373923876e-06,8.3377671922243456e-06,1.0407296450073938e-05,1.2914105899981047e-05,1.593314039648496e-05,1.9548821297287239e-05,2.3855717115285412e-05,2.8959197098385456e-05,3.4976060559915412e-05,4.2035134878405807e-05,5.0277835259492308e-05,5.985867959642551e-05,7.0945752071328275e-05,8.3721109499715481e-05,9.8381124829307893e-05,0.00011513676265480562,0.00013421378209744174,0.00015585286291655776,0.00018030965126504986,0.00020785472206642295,0.00023877345557344484,0.00027336582626215003,0.00031194610281512513,0.0003548424585492041,0.00040239649223837486,0.00045496265986405039,0.00051290761837762423,0.0005766094830590028,0.00064645700045098953,0.00072284863904895904,0.00080619159974799242,0.00089690074715815745,0.00099539746068063543,0.0011021083996212064,0.0012174641678000251,0.001341897847196303,0.0014758433427005807,0.0016197334346142829,0.0017739973634795009,0.0019390576624863951,0.0021153257946228774,0.0023031959353131395,0.0025030359635379671,0.0027151743958226554,0.0029398816504652256,0.0031773437266253879,0.0034276262219950582,0.003690626722851237,0.0039660141259242488,0.004253154521434252,0.004551024949585261,0.0048581185994801511,0.0051723476659768222,0.0054909527801884541,0.005810430227562292,0.0061264895627843327,0.0064340542764976787,0.0067273165722981712,0.0069998540077743686,0.0072448109299502236,0.007455141719653312,0.0076239064580613525,0.0077446034511782962,0.0078115178189446842,0.007820061730215877,0.007767080351550229,0.0076510984751944726,0.0074724861442513665,0.007233527172938888,0.006938381780270046,0.0065929429170439478,0.0062045944333659212,0.0057818871334631471,0.0053341551907524851,0.0048710997104624947,0.0044023680356110829,0.0039371565894419985,0.0034838618215823286,0.0030497986231952513,0.0026409990368731597,0.0022620969512212479,0.0019162974854389401,0.0016054235994444554,0.0013300276192869248,0.001089552156319896,0.00088252342047904228,0.00070676008499118734],[3.0364421165616674e-07,4.1770728856370472e-07,5.6988196567471696e-07,7.7120559163657149e-07,1.035370832788738e-06,1.3792141242218958e-06,1.8232585974407712e-06,2.392310669319256e-06,3.1161081922474782e-06,4.0300167500399032e-06,5.1757693875093002e-06,6.6022438312646812e-06,8.3662701381391588e-06,1.0533460731166201e-05,1.3179053977471217e-05,1.6388761844081923e-05,2.0259611742858301e-05,2.4900772441984127e-05,3.04343538689367e-05,3.6996170743412894e-05,4.4736460239872444e-05,5.382054426825601e-05,6.4429427458205214e-05,7.6760322518120111e-05,9.1027095298833841e-05,0.00010746062260792351,0.00012630905658214136,0.0001478379902214789,0.00017233051950979767,0.00020008719838582621,0.00023142588367747261,0.00026668146796529895,0.00030620549919148279,0.0003503656866726906,0.00039954529400330554,0.00045414242014349334,0.00051456917076872434,0.00058125072270638557,0.00065462428499162516,0.00073513796072317275,0.00082324951446275437,0.00091942505034518611,0.0010241376062448957,0.001137865669074924,0.0012610916151920479,0.0013943000772442162,0.001537976233386218,0.0016926040045095365,0.0018586641265847406,0.0020366320331555018,0.0022269754298062075,0.002430151357632727,0.0026466024133759403,0.0028767516056344205,0.0031209950669550636,0.0033796915054583702,0.0036531468775127828,0.0039415923315508318,0.0042451530859965595,0.0045638056787583861,0.0048973211203351729,0.0052451920790061984,0.0056065434925433762,0.0059800280354177626,0.0063637106420336266,0.006754949582701497,0.0071502850004759788,0.0075453487730081032,0.007934811422685803,0.0083123819761270531,0.008670874775780435,0.0090023531674830876,0.009298353956871357,0.0095501890845880698,0.009749312892801074,0.0098877355533394124,0.0099584566270111349,0.0099558881560713221,0.0098762347967938126,0.0097177996457135513,0.0094811886476704847,0.009169393500320918,0.0087877421690765404,0.0083437166158001289,0.007846648074329483,0.0073073100817881388,0.0067374374903004909,0.006149205044005018,0.0055547013232459209,0.0049654328053123885,0.0043918887097751649,0.0038431907501923577,0.003326843705040394,0.002848593778443547,0.0024123929810416387,0.0020204600524637633,0.0016734224040947361,0.0013705195697804272,0.0011098468329838514,0.00088861792592491808],[4.971000852426406e-07,6.8178707659709491e-07,9.2732350447319435e-07,1.2510026724901847e-06,1.6741647107985235e-06,2.2229061135715062e-06,2.9288588355906321e-06,3.8300352308705481e-06,4.9717331397380133e-06,6.4074934981840501e-06,8.2001010355834872e-06,1.0422617017313798e-05,1.3159431637934017e-05,1.6507322622438774e-05,2.0576505873245807e-05,2.5491663615974849e-05,3.1392935437693655e-05,3.8436857853041833e-05,4.6797238542135703e-05,5.6665952138892612e-05,6.8253645366627447e-05,8.1790340377750333e-05,9.7525926317890312e-05,0.00011573053036853127,0.00013669476079859627,0.00016072981585217339,0.00018816745359942296,0.00021935981916733216,0.00025467912703609649,0.00029451719732738626,0.0003392848462158575,0.00038941113175916054,0.00044534245755901492,0.00050754153773164743,0.00057648622767514964,0.00065266822606925394,0.00073659165442461984,0.00082877152130784732,0.00092973207909651662,0.0010400050817506647,0.0011601279525946617,0.0012906418714292234,0.0014320897903223511,0.0015850143869351185,0.0017499559627935336,0.0019274502907296541,0.0021180264093774367,0.0023222043507235982,0.0025404927653656113,0.0027733863732293945,0.0030213631060924634,0.0032848807100151699,0.0035643724251071835,0.0038602411394510982,0.0041728511075434177,0.0045025159233706728,0.0048494809541593346,0.0052138979135289282,0.0055957887669714577,0.0059949958567137567,0.0064111151981278269,0.0068434105601212821,0.0072907074113923703,0.0077512682306721337,0.0082226540252752396,0.0087015809398718683,0.0091837850782590623,0.0096639124036183716,0.010135453020083146,0.010590739518043062,0.011021026862935067,0.011416666362143935,0.011767378824209907,0.012062622800349317,0.012292043751017967,0.012445980260944905,0.012515995203827079,0.012495394075876132,0.012379690369906524,0.012166979299013744,0.011858186446694665,0.011457166639356543,0.010970639730663562,0.010407962956435495,0.0097807527634245408,0.00910238118418716,0.0083873816844084563,0.007650805972628536,0.0069075759401468753,0.0061718735423743985,0.0054566063456015215,0.0047729783459806718,0.0041301855138337513,0.003535244474165812,0.0029929519571202231,0.0025059631611211875,0.0020749697464237339,0.0016989532895680722,0.0013754878239824392,0.001101065409807461],[8.0395679038283698e-07,1.0993561646381206e-06,1.4907083085932666e-06,2.0047611663579263e-06,2.6743436181032529e-06,3.5393773218576604e-06,4.6479728497425949e-06,6.0576011338491599e-06,7.8363283604049277e-06,1.0064099786342794e-05,1.2834055624387357e-05,1.6253860255243215e-05,2.0447024654177831e-05,2.5554201107265291e-05,3.173442904887838e-05,3.916631115394086e-05,4.8049099616395245e-05,5.8603673769832063e-05,7.1073391775860467e-05,8.5724800935074158e-05,0.00010284819318167575,0.00012275799443130768,0.00014579297859915804,0.0001723162992415887,0.00020271533386169389,0.0002374013379310083,0.00027680890759896199,0.00032139525187851754,0.00037163927680531911,0.00042804048566616145,0.0004911177008796151,0.00056140761448678176,0.00063946317547301432,0.00072585182329131144,0.00082115357799432279,0.00092595899830305811,0.0010408670197452413,0.0011664826856816466,0.0013034147845995016,0.0014522734074754861,0.001613667439269993,0.0017882019986504418,0.0019764758397325744,0.0021790787287306939,0.0023965888064487722,0.0026295699436467246,0.0028785690889095265,0.0031441135950323095,0.0034267084856749522,0.0037268335821796237,0.0040449403406659255,0.0043814481374705389,0.0047367395682899327,0.0051111540719860358,0.0055049788340760806,0.005918435456088408,0.0063516603038288912,0.0068046758139951643,0.0072773494401804362,0.0077693365164995575,0.0082800033359214462,0.0088083274523540114,0.0093527738882110481,0.0099111487477622235,0.010480435707563268,0.011056625718866271,0.011634555443443053,0.012207774607809549,0.012768465603679011,0.013307439332166281,0.013814228799733583,0.014277296087317443,0.014684359331776866,0.015022835099723577,0.015280379215381177,0.015445497162715087,0.015508185074790622,0.01546055534313638,0.015297398001916308,0.015016630808894824,0.014619597398890866,0.014111183546785042,0.013499735484667152,0.012796780022768683,0.012016562337994174,0.011175432072719113,0.010291120326595966,0.009381958045400509,0.0084660894981201731,0.0075607328147585407,0.0066815333098979354,0.0058420453996252016,0.0050533665439765844,0.0043239332111077496,0.0036594757649365465,0.003063117663856068,0.0025355953683023759,0.0020755694582854272,0.0016799948287327569,0.0013445182629164708],[1.284539876862277e-06,1.7512875721502284e-06,2.3674785346679283e-06,3.1739548552875061e-06,4.2205667803810463e-06,5.5675879161341392e-06,7.2872253040447494e-06,9.4652065085710941e-06,1.2202421913822819e-05,1.5616597022732939e-05,1.9843966867806378e-05,2.504092281023089e-05,3.1385601101091826e-05,3.9079382621926807e-05,4.834827417109405e-05,5.944414342610752e-05,7.264578216034934e-05,8.8259775271550282e-05,0.0001066211565264328,0.0001280938354832788,0.00015307078368041911,0.00018197397175590154,0.00021525405260129879,0.00025338978888754613,0.00029688722629431479,0.00034627861650846201,0.00040212109652828436,0.00046499513302538194,0.00053550274248709187,0.00061426549960400402,0.00070192234789322172,0.00079912722787141993,0.00090654653922318362,0.001024856454358356,0.0011547401015244074,0.0012968846362420158,0.001451978220268901,0.0016207069275714281,0.0018037515968954917,0.002001784650469904,0.002215466898123354,0.0024454443455922733,0.0026923450249150866,0.0029567758632889759,0.0032393196040988201,0.0035405317890579019,0.0038609378018003454,0.0042010299578478247,0.0045612645986896575,0.0049420591009488486,0.0053437886335625578,0.0057667823701550045,0.0062113186690032412,0.006677618444363943,0.007165835546225993,0.0076760424253135692,0.0082082086927779459,0.0087621694355829588,0.0093375794250215964,0.0099338488394647081,0.010550056076018844,0.011184833971868641,0.011836227622622717,0.012501525213967161,0.013177067914373283,0.013858050637134377,0.014538331719216336,0.015210275281785925,0.015864654021832649,0.016490641250907212,0.017075918263037851,0.017606916236837803,0.018069201182326119,0.018447996909821233,0.018728826113290319,0.018898235190804618,0.018944556163387857,0.018858650584422831,0.018634576838559871,0.018270124358898281,0.017767166077092483,0.017131793266733249,0.016374213671940162,0.015508412797743596,0.014551597563372686,0.01352345921089956,0.012445306621721958,0.011339130615953574,0.010226663548015451,0.0091284963706007513,0.0080633077805982653,0.0070472481212669668,0.0060935058522457435,0.0052120682893959536,0.0044096726390085734,0.0036899295866193531,0.0030535909756791392,0.0024989261012282149,0.002022168046511169,0.0016179920637591732],[2.0277054626334119e-06,2.7562767431131549e-06,3.7147433369445864e-06,4.9646706214812936e-06,6.5807778771821721e-06,8.6528772178419783e-06,1.12879071176365e-05,1.4612028550593112e-05,1.8772746723259055e-05,2.3941017474772067e-05,3.031329487512759e-05,3.8113475516627877e-05,4.7594695507684335e-05,5.90409381818396e-05,7.2768413874560022e-05,8.9126677568408214e-05,0.00010849945548713777,0.00013130515753358355,0.00015799705852347881,0.00018906313720482576,0.00022502556785267431,0.00026643986462876506,0.00031389368378687222,0.0003680052931316133,0.00042942172188741538,0.00049881660732338496,0.00057688775714780983,0.000664354448882097,0.00076195448920011381,0.0008704410576241122,0.00099057936004591941,0.0011231431183278081,0.0012689109227606843,0.0014286624744411307,0.0016031747446921519,0.0017932180785105365,0.0019995522686893654,0.0022229226267476269,0.0024640560761064164,0.0027236572920810507,0.0030024049121914914,0.0033009478389745433,0.0036199016557815536,0.0039598451736929385,0.004321317124134594,0.0047048130060140872,0.005110782086339704,0.0055396245360863168,0.0059916886530985919,0.0064672680724299596,0.0069665987786647482,0.0074898555959627983,0.0080371476154970506,0.0086085116978343174,0.0092039027306936583,0.0098231787102081997,0.010466077949549605,0.011132184849706123,0.011820879808218438,0.012531268196295738,0.013262083202625849,0.014011558099694859,0.01477726552942122,0.015555925037177908,0.016343185391521846,0.017133394934763853,0.017919380590986515,0.018692263053027878,0.019441340635391945,0.020154075867153246,0.020816215991595721,0.021412070658258765,0.021924957572134317,0.022337810849222661,0.022633929103058757,0.022797822995682841,0.02281610730719982,0.022678372428185961,0.022377965979952903,0.021912617782319996,0.02128485063714735,0.020502134646755595,0.019576762625516296,0.018525446640274411,0.017368658558494097,0.016129758358042805,0.014833970739696766,0.013507281631520885,0.012175330495462853,0.010862371723649433,0.0095903694023385007,0.0083782755589104779,0.0072415244185053459,0.0061917561639539733,0.0052367651969645011,0.0043806516849320305,0.0036241425699211969,0.0029650400049935598,0.0023987515947226832,0.0019188575588124652],[3.1624331173179336e-06,4.2859968272970076e-06,5.7588911431008585e-06,7.6727343286815365e-06,1.0138075089258127e-05,1.328699057963724e-05,1.7275757002699986e-05,2.2287539374471649e-05,2.8535041207604732e-05,3.6263051153077679e-05,4.5750822313806784e-05,5.7314221110537622e-05,7.1307586170629762e-05,8.8125243488371461e-05,0.00010820263169589043,0.0001320170002124343,0.00016008765278264771,0.00019297571894744562,0.0002312834458352458,0.00027565301191761311,0.00032676487274394586,0.00038533565596527981,0.00045211562909096048,0.00052788576839451519,0.000613454461263235,0.00070965387717924577,0.000817336044558778,0.0009373686719949065,0.0010706307531717536,0.0012180079949529589,0.0013803881079821202,0.0015586559986369407,0.0017536889004041382,0.0019663514817280497,0.0021974909661620049,0.0024479322992411287,0.0027184733949174684,0.0030098804926686341,0.0033228836545206933,0.0036581724292174054,0.0040163917086057021,0.0043981377989380675,0.0048039547270855758,0.0052343307983289339,0.0056896954178810724,0.0061704161815070314,0.006676796229555579,0.0072090718399093279,0.0077674102029294881,0.0083519072660126568,0.0089625854425837408,0.009599390829733042,0.010262189343028416,0.010950760823491975,0.01166478966641926,0.012403849839168443,0.013167381294375573,0.013954653793041802,0.014764713150643651,0.015596304131733034,0.016447763980056783,0.01731688131295641,0.018200717294534915,0.019095390013375908,0.019995828968539721,0.020895514245808922,0.021786223553383416,0.0226578184637529,0.023498107289091522,0.024292824261506456,0.02502576171039957,0.025679083074693031,0.026233830176516842,0.026670619525742133,0.026970501628753647,0.027115936899325135,0.027091824426235405,0.02688650783605568,0.026492677488737064,0.025908091149800607,0.025136046098716804,0.024185553473667656,0.023071188838093837,0.021812619186767634,0.020433833226717529,0.018962126048840008,0.017426908786437805,0.015858426626290941,0.01428647346126642,0.012739188313775542,0.011242008079417823,0.009816834586648877,0.0084814534578544747,0.007249220098947253,0.0061290066428653228,0.0051253848527328715,0.0042390053860977698,0.0034671243443118718,0.0028042239360600804,0.002242675023244278],[4.8732001596119343e-06,6.5850999487684496e-06,8.8213416686804297e-06,1.1716526987854821e-05,1.5432103378537495e-05,2.0159761203704522e-05,2.6124842946326435e-05,3.3589679987167105e-05,4.2856766638764154e-05,5.4271679119536861e-05,6.8225649055402799e-05,8.5157706889792955e-05,0.00010555631994125947,0.00012996046219050363,0.000158960067430681,0.0001931958332869699,0.00023335835988841475,0.00028018662280072248,0.0003344657944763856,0.0003970244413997291,0.00046873113495154783,0.00055049052264123253,0.00064323891277785761,0.00074793943003517369,0.00086557680195821518,0.0009971518375559334,0.0011436756590260269,0.0013061637466441106,0.0014856298551586533,0.0016830798578573965,0.00189950557195455,0.0021358786161940059,0.0023931443486422095,0.0026722159296010285,0.0029739685514367162,0.0032992338739164418,0.0036487947003850602,0.004023379926814191,0.004423659792422617,0.0048502414572025076,0.0053036649282736945,0.0057843993534729757,0.0062928396968326625,0.0068293038063208557,0.0073940298788149348,0.0079871743196247274,0.0086088099818829589,0.0092589247510876643,0.009937420405776401,0.010644111626663424,0.011378724928136279,0.012140897125466338,0.012930172698420211,0.013745999030442308,0.014587717953268371,0.015454551278580947,0.016345577045222413,0.017259692097365643,0.01819555546284746,0.019151506061115674,0.02012544790598229,0.021114696663960118,0.022115783719967096,0.023124218250266532,0.024134214416508475,0.025138399433576788,0.026127528085904513,0.027090238803556196,0.02801289372504738,0.028879548217605463,0.029672092406325252,0.030370597516976312,0.030953883536008895,0.031400303300540645,0.031688714093519366,0.031799584145276075,0.031716161222195983,0.031425616430044358,0.030920070458747371,0.030197412779609984,0.029261836756485731,0.028124034195301812,0.026801019561903582,0.025315584275986746,0.023695412063345325,0.021971914188865273,0.020178865677245261,0.018350938177876527,0.016522230660062542,0.014724895381162777,0.012987944330157354,0.011336302284767183,0.0097901490524995183,0.0083645680460230493,0.0070694937119657308,0.0059099288068209044,0.0048863858439764261,0.0039954962578048021,0.0032307262273496965,0.0025831392657260552],[7.4199542150133998e-06,9.9970693553992747e-06,1.3351654357524579e-05,1.7678939724383286e-05,2.3211662718579435e-05,3.0224388896098939e-05,3.9037722407217758e-05,5.0022276991453073e-05,6.3602275992929294e-05,8.0258652161326762e-05,0.00010053152657675308,0.00012502196036085137,0.00015439289207817337,0.00018936919668947178,0.00023073682714374496,0.00027934102564086645,0.00033608361676638101,0.00040191941778852717,0.00047785182140178091,0.00056492762244124439,0.00066423117228413741,0.00077687795284010471,0.00090400766652478834,0.0010467769399137249,0.0012063517374900504,0.0013838995786545601,0.0015805816465431903,0.0017975448716937648,0.002035914067615178,0.002296784189125919,0.0025812127781372715,0.0028902126554745801,0.0032247449114172415,0.0035857122419162219,0.0039739526719200129,0.0043902337018979377,0.0048352469084859346,0.0053096030251858009,0.0058138275242182692,0.0063483567159510782,0.0069135343777695871,0.0075096089197657818,0.0081367310900478506,0.0087949522175153616,0.0094842229839937064,0.010204392709505692,0.010955209122012841,0.011736318562342876,0.012547266539704683,0.013387498492561252,0.014256360507286165,0.015153099579047567,0.016076862733216256,0.017026693920880916,0.018001527014895845,0.019000172426247772,0.020021293822679736,0.021063370203688737,0.022124637297372761,0.023203001147642233,0.024295916253403247,0.025400221238860092,0.026511927382572867,0.027625959957948719,0.028735859526248467,0.029833459875571417,0.03090857034315871,0.031948701192203409,0.032938879360037358,0.033861605878812873,0.034697003568254128,0.035423193096568342,0.03601691738956269,0.036454410236465735,0.036712477573410916,0.036769732807626042,0.036607904282618384,0.036213116748429031,0.035577041801797139,0.034697815885223623,0.033580638539451563,0.032237986954343469,0.03068941318071625,0.028960924587911281,0.02708398277329593,0.025094187599498524,0.023029738166725471,0.020929778871132922,0.018832744823540762,0.016774816540322559,0.014788579867477506,0.012901965464742059,0.011137515491627279,0.009511996401266971,0.00803634894344573,0.0067159422174261352,0.0055510798661636673,0.004537694425792692,0.0036681607468024933,0.0029321608156794177],[1.1163499630587491e-05,1.499690487001082e-05,1.9969153826398154e-05,2.6359809548833527e-05,3.4500047047676469e-05,4.4777978188794337e-05,5.7643644611515062e-05,7.3613492459011071e-05,9.3274144874736951e-05,0.00011728529984307155,0.00014638160170854148,0.00018137336351007867,0.000223146052360549,0.00027265848923463843,0.00033093975517753177,0.00039908483557664148,0.0004782490704485864,0.00056964150982732734,0.00067451729802591235,0.00079416922815833885,0.00092991861884800177,0.0010831056690454224,0.0012550794452523379,0.001447187649353174,0.001660766305910533,0.0018971294963481026,0.0021575592549234169,0.0024432957285738023,0.0027555276901661003,0.0030953834827503767,0.0034639224612945238,0.0038621269881176251,0.0042908950288215722,0.0047510333868728289,0.0052432516070259443,0.0057681565704236692,0.0063262477973861902,0.0069179134675568981,0.0075434271611615226,0.0082029453196209041,0.0088965054185882308,0.0096240248415777486,0.010385300437556318,0.011180008740865582,0.012007706826005564,0.012867833761945217,0.013759712618519887,0.014682552957193272,0.015635453703272389,0.016617406235559837,0.017627297425271766,0.018663912183625172,0.01972593480214101,0.02081194794774394,0.021920427557658564,0.023049731023982657,0.024198074946507487,0.025363497400913534,0.026543798246343918,0.027736449742617963,0.028938469085124093,0.030146244973510695,0.031355312682335844,0.032560076928223512,0.033753489501644869,0.034926699011097503,0.036068702293360587,0.037166039365701432,0.038202583830896628,0.039159485698971826,0.040015321283009865,0.04074649375509664,0.041327908175039049,0.041733918023748352,0.04193950958767044,0.041921659921001816,0.04166077770684623,0.041142117808269069,0.040357052307376566,0.039304084728911164,0.037989509869245486,0.036427647774221125,0.034640614331656099,0.032657629201120711,0.030513900453106917,0.028249160359770098,0.025905954722216875,0.023527806220538249,0.021157378959004793,0.018834766378604786,0.016596009044191146,0.014471924623097673,0.012487302599091111,0.010660484255002234,0.0090033175287771803,0.0075214494029984258,0.0062148977080948133,0.0050788308835532144,0.0041044786812079789,0.0032800984754366293],[1.659702246793783e-05,2.2231483480588645e-05,2.9514023094346018e-05,3.8839873966630699e-05,5.0674199334892901e-05,6.5558405161402351e-05,8.4115755549361685e-05,0.00010705603096746958,0.00013517898299601069,0.00016937636767149554,0.00021063238083425515,0.0002600223707979035,0.00031870976283994055,0.00038794119251918879,0.00046903990650430574,0.00056339754650751338,0.00067246448072198241,0.00079773888542808793,0.00094075480580981669,0.0011030694392633285,0.0012862498873430887,0.0014918596155236591,0.0017214448452135052,0.0019765210822110472,0.0022585599622574155,0.002568976569465684,0.002909117358747949,0.0032802487900269349,0.0036835467606835082,0.0041200869036629763,0.0045908358019703882,0.0050966431557741432,0.0056382349257561963,0.0062162074654122327,0.0068310226454476103,0.0074830039650020446,0.0081723336369853312,0.0088990506281771149,0.009663049628833768,0.010464080921272387,0.011301751112186644,0.01217552468919034,0.013084726358103888,0.014028544113470454,0.015006032990075073,0.016016119436638391,0.017057606242141057,0.018129177926430956,0.019229406473047744,0.020356757222335375,0.021509594639285656,0.022686187497020772,0.023884712737057896,0.025103256835101222,0.026339812863453039,0.027592270549663105,0.028858395460823482,0.03013579202341482,0.031421843544556516,0.032713620996595069,0.034007751502248496,0.035300237827370719,0.03658622248683429,0.037859695008509206,0.039113148944759389,0.040337206302964806,0.041520240325057085,0.042648041194397711,0.043703580686415583,0.044666938005563442,0.045515447326248307,0.046224116153655244,0.046766342431099402,0.047114929090314416,0.047243360864754738,0.047127274111418913,0.046746020817452501,0.046084207078473029,0.045133077162150398,0.043891618348225726,0.042367278980184157,0.040576220951789831,0.038543065260220957,0.036300131417196027,0.033886214047195148,0.03134497853470497,0.028723088214996792,0.026068195370918149,0.023426935498775635,0.02084305866895848,0.018355814478260395,0.015998680438650291,0.013798490914057769,0.011774988578694681,0.0099407864683632233,0.0083016992070195795,0.0068573792963006761,0.0056021798458819856,0.0045261591479779182,0.0036161444613868753],[2.4384263478539786e-05,3.2568135539973204e-05,4.3108400494902407e-05,5.6556720297513047e-05,7.3558017997130387e-05,9.4857596071464041e-05,0.00012130698837996992,0.00015386819538243198,0.00019361598844712849,0.00024173802566814642,0.00029953259571015978,0.00036840389320831,0.00044985482331515826,0.00054547742757702006,0.00065694111191966264,0.00078597893430374809,0.0009343722700301322,0.0011039342138813124,0.0012964920992946773,0.0015138695163983279,0.0017578681953484148,0.0020302500924218795,0.0023327199777443651,0.0026669087794339861,0.0030343578930101468,0.0034365046201684586,0.0038746688596399325,0.0043500411361648943,0.0048636720221902048,0.0054164629807165335,0.0060091586363492317,0.0066423404643863029,0.0073164218739831125,0.0080316446503715215,0.0087880767121859046,0.0095856111326843071,0.010423966367698044,0.011302687628244863,0.012221149331726593,0.013178558562378319,0.014173959469035559,0.015206238526223262,0.016274130582856105,0.017376225621145599,0.018510976145999791,0.019676705121087559,0.020871614359616989,0.022093793261802237,0.023341227760156392,0.024611809276873575,0.025903343396841867,0.027213557788600354,0.02854010862639705,0.029880584330970753,0.031232504798729157,0.032593313374939689,0.033960357614636637,0.035330853386865813,0.036701825231747184,0.038070014338708123,0.039431744526349233,0.040782736812013838,0.042117865346894982,0.043430852448541793,0.044713908743176919,0.045957336054900447,0.047149124831793773,0.048274592754672808,0.04931612397588462,0.05025307590363854,0.051061919487604947,0.05171666750494168,0.052189623062007119,0.052452449157931576,0.052477523340620336,0.052239504120641052,0.051717003147621968,0.050894233896368581,0.049762497182779711,0.048321367963209801,0.046579466468922442,0.044554727976694145,0.042274126173862031,0.039772850877762903,0.037092987028055802,0.034281783614847558,0.03138963431791706,0.028467912921096909,0.025566814215545301,0.022733344853779154,0.020009589731649249,0.017431350541265222,0.015027217675579522,0.012818098656501411,0.010817189638482333,0.0090303447358159421,0.007456773497480613,0.0060899812968292066,0.0049188610792646791,0.0039288471590060228],[3.5404473277972417e-05,4.7151472735841131e-05,6.2227347153739917e-05,8.1392329591476937e-05,0.00010552901777259828,0.00013564985663345704,0.00017290250332235515,0.00021857262264945369,0.00027408373439026702,0.000340993835424266,0.00042098864358879778,0.0005158714481389411,0.00062754969404487824,0.00075801856368826756,0.00090934194004765889,0.0010836312320058759,0.0012830226092353026,0.0015096532284510386,0.0017656370349804034,0.0020530406966978152,0.002373860176727458,0.002729998383597916,0.0031232442598811755,0.0035552535895255906,0.0040275317258282716,0.0045414183705737333,0.0050980744729909079,0.0056984712660497526,0.0063433814171922273,0.0070333722399438491,0.0077688008905363818,0.0085498114580501855,0.0093763338460712484,0.010248084337075549,0.011164567726607033,0.012125080911997656,0.013128717819335698,0.01417437555226733,0.015260761646801525,0.016386402317449866,0.017549651581676963,0.01874870115166212,0.019981590984613176,0.021246220385016699,0.022540359553653959,0.023861661477808899,0.025207674052710231,0.026575852312038756,0.027963570618619329,0.029368134614078049,0.030786792630573028,0.032216746101973129,0.033655158238157068,0.035099159794725047,0.036545850122765421,0.037992290761346345,0.039435487600784497,0.040872356110598404,0.042299662401233257,0.043713931229370062,0.045111310911968419,0.046487385142184867,0.047836923723947954,0.049153569114899938,0.050429464035225698,0.051654837378667308,0.052817580507202387,0.053902861899394333,0.054892842190013322,0.055766560371717531,0.056500061901255845,0.057066828240658521,0.05743854437519931,0.057586207758600343,0.057481542759026186,0.057098644313012738,0.056415738916822014,0.055416925515542934,0.054093747116683563,0.052446447996090745,0.050484791084571982,0.048228343532310862,0.045706181996733035,0.042956018252500172,0.040022795107280504,0.036956847199691389,0.033811756551503286,0.030642055356999705,0.027500936511150174,0.024438125558379709,0.021498047468914087,0.018718390698438475,0.016129133128447822,0.013752053969461647,0.01160071672952652,0.0096808745498980185,0.0079912233064560172,0.0065244114399630841,0.0052682088834957036,0.0042067399839725],[5.0803717741136972e-05,6.7467761498513426e-05,8.8778590295796167e-05,0.00011577058514608481,0.00014963599494277003,0.00019173195413852166,0.00024358415740628389,0.00030688663520863301,0.0003834972070667438,0.00047542835938239132,0.00058483349121246512,0.00071398868056791022,0.00086527032997436057,0.0010411292374516595,0.0012440617936467326,0.0014765791167022529,0.0017411749970452622,0.0020402935330657108,0.0023762972989220892,0.0027514368049187292,0.0031678218994725944,0.0036273956315458124,0.0041319109554691074,0.004682910526896877,0.0052817097175163951,0.0059293828726102926,0.0066267527523621731,0.00737438303514764,0.0081725737173269468,0.0090213592164160878,0.0099205089695902672,0.01086953031390853,0.011867673435467721,0.012913938179507043,0.014007082520541643,0.015145632499732956,0.016327893445210063,0.017551962299579196,0.018815740887257796,0.020116949962518435,0.021453143887238599,0.022821725795320019,0.024219963108477096,0.025645003275361112,0.027093889612248741,0.028563577127722565,0.030050948213887606,0.031552828079037205,0.033065999774879395,0.034587218624673843,0.036113225769610797,0.03764076039313341,0.039166569918928973,0.040687417057855453,0.04220008194199143,0.043701356668845691,0.045188028341230486,0.04665684513254055,0.048104458130588605,0.049527329960160606,0.050921599896565112,0.052282895021504211,0.053606078785611334,0.054884933034699442,0.05611177785664119,0.057277045730486732,0.058368841758690518,0.059372538459113111,0.06027046877059037,0.061041790893813154,0.061662599627240765,0.062106348195692697,0.062344621316757623,0.062348265946168775,0.062088844702913745,0.061540334021551221,0.060680950867096593,0.059494964095706412,0.057974333479199378,0.056120023192795451,0.053942857116706877,0.051463818475206695,0.04871374230526386,0.04573240103768772,0.042567035571368456,0.039270431194720963,0.035898674811613823,0.032508753615800877,0.02915616365401915,0.025892689400196341,0.022764494019397428,0.019810627376250004,0.017062019015672263,0.014540980785567089,0.012261202883102614,0.010228191705921524,0.008440070817397784,0.0068886492238996889,0.0055606543869404709,0.0044390301864343758],[7.2051324126746024e-05,9.5415134786634321e-05,0.000125188675849739,0.00016276151997324999,0.00020972337077335718,0.00026786923990456286,0.00033919957361457461,0.00042591468355094523,0.00053040306025010236,0.00065522341808514661,0.00080308061911045416,0.00097679592785497853,0.0011792723356273971,0.0014134559382215019,0.0016822945355935955,0.0019886947325527377,0.0023354788495782443,0.0027253429042930848,0.0031608168059998076,0.0036442277330535999,0.0041776674544587254,0.0047629641329122521,0.0054016589253740969,0.0060949874947388996,0.0068438663734902211,0.0076488839835539019,0.0085102960174705984,0.0094280248221637521,0.010401662393003799,0.011430476576164533,0.012513420084751745,0.013649141952749534,0.014836001075461683,0.016072081512114551,0.017355209253185178,0.018682970180435174,0.020052728970968714,0.021461648717808233,0.022906711058688686,0.0243847366223236,0.025892405617590181,0.027426278406149352,0.028982815913050297,0.030558399742774345,0.03214935187954477,0.033751953859638695,0.035362465308045231,0.036977141728700591,0.038592251420635722,0.040204091351427634,0.041809001737737182,0.043403378934911155,0.044983685986688109,0.046546459782291952,0.048088313151007242,0.049605929329989612,0.05109604502015351,0.052555416692731803,0.053980763009820742,0.055368674404210581,0.05671547945292036,0.058017057328534856,0.059268587178185145,0.060464229703409311,0.061596744292954329,0.062657057113892967,0.063633811056931985,0.064512945667478241,0.065277371269253523,0.065906812602021483,0.06637789948996109,0.066664572236568242,0.06673884639496698,0.066571946627277612,0.066135776465328477,0.065404645776394946,0.064357137280153756,0.062977963733312547,0.061259653011085886,0.059203901658943014,0.056822458527803626,0.054137436566615897,0.051180998662120863,0.047994417322234688,0.044626562191611235,0.041131918184646565,0.037568275488602754,0.033994257167048195,0.030466858567574636,0.027039165014588102,0.023758391924986594,0.02066435760123967,0.017788457669149476,0.015153166073674009,0.012772045279765725,0.010650211788084374,0.0087851751925998381,0.0071679514514070989,0.005784344184576835,0.0046162908442069816],[0.00010099926789459382,0.00013337668094121383,0.00017449159673564729,0.00022618714617539282,0.00029055553978777628,0.00036993928783503701,0.00046692506109613751,0.00058432950143200841,0.00072517664834670522,0.0008926670599437161,0.0010901391439285175,0.0013210236418742171,0.0015887925920741216,0.0018969044002713667,0.0022487468477108826,0.0026475799467745144,0.0030964805123853221,0.0035982901610648391,0.0041555681984648662,0.004770550537825575,0.0054451154378150259,0.00618075649041612,0.0069785629561947169,0.0078392072572120736,0.0087629392107770997,0.0097495864255658284,0.010798560183325295,0.011908866086719512,0.013079118755674725,0.014307559888349629,0.015592079056628577,0.016930236669639533,0.018319288604515777,0.019756212066292422,0.021237732295578935,0.022760349792368753,0.024320367767130605,0.025913919566942785,0.027536995855927237,0.029185471356657524,0.030855130983444334,0.032541695220109725,0.034240844614458608,0.035948243279276794,0.037659561305110827,0.039370496002562365,0.041076791899742594,0.042774259420758715,0.044458792158050944,0.046126382615454979,0.047773136224361419,0.04939528329795953,0.050989188352744949,0.052551355843852884,0.054078430771341987,0.055567191753551362,0.057014532977672207,0.058417429913501011,0.059772881884187806,0.06107782273627807,0.062328989343435552,0.063522737147181013,0.064654793231769231,0.065719941508404919,0.066711642299073809,0.067621600377470933,0.068439310932161559,0.069151630396202132,0.069742435802607514,0.07019244844141187,0.070479300982625434,0.070577918508139353,0.07046126152553725,0.070101444095931373,0.0694711965288307,0.068545595665603171,0.067303943558374185,0.065731643926112443,0.063821910110926985,0.061577140988263085,0.059009822434708342,0.05614284916494041,0.053009210758798421,0.049651041012580333,0.046118085334173463,0.042465690893674475,0.038752463578353297,0.035037760755648448,0.031379197395483574,0.027830335086147198,0.024438700544572707,0.021244245545801291,0.018278318018625218,0.01556316911487365,0.013111978002826834,0.010929338972033102,0.0090121271356364378,0.0073506412658554086,0.005929915459467053,0.0047310945624270961],[0.00013994112174217624,0.00018429197981499921,0.00024041415962057486,0.0003107215269566488,0.0003979319500611841,0.00050506147892724748,0.00063540813073231881,0.00079252463172632714,0.00098018001275051504,0.0012023105620367846,0.0014629612579389949,0.001766219383530482,0.0021161425130153308,0.0025166834119588919,0.0029716145772499614,0.0034844551429428937,0.0040584026978872896,0.0046962722217564886,0.0054004438844007336,0.006172820916286079,0.0070147981960698306,0.0079272416636564109,0.0089104781939394872,0.0099642951864957179,0.011087948854604729,0.012280180034533955,0.013539236273178526,0.014862898971124512,0.016248514437204955,0.01769302782739585,0.019193019075586362,0.020744740060639869,0.022344152382361728,0.023986965232262895,0.025668672940939212,0.027384591862788195,0.029129896322621768,0.030899653400177345,0.032688856370317973,0.034492456651245902,0.036305394142220088,0.038122625857429163,0.039939152784681006,0.041750044916865049,0.043550464420698244,0.045335686920524566,0.047101120883497584,0.048842325093554739,0.050555024190096866,0.052235122214393782,0.053878714037902335,0.055482094419130629,0.05704176421579274,0.058554432920438042,0.060017016132161947,0.061426625759890982,0.06278054961796746,0.064076215601519326,0.065311133873197619,0.066482808640638213,0.067588609529412175,0.068625591861649543,0.069590256160879493,0.070478240877374795,0.071283949554966558,0.072000124940651167,0.072617397592393634,0.073123853952708928,0.073504685918174675,0.073741996855528499,0.073814843573920291,0.073699586347822546,0.073370597837906948,0.072801347448237089,0.071965833934243773,0.070840291930704194,0.069405054669708324,0.067646422393045316,0.065558369129973065,0.063143922464979324,0.060416071784096068,0.057398097860573274,0.054123266134009994,0.050633881987240524,0.046979762546930315,0.043216230047447908,0.03940177147821361,0.035595534337499651,0.03185483683344098,0.028232862688274022,0.024776687513049105,0.021525748752167919,0.018510828736540929,0.015753575206667706,0.013266540440666132,0.011053682869992847,0.0091112467558523182,0.0074289178116916481,0.0059911459369676673,0.00477852961444045],[0.0001916658815802811,0.00025172105604172004,0.00032745042472357946,0.00042197546829525202,0.0005387809871104873,0.00068169793422982565,0.00085487197417029055,0.0010627173081608622,0.001309856115187392,0.0016010448227425469,0.0019410892704232769,0.0023347515871052524,0.0027866521962624639,0.0033011707351319284,0.0038823497838857499,0.0045338051391791978,0.005258645949121306,0.0060594073969654711,0.006937997842501601,0.007895661479424141,0.0089329567224279635,0.010049749770632133,0.011245222159840354,0.012517890650073187,0.013865637509226978,0.015285749140294042,0.016774961033600235,0.018329507171941609,0.019945172236441294,0.021617345217376367,0.023341073296163851,0.025111115109506921,0.026921992720548765,0.028768041798772515,0.030643459650361041,0.032542350847731043,0.034458770286874066,0.036386763560263005,0.038320404577119709,0.040253830396385276,0.042181273264171697,0.044097089869063813,0.045995787846755343,0.047872049580812759,0.049720753358980047,0.051536991953901198,0.05331608870220355,0.055053611154059066,0.056745382352035682,0.058387489765264554,0.059976291839394673,0.061508422003498063,0.06298078977073332,0.064390578236567561,0.065735236760935151,0.067012466855809069,0.06822019822982972,0.06935655053959941,0.070419774704750984,0.071408165823432554,0.072319938116687771,0.073153051496754468,0.073904980083156865,0.074572416220493293,0.075150910189597214,0.07563445642091729,0.076015051466453334,0.076282266024352424,0.076422890408805802,0.076420726342474987,0.076256603594187719,0.07590869401759677,0.075353175816660858,0.074565267801756013,0.073520610378306608,0.072196922905420347,0.070575823114439717,0.068644660589785841,0.066398198451536924,0.063839978417896265,0.060983224609290489,0.057851178393784328,0.054476805814529176,0.050901874928888015,0.047175456463805852,0.04335195153452371,0.039488789660815364,0.035643965233603588,0.031873588973184652,0.028229622702984115,0.02475794266547619,0.021496841860728418,0.018476039764290544,0.015716223022986614,0.01322909795938737,0.011017898914505015,0.0090782685493296482,0.0073994088553785992,0.005965395116992552,0.004756548556677561],[0.00025950064816834134,0.00033989311785279796,0.00044091567029765414,0.0005665540395616552,0.00072121829535670213,0.00090970853061296281,0.0011371614461065747,0.0014089777977546317,0.0017307318315890263,0.0021080650290514376,0.0025465676157087726,0.0030516522415384795,0.0036284249225736398,0.0042815586670211774,0.0050151751528120367,0.0058327393770989085,0.0067369714022858388,0.0077297782556270721,0.0088122078053797358,0.0099844251546219107,0.011245710881083223,0.012594479408327596,0.014028314993344157,0.015544022296736537,0.017137688267650587,0.01880475209866667,0.020540080235575124,0.022338043800225259,0.024192596236417611,0.026097349460756092,0.028045647246824686,0.030030634961686255,0.032045325093270273,0.034082658253066465,0.036135559516970506,0.038196990089526324,0.040259994356332547,0.042317742438509783,0.044363568392278119,0.046391004213670567,0.048393809818500652,0.050365999174120629,0.052301862763928418,0.054195986568655846,0.056043267750139548,0.057838927222929076,0.059578519295440432,0.06125793855306759,0.062873424136557096,0.064421561532818097,0.065899281930195022,0.067303859077019565,0.068632903392308736,0.069884352770417671,0.071056459044900933,0.072147768370292562,0.073157092786530695,0.074083468917025733,0.074926098146401679,0.075684260865927444,0.076357195767056379,0.076943934221595428,0.077443080248903506,0.077852529338134913,0.078169125370229325,0.078388264694748563,0.078503470035143866,0.078505973271154925,0.078384362968314136,0.078124366303932297,0.077708841631219716,0.077118053472704437,0.076330283842306654,0.075322802539584482,0.07407317746209581,0.072560859682960041,0.070768934217888088,0.068685893264523706,0.06630726999787491,0.063636971028383713,0.060688164761030589,0.057483618810325016,0.054055427884089048,0.05044412838252775,0.046697251110773649,0.042867412991180597,0.039010087429196247,0.035181217399703493,0.031434843487605939,0.027820911004211999,0.024383397638386348,0.021158869080705332,0.018175528876280957,0.015452785061388386,0.013001314436800106,0.010823569500307204,0.0089146459441369289,0.0072634118096674685,0.0058537931817430715,0.0046661148369972431],[0.00034733491804393333,0.00045373102635557828,0.00058696872133482542,0.00075207336069076124,0.00095455329405451362,0.0012003408370382029,0.0014957082972206527,0.0018471597886847455,0.0022613011892822694,0.0027446922095037247,0.0033036860025003798,0.0039442629016834835,0.0046718655959389621,0.0054912432515759751,0.0064063117256696828,0.0074200361083947893,0.0085343404627516786,0.009750047929906084,0.011066852502705204,0.012483321917307841,0.013996929441750112,0.015604110988099468,0.017300343032459715,0.019080236330883613,0.020937640352037729,0.022865753647127882,0.024857235951445216,0.026904318553640623,0.028998910274946037,0.03113269718332146,0.033297234863095729,0.035484032631843986,0.037684629530318682,0.039890662214819496,0.042093925073581895,0.044286422994589007,0.046460417257124631,0.048608465025669234,0.050723452909688257,0.052798625028432994,0.054827605993356864,0.056804419195849422,0.058723500766006152,0.060579709548975381,0.062368333428176499,0.064085092308096919,0.065726138051721672,0.067288051646476943,0.068767837843932436,0.070162917475903211,0.071471117582271981,0.072690659376746694,0.073820143899996082,0.074858534928364792,0.075805138272282704,0.076659575954540024,0.077421752848663317,0.078091812145828957,0.078670074521717037,0.079156954206801383,0.079552843589945438,0.079857956969082017,0.080072124283099941,0.080194527965711027,0.080223381335777291,0.080155555837000167,0.079986177047890322,0.079708224841165604,0.079312189318008278,0.078785847934211603,0.07811423658773807,0.077279884496314399,0.07626336687052708,0.075044200412616266,0.073602067158939716,0.071918307428150613,0.069977579618680785,0.067769550503318912,0.065290460370716369,0.062544406315504814,0.059544204730220006,0.056311728398918674,0.052877660173841295,0.049280658337999585,0.045565982246410904,0.041783674825528659,0.037986436064155714,0.034227345237786685,0.03055759747196013,0.027024412376557977,0.023669250579550688,0.020526441165486055,0.017622283345870023,0.01497464363781479,0.012593029751238617,0.010479088002778783,0.008627445106848897,0.0070267991539116415,0.0056611587449830469,0.0045111327672344532],[0.00045961829982201641,0.00059884141480007224,0.00077259041102107045,0.00098712204421398946,0.0012492267154801714,0.0015661351356566352,0.0019453931655590633,0.0023947068272199452,0.002921761681732621,0.003534022890965099,0.0042385241116511124,0.0050416547089837923,0.005948955456589764,0.0069649328047644756,0.0080929009216281367,0.0093348591016314975,0.010691409934917195,0.012161721049145122,0.013743530523724278,0.015433193495268886,0.017225765258179884,0.019115114496938989,0.021094059273417974,0.023154518056163594,0.025287668363108362,0.027484106375336687,0.029734002009103026,0.032027245235655602,0.03435358075558935,0.036702729339950634,0.039064495159678178,0.041428859197578972,0.043786059370709861,0.046126658311883555,0.048441599909616863,0.050722255734200548,0.052960462428682638,0.055148551054193397,0.057279369275728638,0.059346297173862937,0.061343257378417802,0.06326472014466461,0.065105703930531569,0.066861771982161644,0.068529025392136067,0.070104093056893732,0.071584118924567244,0.07296674688863071,0.074250103642465259,0.075432779759195046,0.076513809190374218,0.077492647271152876,0.078369147155416055,0.079143534349022077,0.079816378618718029,0.080388561975817716,0.080861240613572277,0.081235797577444979,0.081513781574637761,0.081696825775050566,0.08178653894726165,0.081784360218721194,0.081691368762037989,0.081508041574635232,0.081233957077711597,0.080867450182750641,0.080405235937749869,0.079842033198290668,0.079170235173435355,0.07837968722113095,0.077457640160376817,0.076388945857798735,0.075156548223406797,0.073742296422525583,0.072128070250869036,0.070297165080616258,0.068235842225423962,0.065934917031561791,0.0633912373787935,0.060608903152406093,0.057600093350226277,0.054385399781111655,0.050993610589262717,0.047460937559410887,0.04382973231408082,0.040146782414042903,0.036461314268684104,0.032822852301755794,0.029279091308886569,0.025873931431110289,0.022645804316235588,0.019626387835197188,0.016839769046061815,0.014302075219467719,0.012021554781088859,0.0099990575092454397,0.008228838815656208,0.0066995978534087012,0.0053956537807393424,0.0042981679501461643],[0.00060132302364656969,0.00078145999546687514,0.0010055057067561263,0.0012811526974030446,0.0016166624070912752,0.0020207256856620498,0.0025022836328709454,0.0030703126808302827,0.0037335807561988416,0.0045003840781148059,0.0053782763726351627,0.0063738037483465912,0.0074922589735496523,0.0087374683075406266,0.010111622365933489,0.011615159863942969,0.013246709716627017,0.015003093203098583,0.016879384092046857,0.018869021147733693,0.020963964609657687,0.023154886296653614,0.025431382042575341,0.027782195216752782,0.030195440995520482,0.03265882262268862,0.035159832870399643,0.037685936024386836,0.040224727736658597,0.042764071838571234,0.045292214582767262,0.047797877747772617,0.050270332616465969,0.052699457091394675,0.05507577821830608,0.057390502238992211,0.059635534059959278,0.061803487761499971,0.063887689520262261,0.065882174097943114,0.067781675866713534,0.069581615197226859,0.071278080921904297,0.072867809497418959,0.074348161419020828,0.075717095379741306,0.076973140614919014,0.078115367822855358,0.07914335900150761,0.080057176483346482,0.080857331377356789,0.081544751525387413,0.082120748929481749,0.082586986378256386,0.082945442654551213,0.08319837519547546,0.083348278349283281,0.083397834392712394,0.083349853235610061,0.083207195318149907,0.082972670789703357,0.082648907001034957,0.082238176185983294,0.081742176667700339,0.081161764783480903,0.080496641644806119,0.07974500908643567,0.078903222211463647,0.077965480280481517,0.076923610691379291,0.075767008990836271,0.074482797640331,0.073056254868714643,0.071471541508474429,0.069712719952115698,0.067765019621153375,0.06561626383653886,0.063258340489717874,0.060688579262405992,0.057910894997189294,0.054936571078454177,0.051784586522321839,0.048481431913292759,0.045060407050632634,0.041560441409341502,0.038024521829549005,0.034497845706226535,0.031025839195856136,0.027652187018935768,0.024417013393320437,0.021355334079790341,0.01849587028909893,0.015860279945855222,0.013462824530802631,0.011310454288174458,0.0094032642726353845,0.0077352509075152001,0.0062952847438450367,0.0050682101598678985,0.0040359860520234941],[0.00077786286053713823,0.0010083420993812263,0.0012940379147714566,0.0016442902943752343,0.002069018749210381,0.0025785224230617273,0.0031832318707886724,0.0038934191992921249,0.0047188770639255218,0.005668580412691024,0.0067503474834796099,0.0079705180420972278,0.0093336669501826348,0.010842369757063796,0.012497034165403311,0.014295807143223253,0.016234562511635152,0.018306968505456284,0.020504629610990782,0.02281729244203394,0.025233101946869081,0.027738892130504764,0.030320494838450722,0.032963050911334849,0.035651309954989781,0.038369907735301099,0.041103613402684577,0.043837541985610066,0.046557330534328797,0.049249278710027329,0.051900456378513565,0.054498781865620752,0.057033075033337953,0.059493089365099353,0.06186952695161977,0.064154039785717085,0.066339220222271927,0.068418582921324189,0.070386540118202154,0.072238371676018265,0.073970191074004071,0.075578908259129454,0.07706219012227479,0.078418419237638273,0.079646651411128769,0.080746572509552514,0.081718454979810742,0.082563114410541011,0.083281866432996871,0.083876484198251847,0.08434915659666771,0.084702447291642557,0.084939254505604467,0.085062771296721892,0.085076445765350228,0.084983940186982132,0.084789087437199123,0.084495842216011641,0.084108223485729536,0.083630243261358095,0.083065815591044243,0.082418638536370215,0.081692041680532332,0.080888792790745692,0.080010860459007474,0.0790591354819353,0.078033122718545442,0.076930626840892274,0.075747468501120616,0.074477279684798114,0.073111435277065734,0.07163917875395559,0.070047990691163894,0.068324228359810751,0.066454034328184947,0.064424475497467867,0.062224837065752034,0.059847964935613118,0.057291530710679037,0.054559089357953804,0.05166081190938266,0.048613802662389891,0.045441948515154998,0.042175292322150351,0.03884896701213085,0.03550176752172518,0.032174469114370878,0.028908020428106636,0.025741746187146253,0.022711688022680063,0.019849193788881152,0.017179838776320584,0.01472272971341935,0.012490208109326897,0.010487936887386785,0.00871532640692225,0.0071662350598861698,0.0058298668521459167,0.0046917839183692944,0.0037349550530184541],[0.00099496120306344035,0.0012865901053085418,0.0016468856145572641,0.0020870472706529942,0.0026188290983822867,0.0032542626044107298,0.0040053222395174696,0.0048835438925794407,0.0058996118147082218,0.0070629335190209065,0.0083812251562045692,0.0098601311949506974,0.01150290164623324,0.01331014746202598,0.015279690238929881,0.017406516319725215,0.019682838362459563,0.022098260123759685,0.024640033316742672,0.027293389643557302,0.030041927018345099,0.032868026926082199,0.035753279890682658,0.038678897980836478,0.041626096775224192,0.044576433702427629,0.047512094567338285,0.050416124807903973,0.05327260613327086,0.05606678237311595,0.058785140488468321,0.061415453786527602,0.063946794597573367,0.066369523234022954,0.068675259203594199,0.070856839612902942,0.072908268649528526,0.074824661085896069,0.076602181967532254,0.078237984046705178,0.079730144085497126,0.08107759884959756,0.082280081410817024,0.083338058240777085,0.084252667485239463,0.085025658740219834,0.085659334595763262,0.08615649416384083,0.086520378758433159,0.086754619844076813,0.086863189308071215,0.086850352031988501,0.086720620625685779,0.086478712020255935,0.086129505365571943,0.085678000305748722,0.085129274170411218,0.084488435885093194,0.083760573457618337,0.08295069077680875,0.082063628289839666,0.081103961154714035,0.080075868097705394,0.078982964995954905,0.077828099798371742,0.076613110394044545,0.075338554770360153,0.074003433061627447,0.072604932853913229,0.071138240424498803,0.069596468687125837,0.067970754386055723,0.066250569891268554,0.064424277534470067,0.062479927653451853,0.060406268595189758,0.058193902972294875,0.05583649540046929,0.053331918160135945,0.050683216378857435,0.047899284633668167,0.044995171014696592,0.041991959303528122,0.038916220341235361,0.035799064783419203,0.032674866451600684,0.029579754443236874,0.026549990338277013,0.023620352932156256,0.020822647052647768,0.018184436590602683,0.015728077330660242,0.01347009561878838,0.011420927726196833,0.0095850051994625755,0.0079611462621986887,0.0065431944304264042,0.005320833993769895,0.004280508050260934,0.0034063676985977079],[0.0012584632174875276,0.0016234122746003007,0.0020728167094725921,0.0026199400008738781,0.0032785267674675647,0.004062429532423922,0.0049851686053925103,0.0060594408642226875,0.0072965992391690057,0.0087061296362338485,0.010295155231519925,0.012067998990705873,0.014025833586474957,0.016166443542403503,0.018484117671673302,0.020969681251685968,0.023610667681558627,0.026391619570001062,0.029294500298569802,0.032299190010522498,0.035384035383538869,0.038526420839911556,0.041703330055300705,0.044891870418077566,0.048069738843997435,0.051215614255140311,0.05430946921769688,0.057332799900061238,0.060268779037469515,0.06310234059221391,0.065820207160734404,0.068410872015118238,0.070864547261448141,0.073173088326482796,0.075329903235508186,0.077329853257033287,0.079169149717037673,0.080845250280970005,0.082356756830011354,0.083703316215089946,0.084885524610995591,0.085904835848139113,0.086763473904682975,0.087464349640545239,0.088010981805181548,0.088407422325388646,0.088658185861498554,0.088768183602013273,0.088742661244085794,0.088587141077802453,0.088307368052485249,0.087909259646795204,0.087398859280152244,0.08678229287344992,0.086065727967359895,0.085255334504528726,0.08435724594111392,0.083377518740064119,0.082322087497785704,0.081196711992698414,0.08000691141594464,0.078757880154910989,0.077454379086845576,0.076100596877290691,0.074699977834382286,0.073255016995866382,0.071767029666845103,0.070235911479272869,0.068659915412152536,0.067035482459628759,0.06535717036376601,0.063617727255635886,0.061808351683527739,0.059919165993989207,0.057939906867238142,0.055860807642809054,0.053673616381236543,0.051372666778675954,0.048955901135678125,0.046425739135043255,0.043789694536441721,0.04106066301236546,0.038256835224849163,0.035401225615841268,0.032520844549693034,0.02964557496782869,0.02680684096597645,0.024036172204670674,0.021363773640371161,0.018817204846835786,0.016420258480327684,0.014192105444271904,0.012146747840001191,0.010292792888301235,0.0086335345724449942,0.007167307233932366,0.0058880585070036889,0.0047860787552214557,0.0038488206985816333,0.0030617455883225923],[0.0015740902160653379,0.0020258116557993889,0.0025802792198557963,0.0032530078506441719,0.0040598580791974051,0.0050165452252426334,0.0061380727539978299,0.0074381123940095942,0.0089283609725970669,0.010617909645725399,0.012512664464925674,0.014614857390903098,0.016922683575084339,0.019430093999803902,0.022126762816552226,0.024998236762180746,0.028026260992732852,0.031189262867740833,0.034462963979848722,0.037821082234075466,0.041236080896375961,0.044679920669722102,0.04812477393705817,0.051543666774319055,0.054911023236940887,0.05820309657863567,0.061398282238441619,0.064477316527808304,0.06742337213755846,0.070222066404289435,0.072861400649192221,0.075331649084448657,0.077625214262447617,0.079736463422352438,0.081661556963404255,0.083398277145752667,0.084945862341547523,0.086304849926356883,0.087476929268843734,0.088464805198521387,0.089272071702542893,0.0899030952982528,0.090362907431843928,0.090657105271270674,0.090791760328006219,0.090773334417469764,0.090608602531988894,0.090304582245869694,0.089868469299236378,0.089307579017596353,0.088629293218414132,0.087841012231920701,0.086950111613809195,0.085963903039180722,0.084889598720064935,0.083734278456213784,0.08250485807923541,0.081208057553531041,0.079850366337146858,0.078438002797080533,0.076976863590902805,0.07547245813271275,0.073929822833977893,0.072353410147921848,0.070746949039950963,0.069113276849485969,0.067454147942159426,0.065770032055366037,0.064059924211803468,0.062321197181390404,0.060549534675569443,0.058738986312289437,0.056882181605829259,0.054970728422255144,0.052995801688878089,0.050948902769768954,0.048822742656760003,0.046612177772550563,0.044315110383961021,0.041933259775909379,0.039472716852942548,0.036944212949454332,0.034363060718883016,0.031748757208833668,0.029124272339742741,0.026515075951474138,0.023947980071559793,0.021449887854310325,0.019046545696859839,0.016761390488526567,0.014614570967867831,0.012622202734536079,0.010795893095315159,0.0091425473108452497,0.0076644445159627364,0.0063595517681099686,0.0052220298797371178,0.004242875738520579,0.0034106428146540072,0.0027121839564100136],[0.0019471386606631014,0.0025002090563298173,0.0031769350250764319,0.0039952439953673674,0.0049731966168883633,0.0061283552014339861,0.0074770684058346245,0.0090337034507908323,0.010809865974169532,0.01281365407122982,0.015048996159180443,0.017515121259557769,0.020206204754878904,0.02311122277559572,0.026214034771867456,0.029493697682173328,0.03292499797409499,0.036479171457631597,0.040124766901221784,0.043828599610673091,0.047556736298494072,0.051275453202989256,0.054952115266315188,0.058555934365304423,0.062058577724125687,0.065434612051693195,0.068661782932958271,0.071721141070998543,0.074597036051053986,0.077277003835210897,0.079751576201685187,0.082014039287586424,0.084060165068250869,0.085887934935237775,0.087497269407704775,0.088889773149515183,0.090068500350083472,0.091037742394817878,0.09180283762356653,0.09237000172776258,0.092746176766923108,0.092938896674012519,0.092956167273033838,0.09280635910340751,0.092498111637152658,0.092040247733489941,0.091441697380271997,0.090711429921457559,0.089858394072977466,0.088891465096326158,0.087819398538388896,0.086650789961100511,0.085394040073533836,0.084057324633455624,0.082648568390066193,0.08117542217286472,0.079645241967016348,0.078065068426979564,0.0764416047506805,0.074781190174367185,0.073089765608426768,0.071372827244619796,0.069635363549312546,0.067881771244974493,0.066115747088251547,0.064340154909645328,0.062556871811740813,0.060766623669871768,0.058968827702000043,0.057161467810650582,0.05534103495676948,0.053502567897235745,0.051639827148092093,0.049745625656027082,0.047812323318059742,0.045832470812962378,0.043799564410993246,0.041708851695573382,0.039558112650294616,0.037348334520995292,0.035084203711150709,0.032774353196065538,0.03043132731124297,0.028071253903654749,0.025713242908634679,0.023378556802139148,0.021089619122348656,0.018868940359208317,0.016738045053099143,0.01471648005274521,0.012820972605774594,0.01106479004998507,0.0094573325409803462,0.008003968850896697,0.0067061050390219562,0.0055614586011870108,0.0045644978878061088,0.0037069988505466964,0.0029786686143268952,0.0023677874974735833],[0.0023821313063667423,0.0030520103360287586,0.0038691303253946484,0.0048539561987099161,0.0060267823263409114,0.007406935658224781,0.0090118889970723145,0.010856326507100642,0.012951213897229677,0.015302932788990704,0.017912541340632828,0.020775220373973537,0.02387995569452149,0.027209493309793213,0.030740585819013466,0.034444526975165868,0.038287949378627131,0.042233839747358781,0.046242709452839162,0.05027384687555933,0.054286573844982866,0.058241431390549096,0.062101229754735879,0.065831912789200975,0.06940320551479022,0.072789033472083986,0.075967721212754621,0.078921992906016328,0.081638809180933289,0.084109080368882316,0.086327297391745106,0.088291118447489603,0.09000094359012667,0.091459501663529841,0.09267146611972478,0.093643109049572071,0.094381996923177808,0.09489672734615566,0.095196703539131136,0.095291941984342599,0.095192908398149909,0.094910377518512556,0.094455312834219832,0.093838763104247741,0.09307177318396101,0.092165307224669965,0.091130182729205075,0.089977014242468067,0.088716165658049337,0.087357710256401738,0.085911397677725987,0.08438662708679627,0.082792425812225956,0.081137432736011386,0.079429885660143446,0.077677611768717403,0.07588802011466167,0.074068094767418768,0.072224386845642044,0.070363003130116578,0.068489588346279842,0.066609297621001498,0.06472675523195516,0.062845995847174374,0.060970385341561871,0.059102520347027794,0.05724410924151109,0.055395842388902043,0.053557265801027688,0.051726679177637389,0.049901085114029672,0.048076219373807107,0.046246690701029339,0.044406251392906423,0.042548206538652752,0.040665951656257547,0.038753608052651725,0.036806706169387186,0.034822853159805253,0.032802314901669898,0.030748446038417251,0.02866791417455997,0.026570684167455678,0.024469752629062182,0.022380647909955902,0.020320733768135802,0.018308373005320299,0.01636201881880768,0.014499305659344191,0.012736208123836166,0.011086326767558226,0.0095603452257810029,0.0081656855984000819,0.0069063707087534745,0.0057830845214299955,0.0047934072980407505,0.0039321911253482429,0.0031920348683472312,0.0025638154428394857,0.0020372341529863985],[0.0028824335967274394,0.0036851350314896815,0.0046613245978235377,0.0058340850556227921,0.007225919748281762,0.0088577651879722698,0.010747910331338787,0.012910877765322655,0.01535633394490413,0.018088103124457449,0.021103361222212166,0.024392080566149308,0.02793678400041532,0.031712647724499658,0.035687967891093381,0.039824978564781989,0.044080980853673332,0.048409717814597977,0.052762909902047406,0.057091853557831536,0.061348982441164171,0.065489297114585399,0.069471583911253798,0.073259365335454019,0.076821550011481249,0.080132776801992975,0.08317347220810585,0.085929659962027935,0.08839257508453012,0.090558140894976977,0.092426366871316709,0.094000719082264331,0.095287504947450252,0.096295302316224171,0.097034451128088409,0.097516615639845886,0.097754417228717236,0.097761132396679121,0.09755044763991659,0.097136261842417318,0.096532527211921793,0.095753120921822407,0.094811741081934325,0.09372182210654427,0.092496465793709876,0.091148385402984741,0.089689860723136838,0.08813270260099601,0.086488225714604197,0.084767228571898043,0.082979979841691129,0.081136210203882189,0.079245108954437746,0.077315324620557804,0.075354968826469512,0.073371622587559457,0.071372344082304237,0.069363676738469909,0.067351656157444761,0.065341813987572522,0.063339176371490002,0.061348254107446543,0.059373021318132276,0.057416879425216977,0.055482603864124472,0.053572272552939663,0.051687177917158302,0.049827728370345534,0.04799335035837124,0.046182407764655722,0.044392160549555415,0.042618787494220114,0.040857497288737568,0.039102746752344167,0.037348574348151135,0.035589042202507679,0.03381876265193233,0.032033468908544069,0.030230576969216705,0.028409680032004288,0.026572918844490648,0.024725181496170107,0.022874102676818893,0.021029852863009131,0.019204729345711428,0.017412580661769383,0.015668111543281592,0.013986125407694379,0.012380764974524172,0.010864808917551391,0.0094490743416444506,0.0081419626285155634,0.0069491714583935363,0.0058735803178677874,0.0049153021778880522,0.0040718816256437975,0.0033386105194369107,0.0027089267089377617,0.0021748595698660774,0.0017274876869352582],[0.0034498540699382314,0.0044015299959362705,0.0055555075551412527,0.006937515973504913,0.0085721793619192334,0.010481813614829742,0.012685130069407552,0.015195916746054196,0.01802178147739477,0.021163048894856904,0.024611903340207009,0.028351861219069831,0.03235763892739444,0.036595457118294476,0.041023790653790498,0.045594538943759276,0.050254556988095639,0.054947457011371804,0.059615567568894259,0.06420192414250267,0.068652164140002789,0.072916210078720053,0.076949646320470563,0.0807147244536323,0.084180966721537395,0.087325371718449493,0.090132257948845218,0.092592805466616371,0.094704371491979258,0.096469661844343385,0.097895836834682212,0.098993619719249429,0.099776460482086909,0.100259790392769,0.10046038603872008,0.10039584729507134,0.10008418308805359,0.099543492130818409,0.098791722702078297,0.097846495219142529,0.09672497288826859,0.095443768207527646,0.094018875845208932,0.092465624951146005,0.090798646035156583,0.089031849097132743,0.087178410760725661,0.085250768845447952,0.083260623221077662,0.081218942020945373,0.079135972420135994,0.077021255258276244,0.074883642829924241,0.07273131918760932,0.070571822300631915,0.06841206737634023,0.066258370564442171,0.064116472111984388,0.061991557802967848,0.059888277198686536,0.057810756810911065,0.055762605944036536,0.053746912639160212,0.051766227108741895,0.049822530489208226,0.04791718791681468,0.046050887079174291,0.044223566622280365,0.042434342978068543,0.040681448857407147,0.038962200973759471,0.037273017340420607,0.035609504418997219,0.033966630423485043,0.032338992784476467,0.030721175708920086,0.029108179555378751,0.027495889829262331,0.025881542714468391,0.024264138526742429,0.022644755644972859,0.02102672540668633,0.019415641962291161,0.017819198090646932,0.016246855995917332,0.014709378708645955,0.013218260913364067,0.011785106483814513,0.010421003117181936,0.0091359423097047854,0.0079383261872554376,0.0068345925130181432,0.0058289769178638479,0.0049234184929974655,0.004117602712241192,0.003409125342350309,0.0027937533501142179,0.0022657542380897584,0.0018182637695486482,0.0014436633777802071],[0.004084252665064598,0.0052006976538719789,0.0065506402690770574,0.0081624284354500434,0.010062653699842057,0.012274708304682025,0.014817253443352583,0.017702687677439825,0.020935719470135786,0.024512155269688102,0.028418012551086801,0.032629054530627311,0.037110819877328782,0.041819187922386425,0.046701480165860093,0.051698055945520571,0.056744318333282737,0.061773010232780166,0.066716654456557958,0.071509978488062828,0.076092166460345737,0.080408797637067569,0.084413360568166174,0.088068271687721897,0.091345371804020609,0.094225918508514889,0.096700131962373564,0.098766381636877967,0.10043011967098428,0.10170267165081071,0.10259998873826484,0.10314144867025783,0.10334877073052957,0.10324508521505801,0.10285417467730207,0.10219988498333143,0.10130569040269866,0.10019438891587601,0.098887900996155853,0.097407146097374567,0.095771974513494937,0.094001136840021093,0.09211227792793665,0.090121946318415289,0.088045613368629205,0.08589769857819278,0.083691599118527776,0.081439722443036794,0.079153521310846728,0.076843530756754874,0.074519406605324648,0.072189965133837838,0.069863223477104178,0.067546440351675688,0.065246156656440041,0.062968235470183084,0.060717900899102673,0.058499775111748115,0.056317912721374382,0.054175831430361351,0.05207653754886496,0.050022544678630286,0.048015883591070785,0.046058101253438601,0.044150247243963284,0.042292846652771519,0.04048586018428546,0.038728634668895763,0.037019850491255613,0.035357476216995046,0.033738744298045388,0.032160164223008297,0.030617589785648859,0.029106354347266813,0.027621481625487845,0.026157969986582392,0.024711136674436932,0.023276996833893521,0.021852642848377728,0.020436584426926831,0.019029010286595368,0.017631938354397275,0.016249232261848229,0.01488647582659316,0.013550712120986642,0.012250067557636104,0.010993292476060334,0.0097892568468539339,0.0086464423978425929,0.0075724707821576576,0.0065737019205833287,0.0056549282938697445,0.0048191808815964982,0.0040676518487458716,0.0033997290943261231,0.0028131293263526785,0.0023041100655154158,0.0018677372414594839,0.0014981838537526484,0.0011890362749354779],[0.0047831848139549766,0.0060792728950357592,0.0076421613436251168,0.0095027309047600456,0.011689324494187516,0.014226042268536288,0.017130957376834805,0.020414362079722657,0.024077170243856767,0.028109609100265595,0.032490328309181846,0.037186036588624155,0.042151745632648722,0.047331659536339596,0.05266069876691877,0.05806659545923859,0.063472446854807532,0.068799571593121861,0.073970484292377528,0.078911791161983352,0.083556815193309736,0.087847783540051669,0.091737449572038915,0.095190073350686438,0.098181741094353472,0.10070006008476678,0.10274331414469245,0.10431920112492972,0.10544329443189539,0.10613737443337712,0.10642776387770864,0.10634377755978382,0.10591636503850035,0.10517699140683889,0.10415676965964137,0.10288583264693775,0.10139291490534084,0.099705105161570773,0.097847728000823919,0.095844316253459697,0.093716641953761531,0.091484781313397739,0.089167196540838253,0.086780823605769858,0.084341159799631638,0.081862348179804797,0.079357257942640175,0.076837560782313727,0.074313803687085581,0.071795478670453106,0.069291089821450227,0.066808217901248815,0.064353582569859361,0.061933102215795142,0.059551951279000953,0.057214614887768883,0.054924940554218017,0.052686186570724852,0.050501066605347041,0.048371789799011841,0.046300095425528071,0.044287280913258391,0.042334221801334046,0.040441382108996497,0.038608813769200487,0.03683614438017991,0.03512255372108708,0.033466741362658987,0.031866890254136984,0.030320634151828812,0.028825039687629957,0.02737661603235924,0.025971365631413078,0.024604887597681185,0.023272540606418007,0.021969664717901956,0.020691852351049402,0.019435249174727547,0.018196857821634323,0.016974812769882074,0.015768594599245442,0.01457915636125655,0.013408943350236985,0.012261798768059481,0.011142759917757676,0.010057760916682415,0.0090132670532580804,0.0080158718507177557,0.007071890200604879,0.0061869796421186313,0.0053658174601131899,0.0046118545244429399,0.0039271586378812904,0.0033123515851067901,0.0027666359970191122,0.0022879013153673036,0.0018728930878352534,0.0015174268118611077,0.0012166265919287644,0.00096516977546480737],[0.0055416114638444976,0.0070306848739852268,0.0088216010441618305,0.010947631242786133,0.013438597743199237,0.016318887647234229,0.019605402516122691,0.023305576630700386,0.027415614167102569,0.031919101382286874,0.036786141493190191,0.041973136079618972,0.04742329803027092,0.053067929657327852,0.058828439814605768,0.0646190113204924,0.070349771233313957,0.075930268167566123,0.081273028719238749,0.086296953444825478,0.090930323732950985,0.095113223730206906,0.098799233001293882,0.10195631027387488,0.10456685924721172,0.10662703610054364,0.10814541740037707,0.10914119029567172,0.1096420501386528,0.10968199268232921,0.10929917040218728,0.10853394946399973,0.10742726140493042,0.10601929841347459,0.10434855941977622,0.10245122079836501,0.10036078299775479,0.098107933283497234,0.095720563584434967,0.093223888542132288,0.090640619233687936,0.087991159866017063,0.085293805900756789,0.082564931279958453,0.079819159180478771,0.077069515109222872,0.074327563584206932,0.071603530677791488,0.068906414854494752,0.066244088236462245,0.063623389963484739,0.061050212850215765,0.058529584158880189,0.056065741020249277,0.053662200835559747,0.051321826850219243,0.049046888976631564,0.046839119831263952,0.044699765818915972,0.042629632931937056,0.040629126732549738,0.038698285768324417,0.036836807474050104,0.035044065507746497,0.033319117556264904,0.031660703053158011,0.030067231106809797,0.028536760331108284,0.027066974201911127,0.02565515787439096,0.024298184735711322,0.022992522784334338,0.021734271547438837,0.020519239027490154,0.019343064707755105,0.018201388999371619,0.017090062312086422,0.016005379345106915,0.014944317697307689,0.013904755903880368,0.012885645503081458,0.011887115014637175,0.010910490314530848,0.0099582247579204086,0.0090337421398477471,0.0081412047721453537,0.0072852263990101779,0.0064705545578991599,0.0057017489384810945,0.0049828813375020417,0.0043172793320083733,0.0037073304226611088,0.0031543568954623862,0.0026585648095473406,0.0022190640763472148,0.0018339511531938687,0.0015004418505573502,0.0012150393585375644,0.00097372184469692827,0.00077213469672141109],[0.0063517051800273767,0.008044939466719395,0.010076344990452995,0.012481390098057758,0.015291059647120006,0.018529572212228798,0.022212054149647439,0.026342328672457945,0.030910996436130753,0.035893988355925603,0.041251758644551807,0.046929255176108908,0.052856756104776262,0.058951599274838257,0.065120759535863659,0.071264155465198514,0.077278498967936676,0.083061446531344743,0.088515776291045734,0.093553305283994762,0.098098278379644022,0.10209000335624367,0.10548457129179627,0.10825558107062806,0.1103938727007065,0.11190635682932086,0.11281409827833112,0.11314986213039856,0.11295535701816657,0.11227841020567998,0.11117028470196672,0.10968330507991905,0.10786890328230718,0.10577613692912796,0.10345067854229337,0.10093423097960381,0.098264295871007559,0.095474208688548834,0.092593354396629829,0.089647487840892895,0.086659098896708198,0.083647779959780594,0.080630569612985981,0.077622259444660183,0.07463566036111581,0.071681830521489714,0.068770269915538043,0.065909087470379865,0.063105146223996128,0.060364191180437329,0.05769096339359564,0.055089302854598649,0.052562241983896606,0.050112090965863644,0.047740515778204359,0.045448609510954426,0.043236957390893407,0.041105695785197759,0.039054565322098486,0.037082958116317781,0.035189958915546889,0.033374379798573529,0.031634787882389041,0.029969525384725814,0.028376721415275474,0.026854295129181849,0.02539995047138149,0.024011163747368856,0.022685166686949556,0.021418929421698964,0.020209149622787321,0.019052255535084661,0.017944431277208319,0.016881672037456483,0.015859874328352206,0.014874962249289286,0.013923045178059652,0.013000596338099522,0.012104636418698047,0.011232903010510794,0.010383985902060694,0.0095574105728579058,0.0087536572163502014,0.0079741095211597595,0.0072209351255702898,0.006496906986516773,0.0058051808884248546,0.0051490482830522481,0.0045316852804350707,0.003955917925490683,0.0034240211974895136,0.0029375649609506573,0.0024973149858261521,0.0021031917752762602,0.0017542848739249516,0.0014489160531116494,0.0011847416107325429,0.00095888214681520516,0.00076806758770838856,0.00060878580026845386],[0.0072027798700263594,0.0091085544966854042,0.011389584054016617,0.014083298080724128,0.017221497646582332,0.020827765292950707,0.024914858795215079,0.029482274068186771,0.0345141814644533,0.039977941824170346,0.045823390846530754,0.051983041549398874,0.058373296061799688,0.064896683639177055,0.071445057892575228,0.077903600917493376,0.08415540439877528,0.090086336815584866,0.09558986921457284,0.10057152489744066,0.10495264280635706,0.10867319879013548,0.11169350814294741,0.11399472866063529,0.1155781857329933,0.11646363863638207,0.11668668970091149,0.11629559674705252,0.11534777843272132,0.11390629997027264,0.11203659513613122,0.10980362543779118,0.10726960746269761,0.10449236507581794,0.10152429434532985,0.098411874074921885,0.09519561865433486,0.091910353911165893,0.08858569859307984,0.085246649397023755,0.081914190367659845,0.078605872544861413,0.075336332715868107,0.072117738466112538,0.06896015949682735,0.065871872706071838,0.062859611864196266,0.059928773163250348,0.057083586704865991,0.054327262064489491,0.051662114060920694,0.049089673110979802,0.046610783189525141,0.044225689442986445,0.041934116852621064,0.039735340924254028,0.037628251112064838,0.035611407499054733,0.033683091108723764,0.031841348080829543,0.030084027793768928,0.028408814856876432,0.026813254743816978,0.025294772727971957,0.02385068576679698,0.022478207136000697,0.021174444013908559,0.019936388925267445,0.018760906990918619,0.017644722233021919,0.016584407580323979,0.015576384407369883,0.014616938034679115,0.013702255206851584,0.012828487850868736,0.011991844336968692,0.011188705299568285,0.010415756457808409,0.0096701266815329597,0.0089495166930822646,0.0082523029843708014,0.0075776030645826739,0.0069252918566984744,0.0062959643285010755,0.0056908454138279215,0.005111654034324834,0.0045604327757334971,0.0040393579517250368,0.0035505461362656224,0.0030958727724069044,0.0026768164076443417,0.0022943388582242342,0.0019488076471485169,0.0016399628904373935,0.0013669268795029564,0.0011282512940696085,0.00092199453439212407,0.00074582021033617698,0.00059710737117706428,0.00047306350063989545],[0.0080813663188681866,0.010204672987789216,0.012740478441745537,0.015727906751782119,0.019199217553866155,0.023176903513106688,0.027670804117657027,0.032675449657933196,0.038167868428218565,0.044106089675567423,0.050428551314186498,0.057054573928082282,0.063885992912048578,0.070809953527111752,0.077702776658511399,0.084434705680915073,0.090875257559463976,0.096898834343124601,0.10239021307545838,0.10724952851847531,0.11139639585778523,0.11477288746293013,0.11734517252201723,0.11910374132128576,0.12006225525560374,0.12025517670174518,0.11973442775399251,0.11856539375228566,0.11682262009220368,0.11458554668405731,0.11193458577579463,0.10894778207677171,0.10569820908128892,0.10225216413603426,0.098668139309244632,0.094996475921771295,0.091279564607065641,0.087552432373801795,0.083843561233625158,0.080175803916596872,0.076567293617403928,0.073032279213247703,0.069581849061533099,0.066224531649659205,0.062966778639198875,0.059813345636060042,0.056767589832023631,0.053831703405919841,0.051006899035756531,0.048293560450700816,0.045691367558394355,0.043199402803124655,0.040816243211120866,0.038540041032954199,0.036368594878057846,0.034299412606064686,0.032329766860710346,0.030456743900295871,0.028677286221113221,0.026988229340595044,0.025386332980350642,0.023868306758009397,0.022430830368696312,0.02107056813529502,0.019784177770340763,0.018568313273921385,0.017419622150317969,0.016334737612386355,0.0153102671779922,0.014342780011155742,0.013428796403865179,0.012564783721508221,0.011747163657232362,0.010972335445928886,0.010236718528769641,0.0095368159544329256,0.0088692967257808734,0.0082310917977575625,0.0076194951579714029,0.0070322590867040345,0.0064676718752227358,0.0059246072608281257,0.0054025375205788593,0.0049015061171909973,0.0044220603522416666,0.0039651489336249394,0.0035319930719861291,0.0031239422361554131,0.0027423267999157033,0.0023883195019276694,0.0020628160983366447,0.0017663431199795962,0.0014989976263553922,0.0012604206620660768,0.001049803120341237,0.00086592018673962361,0.00070718866872942392,0.00057174040968041204,0.00045750464007084389,0.00036229245471585997],[0.0089714477688683115,0.011313369860695414,0.014104551948879357,0.017385529042173872,0.021188670713112184,0.025534966856588025,0.030430867085652347,0.035865416940050902,0.041807953183413835,0.048206616877457316,0.054987913149078201,0.062057489786088688,0.06930222539628754,0.076593617579723369,0.083792351150643637,0.090753816863311881,0.097334254285753721,0.10339711986848386,0.10881924227866593,0.11349632773495795,0.11734742006463804,0.12031800045727407,0.12238152285879769,0.12353931144274662,0.12381888310802899,0.12327088629227248,0.1219649543527393,0.1199848466545273,0.11742328631516727,0.11437689774159221,0.11094160187031589,0.10720874915784503,0.10326217049425722,0.099176217553507792,0.095014760680446453,0.090831026929486899,0.086668102511275338,0.082559896809451444,0.078532367874338496,0.074604835688707224,0.070791250436949837,0.067101328839909949,0.063541514217883913,0.060115749995645354,0.056826079647869045,0.053673098969305937,0.0506562910527645,0.047774273138150448,0.045024980119474735,0.042405803978128487,0.039913703072909375,0.037545290753217976,0.035296909396037655,0.033164693636304081,0.031144625063808655,0.029232579764428203,0.027424369580374221,0.025715777692255717,0.024102588973808368,0.022580615468699865,0.021145717249730675,0.019793818828358262,0.018520921187939941,0.017323109432596798,0.01619655600297756,0.015137519448994332,0.014142338912138548,0.013207424796562657,0.012329246619365677,0.011504319707616652,0.010729193174972092,0.010000442317309774,0.0093146690064314485,0.0086685135992111157,0.0080586811184774378,0.0074819829175231225,0.0069353928108848873,0.0064161140472639702,0.005921650993166226,0.0054498775288290696,0.0049990933921568066,0.0045680602908232774,0.00415601150294952,0.003762631596815533,0.0033880063280443589,0.003032546164202734,0.0026968897436537289,0.0023817955395803538,0.0020880308905537191,0.0018162673688377892,0.001566990322604999,0.0013404285827007451,0.0011365080545201515,0.00095483051574240271,0.00079467667937245599,0.00065503067438223259,0.00053462169005037913,0.00043197769678460734,0.00034548589593161441,0.00027345480311810903],[0.0098548596444478186,0.012412155220748147,0.015454317746659264,0.019023007586734201,0.023150385399654395,0.027855593286918476,0.033141330572543141,0.038990796825040495,0.045365293437072574,0.052202768048605193,0.05941754967490321,0.066901455971320509,0.074526360641713627,0.08214819532187416,0.089612236407770537,0.096759405678348412,0.10343320757128963,0.10948684827550666,0.11479004264003402,0.11923502057635658,0.12274129651938169,0.12525885966700881,0.12676957023383872,0.12728669499771703,0.12685266878874454,0.12553531155138517,0.1234228488246172,0.12061816550804227,0.11723276131688694,0.11338086886268423,0.10917414424664003,0.10471725247468637,0.10010455691113758,0.095417997277610758,0.090726119612837247,0.08608411869914874,0.081534680317854102,0.077109373824607558,0.072830345132028171,0.068712090324236211,0.064763140467456126,0.06098754669361562,0.057386110437799377,0.053957349134379856,0.05069821907077815,0.047604634441271894,0.044671827392108621,0.041894591580284482,0.039267445052093349,0.036784739954415238,0.034440738633011031,0.032229669055386177,0.030145767544328253,0.028183313419841476,0.026336658016426085,0.024600249315137334,0.022968652789405641,0.021436568767351317,0.019998846494732721,0.018650495038734987,0.017386691147068794,0.016202784144250623,0.015094297903098552,0.01405692988428479,0.013086547210945794,0.012179179767936948,0.011331010420101912,0.010538362662675511,0.0097976863686559251,0.009105542774779974,0.0084585904003692571,0.0078535741219595973,0.0072873199842304883,0.0067567383424020381,0.0062588374493256198,0.0057907485434589489,0.0053497619118323915,0.0049333715000658643,0.0045393237591827441,0.0041656649587824886,0.0038107805175334594,0.0034734202178244621,0.0031527044847241164,0.0028481090124526389,0.0025594275546304388,0.0022867152384457284,0.0020302169325625823,0.0017902867119051658,0.0015673051727609891,0.0013616012472066081,0.0011733843463240265,0.0010026913033455891,0.00084935090682239204,0.00071296703263111006,0.00059291970389607643,0.00048838199118919135,0.0003983496210789709,0.00032167954237032737,0.00025713350580562389,0.00020342289900560949],[0.010711845912668041,0.013476663553915661,0.01676012088047512,0.020604730863189716,0.025042175741100396,0.030089497110131345,0.03574542387788239,0.041987139513239305,0.048767808054113924,0.056015167619592451,0.063631456911499726,0.071494864019910967,0.079462581426737816,0.087375424203585725,0.095063831403505841,0.10235493743718622,0.10908028560903316,0.11508367381949713,0.12022858371964987,0.12440465586494477,0.12753273564087889,0.12956812301488566,0.13050180317421969,0.13035960031132124,0.12919936629508802,0.12710647250003357,0.12418800120470802,0.12056612076146646,0.11637116889115566,0.11173495885433112,0.10678476686188838,0.10163836341366836,0.096400327514956155,0.091159744879868027,0.085989254798173639,0.080945290811891099,0.076069271160066149,0.071389445186261308,0.06692309432679508,0.0626788165697372,0.058658680936636808,0.054860109669963915,0.051277416504426153,0.047902988855544219,0.04472814399431687,0.041743713203805974,0.038940416124618286,0.03630908450693468,0.03384078521156457,0.03152688056487802,0.029359052827878818,0.02732931008026257,0.025429983750453435,0.023653723217752505,0.021993489939580391,0.020442551901620226,0.018994478388662115,0.017643134772188807,0.016382676962437882,0.015207545227059638,0.014112457153286346,0.013092399588547807,0.01214261942612292,0.011258613114607428,0.010436114779774507,0.0096710828784490922,0.0089596853833406598,0.0082982836511723782,0.0076834153712194804,0.0071117773265882301,0.0065802090965518135,0.0060856792191024307,0.0056252756171184179,0.0051962021459801642,0.0047957828292122945,0.0044214746436636171,0.004070888617092744,0.0037418176413059642,0.0034322680193984972,0.0031404906490008324,0.0028650071686391943,0.0026046265372117322,0.0023584484013560144,0.0021258510965526602,0.0019064639680356056,0.0017001255759786249,0.0015068309733361771,0.0013266723950744826,0.0011597782568688736,0.0010062553152918768,0.00086613826149682443,0.00073935003689525904,0.00062567493327382714,0.0005247452368609657,0.00043604094585817163,0.00035890105330542486,0.00029254412234629542,0.00023609542778127744,0.00018861779560947237,0.00014914340734598026],[0.01152175240447552,0.014481503850105753,0.017991166180412747,0.022093858446439123,0.026820580978891503,0.032186134331766821,0.038185219859268524,0.044789050784558873,0.051942819774280453,0.059564354532205301,0.067544242876357255,0.075747623066563241,0.084017718117085263,0.092181053246587707,0.10005414614515334,0.10745131566923044,0.11419313207294134,0.12011494591480192,0.12507489504607014,0.12896080628413611,0.13169548105130449,0.13323997650835948,0.13359465375483809,0.13279794627302874,0.13092298631925764,0.12807239571244111,0.12437168396341192,0.11996178856209484,0.11499133242910216,0.1096091606752177,0.10395765685869195,0.098167236266250152,0.092352282010130293,0.086608642709512851,0.081012663146738481,0.07562158666392646,0.070475064154458575,0.065597440241294491,0.061000468300105429,0.056686131006893861,0.052649303316133704,0.048880075853902825,0.045365642229841185,0.042091729312191635,0.039043605684561236,0.036206737039029532,0.033567170136493595,0.031111724374851536,0.028828058135331708,0.026704661425415981,0.024730810846536892,0.022896509826461135,0.021192427209155568,0.019609840600098807,0.018140586756296092,0.016777019078100888,0.01551197125012042,0.014338725779923549,0.013250986242892041,0.012242852241208991,0.01130879630558077,0.010443642155663473,0.0096425438736853671,0.0089009656409141814,0.0082146617548039952,0.0075796567076644788,0.0069922251893343853,0.0064488719990521744,0.0059463120318147197,0.0054814507456885184,0.0050513658025440767,0.0046532908636311657,0.0042846027451724231,0.0039428132116015313,0.0036255665201908554,0.0033306433747792032,0.0030559712014443831,0.0027996397078954389,0.0025599196913823254,0.0023352822254118794,0.002124414887494994,0.0019262317292763767,0.0017398742706963295,0.0015647018368221282,0.00140027087025161,0.0012463042173129386,0.0011026525840077714,0.000969251220281524,0.00084607532591733712,0.00073309766282436759,0.00063025145662836302,0.00053740097022060139,0.00045432125141390661,0.00038068761780222127,0.00031607455414438572,0.00025996294828977746,0.0002117540393258467,0.00017078812423085843,0.00013636596618340542,0.00010777094424623297],[0.012263825761218023,0.015401232147221259,0.019116684937385029,0.023453699692645765,0.028442469589911975,0.034095539200930107,0.040403702323420894,0.04733247799354396,0.054819534956426268,0.062773416660944784,0.071073862312216435,0.079573924830543069,0.08810395867407439,0.096477399130547342,0.10449809373605023,0.11196879254345707,0.1187002744576892,0.12452049776505994,0.12928312663630623,0.13287480858283351,0.13522066069405703,0.13628755809296453,0.13608499323703699,0.13466347158630609,0.13211060745369457,0.1285452633992569,0.1241102198552191,0.11896395601338602,0.11327216159744403,0.1071995815314867,0.10090272700460043,0.094523876794003286,0.088186654574456388,0.081993315254861129,0.076023720281261628,0.070335842007162377,0.064967523401095517,0.059939142505076093,0.05525679876061123,0.050915652634839451,0.046903105735915725,0.043201593459161969,0.039790859109126421,0.0366496699248288,0.0337570079706771,0.03109281557610697,0.028638395925088201,0.026376569558553241,0.024291674303696709,0.022369476675300971,0.020597042631712487,0.018962598077571561,0.017455396124586318,0.01606559893402806,0.014784176309789804,0.013602820164109649,0.012513872650438582,0.011510265438429045,0.010585467795668045,0.0097334415277324452,0.0089486012405708571,0.0082257787478342732,0.0075601907260793681,0.0069474089271952481,0.00638333240781889,0.0058641613528464314,0.0053863721781147993,0.0049466937175447106,0.0045420844489571267,0.0041697108975888679,0.0038269275701594786,0.0035112589901543259,0.0032203845826384771,0.0029521272358986831,0.0027044462869479468,0.0024754353948329001,0.0022633252746733861,0.0020664906159836602,0.0018834598072190469,0.0017129254796787376,0.0015537535163651134,0.0014049881545894877,0.0012658511812484209,0.0011357339271855017,0.0010141816898876289,0.00090087119069381016,0.00079558254324653085,0.00069816784805856616,0.00060851886149054541,0.00052653620114458252,0.00045210227757989604,0.00038505965224251096,0.00032519589901192921,0.00027223538002140834,0.00022583771488032556,0.00018560218900382319,0.00015107695343075849,0.00012177163523467021,9.7171903798623163e-05,7.6754606196922958e-05],[0.012918076612887665,0.016211396487038808,0.020107180868756035,0.024649176263315947,0.029866728225983626,0.035770241527878291,0.042346903506208955,0.04955704709902322,0.05733154516868294,0.065570606051025937,0.074144277816947976,0.082894865929147674,0.091641331345689761,0.10018557428352666,0.10832033775996011,0.11583830246212369,0.1225418089877415,0.12825255193783458,0.13282055558715972,0.13613176979084937,0.13811371707699602,0.13873876973087793,0.13802482463197194,0.13603335427696084,0.13286502297265626,0.12865324611936221,0.12355621938846309,0.11774804024404451,0.11140958010545056,0.10471974190250782,0.097847661530717084,0.090946294220170448,0.084147682272281282,0.077560043858210664,0.071266667565027197,0.065326456346034595,0.059775847924262583,0.054631755406494072,0.04989512898472262,0.045554741137754318,0.04159084251756099,0.037978415673778632,0.034689854342958355,0.031696999047029627,0.028972548227606785,0.026490926692958064,0.024228726094331521,0.022164838793007818,0.020280394423458237,0.018558586395881829,0.016984450899788114,0.01554463860171405,0.01422720160542424,0.013021405877778173,0.011917571607934527,0.010906939750332981,0.0099815611553575115,0.0091342042620665958,0.0083582776279668303,0.0076477641631317143,0.0069971645734550978,0.0064014480834079538,0.005856008962933301,0.0053566277277534852,0.0048994361374880436,0.0044808853077198778,0.0040977164065657797,0.0037469335464167916,0.0034257786251813494,0.0031317080289187563,0.0028623712790965712,0.0026155918796845908,0.0023893507648111317,0.00218177282844634,0.0019911169917835171,0.0018157700991335056,0.0016542446209966847,0.0015051797119770053,0.001367344689940381,0.001239643570040016,0.0011211190086710123,0.001010953970907562,0.00090846966450000002,0.00081311875732612688,0.00072447353257473572,0.00064220932433649096,0.00056608420004822994,0.00049591632208786528,0.00043156067328075916,0.0003728868563408665,0.00031975949765587308,0.00027202244902739309,0.00022948754787604204,0.00019192823010573976,0.000159077847084476,0.00013063216384721611,0.00010625523945803709,8.5587726554417601e-05,6.8256574948750466e-05,5.3885171307784889e-05],[0.013466158156581726,0.016889595934978012,0.020935686825326372,0.025648289382526474,0.031055945899397627,0.037167165417596432,0.043966003894682491,0.051408336823768302,0.059419233723018723,0.067891819219241797,0.076687937902079131,0.085640830383465233,0.094559882091805311,0.10323733563059595,0.11145667791347835,0.11900224353355753,0.12566943540952208,0.13127487030899662,0.13566572368563548,0.1387275823080022,0.14039021369561724,0.14063081983321332,0.13947454343986365,0.13699221755130833,0.13329557017681767,0.12853029265252031,0.12286753372542139,0.11649447774794013,0.10960469816197478,0.10238894774051331,0.095026962670897511,0.087680731497787504,0.08048952807994357,0.073566846399496316,0.066999219002254376,0.060846761798321977,0.055145174454826765,0.049908843645802586,0.045134650346878066,0.040806075209983785,0.036897228521384974,0.03337649964611087,0.030209615468286544,0.027362002870450059,0.024800449197892049,0.022494131956451127,0.020415136381233306,0.018538596687946881,0.016842589875278285,0.015307889080561502,0.013917655726191309,0.012657122800781111,0.011513299457253432,0.010474711013698611,0.009531178063975099,0.0086736325667260902,0.0078939661083502009,0.0071849048141148257,0.0065399057031142642,0.005953070048451972,0.0054190701662997984,0.0049330868440398438,0.0044907552641980609,0.0040881177815100247,0.0037215822861807143,0.0033878851670398886,0.0030840581036711149,0.0028073980926491887,0.0025554402700875231,0.0023259332442175473,0.0021168168027810596,0.0019262020058904196,0.001752353800635278,0.0015936763753047001,0.0014487014810145003,0.001316079863590469,0.0011945757603474107,0.0010830641404749417,0.00098053004738252029,0.00088606910242811055,0.00079888802572010843,0.00071830398234577634,0.00064374170096480289,0.00057472762374418914,0.00051088078026516879,0.00045190055638605938,0.00039755197024462786,0.00034764940366145436,0.00030203992624381227,0.00026058737932905542,0.00022315827173407594,0.00018961031201075889,0.00015978410531697853,0.00013349822165084041,0.000110547536173636,9.0704483235582196e-05,7.3722674435941187e-05,5.9342217425955341e-05,4.7296035836576303e-05,3.7316522987847582e-05],[0.013892207311532343,0.017416491043662222,0.02157895932919859,0.026423508547429676,0.031978000242673402,0.038249407535162372,0.045219285815940702,0.0528399776634184,0.061031975208503328,0.069682836050161512,0.078647977226850199,0.087753556530810031,0.096801498044508619,0.10557654114348428,0.11385500595315001,0.12141479293316389,0.12804599010258394,0.13356136662988069,0.1378059997372679,0.14066532006406571,0.14207096778204464,0.14200401865785789,0.1404953494759679,0.13762314408152479,0.13350777058778909,0.1283044634293877,0.12219440092859633,0.1153748658798941,0.10804920686410394,0.10041728300548367,0.09266698329751738,0.084967277554411302,0.07746309674420937,0.070272173706084087,0.063483816955582847,0.057159452724108044,0.051334661499112033,0.046022359130378949,0.041216730400769779,0.03689751496269629,0.033034271207063849,0.029590300913259499,0.026526000896481869,0.023801506861783808,0.021378594668942603,0.019221889825350582,0.017299495666513336,0.015583179830531403,0.014048260188543526,0.0126733133517304,0.011439800840903661,0.010331678255254655,0.0093350267591269416,0.0084377264160153866,0.0076291776000487052,0.0069000688925050149,0.0062421860433968697,0.0056482553179993955,0.0051118147260707358,0.0046271074715614167,0.0041889929937256494,0.0037928719517682724,0.003434622332931586,0.0031105445173659264,0.0028173136300843767,0.0025519378827144183,0.0023117218890072655,0.0020942341574432459,0.0018972781449916941,0.0017188664145705995,0.0015571975841292549,0.0014106358888347251,0.0012776932929082941,0.0011570141706789632,0.0010473626100468859,0.00094761236001344106,0.00085673934003878697,0.00077381646075958942,0.00069801029978470367,0.00062857897605899185,0.00056487042228570172,0.00050632021156960948,0.00045244817626984387,0.00040285326004813369,0.00035720633606256758,0.00031524105361553699,0.00027674308520069879,0.00024153838684848257,0.00020948122556476673,0.00018044275809996857,0.00015430087391574349,0.00013093186442666034,0.00011020428013062477,9.1975118310359325e-05,7.6088274716840795e-05,6.2375015134299004e-05,5.0656091571065655e-05,4.0745049855100466e-05,3.2452250387255499e-05,2.5589145720528677e-05],[0.014183595617524313,0.017776703500425033,0.022018538944490226,0.02695300010578823,0.032607455424178998,0.038987797161289396,0.046073838127984983,0.053815471565851682,0.062130026834387626,0.07090122472758327,0.079980061835532024,0.089187834361318163,0.098321354913499068,0.10716023339265822,0.11547590228580323,0.12304188757800689,0.1296446798021699,0.13509446409133574,0.13923493734564399,0.14195148174796759,0.14317707562605742,0.14289549543495683,0.14114157938448935,0.13799856157779131,0.1335927205613531,0.128085793695567,0.12166576825676685,0.11453675741222596,0.10690869765803609,0.098987565625788046,0.090966715418670074,0.083019797606772208,0.075295555786424856,0.067914624929882553,0.060968294493907803,0.054519061473677487,0.048602692469658114,0.043231442758209934,0.038398043994718779,0.03408006820638447,0.03024430131978121,0.026850811666584363,0.023856473596247776,0.021217796443708987,0.018893003825178931,0.016843394376990863,0.015034080569197162,0.01343424001336041,0.012017023501020027,0.010759251611199524,0.0096410060007215796,0.008645191263529103,0.00775711509256077,0.0069641120049328846,0.0062552201249065787,0.005620910811745484,0.005052865856573034,0.0045437950260755157,0.0040872866145419441,0.0036776844532519439,0.0033099859334701489,0.002979756705612457,0.0026830586776422443,0.0024163887085711317,0.002176625988266504,0.0019609865436613283,0.0017669836491388882,0.0015923931770926133,0.0014352231290245441,0.0012936867568476937,0.0011661788303425318,0.0010512547353529074,0.00094761219720732644,0.00085407550832124321,0.00076958218769245998,0.00069317200270511969,0.00062397823464908529,0.00056122097247426699,0.00050420209089649891,0.00045230143729159205,0.00040497365167510417,0.00036174500784101729,0.0003222097114926164,0.000286025223805244,0.00025290637690397505,0.00022261827679295829,0.00019496820931548745,0.00016979694015113221,0.00014696990684923787,0.00012636883052059871,0.00010788423204357332,9.1409237747150937e-05,7.6834923393256731e-05,6.4047295026566279e-05,5.2925860898811426e-05,4.3343625912368364e-05,3.5168249212804899e-05,2.8264051527866127e-05,2.2494541444175704e-05,1.7725144857111255e-05],[0.014331541195814821,0.017959547850097238,0.022241610783674478,0.027221621711200284,0.032926690327167454,0.039362150859951935,0.046506921521384886,0.05430964191103746,0.062686025805624268,0.071517837059096229,0.080653820490322714,0.089912798694438828,0.099088986537477691,0.10795939026453708,0.11629296503545537,0.12386102367653937,0.13044824147455228,0.13586350575827416,0.13994982880081897,0.14259258520887269,0.14372544909943596,0.14333358215056127,0.14145384370736927,0.13817203578913007,0.1336174338215613,0.12795506367204049,0.12137634637250798,0.11408882937519513,0.1063057507735336,0.098236142387522041,0.09007607824262033,0.082001531844927145,0.074163137246691227,0.066682974388063365,0.059653335941881346,0.053137294378129044,0.047170782689346581,0.041765833529879497,0.036914588562956797,0.032593689173933113,0.028768687179652516,0.025398165686269392,0.022437331553439976,0.019840926099192583,0.017565390918342218,0.015570309687043839,0.013819213319559919,0.012279877091107517,0.010924252570266342,0.0097281686233795205,0.0086709123371680533,0.0077347711491982619,0.0069045887693048608,0.0061673638172918552,0.0055119030277710904,0.0049285300456301676,0.0044088449640372531,0.0039455273099662617,0.0035321748083919032,0.0031631709503834567,0.0028335754996227785,0.0025390332264050566,0.0022756971823436902,0.002040163664341876,0.0018294166656835469,0.0016407801041103446,0.0014718764868410185,0.0013205909534209524,0.0011850398558336231,0.0010635432115345734,0.00095460051258963122,0.00085686950045054419,0.00076914762298522696,0.00069035597521407651,0.00061952558142072906,0.00055578589670102977,0.00049835538604666634,0.00044653398058614206,0.00039969712455173559,0.00035729103303431821,0.00031882870562187078,0.00028388621002930386,0.00025209878011893741,0.00022315636757288529,0.0001967984334789229,0.00017280794032321814,0.00015100467586616584,0.00013123817994477571,0.00011338063373734341,9.732010024254366e-05,8.2954477556382316e-05,7.0186454268408272e-05,5.8919654963491533e-05,4.9056050617187084e-05,4.0494599249427141e-05,3.3130988845599055e-05,2.6858285362641306e-05,2.1568247402216482e-05,1.7153055768038675e-05,1.350721744629011e-05],[0.014331541195814814,0.017959547850097232,0.022241610783674471,0.027221621711200277,0.032926690327167468,0.039362150859951942,0.046506921521384859,0.054309641911037473,0.062686025805624282,0.071517837059096201,0.080653820490322714,0.089912798694438814,0.099088986537477691,0.10795939026453712,0.11629296503545544,0.12386102367653935,0.13044824147455236,0.13586350575827416,0.13994982880081888,0.14259258520887275,0.14372544909943602,0.1433335821505613,0.14145384370736933,0.13817203578913004,0.1336174338215613,0.12795506367204046,0.12137634637250796,0.11408882937519507,0.10630575077353357,0.098236142387522069,0.090076078242620289,0.082001531844927159,0.074163137246691227,0.066682974388063365,0.059653335941881318,0.053137294378129057,0.047170782689346595,0.041765833529879497,0.036914588562956797,0.032593689173933106,0.028768687179652523,0.025398165686269382,0.022437331553439969,0.01984092609919258,0.017565390918342218,0.015570309687043832,0.013819213319559919,0.012279877091107524,0.010924252570266342,0.0097281686233795153,0.0086709123371680515,0.0077347711491982567,0.00690458876930486,0.0061673638172918578,0.0055119030277710913,0.004928530045630165,0.0044088449640372531,0.0039455273099662617,0.0035321748083919024,0.003163170950383458,0.0028335754996227794,0.0025390332264050575,0.0022756971823436906,0.0020401636643418764,0.0018294166656835475,0.0016407801041103448,0.0014718764868410182,0.0013205909534209526,0.0011850398558336231,0.0010635432115345736,0.00095460051258963079,0.00085686950045054386,0.00076914762298522707,0.00069035597521407608,0.00061952558142072949,0.00055578589670102977,0.00049835538604666612,0.00044653398058614179,0.00039969712455173553,0.00035729103303431821,0.00031882870562187121,0.00028388621002930375,0.00025209878011893741,0.00022315636757288529,0.00019679843347892285,0.00017280794032321816,0.00015100467586616579,0.00013123817994477565,0.00011338063373734338,9.7320100242543633e-05,8.295447755638233e-05,7.0186454268408272e-05,5.891965496349154e-05,4.905605061718709e-05,4.0494599249427121e-05,3.3130988845599048e-05,2.6858285362641302e-05,2.1568247402216485e-05,1.7153055768038675e-05,1.3507217446290113e-05],[0.014183595617524315,0.017776703500425029,0.02201853894449023,0.026953000105788237,0.032607455424178998,0.038987797161289396,0.046073838127984983,0.053815471565851675,0.062130026834387654,0.07090122472758327,0.079980061835532024,0.08918783436131815,0.098321354913499054,0.10716023339265816,0.1154759022858033,0.12304188757800685,0.12964467980216984,0.13509446409133571,0.13923493734564402,0.14195148174796759,0.14317707562605742,0.14289549543495683,0.14114157938448935,0.13799856157779131,0.13359272056135307,0.12808579369556705,0.12166576825676682,0.11453675741222605,0.10690869765803609,0.098987565625788115,0.090966715418670061,0.083019797606772208,0.075295555786424911,0.067914624929882511,0.06096829449390781,0.054519061473677514,0.048602692469658142,0.04323144275820992,0.038398043994718772,0.034080068206384484,0.030244301319781203,0.026850811666584373,0.023856473596247769,0.02121779644370899,0.018893003825178941,0.016843394376990874,0.015034080569197158,0.0134342400133604,0.012017023501020024,0.010759251611199519,0.0096410060007215831,0.0086451912635291048,0.0077571150925607691,0.0069641120049328898,0.0062552201249065787,0.0056209108117454849,0.0050528658565730331,0.0045437950260755157,0.0040872866145419432,0.0036776844532519452,0.0033099859334701476,0.0029797567056124561,0.002683058677642243,0.0024163887085711325,0.0021766259882665027,0.0019609865436613283,0.0017669836491388891,0.0015923931770926133,0.0014352231290245445,0.0012936867568476935,0.0011661788303425325,0.0010512547353529079,0.00094761219720732666,0.00085407550832124299,0.00076958218769245976,0.0006931720027051198,0.00062397823464908529,0.00056122097247426667,0.00050420209089649913,0.00045230143729159172,0.00040497365167510433,0.00036174500784101729,0.00032220971149261662,0.000286025223805244,0.000252906376903975,0.00022261827679295827,0.00019496820931548745,0.00016979694015113213,0.0001469699068492379,0.0001263688305205989,0.00010788423204357331,9.1409237747150978e-05,7.6834923393256745e-05,6.4047295026566293e-05,5.2925860898811446e-05,4.3343625912368371e-05,3.5168249212804899e-05,2.826405152786613e-05,2.2494541444175714e-05,1.7725144857111261e-05],[0.01389220731153234,0.017416491043662212,0.02157895932919859,0.026423508547429669,0.031978000242673416,0.038249407535162372,0.045219285815940667,0.052839977663418379,0.061031975208503321,0.069682836050161512,0.078647977226850199,0.087753556530810004,0.096801498044508605,0.10557654114348432,0.11385500595314998,0.12141479293316385,0.12804599010258391,0.13356136662988075,0.13780599973726793,0.14066532006406576,0.14207096778204464,0.14200401865785789,0.14049534947596798,0.13762314408152479,0.13350777058778912,0.12830446342938776,0.12219440092859639,0.11537486587989411,0.10804920686410392,0.10041728300548367,0.092666983297517352,0.084967277554411302,0.077463096744209384,0.070272173706084101,0.063483816955582847,0.057159452724108051,0.051334661499112026,0.046022359130378922,0.041216730400769758,0.036897514962696276,0.033034271207063842,0.029590300913259492,0.026526000896481862,0.023801506861783815,0.021378594668942597,0.019221889825350585,0.017299495666513339,0.015583179830531405,0.014048260188543518,0.012673313351730409,0.011439800840903661,0.010331678255254658,0.0093350267591269503,0.0084377264160153832,0.0076291776000487086,0.0069000688925050166,0.0062421860433968723,0.005648255317999399,0.0051118147260707358,0.0046271074715614176,0.0041889929937256485,0.0037928719517682724,0.0034346223329315855,0.003110544517365926,0.0028173136300843732,0.0025519378827144178,0.0023117218890072646,0.0020942341574432441,0.0018972781449916943,0.0017188664145706004,0.001557197584129256,0.0014106358888347247,0.0012776932929082947,0.0011570141706789634,0.0010473626100468863,0.00094761236001344128,0.00085673934003878676,0.00077381646075958964,0.00069801029978470324,0.00062857897605899196,0.00056487042228570193,0.00050632021156960959,0.00045244817626984371,0.00040285326004813374,0.00035720633606256736,0.00031524105361553694,0.00027674308520069879,0.00024153838684848244,0.00020948122556476662,0.00018044275809996857,0.00015430087391574347,0.00013093186442666031,0.0001102042801306248,9.1975118310359366e-05,7.6088274716840768e-05,6.2375015134299004e-05,5.0656091571065635e-05,4.0745049855100459e-05,3.2452250387255506e-05,2.5589145720528683e-05],[0.013466158156581733,0.016889595934978005,0.020935686825326358,0.025648289382526477,0.03105594589939762,0.037167165417596425,0.043966003894682512,0.051408336823768302,0.059419233723018723,0.067891819219241784,0.076687937902079117,0.085640830383465247,0.094559882091805297,0.10323733563059592,0.11145667791347835,0.11900224353355744,0.12566943540952213,0.13127487030899665,0.13566572368563548,0.13872758230800214,0.14039021369561724,0.14063081983321341,0.1394745434398636,0.13699221755130839,0.1332955701768177,0.12853029265252031,0.1228675337254214,0.11649447774794008,0.10960469816197481,0.10238894774051337,0.095026962670897566,0.08768073149778749,0.080489528079943515,0.07356684639949633,0.066999219002254348,0.060846761798322005,0.055145174454826723,0.049908843645802572,0.045134650346878073,0.040806075209983785,0.036897228521384981,0.033376499646110884,0.030209615468286544,0.027362002870450066,0.024800449197892059,0.022494131956451117,0.020415136381233316,0.018538596687946888,0.016842589875278292,0.0153078890805615,0.013917655726191308,0.012657122800781111,0.011513299457253436,0.010474711013698609,0.0095311780639750938,0.0086736325667260902,0.0078939661083502009,0.0071849048141148274,0.0065399057031142642,0.0059530700484519781,0.0054190701662997984,0.0049330868440398429,0.0044907552641980635,0.0040881177815100238,0.003721582286180713,0.0033878851670398886,0.0030840581036711149,0.0028073980926491895,0.0025554402700875244,0.0023259332442175469,0.00211681680278106,0.0019262020058904191,0.0017523538006352789,0.0015936763753047008,0.0014487014810145012,0.001316079863590469,0.0011945757603474109,0.0010830641404749423,0.00098053004738252072,0.00088606910242811088,0.00079888802572010843,0.00071830398234577655,0.0006437417009648031,0.00057472762374418925,0.0005108807802651689,0.00045190055638605917,0.00039755197024462786,0.00034764940366145436,0.00030203992624381232,0.00026058737932905531,0.00022315827173407591,0.00018961031201075894,0.00015978410531697853,0.00013349822165084044,0.00011054753617363603,9.070448323558225e-05,7.3722674435941214e-05,5.9342217425955335e-05,4.7296035836576317e-05,3.7316522987847609e-05],[0.012918076612887673,0.016211396487038812,0.020107180868756042,0.024649176263315954,0.02986672822598364,0.035770241527878291,0.042346903506208969,0.049557047099023248,0.057331545168682954,0.065570606051026006,0.074144277816948018,0.082894865929147715,0.091641331345689761,0.10018557428352673,0.10832033775996013,0.11583830246212368,0.12254180898774154,0.12825255193783455,0.13282055558715974,0.1361317697908494,0.13811371707699602,0.13873876973087798,0.13802482463197205,0.13603335427696087,0.13286502297265637,0.12865324611936221,0.12355621938846308,0.11774804024404452,0.11140958010545053,0.10471974190250778,0.097847661530716987,0.090946294220170407,0.084147682272281241,0.077560043858210595,0.07126666756502717,0.065326456346034581,0.059775847924262542,0.054631755406494044,0.049895128984722606,0.045554741137754255,0.041590842517560948,0.037978415673778569,0.034689854342958286,0.031696999047029578,0.028972548227606747,0.026490926692958022,0.024228726094331497,0.02216483879300778,0.02028039442345821,0.018558586395881795,0.016984450899788076,0.015544638601714027,0.014227201605424206,0.013021405877778143,0.011917571607934507,0.010906939750332951,0.0099815611553574924,0.0091342042620665732,0.0083582776279668147,0.0076477641631317013,0.0069971645734550805,0.0064014480834079417,0.0058560089629332828,0.0053566277277534722,0.0048994361374880349,0.0044808853077198682,0.0040977164065657701,0.0037469335464167825,0.0034257786251813411,0.0031317080289187476,0.0028623712790965634,0.0026155918796845843,0.002389350764811126,0.0021817728284463356,0.0019911169917835119,0.0018157700991335,0.0016542446209966805,0.0015051797119770018,0.0013673446899403778,0.0012396435700400125,0.0011211190086710089,0.0010109539709075585,0.00090846966449999731,0.00081311875732612417,0.00072447353257473388,0.0006422093243364889,0.0005660842000482281,0.00049591632208786408,0.00043156067328075791,0.00037288685634086541,0.00031975949765587205,0.00027202244902739233,0.00022948754787604136,0.0001919282301057393,0.0001590778470844756,0.00013063216384721573,0.00010625523945803685,8.5587726554417384e-05,6.825657494875029e-05,5.3885171307784761e-05],[0.012263825761218016,0.015401232147221257,0.019116684937385022,0.023453699692645769,0.028442469589911965,0.034095539200930093,0.040403702323420887,0.047332477993543925,0.054819534956426295,0.06277341666094477,0.071073862312216393,0.079573924830543083,0.08810395867407439,0.096477399130547287,0.10449809373605028,0.11196879254345708,0.11870027445768923,0.12452049776505994,0.1292831266363062,0.13287480858283349,0.13522066069405711,0.1362875580929645,0.13608499323703704,0.13466347158630612,0.13211060745369446,0.12854526339925681,0.1241102198552191,0.11896395601338607,0.11327216159744401,0.10719958153148668,0.10090272700460039,0.094523876794003273,0.088186654574456375,0.081993315254861115,0.076023720281261656,0.070335842007162475,0.064967523401095503,0.059939142505076079,0.055256798760611223,0.050915652634839471,0.046903105735915718,0.043201593459161969,0.039790859109126442,0.0366496699248288,0.0337570079706771,0.031092815576106988,0.028638395925088204,0.026376569558553241,0.02429167430369673,0.022369476675300971,0.020597042631712484,0.018962598077571561,0.017455396124586318,0.016065598934028071,0.014784176309789798,0.013602820164109646,0.01251387265043858,0.011510265438429047,0.010585467795668036,0.0097334415277324452,0.0089486012405708588,0.0082257787478342698,0.007560190726079369,0.0069474089271952472,0.0063833324078188805,0.0058641613528464297,0.0053863721781147993,0.0049466937175447097,0.0045420844489571267,0.0041697108975888679,0.0038269275701594782,0.0035112589901543276,0.0032203845826384767,0.0029521272358986874,0.0027044462869479477,0.002475435394832901,0.0022633252746733865,0.0020664906159836628,0.001883459807219048,0.0017129254796787378,0.0015537535163651134,0.0014049881545894866,0.0012658511812484209,0.0011357339271855023,0.0010141816898876291,0.0009008711906938106,0.00079558254324653107,0.00069816784805856659,0.00060851886149054541,0.00052653620114458252,0.0004521022775798961,0.00038505965224251113,0.00032519589901192932,0.0002722353800214084,0.00022583771488032562,0.00018560218900382324,0.00015107695343075857,0.00012177163523467025,9.7171903798623204e-05,7.6754606196923026e-05],[0.011521752404475522,0.014481503850105751,0.017991166180412743,0.022093858446439123,0.026820580978891499,0.032186134331766841,0.038185219859268517,0.044789050784558845,0.051942819774280474,0.059564354532205321,0.067544242876357283,0.075747623066563269,0.084017718117085249,0.092181053246587749,0.10005414614515334,0.10745131566923041,0.11419313207294135,0.12011494591480192,0.12507489504607017,0.1289608062841362,0.13169548105130455,0.1332399765083595,0.13359465375483809,0.13279794627302874,0.13092298631925769,0.12807239571244106,0.12437168396341197,0.11996178856209484,0.11499133242910213,0.10960916067521771,0.10395765685869197,0.098167236266250166,0.092352282010130307,0.086608642709512879,0.081012663146738467,0.075621586663926432,0.070475064154458533,0.065597440241294477,0.061000468300105394,0.056686131006893861,0.052649303316133669,0.048880075853902805,0.045365642229841172,0.042091729312191628,0.039043605684561222,0.036206737039029532,0.033567170136493581,0.031111724374851542,0.028828058135331725,0.026704661425415981,0.024730810846536905,0.022896509826461114,0.021192427209155575,0.019609840600098807,0.018140586756296106,0.016777019078100888,0.015511971250120426,0.014338725779923542,0.013250986242892043,0.012242852241208989,0.011308796305580765,0.010443642155663476,0.0096425438736853636,0.0089009656409141779,0.0082146617548039917,0.007579656707664478,0.0069922251893343905,0.0064488719990521744,0.005946312031814718,0.0054814507456885219,0.0050513658025440767,0.0046532908636311657,0.0042846027451724214,0.003942813211601533,0.0036255665201908572,0.0033306433747792058,0.0030559712014443866,0.0027996397078954402,0.0025599196913823272,0.0023352822254118786,0.002124414887494994,0.0019262317292763772,0.0017398742706963293,0.0015647018368221285,0.0014002708702516103,0.0012463042173129391,0.0011026525840077718,0.00096925122028152357,0.00084607532591733691,0.00073309766282436738,0.00063025145662836313,0.00053740097022060161,0.00045432125141390672,0.00038068761780222138,0.00031607455414438572,0.00025996294828977762,0.00021175403932584684,0.00017078812423085849,0.00013636596618340542,0.00010777094424623306],[0.010711845912668038,0.013476663553915665,0.016760120880475127,0.020604730863189723,0.025042175741100389,0.030089497110131362,0.035745423877882397,0.041987139513239291,0.048767808054113924,0.056015167619592438,0.063631456911499754,0.071494864019910995,0.079462581426737844,0.087375424203585683,0.095063831403505814,0.10235493743718622,0.1090802856090332,0.11508367381949709,0.12022858371964985,0.12440465586494483,0.12753273564087883,0.12956812301488563,0.13050180317421972,0.13035960031132124,0.12919936629508802,0.12710647250003357,0.12418800120470792,0.12056612076146644,0.11637116889115566,0.11173495885433116,0.10678476686188834,0.10163836341366832,0.096400327514956141,0.09115974487986804,0.085989254798173667,0.080945290811891085,0.076069271160066135,0.071389445186261238,0.066923094326795024,0.062678816569737228,0.058658680936636821,0.054860109669963915,0.051277416504426125,0.047902988855544233,0.04472814399431687,0.041743713203805974,0.038940416124618286,0.036309084506934673,0.033840785211564577,0.031526880564878026,0.029359052827878825,0.027329310080262577,0.025429983750453435,0.023653723217752498,0.021993489939580387,0.020442551901620212,0.018994478388662115,0.017643134772188793,0.016382676962437885,0.015207545227059634,0.014112457153286342,0.013092399588547811,0.012142619426122917,0.011258613114607432,0.010436114779774505,0.009671082878449087,0.008959685383340658,0.0082982836511723765,0.0076834153712194795,0.0071117773265882336,0.0065802090965518117,0.0060856792191024333,0.0056252756171184179,0.005196202145980165,0.0047957828292122971,0.0044214746436636171,0.0040708886170927458,0.0037418176413059655,0.0034322680193984976,0.0031404906490008319,0.0028650071686391961,0.0026046265372117313,0.0023584484013560135,0.002125851096552661,0.001906463968035605,0.0017001255759786253,0.0015068309733361764,0.001326672395074483,0.0011597782568688738,0.0010062553152918772,0.00086613826149682476,0.00073935003689525926,0.00062567493327382725,0.00052474523686096613,0.00043604094585817174,0.00035890105330542492,0.00029254412234629563,0.00023609542778127752,0.00018861779560947246,0.0001491434073459804],[0.0098548596444478307,0.012412155220748152,0.015454317746659276,0.019023007586734208,0.023150385399654406,0.027855593286918487,0.033141330572543155,0.038990796825040509,0.045365293437072601,0.052202768048605186,0.059417549674903265,0.066901455971320523,0.07452636064171371,0.082148195321874201,0.089612236407770537,0.096759405678348495,0.10343320757128974,0.10948684827550671,0.11479004264003412,0.11923502057635665,0.12274129651938175,0.12525885966700884,0.12676957023383864,0.12728669499771711,0.1268526687887446,0.12553531155138509,0.1234228488246172,0.12061816550804225,0.11723276131688698,0.11338086886268425,0.10917414424664004,0.10471725247468631,0.10010455691113752,0.09541799727761073,0.090726119612837122,0.086084118699148712,0.081534680317854061,0.077109373824607516,0.072830345132028157,0.068712090324236155,0.064763140467456098,0.060987546693615557,0.057386110437799322,0.053957349134379821,0.050698219070778074,0.047604634441271866,0.044671827392108593,0.041894591580284433,0.039267445052093307,0.03678473995441521,0.034440738633010982,0.032229669055386136,0.030145767544328201,0.028183313419841424,0.026336658016426057,0.024600249315137306,0.022968652789405585,0.021436568767351279,0.019998846494732683,0.018650495038734959,0.017386691147068763,0.016202784144250578,0.015094297903098523,0.014056929884284766,0.013086547210945763,0.012179179767936926,0.011331010420101885,0.010538362662675495,0.0097976863686559112,0.0091055427747799567,0.0084585904003692414,0.0078535741219595816,0.007287319984230471,0.0067567383424020199,0.0062588374493256068,0.005790748543458942,0.0053497619118323802,0.0049333715000658522,0.0045393237591827337,0.0041656649587824791,0.0038107805175334481,0.0034734202178244539,0.0031527044847241082,0.0028481090124526311,0.002559427554630431,0.0022867152384457227,0.0020302169325625767,0.0017902867119051603,0.0015673051727609845,0.0013616012472066042,0.0011733843463240237,0.0010026913033455867,0.00084935090682239009,0.00071296703263110833,0.00059291970389607502,0.00048838199118918994,0.00039834962107897025,0.0003216795423703265,0.00025713350580562313,0.000203422899005609],[0.0089714477688683115,0.01131336986069542,0.014104551948879352,0.017385529042173869,0.021188670713112187,0.025534966856588022,0.03043086708565235,0.035865416940050923,0.041807953183413828,0.048206616877457302,0.054987913149078228,0.062057489786088695,0.06930222539628754,0.076593617579723369,0.083792351150643624,0.090753816863311979,0.097334254285753721,0.10339711986848378,0.10881924227866595,0.11349632773495796,0.11734742006463807,0.12031800045727406,0.12238152285879762,0.1235393114427466,0.12381888310802899,0.12327088629227249,0.12196495435273924,0.11998484665452733,0.11742328631516727,0.11437689774159217,0.11094160187031592,0.10720874915784499,0.10326217049425719,0.099176217553507778,0.095014760680446481,0.090831026929486858,0.086668102511275324,0.082559896809451458,0.07853236787433851,0.074604835688707197,0.07079125043694981,0.067101328839909949,0.063541514217883871,0.060115749995645333,0.056826079647869066,0.053673098969305923,0.050656291052764479,0.047774273138150504,0.045024980119474742,0.042405803978128466,0.039913703072909389,0.037545290753217983,0.035296909396037669,0.033164693636304074,0.031144625063808641,0.029232579764428179,0.027424369580374218,0.025715777692255717,0.024102588973808393,0.022580615468699862,0.021145717249730672,0.019793818828358244,0.018520921187939954,0.017323109432596791,0.016196556002977567,0.015137519448994335,0.014142338912138546,0.013207424796562655,0.012329246619365688,0.011504319707616652,0.01072919317497209,0.010000442317309777,0.0093146690064314502,0.0086685135992111157,0.0080586811184774464,0.0074819829175231251,0.006935392810884889,0.0064161140472639719,0.0059216509931662303,0.0054498775288290679,0.0049990933921568084,0.0045680602908232766,0.0041560115029495208,0.0037626315968155321,0.0033880063280443567,0.0030325461642027353,0.0026968897436537294,0.0023817955395803543,0.0020880308905537191,0.0018162673688377892,0.0015669903226049988,0.0013404285827007454,0.0011365080545201519,0.00095483051574240293,0.0007946766793724561,0.00065503067438223248,0.00053462169005037957,0.00043197769678460744,0.00034548589593161468,0.00027345480311810919],[0.0080813663188681883,0.010204672987789216,0.012740478441745541,0.015727906751782116,0.019199217553866166,0.023176903513106695,0.027670804117657027,0.032675449657933182,0.038167868428218565,0.044106089675567395,0.050428551314186477,0.057054573928082282,0.063885992912048606,0.070809953527111766,0.077702776658511413,0.084434705680915045,0.090875257559463948,0.096898834343124546,0.1023902130754584,0.1072495285184753,0.11139639585778525,0.11477288746293016,0.11734517252201718,0.11910374132128577,0.12006225525560377,0.12025517670174517,0.11973442775399254,0.11856539375228567,0.11682262009220371,0.11458554668405728,0.11193458577579461,0.10894778207677169,0.10569820908128894,0.10225216413603427,0.098668139309244562,0.094996475921771226,0.091279564607065614,0.087552432373801739,0.08384356123362513,0.080175803916596858,0.076567293617403942,0.073032279213247675,0.069581849061533085,0.066224531649659232,0.062966778639198903,0.05981334563606007,0.056767589832023638,0.053831703405919862,0.051006899035756538,0.048293560450700809,0.045691367558394327,0.043199402803124641,0.040816243211120859,0.038540041032954192,0.036368594878057818,0.034299412606064672,0.032329766860710339,0.030456743900295864,0.028677286221113221,0.026988229340595044,0.025386332980350649,0.023868306758009415,0.022430830368696319,0.021070568135295044,0.01978417777034077,0.018568313273921389,0.017419622150317966,0.016334737612386359,0.015310267177992198,0.014342780011155749,0.013428796403865182,0.012564783721508217,0.011747163657232365,0.010972335445928884,0.010236718528769647,0.0095368159544329291,0.0088692967257808682,0.0082310917977575677,0.0076194951579714064,0.0070322590867040319,0.0064676718752227349,0.0059246072608281223,0.0054025375205788585,0.0049015061171909964,0.0044220603522416666,0.0039651489336249386,0.0035319930719861273,0.0031239422361554131,0.0027423267999157033,0.0023883195019276681,0.0020628160983366456,0.0017663431199795958,0.0014989976263553929,0.0012604206620660773,0.0010498031203412374,0.00086592018673962404,0.00070718866872942392,0.00057174040968041226,0.000457504640070844,0.00036229245471586024],[0.0072027798700263585,0.0091085544966854025,0.011389584054016624,0.014083298080724119,0.017221497646582332,0.02082776529295071,0.024914858795215086,0.029482274068186758,0.034514181464453293,0.039977941824170339,0.045823390846530754,0.051983041549398902,0.058373296061799675,0.064896683639177069,0.071445057892575214,0.07790360091749339,0.084155404398775294,0.090086336815584908,0.095589869214572826,0.10057152489744071,0.10495264280635706,0.10867319879013547,0.11169350814294748,0.11399472866063536,0.1155781857329933,0.11646363863638207,0.11668668970091152,0.11629559674705252,0.11534777843272132,0.11390629997027264,0.11203659513613125,0.10980362543779119,0.10726960746269763,0.10449236507581794,0.10152429434532993,0.098411874074921885,0.095195618654334888,0.09191035391116581,0.088585698593079854,0.085246649397023769,0.081914190367659831,0.078605872544861399,0.075336332715868065,0.072117738466112469,0.06896015949682735,0.065871872706071824,0.062859611864196252,0.059928773163250341,0.057083586704866011,0.054327262064489498,0.051662114060920722,0.049089673110979809,0.046610783189525155,0.044225689442986452,0.041934116852621058,0.039735340924254028,0.037628251112064845,0.035611407499054733,0.033683091108723758,0.031841348080829494,0.030084027793768932,0.028408814856876442,0.026813254743816975,0.025294772727971961,0.023850685766796987,0.022478207136000686,0.021174444013908555,0.019936388925267445,0.018760906990918622,0.017644722233021919,0.016584407580323986,0.015576384407369883,0.01461693803467912,0.013702255206851593,0.012828487850868747,0.011991844336968701,0.011188705299568285,0.010415756457808413,0.0096701266815329562,0.0089495166930822663,0.0082523029843708032,0.0075776030645826747,0.0069252918566984735,0.0062959643285010738,0.0056908454138279198,0.0051116540343248322,0.0045604327757334962,0.0040393579517250368,0.0035505461362656224,0.0030958727724069031,0.0026768164076443422,0.0022943388582242334,0.0019488076471485169,0.0016399628904373938,0.0013669268795029571,0.0011282512940696092,0.00092199453439212461,0.00074582021033617752,0.00059710737117706449,0.00047306350063989577],[0.006351705180027381,0.0080449394667194002,0.010076344990453004,0.012481390098057769,0.015291059647120023,0.018529572212228802,0.022212054149647456,0.026342328672457942,0.030910996436130756,0.03589398835592561,0.041251758644551828,0.046929255176108922,0.052856756104776297,0.058951599274838284,0.065120759535863701,0.07126415546519857,0.077278498967936732,0.083061446531344812,0.088515776291045761,0.0935533052839949,0.098098278379644133,0.10209000335624369,0.10548457129179639,0.1082555810706281,0.11039387270070644,0.1119063568293208,0.11281409827833112,0.11314986213039867,0.11295535701816656,0.11227841020568,0.11117028470196672,0.10968330507991905,0.10786890328230715,0.10577613692912798,0.10345067854229337,0.1009342309796038,0.098264295871007559,0.095474208688548889,0.092593354396629704,0.089647487840892937,0.086659098896708212,0.083647779959780594,0.080630569612985939,0.077622259444660086,0.074635660361115783,0.07168183052148977,0.068770269915538015,0.065909087470379851,0.063105146223996114,0.060364191180437336,0.057690963393595647,0.055089302854598655,0.052562241983896599,0.050112090965863609,0.047740515778204352,0.045448609510954377,0.043236957390893373,0.041105695785197731,0.039054565322098458,0.03708295811631776,0.035189958915546861,0.033374379798573515,0.031634787882389027,0.029969525384725793,0.028376721415275453,0.026854295129181836,0.025399950471381494,0.024011163747368856,0.022685166686949542,0.02141892942169896,0.020209149622787304,0.01905225553508464,0.017944431277208312,0.016881672037456479,0.015859874328352185,0.014874962249289272,0.013923045178059637,0.013000596338099515,0.012104636418698037,0.011232903010510782,0.010383985902060683,0.0095574105728578954,0.0087536572163501945,0.007974109521159756,0.0072209351255702854,0.0064969069865167626,0.0058051808884248459,0.0051490482830522438,0.004531685280435069,0.0039559179254906804,0.0034240211974895093,0.0029375649609506543,0.0024973149858261508,0.0021031917752762593,0.0017542848739249507,0.0014489160531116487,0.001184741610732542,0.00095888214681520462,0.00076806758770838856,0.00060878580026845375],[0.0055416114638444994,0.0070306848739852346,0.0088216010441618357,0.010947631242786136,0.013438597743199252,0.016318887647234236,0.019605402516122701,0.0233055766307004,0.027415614167102587,0.031919101382286902,0.036786141493190198,0.041973136079619,0.047423298030270948,0.053067929657327893,0.05882843981460583,0.064619011320492428,0.070349771233313943,0.075930268167566178,0.081273028719238763,0.086296953444825519,0.090930323732950971,0.095113223730206933,0.098799233001293951,0.10195631027387488,0.10456685924721175,0.10662703610054368,0.10814541740037709,0.10914119029567167,0.10964205013865283,0.1096819926823292,0.10929917040218724,0.10853394946399973,0.10742726140493043,0.1060192984134746,0.10434855941977617,0.10245122079836495,0.10036078299775478,0.098107933283497151,0.09572056358443494,0.093223888542132205,0.090640619233687963,0.087991159866017063,0.085293805900756803,0.082564931279958467,0.07981915918047873,0.077069515109222872,0.074327563584206932,0.071603530677791488,0.068906414854494766,0.066244088236462231,0.063623389963484794,0.061050212850215682,0.058529584158880148,0.056065741020249291,0.053662200835559733,0.051321826850219236,0.049046888976631516,0.046839119831263896,0.044699765818915965,0.042629632931937014,0.040629126732549731,0.038698285768324396,0.03683680747405009,0.035044065507746476,0.033319117556264891,0.03166070305315799,0.030067231106809769,0.028536760331108264,0.027066974201911113,0.025655157874390936,0.024298184735711301,0.022992522784334345,0.02173427154743883,0.020519239027490147,0.019343064707755105,0.018201388999371619,0.017090062312086419,0.016005379345106919,0.014944317697307672,0.013904755903880359,0.012885645503081442,0.011887115014637167,0.010910490314530841,0.0099582247579204017,0.0090337421398477367,0.0081412047721453468,0.0072852263990101692,0.0064705545578991512,0.0057017489384810901,0.0049828813375020391,0.004317279332008369,0.0037073304226611066,0.0031543568954623849,0.0026585648095473393,0.002219064076347213,0.0018339511531938683,0.0015004418505573497,0.001215039358537564,0.00097372184469692816,0.0007721346967214112],[0.0047831848139549757,0.0060792728950357592,0.0076421613436251142,0.0095027309047600421,0.011689324494187518,0.014226042268536288,0.017130957376834805,0.020414362079722664,0.02407717024385676,0.028109609100265599,0.032490328309181832,0.037186036588624141,0.042151745632648722,0.047331659536339617,0.05266069876691877,0.058066595459238604,0.06347244685480756,0.068799571593121875,0.073970484292377486,0.078911791161983352,0.08355681519330975,0.087847783540051599,0.091737449572038943,0.095190073350686508,0.098181741094353472,0.10070006008476678,0.1027433141446924,0.10431920112492969,0.10544329443189542,0.10613737443337717,0.10642776387770869,0.10634377755978378,0.10591636503850045,0.10517699140683889,0.10415676965964142,0.10288583264693785,0.10139291490534084,0.099705105161570731,0.097847728000823864,0.09584431625345971,0.093716641953761476,0.091484781313397712,0.089167196540838226,0.086780823605769872,0.084341159799631651,0.081862348179804867,0.079357257942640147,0.076837560782313741,0.074313803687085539,0.071795478670453106,0.069291089821450241,0.066808217901248815,0.064353582569859361,0.061933102215795129,0.05955195127900096,0.057214614887768869,0.054924940554218003,0.052686186570724852,0.050501066605347041,0.048371789799011855,0.046300095425528098,0.04428728091325837,0.042334221801334046,0.040441382108996504,0.038608813769200494,0.036836144380179917,0.035122553721087101,0.033466741362659001,0.031866890254136991,0.03032063415182883,0.028825039687629946,0.027376616032359261,0.025971365631413102,0.024604887597681212,0.023272540606418021,0.021969664717901974,0.020691852351049395,0.019435249174727547,0.018196857821634334,0.016974812769882084,0.015768594599245445,0.014579156361256559,0.013408943350236987,0.012261798768059481,0.011142759917757669,0.01005776091668242,0.0090132670532580804,0.0080158718507177609,0.0070718902006048773,0.006186979642118633,0.0053658174601131908,0.0046118545244429425,0.0039271586378812912,0.003312351585106791,0.0027666359970191122,0.0022879013153673045,0.001872893087835255,0.0015174268118611086,0.0012166265919287659,0.00096516977546480824],[0.004084252665064598,0.0052006976538719807,0.0065506402690770592,0.00816242843545004,0.010062653699842059,0.012274708304682018,0.014817253443352588,0.017702687677439825,0.020935719470135786,0.024512155269688092,0.02841801255108679,0.032629054530627331,0.037110819877328796,0.041819187922386446,0.046701480165860093,0.051698055945520557,0.056744318333282723,0.061773010232780153,0.066716654456557972,0.071509978488062828,0.076092166460345764,0.080408797637067583,0.084413360568166187,0.088068271687721925,0.091345371804020609,0.094225918508514903,0.096700131962373537,0.098766381636877967,0.10043011967098428,0.10170267165081071,0.10259998873826483,0.10314144867025782,0.1033487707305295,0.10324508521505806,0.10285417467730211,0.10219988498333142,0.10130569040269864,0.10019438891587601,0.098887900996155881,0.097407146097374581,0.095771974513494978,0.094001136840021107,0.092112277927936706,0.090121946318415316,0.088045613368629191,0.085897698578192752,0.08369159911852779,0.081439722443036822,0.079153521310846728,0.076843530756754833,0.07451940660532462,0.072189965133837811,0.069863223477104164,0.067546440351675716,0.065246156656439985,0.062968235470183043,0.060717900899102666,0.058499775111748122,0.056317912721374395,0.054175831430361338,0.052076537548864953,0.050022544678630286,0.048015883591070792,0.04605810125343858,0.044150247243963305,0.042292846652771533,0.040485860184285481,0.038728634668895798,0.037019850491255619,0.035357476216995025,0.033738744298045423,0.032160164223008346,0.030617589785648876,0.029106354347266827,0.027621481625487852,0.026157969986582388,0.024711136674436935,0.023276996833893535,0.021852642848377731,0.020436584426926831,0.019029010286595371,0.017631938354397289,0.016249232261848229,0.014886475826593163,0.013550712120986639,0.012250067557636104,0.010993292476060337,0.0097892568468539339,0.0086464423978425946,0.0075724707821576585,0.0065737019205833304,0.0056549282938697463,0.0048191808815964991,0.0040676518487458742,0.0033997290943261226,0.0028131293263526798,0.0023041100655154167,0.0018677372414594847,0.0014981838537526495,0.0011890362749354785],[0.0034498540699382275,0.0044015299959362679,0.0055555075551412501,0.0069375159735049069,0.008572179361919223,0.010481813614829739,0.012685130069407543,0.015195916746054186,0.018021781477394756,0.021163048894856897,0.024611903340206989,0.028351861219069827,0.032357638927394426,0.036595457118294462,0.041023790653790464,0.045594538943759241,0.050254556988095632,0.054947457011371749,0.059615567568894225,0.064201924142502684,0.068652164140002775,0.072916210078720012,0.076949646320470494,0.0807147244536323,0.084180966721537367,0.087325371718449424,0.090132257948845163,0.092592805466616426,0.094704371491979231,0.096469661844343399,0.097895836834682254,0.098993619719249415,0.099776460482086909,0.10025979039276901,0.10046038603872,0.10039584729507131,0.10008418308805356,0.099543492130818395,0.098791722702078283,0.097846495219142585,0.096724972888268604,0.095443768207527716,0.09401887584520896,0.092465624951146033,0.090798646035156555,0.089031849097132756,0.087178410760725675,0.085250768845447952,0.083260623221077676,0.081218942020945373,0.079135972420135967,0.077021255258276272,0.074883642829924296,0.072731319187609403,0.070571822300631915,0.068412067376340244,0.066258370564442184,0.064116472111984416,0.061991557802967903,0.05988827719868655,0.057810756810911107,0.055762605944036578,0.05374691263916026,0.051766227108741923,0.049822530489208282,0.047917187916814742,0.046050887079174332,0.044223566622280434,0.042434342978068598,0.040681448857407189,0.038962200973759541,0.037273017340420656,0.035609504418997254,0.033966630423485092,0.032338992784476488,0.03072117570892011,0.029108179555378783,0.027495889829262349,0.025881542714468412,0.024264138526742453,0.02264475564497288,0.02102672540668634,0.019415641962291168,0.017819198090646943,0.016246855995917353,0.014709378708645969,0.01321826091336408,0.011785106483814525,0.01042100311718195,0.0091359423097047976,0.0079383261872554463,0.0068345925130181527,0.0058289769178638557,0.0049234184929974724,0.0041176027122411972,0.0034091253423503129,0.0027937533501142227,0.0022657542380897623,0.0018182637695486506,0.0014436633777802092],[0.0028824335967274407,0.0036851350314896841,0.0046613245978235403,0.0058340850556227999,0.0072259197482817637,0.0088577651879722785,0.010747910331338794,0.012910877765322669,0.015356333944904144,0.018088103124457459,0.02110336122221218,0.024392080566149332,0.027936784000415327,0.031712647724499672,0.035687967891093395,0.03982497856478201,0.044080980853673374,0.048409717814597991,0.052762909902047447,0.057091853557831584,0.061348982441164171,0.065489297114585412,0.069471583911253826,0.073259365335454088,0.076821550011481277,0.08013277680199303,0.08317347220810585,0.085929659962027991,0.088392575084530203,0.09055814089497706,0.092426366871316806,0.094000719082264289,0.095287504947450252,0.096295302316224157,0.097034451128088436,0.097516615639845899,0.097754417228717222,0.09776113239667919,0.097550447639916604,0.097136261842417346,0.09653252721192182,0.095753120921822463,0.094811741081934298,0.093721822106544284,0.092496465793709889,0.091148385402984686,0.089689860723136797,0.08813270260099601,0.086488225714604197,0.084767228571897987,0.082979979841691115,0.081136210203882161,0.079245108954437732,0.077315324620557763,0.075354968826469498,0.073371622587559401,0.071372344082304209,0.069363676738469868,0.067351656157444678,0.065341813987572536,0.063339176371489947,0.061348254107446543,0.059373021318132269,0.057416879425216956,0.055482603864124444,0.053572272552939643,0.051687177917158302,0.049827728370345548,0.04799335035837126,0.046182407764655729,0.044392160549555422,0.042618787494220101,0.040857497288737575,0.039102746752344174,0.037348574348151128,0.035589042202507679,0.033818762651932316,0.032033468908544062,0.030230576969216695,0.028409680032004274,0.026572918844490635,0.024725181496170087,0.022874102676818872,0.021029852863009117,0.019204729345711415,0.017412580661769369,0.015668111543281588,0.013986125407694377,0.01238076497452417,0.010864808917551382,0.0094490743416444471,0.0081419626285155686,0.0069491714583935328,0.0058735803178677866,0.0049153021778880514,0.0040718816256437975,0.0033386105194369111,0.0027089267089377617,0.002174859569866077,0.0017274876869352587],[0.0023821313063667427,0.0030520103360287608,0.003869130325394651,0.0048539561987099179,0.0060267823263409175,0.0074069356582247871,0.0090118889970723197,0.010856326507100649,0.012951213897229683,0.015302932788990717,0.017912541340632849,0.020775220373973551,0.023879955694521504,0.027209493309793231,0.030740585819013497,0.034444526975165882,0.038287949378627152,0.042233839747358781,0.046242709452839155,0.050273846875559372,0.054286573844982922,0.058241431390549124,0.062101229754735955,0.065831912789200975,0.069403205514790248,0.072789033472083986,0.075967721212754649,0.078921992906016342,0.081638809180933317,0.08410908036888233,0.086327297391745175,0.088291118447489644,0.090000943590126628,0.091459501663529896,0.09267146611972478,0.093643109049572085,0.094381996923177877,0.094896727346155729,0.095196703539131122,0.095291941984342626,0.095192908398149922,0.094910377518512626,0.094455312834219901,0.093838763104247713,0.093071773183961024,0.092165307224669965,0.091130182729205131,0.089977014242468054,0.088716165658049281,0.087357710256401711,0.085911397677725987,0.084386627086796256,0.082792425812225956,0.081137432736011358,0.079429885660143418,0.077677611768717347,0.07588802011466167,0.074068094767418727,0.072224386845642072,0.070363003130116536,0.068489588346279801,0.06660929762100147,0.064726755231955119,0.062845995847174402,0.060970385341561829,0.059102520347027752,0.057244109241511063,0.055395842388902009,0.053557265801027688,0.051726679177637389,0.049901085114029693,0.048076219373807148,0.046246690701029318,0.044406251392906423,0.042548206538652739,0.040665951656257526,0.038753608052651711,0.036806706169387186,0.034822853159805253,0.032802314901669884,0.030748446038417233,0.028667914174559949,0.026570684167455668,0.024469752629062168,0.022380647909955888,0.020320733768135788,0.018308373005320292,0.016362018818807673,0.014499305659344182,0.012736208123836161,0.011086326767558226,0.0095603452257809977,0.0081656855984000836,0.0069063707087534763,0.0057830845214299938,0.0047934072980407496,0.0039321911253482429,0.0031920348683472312,0.0025638154428394861,0.0020372341529863989],[0.001947138660663101,0.002500209056329819,0.0031769350250764315,0.0039952439953673657,0.0049731966168883651,0.0061283552014339895,0.0074770684058346245,0.0090337034507908306,0.01080986597416953,0.01281365407122982,0.015048996159180445,0.017515121259557769,0.020206204754878897,0.023111222775595734,0.026214034771867453,0.029493697682173338,0.032924997974094997,0.036479171457631576,0.040124766901221791,0.043828599610673112,0.047556736298494107,0.051275453202989256,0.054952115266315181,0.058555934365304457,0.062058577724125714,0.065434612051693181,0.068661782932958257,0.071721141070998515,0.074597036051053986,0.077277003835210911,0.079751576201685215,0.082014039287586438,0.084060165068250883,0.085887934935237803,0.087497269407704803,0.088889773149515156,0.090068500350083486,0.091037742394817892,0.091802837623566641,0.092370001727762649,0.092746176766923108,0.092938896674012561,0.092956167273033879,0.092806359103407482,0.092498111637152616,0.092040247733489969,0.091441697380272011,0.090711429921457643,0.089858394072977396,0.08889146509632613,0.087819398538388896,0.086650789961100524,0.085394040073533822,0.084057324633455596,0.082648568390066193,0.081175422172864678,0.079645241967016334,0.078065068426979578,0.076441604750680472,0.074781190174367254,0.073089765608426782,0.071372827244619824,0.069635363549312559,0.067881771244974451,0.066115747088251631,0.064340154909645328,0.062556871811740841,0.060766623669871796,0.058968827702000085,0.05716146781065063,0.055341034956769501,0.053502567897235787,0.051639827148092093,0.049745625656027116,0.047812323318059777,0.045832470812962406,0.043799564410993246,0.041708851695573403,0.039558112650294609,0.037348334520995299,0.035084203711150688,0.032774353196065524,0.030431327311242984,0.028071253903654749,0.025713242908634686,0.023378556802139148,0.021089619122348656,0.018868940359208324,0.01673804505309915,0.014716480052745217,0.012820972605774602,0.011064790049985075,0.0094573325409803514,0.008003968850896704,0.0067061050390219579,0.0055614586011870134,0.0045644978878061106,0.0037069988505466986,0.0029786686143268991,0.0023677874974735859],[0.0015740902160653375,0.0020258116557993889,0.0025802792198557959,0.0032530078506441723,0.004059858079197406,0.005016545225242636,0.0061380727539978325,0.0074381123940095925,0.0089283609725970704,0.010617909645725399,0.012512664464925672,0.014614857390903086,0.016922683575084342,0.019430093999803916,0.022126762816552212,0.024998236762180753,0.028026260992732858,0.031189262867740826,0.034462963979848722,0.037821082234075466,0.041236080896375954,0.044679920669722074,0.048124773937058184,0.051543666774319062,0.054911023236940915,0.058203096578635663,0.061398282238441598,0.064477316527808304,0.067423372137558529,0.070222066404289407,0.072861400649192193,0.075331649084448712,0.077625214262447673,0.079736463422352438,0.081661556963404283,0.083398277145752653,0.084945862341547523,0.086304849926356897,0.087476929268843706,0.088464805198521429,0.089272071702542907,0.089903095298252814,0.090362907431843886,0.09065710527127073,0.090791760328006219,0.090773334417469778,0.090608602531988838,0.090304582245869694,0.08986846929923635,0.089307579017596381,0.08862929321841416,0.087841012231920632,0.086950111613809195,0.08596390303918075,0.084889598720064921,0.083734278456213743,0.082504858079235383,0.081208057553531027,0.079850366337146816,0.078438002797080505,0.076976863590902778,0.075472458132712764,0.073929822833977893,0.072353410147921793,0.070746949039951046,0.069113276849485983,0.067454147942159481,0.065770032055366134,0.064059924211803509,0.062321197181390474,0.060549534675569505,0.058738986312289451,0.056882181605829293,0.054970728422255137,0.052995801688878116,0.050948902769768975,0.04882274265676001,0.046612177772550591,0.044315110383961027,0.041933259775909386,0.039472716852942569,0.036944212949454339,0.034363060718883051,0.031748757208833689,0.029124272339742741,0.026515075951474142,0.023947980071559811,0.021449887854310328,0.019046545696859835,0.016761390488526585,0.014614570967867833,0.012622202734536091,0.010795893095315163,0.0091425473108452619,0.0076644445159627398,0.0063595517681099747,0.0052220298797371221,0.0042428757385205833,0.0034106428146540107,0.0027121839564100162],[0.0012584632174875287,0.0016234122746003029,0.0020728167094725938,0.0026199400008738803,0.0032785267674675682,0.0040624295324239263,0.0049851686053925138,0.0060594408642226935,0.0072965992391690136,0.0087061296362338555,0.010295155231519935,0.01206799899070588,0.014025833586474971,0.016166443542403514,0.018484117671673322,0.020969681251685982,0.023610667681558638,0.026391619570001103,0.029294500298569826,0.03229919001052254,0.035384035383538875,0.038526420839911597,0.041703330055300747,0.044891870418077615,0.048069738843997456,0.051215614255140339,0.054309469217696929,0.057332799900061258,0.060268779037469557,0.063102340592213965,0.065820207160734501,0.068410872015118238,0.070864547261448196,0.073173088326482824,0.075329903235508186,0.077329853257033343,0.079169149717037715,0.08084525028097006,0.082356756830011327,0.083703316215089973,0.084885524610995661,0.085904835848139113,0.086763473904682947,0.087464349640545253,0.088010981805181576,0.088407422325388632,0.088658185861498554,0.088768183602013287,0.088742661244085794,0.088587141077802523,0.088307368052485277,0.087909259646795218,0.08739885928015223,0.086782292873449893,0.086065727967359909,0.085255334504528713,0.08435724594111392,0.083377518740064091,0.08232208749778569,0.0811967119926984,0.08000691141594464,0.078757880154911031,0.077454379086845576,0.076100596877290663,0.074699977834382328,0.073255016995866437,0.071767029666845172,0.070235911479272939,0.06865991541215262,0.067035482459628773,0.065357170363766051,0.063617727255635872,0.061808351683527753,0.059919165993989207,0.057939906867238135,0.055860807642809034,0.053673616381236522,0.051372666778675982,0.048955901135678111,0.046425739135043255,0.043789694536441701,0.041060663012365446,0.038256835224849177,0.035401225615841268,0.032520844549693034,0.029645574967828686,0.026806840965976454,0.024036172204670678,0.021363773640371161,0.018817204846835786,0.016420258480327687,0.014192105444271902,0.012146747840001193,0.010292792888301237,0.0086335345724449942,0.0071673072339323686,0.0058880585070036889,0.0047860787552214566,0.003848820698581635,0.0030617455883225945],[0.0009949612030634423,0.0012865901053085431,0.001646885614557266,0.0020870472706529951,0.0026188290983822906,0.003254262604410735,0.0040053222395174714,0.004883543892579445,0.005899611814708227,0.0070629335190209117,0.0083812251562045779,0.0098601311949507026,0.011502901646233243,0.013310147462025993,0.015279690238929892,0.017406516319725222,0.019682838362459581,0.022098260123759702,0.024640033316742718,0.027293389643557327,0.030041927018345117,0.032868026926082212,0.035753279890682693,0.038678897980836485,0.041626096775224213,0.044576433702427677,0.047512094567338299,0.050416124807903993,0.053272606133270915,0.056066782373115992,0.058785140488468356,0.061415453786527636,0.063946794597573367,0.066369523234022981,0.068675259203594186,0.070856839612903025,0.072908268649528554,0.074824661085896096,0.076602181967532323,0.078237984046705206,0.079730144085497182,0.081077598849597587,0.082280081410817038,0.083338058240777085,0.084252667485239477,0.085025658740219834,0.085659334595763276,0.086156494163840774,0.086520378758433131,0.086754619844076813,0.086863189308071215,0.086850352031988473,0.086720620625685779,0.086478712020255935,0.086129505365571929,0.085678000305748722,0.085129274170411245,0.084488435885093194,0.083760573457618337,0.082950690776808764,0.082063628289839693,0.081103961154714077,0.080075868097705435,0.078982964995954932,0.077828099798371728,0.076613110394044601,0.075338554770360222,0.074003433061627474,0.072604932853913284,0.071138240424498858,0.069596468687125837,0.067970754386055751,0.066250569891268582,0.064424277534470067,0.062479927653451915,0.060406268595189758,0.058193902972294896,0.055836495400469296,0.053331918160135931,0.050683216378857435,0.047899284633668188,0.044995171014696592,0.041991959303528108,0.038916220341235354,0.035799064783419196,0.032674866451600691,0.029579754443236874,0.026549990338276996,0.023620352932156252,0.020822647052647768,0.018184436590602687,0.015728077330660239,0.01347009561878838,0.011420927726196834,0.0095850051994625773,0.0079611462621986904,0.0065431944304264068,0.0053208339937698959,0.0042805080502609357,0.0034063676985977101],[0.00077786286053713844,0.0010083420993812263,0.0012940379147714563,0.0016442902943752341,0.0020690187492103814,0.0025785224230617269,0.0031832318707886733,0.0038934191992921249,0.0047188770639255253,0.0056685804126910249,0.0067503474834796134,0.0079705180420972261,0.00933366695018264,0.0108423697570638,0.012497034165403317,0.014295807143223253,0.016234562511635166,0.018306968505456291,0.020504629610990789,0.022817292442033926,0.025233101946869084,0.027738892130504757,0.030320494838450718,0.032963050911334849,0.035651309954989774,0.038369907735301099,0.041103613402684577,0.043837541985610066,0.046557330534328784,0.049249278710027336,0.051900456378513558,0.054498781865620766,0.057033075033337932,0.05949308936509938,0.061869526951619777,0.064154039785717071,0.066339220222271955,0.068418582921324189,0.070386540118202209,0.072238371676018265,0.073970191074004099,0.07557890825912951,0.07706219012227479,0.078418419237638287,0.079646651411128797,0.080746572509552514,0.081718454979810756,0.082563114410541011,0.083281866432996843,0.083876484198251861,0.084349156596667724,0.084702447291642544,0.084939254505604467,0.085062771296721851,0.085076445765350228,0.084983940186982132,0.084789087437199151,0.084495842216011627,0.084108223485729564,0.083630243261358123,0.08306581559104427,0.082418638536370242,0.081692041680532401,0.080888792790745651,0.080010860459007571,0.079059135481935341,0.07803312271854547,0.076930626840892372,0.075747468501120671,0.07447727968479817,0.073111435277065734,0.071639178753955729,0.070047990691163964,0.068324228359810793,0.066454034328184988,0.064424475497467923,0.062224837065752048,0.059847964935613132,0.057291530710679037,0.054559089357953811,0.051660811909382653,0.048613802662389898,0.045441948515154998,0.042175292322150344,0.03884896701213085,0.035501767521725187,0.032174469114370892,0.02890802042810664,0.025741746187146256,0.022711688022680067,0.019849193788881163,0.017179838776320587,0.014722729713419364,0.012490208109326908,0.010487936887386791,0.0087153264069222535,0.0071662350598861741,0.0058298668521459202,0.0046917839183692979,0.003734955053018458],[0.00060132302364656958,0.0007814599954668747,0.0010055057067561266,0.0012811526974030442,0.001616662407091275,0.0020207256856620498,0.0025022836328709459,0.0030703126808302827,0.0037335807561988416,0.0045003840781148051,0.0053782763726351653,0.0063738037483465904,0.0074922589735496523,0.0087374683075406284,0.010111622365933489,0.011615159863942971,0.013246709716627014,0.01500309320309858,0.016879384092046867,0.0188690211477337,0.020963964609657687,0.023154886296653604,0.025431382042575324,0.027782195216752778,0.030195440995520493,0.032658822622688627,0.035159832870399657,0.03768593602438685,0.040224727736658583,0.042764071838571241,0.045292214582767304,0.047797877747772638,0.050270332616465963,0.052699457091394702,0.055075778218306094,0.057390502238992239,0.059635534059959298,0.061803487761499999,0.063887689520262247,0.065882174097943128,0.067781675866713548,0.069581615197226901,0.071278080921904297,0.072867809497418959,0.074348161419020828,0.07571709537974132,0.076973140614919014,0.078115367822855372,0.07914335900150761,0.080057176483346482,0.080857331377356775,0.081544751525387385,0.082120748929481693,0.082586986378256358,0.082945442654551213,0.08319837519547546,0.083348278349283253,0.083397834392712422,0.083349853235610102,0.083207195318149907,0.082972670789703398,0.082648907001034944,0.082238176185983253,0.081742176667700409,0.081161764783481,0.080496641644806188,0.079745009086435725,0.078903222211463717,0.077965480280481614,0.07692361069137936,0.075767008990836313,0.074482797640331,0.073056254868714643,0.071471541508474484,0.069712719952115712,0.067765019621153347,0.065616263836538832,0.063258340489717887,0.060688579262405999,0.057910894997189287,0.054936571078454184,0.05178458652232186,0.048481431913292752,0.04506040705063262,0.041560441409341509,0.038024521829549018,0.034497845706226549,0.031025839195856147,0.027652187018935764,0.024417013393320447,0.021355334079790355,0.018495870289098937,0.015860279945855236,0.013462824530802643,0.011310454288174459,0.0094032642726353914,0.0077352509075152062,0.0062952847438450402,0.0050682101598679037,0.0040359860520234976],[0.00045961829982201689,0.00059884141480007322,0.00077259041102107132,0.00098712204421399054,0.0012492267154801721,0.0015661351356566363,0.0019453931655590655,0.0023947068272199478,0.0029217616817326258,0.0035340228909651033,0.004238524111651115,0.0050416547089837975,0.0059489554565897674,0.0069649328047644852,0.0080929009216281454,0.0093348591016315062,0.010691409934917209,0.012161721049145136,0.013743530523724297,0.015433193495268897,0.017225765258179895,0.019115114496939017,0.021094059273417988,0.023154518056163614,0.025287668363108386,0.0274841063753367,0.029734002009103047,0.032027245235655616,0.034353580755589398,0.036702729339950675,0.039064495159678227,0.041428859197579,0.043786059370709889,0.046126658311883575,0.048441599909616884,0.050722255734200583,0.052960462428682693,0.055148551054193432,0.057279369275728693,0.059346297173862993,0.061343257378417837,0.063264720144664596,0.065105703930531611,0.066861771982161672,0.068529025392136081,0.070104093056893788,0.071584118924567258,0.072966746888630765,0.074250103642465273,0.075432779759195073,0.076513809190374177,0.077492647271152862,0.078369147155416125,0.079143534349022118,0.079816378618718056,0.080388561975817674,0.080861240613572277,0.081235797577445035,0.081513781574637831,0.081696825775050608,0.081786538947261664,0.081784360218721194,0.081691368762038044,0.081508041574635315,0.081233957077711638,0.08086745018275078,0.080405235937749939,0.079842033198290738,0.079170235173435383,0.078379687221131006,0.077457640160376873,0.076388945857798748,0.075156548223406811,0.073742296422525624,0.072128070250869036,0.070297165080616245,0.068235842225423976,0.065934917031561777,0.063391237378793458,0.060608903152406066,0.057600093350226277,0.054385399781111649,0.050993610589262724,0.04746093755941088,0.04382973231408082,0.040146782414042896,0.03646131426868409,0.032822852301755794,0.029279091308886566,0.025873931431110289,0.022645804316235592,0.019626387835197198,0.016839769046061822,0.014302075219467721,0.012021554781088862,0.0099990575092454466,0.0082288388156562149,0.0066995978534087047,0.0053956537807393458,0.0042981679501461678],[0.00034733491804393355,0.00045373102635557893,0.00058696872133482585,0.00075207336069076243,0.00095455329405451535,0.0012003408370382042,0.0014957082972206553,0.0018471597886847478,0.002261301189282272,0.0027446922095037268,0.003303686002500382,0.0039442629016834862,0.0046718655959389673,0.0054912432515759856,0.0064063117256696863,0.0074200361083947954,0.0085343404627516856,0.0097500479299060996,0.011066852502705211,0.012483321917307853,0.013996929441750126,0.015604110988099489,0.017300343032459725,0.019080236330883626,0.020937640352037747,0.022865753647127875,0.024857235951445227,0.026904318553640654,0.028998910274946058,0.031132697183321491,0.033297234863095729,0.035484032631844013,0.037684629530318724,0.039890662214819531,0.04209392507358193,0.044286422994589056,0.046460417257124638,0.048608465025669234,0.050723452909688285,0.052798625028433063,0.054827605993356926,0.056804419195849422,0.058723500766006201,0.060579709548975409,0.062368333428176576,0.064085092308096933,0.065726138051721714,0.067288051646476943,0.068767837843932478,0.070162917475903239,0.071471117582271995,0.072690659376746736,0.073820143899996069,0.074858534928364764,0.075805138272282704,0.07665957595454001,0.077421752848663372,0.078091812145828998,0.078670074521717051,0.079156954206801369,0.079552843589945382,0.079857956969082072,0.080072124283100038,0.080194527965711124,0.080223381335777375,0.080155555837000236,0.079986177047890378,0.079708224841165645,0.079312189318008305,0.078785847934211631,0.078114236587738084,0.077279884496314427,0.076263366870527052,0.07504420041261628,0.07360206715893973,0.071918307428150655,0.069977579618680785,0.067769550503318884,0.065290460370716369,0.062544406315504814,0.059544204730220013,0.056311728398918674,0.052877660173841275,0.049280658337999578,0.04556598224641091,0.041783674825528666,0.037986436064155735,0.034227345237786692,0.03055759747196013,0.027024412376557991,0.023669250579550702,0.020526441165486065,0.017622283345870033,0.014974643637814799,0.012593029751238626,0.010479088002778789,0.0086274451068489022,0.007026799153911645,0.0056611587449830521,0.0045111327672344576],[0.00025950064816834139,0.00033989311785279796,0.00044091567029765408,0.0005665540395616552,0.00072121829535670256,0.00090970853061296292,0.0011371614461065749,0.0014089777977546319,0.0017307318315890265,0.0021080650290514385,0.0025465676157087726,0.0030516522415384786,0.0036284249225736411,0.0042815586670211774,0.0050151751528120384,0.0058327393770989102,0.0067369714022858396,0.007729778255627073,0.0088122078053797376,0.0099844251546219141,0.011245710881083212,0.012594479408327596,0.014028314993344164,0.015544022296736541,0.017137688267650584,0.01880475209866667,0.020540080235575117,0.022338043800225259,0.024192596236417622,0.026097349460756088,0.0280456472468247,0.030030634961686269,0.03204532509327028,0.034082658253066479,0.036135559516970533,0.038196990089526352,0.040259994356332568,0.042317742438509796,0.044363568392278126,0.04639100421367056,0.048393809818500652,0.050365999174120629,0.052301862763928446,0.054195986568655846,0.056043267750139521,0.05783892722292909,0.059578519295440453,0.061257938553067569,0.062873424136557124,0.064421561532818084,0.065899281930195022,0.067303859077019523,0.068632903392308722,0.069884352770417671,0.071056459044900933,0.072147768370292562,0.073157092786530736,0.074083468917025747,0.074926098146401776,0.07568426086592743,0.076357195767056532,0.076943934221595511,0.077443080248903617,0.077852529338134968,0.078169125370229353,0.078388264694748591,0.078503470035143907,0.078505973271154925,0.078384362968314136,0.078124366303932338,0.077708841631219716,0.077118053472704437,0.076330283842306654,0.075322802539584496,0.07407317746209581,0.072560859682960027,0.070768934217888116,0.068685893264523706,0.066307269997874924,0.063636971028383726,0.060688164761030589,0.057483618810325023,0.054055427884089062,0.05044412838252775,0.046697251110773656,0.042867412991180603,0.03901008742919624,0.035181217399703521,0.031434843487605946,0.027820911004212016,0.024383397638386366,0.021158869080705342,0.018175528876280964,0.015452785061388396,0.013001314436800115,0.01082356950030721,0.0089146459441369376,0.0072634118096674754,0.0058537931817430784,0.0046661148369972474],[0.0001916658815802812,0.00025172105604171982,0.00032745042472357946,0.00042197546829525218,0.0005387809871104872,0.00068169793422982598,0.00085487197417029011,0.0010627173081608622,0.0013098561151873925,0.0016010448227425475,0.0019410892704232771,0.0023347515871052524,0.0027866521962624665,0.0033011707351319293,0.0038823497838857486,0.0045338051391792004,0.0052586459491213034,0.0060594073969654728,0.0069379978425015993,0.0078956614794241462,0.0089329567224279652,0.010049749770632133,0.01124522215984035,0.012517890650073185,0.013865637509226973,0.015285749140294038,0.016774961033600235,0.018329507171941612,0.019945172236441298,0.021617345217376363,0.023341073296163851,0.025111115109506952,0.026921992720548779,0.028768041798772515,0.030643459650361055,0.032542350847731064,0.034458770286874066,0.036386763560263026,0.038320404577119715,0.040253830396385276,0.042181273264171683,0.044097089869063813,0.045995787846755377,0.047872049580812794,0.049720753358980067,0.051536991953901205,0.053316088702203536,0.055053611154059059,0.056745382352035689,0.058387489765264554,0.059976291839394673,0.061508422003498063,0.062980789770733264,0.064390578236567589,0.065735236760935137,0.067012466855809083,0.068220198229829762,0.069356550539599354,0.070419774704751095,0.071408165823432665,0.072319938116687812,0.073153051496754537,0.073904980083156907,0.074572416220493348,0.07515091018959727,0.075634456420917304,0.076015051466453348,0.076282266024352494,0.076422890408805816,0.076420726342475001,0.076256603594187761,0.075908694017596798,0.0753531758166609,0.074565267801755999,0.073520610378306608,0.07219692290542036,0.070575823114439717,0.068644660589785828,0.066398198451536938,0.063839978417896251,0.060983224609290468,0.057851178393784349,0.054476805814529176,0.050901874928888036,0.047175456463805873,0.043351951534523731,0.039488789660815364,0.035643965233603601,0.031873588973184673,0.028229622702984132,0.024757942665476207,0.021496841860728436,0.018476039764290551,0.015716223022986628,0.013229097959387379,0.011017898914505027,0.0090782685493296551,0.0073994088553786062,0.0059653951169925572,0.0047565485566775654],[0.00013994112174217641,0.00018429197981499959,0.00024041415962057516,0.00031072152695664924,0.00039793195006118486,0.00050506147892724824,0.00063540813073231935,0.00079252463172632844,0.00098018001275051634,0.0012023105620367865,0.0014629612579389957,0.0017662193835304833,0.002116142513015333,0.0025166834119588945,0.0029716145772499657,0.0034844551429428967,0.0040584026978872966,0.0046962722217564912,0.0054004438844007397,0.0061728209162860937,0.0070147981960698375,0.0079272416636564196,0.0089104781939394959,0.009964295186495737,0.011087948854604745,0.012280180034533971,0.013539236273178542,0.014862898971124524,0.016248514437204979,0.017693027827395874,0.019193019075586373,0.02074474006063989,0.022344152382361742,0.023986965232262913,0.02566867294093924,0.027384591862788223,0.02912989632262181,0.030899653400177363,0.032688856370318015,0.034492456651245937,0.036305394142220122,0.038122625857429183,0.03993915278468102,0.041750044916865063,0.043550464420698286,0.045335686920524573,0.047101120883497598,0.048842325093554767,0.050555024190096866,0.052235122214393824,0.053878714037902342,0.055482094419130649,0.057041764215792747,0.058554432920438063,0.060017016132161982,0.061426625759890989,0.062780549617967529,0.064076215601519423,0.065311133873197702,0.066482808640638269,0.067588609529412216,0.068625591861649626,0.069590256160879577,0.070478240877374823,0.071283949554966586,0.072000124940651208,0.072617397592393648,0.073123853952708928,0.073504685918174703,0.073741996855528527,0.073814843573920305,0.073699586347822574,0.073370597837906976,0.07280134744823713,0.071965833934243759,0.070840291930704222,0.069405054669708352,0.06764642239304533,0.065558369129973065,0.06314392246497931,0.060416071784096081,0.057398097860573274,0.054123266134010015,0.050633881987240545,0.046979762546930329,0.043216230047447922,0.039401771478213631,0.035595534337499651,0.031854836833440994,0.028232862688274029,0.024776687513049126,0.021525748752167936,0.018510828736540943,0.015753575206667716,0.013266540440666141,0.011053682869992856,0.0091112467558523268,0.0074289178116916533,0.0059911459369676743,0.0047785296144404561],[0.00010099926789459365,0.00013337668094121359,0.00017449159673564712,0.00022618714617539252,0.00029055553978777574,0.00036993928783503669,0.00046692506109613686,0.00058432950143200765,0.00072517664834670446,0.0008926670599437148,0.0010901391439285173,0.0013210236418742163,0.0015887925920741201,0.0018969044002713645,0.0022487468477108796,0.0026475799467745114,0.0030964805123853186,0.003598290161064836,0.0041555681984648584,0.0047705505378255672,0.0054451154378150207,0.0061807564904161148,0.0069785629561947117,0.0078392072572120615,0.0087629392107770963,0.0097495864255658215,0.010798560183325282,0.011908866086719507,0.013079118755674711,0.014307559888349622,0.015592079056628568,0.016930236669639522,0.01831928860451577,0.019756212066292418,0.021237732295578935,0.02276034979236875,0.024320367767130594,0.025913919566942768,0.027536995855927213,0.029185471356657517,0.030855130983444314,0.032541695220109731,0.034240844614458588,0.035948243279276773,0.037659561305110785,0.039370496002562337,0.041076791899742553,0.042774259420758687,0.04445879215805093,0.046126382615454951,0.047773136224361377,0.049395283297959509,0.050989188352744935,0.052551355843852836,0.054078430771341966,0.055567191753551355,0.057014532977672214,0.058417429913501025,0.059772881884187799,0.06107782273627807,0.062328989343435594,0.063522737147181013,0.064654793231769273,0.065719941508404905,0.066711642299073809,0.067621600377470961,0.068439310932161587,0.069151630396202146,0.0697424358026075,0.07019244844141187,0.070479300982625462,0.070577918508139381,0.070461261525537208,0.070101444095931373,0.0694711965288307,0.068545595665603129,0.067303943558374144,0.065731643926112443,0.063821910110926999,0.061577140988263085,0.059009822434708349,0.05614284916494041,0.053009210758798421,0.049651041012580339,0.046118085334173477,0.042465690893674482,0.038752463578353304,0.035037760755648469,0.031379197395483595,0.027830335086147209,0.024438700544572724,0.021244245545801305,0.018278318018625225,0.015563169114873661,0.013111978002826839,0.010929338972033109,0.0090121271356364482,0.0073506412658554147,0.0059299154594670573,0.0047310945624271022],[7.2051324126746037e-05,9.5415134786634321e-05,0.000125188675849739,0.00016276151997325001,0.0002097233707733572,0.00026786923990456296,0.00033919957361457472,0.00042591468355094523,0.00053040306025010236,0.00065522341808514671,0.00080308061911045405,0.0009767959278549781,0.0011792723356273973,0.0014134559382215012,0.0016822945355935948,0.0019886947325527364,0.0023354788495782439,0.0027253429042930844,0.0031608168059998097,0.0036442277330535982,0.0041776674544587245,0.004762964132912253,0.0054016589253740943,0.0060949874947389031,0.0068438663734902176,0.0076488839835538976,0.0085102960174706036,0.0094280248221637521,0.010401662393003802,0.011430476576164523,0.012513420084751748,0.013649141952749543,0.014836001075461683,0.016072081512114537,0.017355209253185188,0.018682970180435177,0.020052728970968728,0.021461648717808233,0.022906711058688689,0.024384736622323606,0.02589240561759017,0.027426278406149356,0.028982815913050304,0.030558399742774342,0.032149351879544777,0.033751953859638681,0.035362465308045217,0.036977141728700598,0.038592251420635701,0.04020409135142762,0.041809001737737182,0.043403378934911134,0.044983685986688109,0.046546459782291945,0.048088313151007277,0.04960592932998964,0.051096045020153524,0.052555416692731838,0.053980763009820763,0.055368674404210602,0.05671547945292036,0.058017057328534898,0.059268587178185159,0.060464229703409339,0.06159674429295435,0.06265705711389298,0.063633811056932013,0.064512945667478297,0.065277371269253551,0.065906812602021511,0.066377899489961117,0.06666457223656827,0.06673884639496698,0.066571946627277612,0.066135776465328505,0.06540464577639496,0.064357137280153742,0.062977963733312547,0.061259653011085879,0.059203901658943008,0.056822458527803633,0.054137436566615904,0.051180998662120863,0.047994417322234681,0.044626562191611249,0.041131918184646579,0.037568275488602774,0.033994257167048209,0.030466858567574653,0.027039165014588116,0.023758391924986608,0.020664357601239688,0.01778845766914949,0.015153166073674021,0.012772045279765734,0.010650211788084379,0.008785175192599845,0.0071679514514071058,0.0057843441845768419,0.0046162908442069876],[5.0803717741137142e-05,6.7467761498513629e-05,8.8778590295796479e-05,0.00011577058514608516,0.00014963599494277052,0.00019173195413852215,0.00024358415740628471,0.00030688663520863382,0.00038349720706674489,0.00047542835938239262,0.00058483349121246696,0.00071398868056791228,0.00086527032997436328,0.0010411292374516629,0.0012440617936467365,0.0014765791167022566,0.0017411749970452663,0.0020402935330657169,0.0023762972989220948,0.0027514368049187375,0.0031678218994726022,0.0036273956315458203,0.0041319109554691161,0.0046829105268968874,0.0052817097175164055,0.0059293828726103039,0.0066267527523621878,0.0073743830351476582,0.0081725737173269624,0.0090213592164161086,0.0099205089695902846,0.010869530313908552,0.01186767343546774,0.012913938179507064,0.014007082520541676,0.015145632499732997,0.016327893445210111,0.017551962299579227,0.018815740887257824,0.02011694996251847,0.021453143887238638,0.02282172579532005,0.024219963108477138,0.025645003275361147,0.027093889612248779,0.02856357712772261,0.030050948213887669,0.031552828079037275,0.033065999774879437,0.034587218624673885,0.03611322576961086,0.037640760393133459,0.039166569918929035,0.040687417057855543,0.042200081941991485,0.043701356668845739,0.045188028341230535,0.046656845132540606,0.048104458130588723,0.049527329960160668,0.050921599896565181,0.05228289502150426,0.05360607878561139,0.05488493303469949,0.056111777856641253,0.057277045730486809,0.058368841758690573,0.059372538459113181,0.060270468770590432,0.061041790893813203,0.061662599627240827,0.062106348195692745,0.062344621316757678,0.062348265946168824,0.062088844702913773,0.061540334021551263,0.060680950867096628,0.05949496409570644,0.057974333479199412,0.056120023192795493,0.053942857116706919,0.05146381847520673,0.048713742305263867,0.045732401037687755,0.042567035571368497,0.039270431194720998,0.035898674811613851,0.032508753615800912,0.029156163654019178,0.025892689400196373,0.022764494019397456,0.019810627376250025,0.017062019015672284,0.014540980785567108,0.012261202883102633,0.010228191705921538,0.0084400708173977979,0.0068886492238996993,0.0055606543869404761,0.0044390301864343836],[3.5404473277972411e-05,4.7151472735841131e-05,6.2227347153739958e-05,8.1392329591476964e-05,0.00010552901777259824,0.00013564985663345704,0.00017290250332235513,0.00021857262264945369,0.00027408373439026691,0.00034099383542426595,0.00042098864358879788,0.00051587144813894099,0.00062754969404487846,0.0007580185636882668,0.00090934194004765878,0.0010836312320058759,0.0012830226092353022,0.0015096532284510384,0.0017656370349804034,0.0020530406966978165,0.0023738601767274575,0.0027299983835979164,0.003123244259881175,0.0035552535895255906,0.0040275317258282707,0.0045414183705737333,0.0050980744729909062,0.00569847126604975,0.0063433814171922264,0.0070333722399438508,0.0077688008905363879,0.008549811458050182,0.0093763338460712466,0.010248084337075553,0.011164567726607047,0.012125080911997665,0.013128717819335698,0.014174375552267332,0.015260761646801523,0.01638640231744987,0.01754965158167696,0.01874870115166212,0.019981590984613173,0.021246220385016702,0.022540359553653966,0.023861661477808892,0.025207674052710231,0.026575852312038756,0.02796357061861934,0.029368134614078049,0.030786792630573032,0.032216746101973136,0.033655158238157068,0.035099159794725061,0.036545850122765434,0.037992290761346352,0.039435487600784518,0.040872356110598432,0.042299662401233284,0.043713931229370062,0.045111310911968447,0.046487385142184888,0.047836923723947988,0.049153569114899966,0.050429464035225705,0.051654837378667336,0.052817580507202394,0.053902861899394361,0.05489284219001335,0.055766560371717573,0.056500061901255831,0.057066828240658514,0.057438544375199296,0.05758620775860037,0.057481542759026193,0.057098644313012731,0.056415738916822014,0.055416925515542934,0.054093747116683563,0.052446447996090759,0.050484791084571989,0.048228343532310876,0.045706181996733042,0.042956018252500186,0.040022795107280518,0.03695684719969141,0.033811756551503293,0.030642055356999719,0.027500936511150195,0.024438125558379722,0.021498047468914105,0.018718390698438489,0.016129133128447836,0.013752053969461659,0.011600716729526525,0.0096808745498980272,0.0079912233064560276,0.0065244114399630893,0.0052682088834957097,0.004206739983972506],[2.4384263478539814e-05,3.2568135539973244e-05,4.3108400494902454e-05,5.6556720297513141e-05,7.3558017997130509e-05,9.4857596071464218e-05,0.00012130698837997011,0.00015386819538243225,0.00019361598844712882,0.00024173802566814675,0.00029953259571016016,0.00036840389320831059,0.00044985482331515912,0.0005454774275770205,0.00065694111191966361,0.00078597893430374884,0.00093437227003013372,0.0011039342138813146,0.001296492099294679,0.0015138695163983301,0.0017578681953484172,0.0020302500924218835,0.0023327199777443686,0.00266690877943399,0.0030343578930101512,0.0034365046201684634,0.003874668859639936,0.0043500411361648986,0.0048636720221902109,0.0054164629807165413,0.0060091586363492377,0.0066423404643863107,0.0073164218739831212,0.0080316446503715371,0.0087880767121859202,0.009585611132684314,0.010423966367698061,0.011302687628244875,0.012221149331726616,0.013178558562378333,0.014173959469035578,0.015206238526223277,0.016274130582856122,0.017376225621145616,0.018510976145999815,0.01967670512108758,0.020871614359617003,0.02209379326180225,0.023341227760156413,0.024611809276873588,0.025903343396841881,0.027213557788600382,0.028540108626397061,0.029880584330970766,0.031232504798729178,0.032593313374939717,0.033960357614636678,0.035330853386865847,0.036701825231747226,0.038070014338708144,0.039431744526349261,0.040782736812013873,0.042117865346895024,0.043430852448541842,0.044713908743176954,0.045957336054900516,0.047149124831793836,0.04827459275467285,0.049316123975884654,0.050253075903638568,0.051061919487604981,0.0517166675049417,0.052189623062007161,0.05245244915793161,0.05247752334062035,0.052239504120641093,0.051717003147621989,0.050894233896368608,0.049762497182779732,0.048321367963209828,0.046579466468922456,0.044554727976694179,0.042274126173862059,0.03977285087776293,0.037092987028055843,0.034281783614847586,0.031389634317917074,0.028467912921096936,0.025566814215545314,0.022733344853779182,0.020009589731649274,0.017431350541265239,0.015027217675579539,0.012818098656501426,0.010817189638482345,0.0090303447358159507,0.0074567734974806217,0.0060899812968292152,0.0049188610792646852,0.0039288471590060289],[1.6597022467937772e-05,2.2231483480588573e-05,2.951402309434592e-05,3.8839873966630577e-05,5.0674199334892711e-05,6.5558405161402094e-05,8.4115755549361401e-05,0.00010705603096746927,0.00013517898299601018,0.00016937636767149497,0.00021063238083425447,0.00026002237079790258,0.00031870976283993952,0.00038794119251918754,0.00046903990650430411,0.00056339754650751176,0.00067246448072197991,0.00079773888542808554,0.0009407548058098143,0.0011030694392633262,0.0012862498873430855,0.0014918596155236556,0.0017214448452134992,0.0019765210822110424,0.0022585599622574099,0.0025689765694656775,0.0029091173587479408,0.0032802487900269253,0.0036835467606835012,0.0041200869036629659,0.0045908358019703752,0.005096643155774132,0.0056382349257561833,0.0062162074654122188,0.0068310226454475964,0.007483003965002029,0.0081723336369853173,0.0088990506281770923,0.0096630496288337506,0.010464080921272366,0.011301751112186618,0.012175524689190316,0.013084726358103867,0.014028544113470433,0.015006032990075049,0.016016119436638353,0.017057606242141039,0.018129177926430932,0.019229406473047713,0.020356757222335337,0.021509594639285617,0.022686187497020747,0.023884712737057851,0.025103256835101197,0.026339812863453004,0.027592270549663081,0.028858395460823437,0.030135792023414782,0.031421843544556467,0.032713620996595034,0.034007751502248461,0.035300237827370677,0.036586222486834262,0.037859695008509164,0.039113148944759354,0.040337206302964772,0.041520240325057058,0.042648041194397676,0.043703580686415541,0.044666938005563421,0.045515447326248272,0.046224116153655181,0.046766342431099353,0.047114929090314381,0.04724336086475471,0.047127274111418843,0.046746020817452452,0.046084207078472987,0.04513307716215037,0.043891618348225699,0.042367278980184137,0.040576220951789803,0.038543065260220943,0.036300131417196006,0.033886214047195121,0.03134497853470497,0.028723088214996792,0.026068195370918142,0.023426935498775635,0.020843058668958477,0.018355814478260395,0.015998680438650301,0.013798490914057769,0.011774988578694686,0.0099407864683632215,0.008301699207019583,0.006857379296300677,0.0056021798458819874,0.0045261591479779217,0.0036161444613868783],[1.1163499630587484e-05,1.499690487001082e-05,1.9969153826398154e-05,2.6359809548833527e-05,3.4500047047676483e-05,4.4777978188794378e-05,5.7643644611515055e-05,7.3613492459011099e-05,9.3274144874736897e-05,0.00011728529984307153,0.00014638160170854156,0.00018137336351007873,0.00022314605236054905,0.00027265848923463848,0.00033093975517753177,0.00039908483557664137,0.00047824907044858634,0.00056964150982732756,0.00067451729802591278,0.00079416922815833874,0.00092991861884800166,0.0010831056690454228,0.0012550794452523386,0.0014471876493531736,0.0016607663059105332,0.0018971294963481032,0.0021575592549234182,0.0024432957285738027,0.0027555276901660981,0.0030953834827503776,0.0034639224612945233,0.0038621269881176277,0.0042908950288215722,0.0047510333868728298,0.0052432516070259451,0.0057681565704236675,0.0063262477973861858,0.0069179134675569007,0.0075434271611615243,0.0082029453196209093,0.0088965054185882308,0.0096240248415777486,0.010385300437556323,0.011180008740865586,0.012007706826005568,0.012867833761945219,0.013759712618519888,0.014682552957193279,0.015635453703272389,0.016617406235559847,0.017627297425271769,0.018663912183625168,0.01972593480214101,0.02081194794774394,0.021920427557658554,0.023049731023982663,0.024198074946507497,0.025363497400913541,0.026543798246343942,0.02773644974261797,0.028938469085124111,0.030146244973510691,0.031355312682335851,0.032560076928223519,0.03375348950164489,0.034926699011097503,0.03606870229336058,0.037166039365701439,0.038202583830896628,0.03915948569897184,0.040015321283009865,0.04074649375509664,0.041327908175039049,0.041733918023748366,0.041939509587670447,0.041921659921001816,0.041660777706846217,0.041142117808269069,0.040357052307376573,0.039304084728911184,0.037989509869245507,0.036427647774221139,0.034640614331656112,0.032657629201120739,0.030513900453106937,0.028249160359770115,0.025905954722216885,0.023527806220538263,0.021157378959004804,0.0188347663786048,0.01659600904419116,0.01447192462309768,0.012487302599091123,0.010660484255002245,0.0090033175287771872,0.0075214494029984327,0.0062148977080948185,0.0050788308835532205,0.0041044786812079832,0.0032800984754366323],[7.419954215013426e-06,9.9970693553993153e-06,1.3351654357524627e-05,1.7678939724383353e-05,2.3211662718579516e-05,3.0224388896099034e-05,3.90377224072179e-05,5.0022276991453255e-05,6.3602275992929511e-05,8.025865216132702e-05,0.00010053152657675348,0.0001250219603608518,0.0001543928920781738,0.00018936919668947238,0.00023073682714374561,0.00027934102564086748,0.00033608361676638204,0.00040191941778852837,0.00047785182140178231,0.00056492762244124634,0.00066423117228413936,0.00077687795284010742,0.00090400766652479105,0.0010467769399137281,0.0012063517374900541,0.001383899578654564,0.0015805816465431948,0.0017975448716937698,0.0020359140676151836,0.0022967841891259268,0.0025812127781372775,0.0028902126554745909,0.0032247449114172506,0.0035857122419162314,0.0039739526719200233,0.0043902337018979524,0.0048352469084859493,0.0053096030251858148,0.0058138275242182848,0.0063483567159510956,0.006913534377769608,0.0075096089197657975,0.0081367310900478697,0.0087949522175153842,0.0094842229839937238,0.010204392709505716,0.010955209122012864,0.011736318562342904,0.012547266539704709,0.013387498492561281,0.014256360507286198,0.0151530995790476,0.016076862733216284,0.017026693920880947,0.018001527014895879,0.019000172426247807,0.020021293822679781,0.021063370203688776,0.022124637297372813,0.023203001147642285,0.024295916253403292,0.025400221238860137,0.026511927382572912,0.027625959957948771,0.028735859526248519,0.029833459875571466,0.030908570343158755,0.031948701192203471,0.032938879360037421,0.033861605878812935,0.034697003568254191,0.035423193096568405,0.036016917389562746,0.036454410236465784,0.036712477573410965,0.036769732807626083,0.036607904282618425,0.036213116748429065,0.035577041801797181,0.034697815885223665,0.033580638539451618,0.032237986954343517,0.030689413180716302,0.028960924587911319,0.027083982773295975,0.025094187599498573,0.023029738166725509,0.020929778871132957,0.018832744823540803,0.016774816540322594,0.014788579867477537,0.01290196546474208,0.011137515491627307,0.0095119964012669884,0.0080363489434457439,0.0067159422174261473,0.0055510798661636794,0.0045376944257927015,0.003668160746802502,0.0029321608156794255],[4.8732001596119267e-06,6.5850999487684352e-06,8.8213416686804145e-06,1.17165269878548e-05,1.5432103378537471e-05,2.0159761203704474e-05,2.6124842946326374e-05,3.3589679987167017e-05,4.2856766638764073e-05,5.4271679119536766e-05,6.8225649055402677e-05,8.515770688979282e-05,0.00010555631994125927,0.00012996046219050344,0.0001589600674306807,0.00019319583328696957,0.00023335835988841434,0.00028018662280072189,0.00033446579447638511,0.0003970244413997284,0.00046873113495154712,0.00055049052264123167,0.00064323891277785652,0.0007479394300351726,0.00086557680195821366,0.0009971518375559321,0.0011436756590260256,0.0013061637466441082,0.0014856298551586507,0.001683079857857395,0.0018995055719545479,0.0021358786161940028,0.0023931443486422065,0.002672215929601025,0.0029739685514367123,0.003299233873916437,0.0036487947003850567,0.0040233799268141893,0.0044236597924226127,0.0048502414572024997,0.0053036649282736867,0.0057843993534729696,0.0062928396968326573,0.006829303806320847,0.007394029878814927,0.0079871743196247187,0.0086088099818829519,0.0092589247510876539,0.0099374204057763923,0.01064411162666341,0.011378724928136262,0.012140897125466324,0.012930172698420197,0.013745999030442298,0.01458771795326836,0.015454551278580936,0.016345577045222395,0.017259692097365626,0.018195555462847453,0.019151506061115667,0.02012544790598228,0.021114696663960115,0.022115783719967096,0.023124218250266514,0.024134214416508471,0.025138399433576774,0.02612752808590451,0.027090238803556169,0.028012893725047366,0.028879548217605439,0.029672092406325231,0.030370597516976294,0.030953883536008881,0.031400303300540625,0.031688714093519331,0.031799584145276054,0.031716161222195956,0.031425616430044337,0.03092007045874736,0.03019741277960996,0.029261836756485721,0.028124034195301809,0.026801019561903575,0.025315584275986736,0.023695412063345318,0.021971914188865273,0.020178865677245264,0.018350938177876527,0.016522230660062545,0.014724895381162778,0.012987944330157356,0.01133630228476719,0.0097901490524995236,0.0083645680460230562,0.0070694937119657325,0.0059099288068209061,0.0048863858439764287,0.0039954962578048038,0.0032307262273496978,0.0025831392657260578],[3.1624331173179323e-06,4.2859968272970093e-06,5.7588911431008602e-06,7.6727343286815331e-06,1.013807508925812e-05,1.3286990579637237e-05,1.7275757002699979e-05,2.2287539374471649e-05,2.8535041207604732e-05,3.6263051153077672e-05,4.5750822313806804e-05,5.7314221110537615e-05,7.1307586170629749e-05,8.8125243488371447e-05,0.00010820263169589045,0.00013201700021243424,0.00016008765278264773,0.00019297571894744562,0.00023128344583524572,0.00027565301191761316,0.00032676487274394586,0.00038533565596527987,0.00045211562909096048,0.00052788576839451519,0.00061345446126323544,0.00070965387717924577,0.00081733604455877821,0.00093736867199490682,0.0010706307531717543,0.0012180079949529587,0.0013803881079821208,0.0015586559986369413,0.0017536889004041386,0.0019663514817280497,0.0021974909661620062,0.0024479322992411292,0.0027184733949174688,0.0030098804926686359,0.0033228836545206942,0.0036581724292174059,0.0040163917086057021,0.0043981377989380684,0.0048039547270855758,0.0052343307983289331,0.0056896954178810768,0.0061704161815070314,0.0066767962295555799,0.0072090718399093288,0.0077674102029294881,0.0083519072660126568,0.0089625854425837426,0.009599390829733042,0.010262189343028418,0.010950760823491975,0.011664789666419255,0.012403849839168446,0.01316738129437557,0.013954653793041807,0.014764713150643659,0.015596304131733034,0.016447763980056786,0.01731688131295641,0.018200717294534919,0.019095390013375915,0.019995828968539724,0.020895514245808926,0.021786223553383426,0.022657818463752918,0.023498107289091536,0.02429282426150646,0.025025761710399563,0.025679083074693035,0.026233830176516842,0.026670619525742126,0.026970501628753647,0.027115936899325142,0.027091824426235405,0.026886507836055694,0.026492677488737067,0.025908091149800614,0.025136046098716804,0.024185553473667666,0.023071188838093844,0.021812619186767645,0.020433833226717536,0.018962126048840018,0.017426908786437816,0.015858426626290955,0.014286473461266427,0.012739188313775549,0.011242008079417831,0.0098168345866488874,0.0084814534578544851,0.0072492200989472608,0.0061290066428653289,0.0051253848527328758,0.004239005386097775,0.0034671243443118761,0.0028042239360600838,0.0022426750232442815],[2.0277054626334191e-06,2.7562767431131647e-06,3.7147433369446004e-06,4.9646706214813122e-06,6.5807778771821966e-06,8.6528772178420139e-06,1.128790711763654e-05,1.4612028550593156e-05,1.8772746723259123e-05,2.3941017474772151e-05,3.0313294875127692e-05,3.8113475516628019e-05,4.7594695507684552e-05,5.9040938181839817e-05,7.276841387456028e-05,8.9126677568408512e-05,0.00010849945548713819,0.00013130515753358391,0.0001579970585234793,0.00018906313720482641,0.00022502556785267507,0.00026643986462876609,0.00031389368378687314,0.00036800529313161471,0.00042942172188741669,0.00049881660732338658,0.00057688775714781167,0.00066435444888209916,0.0007619544892001162,0.00087044105762411502,0.00099057936004592288,0.0011231431183278114,0.0012689109227606887,0.0014286624744411346,0.0016031747446921575,0.0017932180785105419,0.0019995522686893723,0.0022229226267476338,0.0024640560761064229,0.002723657292081059,0.0030024049121914996,0.0033009478389745515,0.0036199016557815623,0.0039598451736929498,0.0043213171241346009,0.0047048130060140976,0.0051107820863397161,0.0055396245360863315,0.0059916886530986067,0.0064672680724299743,0.0069665987786647647,0.0074898555959628157,0.0080371476154970662,0.0086085116978343364,0.0092039027306936791,0.0098231787102082222,0.010466077949549629,0.011132184849706144,0.011820879808218462,0.012531268196295769,0.013262083202625884,0.014011558099694892,0.014777265529421256,0.015555925037177936,0.016343185391521887,0.017133394934763891,0.01791938059098655,0.018692263053027913,0.019441340635391983,0.020154075867153284,0.020816215991595763,0.021412070658258803,0.021924957572134359,0.022337810849222699,0.022633929103058791,0.022797822995682868,0.022816107307199851,0.022678372428186006,0.022377965979952945,0.021912617782320037,0.021284850637147388,0.020502134646755637,0.019576762625516345,0.018525446640274452,0.017368658558494142,0.016129758358042839,0.014833970739696799,0.013507281631520913,0.012175330495462879,0.010862371723649461,0.0095903694023385232,0.008378275558910497,0.0072415244185053641,0.0061917561639539907,0.0052367651969645141,0.0043806516849320418,0.0036241425699212065,0.002965040004993568,0.0023987515947226892,0.0019188575588124713],[1.2845398768622774e-06,1.7512875721502282e-06,2.3674785346679287e-06,3.173954855287507e-06,4.220566780381048e-06,5.5675879161341375e-06,7.2872253040447468e-06,9.4652065085710941e-06,1.2202421913822821e-05,1.5616597022732939e-05,1.9843966867806388e-05,2.5040922810230887e-05,3.1385601101091847e-05,3.9079382621926801e-05,4.8348274171094057e-05,5.9444143426107507e-05,7.2645782160349313e-05,8.8259775271550242e-05,0.00010662115652643284,0.00012809383548327875,0.00015307078368041906,0.00018197397175590143,0.00021525405260129881,0.00025338978888754602,0.0002968872262943149,0.00034627861650846222,0.00040212109652828436,0.00046499513302538211,0.00053550274248709208,0.00061426549960400423,0.00070192234789322227,0.00079912722787141993,0.00090654653922318384,0.001024856454358356,0.001154740101524408,0.001296884636242016,0.0014519782202689004,0.0016207069275714283,0.0018037515968954924,0.0020017846504699044,0.0022154668981233545,0.0024454443455922733,0.0026923450249150866,0.0029567758632889768,0.0032393196040988183,0.0035405317890579019,0.0038609378018003454,0.0042010299578478256,0.0045612645986896575,0.0049420591009488512,0.0053437886335625578,0.0057667823701550019,0.006211318669003243,0.006677618444363943,0.0071658355462259965,0.0076760424253135692,0.0082082086927779511,0.008762169435582964,0.0093375794250216016,0.0099338488394647116,0.010550056076018846,0.011184833971868639,0.011836227622622713,0.012501525213967165,0.013177067914373283,0.013858050637134384,0.014538331719216339,0.015210275281785927,0.015864654021832649,0.016490641250907209,0.017075918263037851,0.017606916236837813,0.018069201182326119,0.01844799690982124,0.018728826113290329,0.018898235190804615,0.01894455616338786,0.018858650584422834,0.018634576838559871,0.018270124358898288,0.017767166077092493,0.017131793266733267,0.016374213671940172,0.015508412797743605,0.014551597563372697,0.013523459210899565,0.012445306621721965,0.011339130615953579,0.01022666354801546,0.00912849637060076,0.0080633077805982722,0.0070472481212669729,0.0060935058522457479,0.005212068289395958,0.0044096726390085769,0.003689929586619357,0.0030535909756791435,0.0024989261012282179,0.0020221680465111716,0.001617992063759175],[8.0395679038284048e-07,1.099356164638125e-06,1.4907083085932723e-06,2.004761166357933e-06,2.6743436181032639e-06,3.5393773218576761e-06,4.6479728497426136e-06,6.0576011338491844e-06,7.8363283604049565e-06,1.0064099786342836e-05,1.2834055624387399e-05,1.6253860255243286e-05,2.0447024654177902e-05,2.5554201107265392e-05,3.1734429048878488e-05,3.9166311153941003e-05,4.8049099616395421e-05,5.8603673769832266e-05,7.1073391775860711e-05,8.5724800935074442e-05,0.00010284819318167613,0.00012275799443130816,0.00014579297859915855,0.00017231629924158924,0.00020271533386169454,0.00023740133793100914,0.00027680890759896302,0.00032139525187851846,0.00037163927680532042,0.00042804048566616281,0.00049111770087961672,0.00056140761448678393,0.00063946317547301627,0.00072585182329131383,0.00082115357799432507,0.00092595899830306093,0.0010408670197452439,0.0011664826856816498,0.0013034147845995053,0.00145227340747549,0.0016136674392699976,0.0017882019986504461,0.0019764758397325792,0.0021790787287307013,0.0023965888064487787,0.0026295699436467324,0.0028785690889095348,0.0031441135950323164,0.0034267084856749626,0.0037268335821796332,0.0040449403406659376,0.0043814481374705493,0.0047367395682899474,0.0051111540719860505,0.0055049788340760936,0.0059184354560884202,0.0063516603038289076,0.0068046758139951825,0.007277349440180457,0.00776933651649958,0.0082800033359214688,0.0088083274523540374,0.0093527738882110707,0.0099111487477622478,0.010480435707563294,0.011056625718866292,0.011634555443443079,0.012207774607809582,0.012768465603679039,0.013307439332166311,0.013814228799733614,0.014277296087317475,0.014684359331776895,0.015022835099723615,0.015280379215381208,0.015445497162715116,0.015508185074790654,0.015460555343136411,0.015297398001916341,0.015016630808894855,0.014619597398890894,0.014111183546785077,0.01349973548466718,0.012796780022768715,0.012016562337994204,0.011175432072719144,0.010291120326595992,0.009381958045400535,0.0084660894981201957,0.0075607328147585624,0.0066815333098979544,0.0058420453996252215,0.0050533665439765982,0.0043239332111077618,0.0036594757649365561,0.0030631176638560766,0.0025355953683023837,0.0020755694582854328,0.0016799948287327623,0.0013445182629164753],[4.9710008524263869e-07,6.8178707659709205e-07,9.2732350447319075e-07,1.2510026724901792e-06,1.6741647107985165e-06,2.2229061135714969e-06,2.9288588355906203e-06,3.830035230870532e-06,4.9717331397379912e-06,6.4074934981840272e-06,8.2001010355834483e-06,1.0422617017313752e-05,1.3159431637933963e-05,1.6507322622438709e-05,2.0576505873245729e-05,2.549166361597474e-05,3.1392935437693526e-05,3.8436857853041671e-05,4.6797238542135541e-05,5.6665952138892408e-05,6.8253645366627203e-05,8.1790340377750035e-05,9.7525926317889959e-05,0.0001157305303685309,0.00013669476079859586,0.00016072981585217287,0.00018816745359942236,0.0002193598191673314,0.00025467912703609584,0.00029451719732738512,0.00033928484621585653,0.0003894111317591594,0.00044534245755901373,0.0005075415377316458,0.00057648622767514791,0.00065266822606925221,0.0007365916544246181,0.00082877152130784472,0.00092973207909651369,0.0010400050817506612,0.0011601279525946587,0.0012906418714292197,0.001432089790322348,0.0015850143869351127,0.0017499559627935288,0.0019274502907296487,0.002118026409377432,0.002322204350723593,0.0025404927653656043,0.0027733863732293876,0.0030213631060924564,0.0032848807100151617,0.0035643724251071761,0.0038602411394510899,0.0041728511075434065,0.004502515923370665,0.0048494809541593251,0.0052138979135289152,0.0055957887669714447,0.0059949958567137446,0.0064111151981278156,0.0068434105601212682,0.0072907074113923572,0.0077512682306721198,0.0082226540252752257,0.0087015809398718492,0.0091837850782590432,0.0096639124036183542,0.010135453020083127,0.010590739518043039,0.011021026862935048,0.011416666362143916,0.011767378824209885,0.012062622800349296,0.012292043751017945,0.012445980260944876,0.012515995203827054,0.012495394075876109,0.012379690369906502,0.012166979299013725,0.011858186446694655,0.011457166639356527,0.010970639730663546,0.010407962956435481,0.0097807527634245269,0.0091023811841871496,0.0083873816844084459,0.0076508059726285273,0.0069075759401468666,0.0061718735423743915,0.0054566063456015154,0.0047729783459806666,0.0041301855138337461,0.0035352444741658098,0.0029929519571202201,0.0025059631611211853,0.0020749697464237321,0.0016989532895680707,0.0013754878239824382,0.0011010654098074606],[3.0364421165616684e-07,4.1770728856370483e-07,5.6988196567471706e-07,7.7120559163657181e-07,1.0353708327887384e-06,1.379214124221896e-06,1.8232585974407708e-06,2.3923106693192556e-06,3.116108192247477e-06,4.0300167500399032e-06,5.1757693875093036e-06,6.6022438312646804e-06,8.3662701381391622e-06,1.0533460731166198e-05,1.3179053977471217e-05,1.638876184408191e-05,2.0259611742858308e-05,2.4900772441984127e-05,3.0434353868936717e-05,3.6996170743412901e-05,4.4736460239872451e-05,5.3820544268255996e-05,6.4429427458205228e-05,7.676032251812007e-05,9.1027095298833896e-05,0.00010746062260792347,0.00012630905658214141,0.00014783799022147895,0.00017233051950979778,0.00020008719838582629,0.00023142588367747259,0.00026668146796529906,0.00030620549919148273,0.00035036568667269098,0.00039954529400330549,0.00045414242014349339,0.00051456917076872456,0.00058125072270638547,0.00065462428499162505,0.00073513796072317275,0.00082324951446275415,0.000919425050345186,0.0010241376062448953,0.001137865669074924,0.0012610916151920477,0.001394300077244216,0.0015379762333862183,0.0016926040045095361,0.0018586641265847408,0.0020366320331555018,0.0022269754298062071,0.0024301513576327266,0.0026466024133759408,0.0028767516056344201,0.0031209950669550657,0.0033796915054583724,0.0036531468775127837,0.0039415923315508361,0.0042451530859965586,0.0045638056787583861,0.0048973211203351755,0.0052451920790062018,0.0056065434925433796,0.0059800280354177626,0.0063637106420336301,0.0067549495827014987,0.0071502850004759805,0.0075453487730081084,0.007934811422685803,0.0083123819761270566,0.008670874775780435,0.0090023531674830876,0.009298353956871357,0.0095501890845880715,0.0097493128928010809,0.0098877355533394141,0.0099584566270111367,0.009955888156071329,0.0098762347967938161,0.0097177996457135547,0.0094811886476704917,0.0091693935003209215,0.0087877421690765456,0.0083437166158001324,0.0078466480743294882,0.007307310081788144,0.006737437490300497,0.0061492050440050215,0.005554701323245927,0.0049654328053123946,0.0043918887097751701,0.0038431907501923616,0.0033268437050403979,0.0028485937784435509,0.0024123929810416409,0.0020204600524637664,0.0016734224040947389,0.0013705195697804292,0.0011098468329838534,0.00088861792592491939],[1.8322327546477271e-07,2.5280884257131216e-07,3.459689787286059e-07,4.6965784781832002e-07,6.3254759135622937e-07,8.4535868050413529e-07,1.12123123964611e-06,1.4761379524217887e-06,1.9293383722426624e-06,2.5038736159679363e-06,3.2270995494630402e-06,4.1312557059447283e-06,5.2540663400440276e-06,6.639369237392413e-06,8.3377671922243846e-06,1.0407296450073981e-05,1.29141058999811e-05,1.5933140396485011e-05,1.954882129728732e-05,2.3855717115285493e-05,2.8959197098385574e-05,3.497606055991554e-05,4.203513487840597e-05,5.0277835259492498e-05,5.9858679596425747e-05,7.09457520713286e-05,8.3721109499715793e-05,9.838112482930834e-05,0.00011513676265480605,0.00013421378209744233,0.00015585286291655841,0.00018030965126505054,0.00020785472206642376,0.00023877345557344571,0.00027336582626215095,0.00031194610281512611,0.0003548424585492053,0.00040239649223837648,0.00045496265986405196,0.00051290761837762618,0.00057660948305900464,0.0006464570004509917,0.0007228486390489611,0.0008061915997479947,0.00089690074715816006,0.00099539746068063803,0.0011021083996212101,0.001217464167800029,0.0013418978471963067,0.0014758433427005855,0.0016197334346142866,0.0017739973634795061,0.0019390576624863998,0.002115325794622883,0.002303195935313146,0.0025030359635379736,0.0027151743958226632,0.0029398816504652343,0.0031773437266253974,0.0034276262219950686,0.0036906267228512483,0.0039660141259242601,0.0042531545214342633,0.0045510249495852749,0.0048581185994801641,0.0051723476659768369,0.0054909527801884697,0.0058104302275623085,0.0061264895627843458,0.0064340542764976943,0.0067273165722981877,0.0069998540077743886,0.00724481092995024,0.0074551417196533302,0.0076239064580613707,0.0077446034511783153,0.0078115178189447059,0.0078200617302158944,0.007767080351550249,0.0076510984751944908,0.0074724861442513864,0.0072335271729389071,0.0069383817802700668,0.0065929429170439695,0.0062045944333659394,0.0057818871334631636,0.0053341551907524999,0.0048710997104625077,0.0044023680356110959,0.0039371565894420098,0.0034838618215823408,0.0030497986231952613,0.0026409990368731684,0.0022620969512212549,0.0019162974854389462,0.0016054235994444606,0.0013300276192869291,0.0010895521563198992,0.00088252342047904554,0.00070676008499118972],[1.0921330944713331e-07,1.5114500225408011e-07,2.0747798232711572e-07,2.8253751336794224e-07,3.8174496689409123e-07,5.1183745945736058e-07,6.8111729319802304e-07,8.997323708122426e-07,1.1799883020627108e-06,1.5366924109934951e-06,1.9875293055326985e-06,2.5534671001841821e-06,3.2591928044850003e-06,4.1335748207663592e-06,5.2101499490344219e-06,6.5276317869641241e-06,8.1304369490987888e-06,1.0069225118786119e-05,1.2401448594044242e-05,1.5191906697052373e-05,1.8513300187018367e-05,2.2446780647036131e-05,2.708248970541035e-05,3.2520082898318872e-05,3.8869232980747728e-05,4.6250107543353711e-05,5.4793815891222627e-05,6.4642820283375779e-05,7.5951306816341409e-05,8.8885511458201109e-05,0.00010362399699827712,0.000120357876969044,0.00013929098291787004,0.00016063997175361946,0.000184634370263683,0.00021151655428701784,0.00024154166043423587,0.00027497742866148958,0.00031210397442355242,0.00035321348954081994,0.00039860987129280772,0.00044860827955462866,0.00050353462194094724,0.00056372496675782292,0.00062952488279579947,0.00070128870310307099,0.00077937870594298468,0.00086416419864041255,0.00095602047651969092,0.0010553276059300347,0.0011624689421381135,0.0012778292325676503,0.001401792064899726,0.0015347362888842786,0.0016770308631750648,0.0018290273526791634,0.0019910490377708294,0.0021633753223012937,0.002346219895002213,0.002539700988343874,0.0027438021934661624,0.0029583227423351636,0.0031828170555591793,0.0034165247220522216,0.0036582938832284873,0.0039065030846412623,0.004158988761321908,0.0044129872824572817,0.0046651015119020863,0.0049113018073396568,0.0051469700686872111,0.0053669928154860122,0.0055659054761958929,0.0057380854400113325,0.0058779864208163904,0.0059804018587131273,0.0060407409971068617,0.0060552984323713694,0.0060214967381771222,0.005938082455963588,0.0058052583574663436,0.0056247392517392077,0.0053997243502203153,0.0051347857726952387,0.0048356795191158682,0.0045090914597798095,0.0041623359738564509,0.0038030282884753343,0.0034387530241220053,0.0030767508504757116,0.0027236426448397871,0.0023852064721703666,0.0020662175723033735,0.0017703559290087134,0.0015001804954555588,0.0012571642849976937,0.0010417807072125127,0.00085362898327798252,0.00069158529172023194,0.00055396640005163182],[6.4303555632304515e-08,8.9260942429647916e-08,1.2290624199299375e-07,1.6789504987039324e-07,2.2757265263030742e-07,3.061176502184609e-07,4.0870664381888738e-07,5.4170125175746114e-07,7.1285847568303754e-07,9.315651550051611e-07,1.2090969260684962e-06,1.5589017518809661e-06,1.996907717311611e-06,2.5418544027684267e-06,3.2156467654860994e-06,4.043730080094172e-06,5.055484126536799e-06,6.2846344699597192e-06,7.7696783589217268e-06,9.5543224790774773e-06,1.1687929542074221e-05,1.4225970465629946e-05,1.7230478711680877e-05,2.0770503195586591e-05,2.4922556060711012e-05,2.9771051529001342e-05,3.5408731988972972e-05,4.1937077467122088e-05,4.9466694646418346e-05,5.8117681645238341e-05,6.8019964850804721e-05,7.9313604211662993e-05,9.2149063532580904e-05,0.00010668744248091041,0.00012310066720414692,0.00014157163667204048,0.0001622943220905696,0.00018547381698574746,0.00021132633581695602,0.00024007915924235761,0.00027197052440428206,0.00030724945879427324,0.00034617555632585176,0.00038901869405522723,0.00043605868729989751,0.00048758487927059996,0.00054389565798932077,0.00060529788694618574,0.00067210622463756019,0.00074464228879082708,0.00082323358940809995,0.00090821210506669627,0.00099991230240366043,0.0010986682924060394,0.0012048096737923117,0.0013186554331088777,0.0014405050622922863,0.001570625841084258,0.0017092350567618683,0.0018564758610905533,0.002012385575364694,0.002176855635375351,0.0023495830903456816,0.0025300146621801091,0.0027172857933134473,0.0029101587355409146,0.0031069653449600455,0.0033055615747218181,0.0035033014073675207,0.0036970378931527347,0.0038831579054962235,0.0040576551660487445,0.0042162431497302678,0.0043545059062314396,0.0044680809826393858,0.0045528649160971766,0.0046052286129336711,0.004622227733241082,0.0046017922672787924,0.0045428800099594742,0.0044455806479312271,0.0043111605409607168,0.0041420427167134346,0.0039417216847229923,0.0037146179044666833,0.0034658815809422883,0.0032011594149124064,0.0029263406101799629,0.0026472995912160185,0.0023696524414456182,0.0020985421453091338,0.0018384645747055381,0.0015931431897606438,0.0013654560764104185,0.0011574146756424964,0.00097018977817627482,0.00080417737719215825,0.00065909498309923769,0.00053409807163787195,0.0004279064029414778],[3.7397664866865946e-08,5.2069153280336725e-08,7.1916380488663825e-08,9.8548832210437756e-08,1.34003998361344e-07,1.8083977936687463e-07,2.4224140656431595e-07,3.2214400728545765e-07,4.2537183322766121e-07,5.5779502682728283e-07,7.2650462705263558e-07,9.4000631685552703e-07,1.2084331937613316e-06,1.5437776075469024e-06,1.9601418596965774e-06,2.4740073033622513e-06,3.1045211246744157e-06,3.8737998308562153e-06,4.8072482215906342e-06,5.9338923808551797e-06,7.2867249998114438e-06,8.903061129665492e-06,1.0824902268610544e-05,1.3099306510564848e-05,1.5778762326656957e-05,1.8921563414268301e-05,2.2592181933684978e-05,2.686163735962785e-05,3.1807858104541392e-05,3.7516033022798313e-05,4.4078949880028814e-05,5.159731786956622e-05,6.0180071278307702e-05,6.9944651446722134e-05,8.1017264231700892e-05,9.3533110265524522e-05,0.00010763658540804054,0.00012348144890991122,0.00014123095693842835,0.00016105795925613455,0.00018314495697112866,0.00020768411936652868,0.00023487725780678916,0.00026493575449959019,0.00029808044325894728,0.00033454143800226341,0.00037455790189204328,0.00041837774476351225,0.00046625722712589245,0.00051846043313934892,0.00057525854910705858,0.00063692884369016887,0.00070375318596569163,0.00077601585231212346,0.00085400025921195978,0.00093798411683246373,0.0010282323357508004,0.0011249868560779188,0.0012284524390485129,0.0013387774162312567,0.0014560284934655714,0.0015801590205087451,0.0017109707144593808,0.0018480696823226365,0.0019908186887500098,0.0021382888566304193,0.0022892152056529624,0.0024419614193888261,0.002594499769258669,0.0027444120321753859,0.002888916407554773,0.0030249238555446222,0.0031491250336159009,0.0032581062917349233,0.0033484902614085124,0.0034170937511461062,0.0034610932621411713,0.0034781867604767509,0.0034667396230625446,0.0034259030594297221,0.003355694831108225,0.0032570346490355048,0.0031317300095153881,0.0029824121109965312,0.0028124254909565639,0.0026256787270008647,0.0024264665804029253,0.0022192760211455862,0.0020085894713807355,0.0017986982837858848,0.0015935380146061022,0.0013965546621986197,0.0012106080155482016,0.0010379149380271712,0.00088003214872412415,0.00073787516845534476,0.00061176781051555163,0.00050151506572210149,0.00040649150700476151,0.00032573737831065975],[2.1482756687185313e-08,3.0001056799343162e-08,4.1564156471006333e-08,5.7134958355176461e-08,7.7938338219217779e-08,1.0551966321379582e-07,1.4181308057014566e-07,1.8922049384206418e-07,2.5070210362536834e-07,3.2987932821264956e-07,4.3115083734433357e-07,5.5982233023024571e-07,7.2225056904180139e-07,9.2600204326763552e-07,1.1800264911564512e-06,1.4948453445946144e-06,1.8827549958969949e-06,2.3580446117991386e-06,2.9372280439776774e-06,3.6392892090725477e-06,4.4859401366185657e-06,5.5018907124889582e-06,6.7151289801841339e-06,8.1572107041574908e-06,9.8635567497831612e-06,1.1873756694821221e-05,1.4231876958472796e-05,1.6986771617372593e-05,2.0192393974052837e-05,2.3908106853334109e-05,2.8198989526441391e-05,3.3136139101975295e-05,3.8796964177632055e-05,4.5265468517052595e-05,5.2632522502520431e-05,6.0996120116282213e-05,7.0461619220507987e-05,8.114196293702252e-05,9.315787997011067e-05,0.00010663806176298616,0.00012171931441876986,0.00013854668332563772,0.00015727354835534904,0.00017806168726371545,0.00020108130434313959,0.00022651102016325701,0.00025453781587626335,0.00028535692122273141,0.00031917162774305771,0.00035619299583682134,0.00039663940350955976,0.00044073585241292322,0.0004887128990774609,0.00054080501212223637,0.0005972480671501473,0.00065827558084849717,0.00072411316143979108,0.00079497053001792613,0.00087103037373878218,0.0009524332662519205,0.0010392579805760479,0.001131496772857746,0.0012290256682330938,0.0013315704413587417,0.0014386698221252497,0.001549638391215897,0.0016635325351582809,0.0017791235519114435,0.0018948823782611523,0.0020089803184808221,0.0021193095121794349,0.002223525680844773,0.0023191140061456232,0.0024034769576291252,0.0024740406976277302,0.0025283745763060007,0.0025643164292020733,0.0025800951259893757,0.0025744412715955419,0.0025466772406584977,0.0024967788590178719,0.0024254029619747964,0.0023338775964219828,0.0022241545532998785,0.0020987269278106503,0.0019605172004785476,0.0018127436267166544,0.0016587742869993553,0.0015019788397502465,0.0013455877914630538,0.0011925680137779061,0.0010455214477294329,0.00090661166251773532,0.00077752043908024273,0.00065943409046092106,0.00055305704652816882,0.00045864850176024065,0.00037607676422968337,0.00030488538986780353,0.00024436520749199659]],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":[]},"yaxis":{"title":[]},"zaxis":{"title":[]}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[-10,-9.7979797979797976,-9.5959595959595951,-9.3939393939393945,-9.191919191919192,-8.9898989898989896,-8.7878787878787872,-8.5858585858585865,-8.3838383838383841,-8.1818181818181817,-7.9797979797979792,-7.7777777777777777,-7.5757575757575761,-7.3737373737373737,-7.1717171717171713,-6.9696969696969697,-6.7676767676767682,-6.5656565656565657,-6.3636363636363633,-6.1616161616161618,-5.9595959595959593,-5.7575757575757578,-5.5555555555555554,-5.3535353535353538,-5.1515151515151514,-4.9494949494949498,-4.7474747474747474,-4.5454545454545459,-4.3434343434343434,-4.1414141414141419,-3.9393939393939394,-3.7373737373737379,-3.5353535353535355,-3.333333333333333,-3.1313131313131315,-2.9292929292929291,-2.7272727272727275,-2.5252525252525251,-2.3232323232323235,-2.1212121212121211,-1.9191919191919187,-1.717171717171718,-1.5151515151515156,-1.3131313131313131,-1.1111111111111107,-0.90909090909091006,-0.70707070707070763,-0.50505050505050519,-0.30303030303030276,-0.10101010101010033,0.10101010101010033,0.30303030303030276,0.50505050505050519,0.70707070707070763,0.90909090909090828,1.1111111111111107,1.3131313131313131,1.5151515151515156,1.7171717171717162,1.9191919191919187,2.1212121212121211,2.3232323232323235,2.5252525252525242,2.7272727272727266,2.9292929292929291,3.1313131313131315,3.3333333333333339,3.5353535353535346,3.737373737373737,3.9393939393939394,4.1414141414141419,4.3434343434343425,4.545454545454545,4.7474747474747474,4.9494949494949498,5.1515151515151505,5.3535353535353529,5.5555555555555554,5.7575757575757578,5.9595959595959584,6.1616161616161627,6.3636363636363633,6.565656565656564,6.7676767676767682,6.9696969696969688,7.171717171717173,7.3737373737373737,7.5757575757575744,7.7777777777777786,7.9797979797979792,8.1818181818181799,8.3838383838383841,8.5858585858585847,8.787878787878789,8.9898989898989896,9.1919191919191903,9.3939393939393945,9.5959595959595951,9.7979797979797993,10],"y":[-2.6000000000000001,-2.3717171717171719,-2.1434343434343432,-1.915151515151515,-1.6868686868686869,-1.4585858585858587,-1.2303030303030302,-1.0020202020202018,-0.77373737373737361,-0.54545454545454541,-0.31717171717171722,-0.088888888888888573,0.13939393939393963,0.36767676767676782,0.59595959595959647,0.82424242424242466,1.0525252525252529,1.2808080808080811,1.5090909090909093,1.7373737373737375,1.9656565656565657,2.1939393939393947,2.4222222222222229,2.6505050505050511,2.8787878787878793,3.1070707070707075,3.3353535353535357,3.5636363636363639,3.791919191919193,4.0202020202020208,4.2484848484848499,4.4767676767676772,4.7050505050505063,4.9333333333333336,5.1616161616161627,5.38989898989899,5.6181818181818191,5.8464646464646481,6.0747474747474755,6.3030303030303045,6.5313131313131318,6.7595959595959609,6.98787878787879,7.2161616161616173,7.4444444444444464,7.6727272727272737,7.9010101010101028,8.1292929292929301,8.3575757575757592,8.5858585858585883,8.8141414141414156,9.0424242424242447,9.270707070707072,9.4989898989899011,9.7272727272727284,9.9555555555555575,10.183838383838387,10.412121212121214,10.640404040404043,10.86868686868687,11.096969696969699,11.325252525252527,11.553535353535356,11.781818181818183,12.010101010101012,12.238383838383841,12.466666666666669,12.694949494949498,12.923232323232325,13.151515151515154,13.379797979797981,13.608080808080809,13.836363636363638,14.064646464646467,14.292929292929296,14.521212121212125,14.749494949494951,14.97777777777778,15.206060606060609,15.434343434343438,15.662626262626263,15.890909090909092,16.11919191919192,16.347474747474749,16.575757575757578,16.804040404040403,17.032323232323233,17.260606060606062,17.488888888888891,17.71717171717172,17.945454545454545,18.173737373737374,18.402020202020203,18.630303030303033,18.858585858585858,19.086868686868687,19.315151515151516,19.543434343434345,19.771717171717174,20],"z":[[2.1482756687185296e-08,3.0001056799343143e-08,4.1564156471006346e-08,5.7134958355176481e-08,7.7938338219217766e-08,1.055196632137958e-07,1.4181308057014566e-07,1.8922049384206424e-07,2.5070210362536834e-07,3.2987932821264972e-07,4.3115083734433362e-07,5.5982233023024582e-07,7.2225056904180171e-07,9.2600204326763542e-07,1.1800264911564514e-06,1.494845344594615e-06,1.8827549958969951e-06,2.3580446117991382e-06,2.9372280439776787e-06,3.6392892090725469e-06,4.4859401366185623e-06,5.5018907124889506e-06,6.7151289801841305e-06,8.1572107041574874e-06,9.8635567497831629e-06,1.1873756694821219e-05,1.4231876958472801e-05,1.6986771617372593e-05,2.019239397405284e-05,2.3908106853334102e-05,2.8198989526441374e-05,3.3136139101975282e-05,3.8796964177632055e-05,4.5265468517052595e-05,5.263252250252041e-05,6.0996120116282199e-05,7.0461619220507974e-05,8.1141962937022533e-05,9.315787997011067e-05,0.00010663806176298616,0.00012171931441876993,0.00013854668332563769,0.00015727354835534907,0.00017806168726371539,0.00020108130434313962,0.00022651102016325706,0.0002545378158762633,0.00028535692122273146,0.00031917162774305766,0.00035619299583682139,0.00039663940350955976,0.00044073585241292317,0.00048871289907746122,0.00054080501212223659,0.0005972480671501473,0.00065827558084849717,0.00072411316143979119,0.00079497053001792537,0.00087103037373878174,0.00095243326625191996,0.0010392579805760475,0.0011314967728577462,0.0012290256682330936,0.0013315704413587412,0.0014386698221252494,0.0015496383912158968,0.0016635325351582804,0.0017791235519114435,0.0018948823782611519,0.0020089803184808216,0.0021193095121794349,0.0022235256808447726,0.0023191140061456228,0.0024034769576291243,0.0024740406976277302,0.0025283745763059998,0.0025643164292020728,0.0025800951259893753,0.002574441271595541,0.0025466772406584964,0.0024967788590178701,0.0024254029619747946,0.0023338775964219806,0.0022241545532998767,0.002098726927810649,0.0019605172004785463,0.0018127436267166522,0.0016587742869993533,0.0015019788397502452,0.0013455877914630523,0.0011925680137779048,0.0010455214477294316,0.00090661166251773434,0.00077752043908024208,0.00065943409046092031,0.00055305704652816828,0.00045864850176024005,0.00037607676422968277,0.00030488538986780305,0.00024436520749199616],[3.7397664866866132e-08,5.206915328033695e-08,7.1916380488664182e-08,9.8548832210438193e-08,1.3400399836134455e-07,1.8083977936687558e-07,2.4224140656431706e-07,3.2214400728545908e-07,4.2537183322766317e-07,5.5779502682728516e-07,7.2650462705263897e-07,9.4000631685553169e-07,1.2084331937613371e-06,1.5437776075469092e-06,1.9601418596965851e-06,2.4740073033622644e-06,3.1045211246744297e-06,3.8737998308562314e-06,4.807248221590652e-06,5.9338923808552059e-06,7.2867249998114768e-06,8.9030611296655225e-06,1.0824902268610598e-05,1.3099306510564896e-05,1.5778762326657014e-05,1.8921563414268369e-05,2.2592181933685063e-05,2.6861637359627945e-05,3.1807858104541507e-05,3.7516033022798463e-05,4.4078949880028977e-05,5.1597317869566403e-05,6.0180071278307925e-05,6.9944651446722392e-05,8.101726423170123e-05,9.3533110265524861e-05,0.00010763658540804093,0.00012348144890991168,0.00014123095693842886,0.00016105795925613512,0.00018314495697112942,0.00020768411936652949,0.00023487725780679003,0.00026493575449959106,0.00029808044325894826,0.00033454143800226455,0.00037455790189204453,0.00041837774476351355,0.00046625722712589403,0.00051846043313935066,0.00057525854910706043,0.00063692884369017115,0.00070375318596569434,0.00077601585231212562,0.00085400025921196217,0.00093798411683246644,0.0010282323357508033,0.0011249868560779218,0.001228452439048516,0.0013387774162312604,0.0014560284934655744,0.0015801590205087488,0.0017109707144593851,0.001848069682322641,0.0019908186887500142,0.0021382888566304232,0.0022892152056529676,0.0024419614193888321,0.0025944997692586751,0.0027444120321753925,0.0028889164075547786,0.0030249238555446292,0.0031491250336159095,0.0032581062917349302,0.0033484902614085198,0.0034170937511461136,0.0034610932621411791,0.0034781867604767591,0.0034667396230625511,0.0034259030594297282,0.0033556948311082319,0.00325703464903551,0.0031317300095153942,0.002982412110996536,0.0028124254909565696,0.0026256787270008694,0.0024264665804029284,0.0022192760211455888,0.002008589471380739,0.0017986982837858876,0.0015935380146061045,0.0013965546621986214,0.0012106080155482031,0.0010379149380271727,0.00088003214872412535,0.00073787516845534541,0.00061176781051555218,0.00050151506572210193,0.00040649150700476194,0.00032573737831066002],[6.4303555632304541e-08,8.9260942429647916e-08,1.2290624199299372e-07,1.6789504987039316e-07,2.275726526303074e-07,3.0611765021846112e-07,4.0870664381888738e-07,5.4170125175746146e-07,7.1285847568303754e-07,9.3156515500516142e-07,1.2090969260684969e-06,1.5589017518809667e-06,1.996907717311611e-06,2.5418544027684263e-06,3.2156467654860985e-06,4.0437300800941712e-06,5.0554841265367973e-06,6.2846344699597149e-06,7.7696783589217234e-06,9.5543224790774756e-06,1.1687929542074227e-05,1.4225970465629939e-05,1.7230478711680881e-05,2.0770503195586584e-05,2.4922556060711023e-05,2.9771051529001338e-05,3.5408731988972965e-05,4.1937077467122081e-05,4.9466694646418312e-05,5.8117681645238334e-05,6.8019964850804667e-05,7.9313604211662939e-05,9.2149063532580904e-05,0.00010668744248091035,0.00012310066720414687,0.00014157163667204048,0.0001622943220905696,0.00018547381698574746,0.00021132633581695607,0.00024007915924235758,0.00027197052440428222,0.00030724945879427324,0.00034617555632585165,0.00038901869405522728,0.00043605868729989768,0.00048758487927059985,0.00054389565798932077,0.00060529788694618574,0.00067210622463756019,0.00074464228879082676,0.00082323358940809995,0.00090821210506669616,0.00099991230240365978,0.0010986682924060403,0.0012048096737923113,0.0013186554331088777,0.001440505062292286,0.0015706258410842571,0.0017092350567618681,0.0018564758610905535,0.0020123855753646927,0.0021768556353753501,0.0023495830903456803,0.0025300146621801082,0.0027172857933134469,0.0029101587355409146,0.0031069653449600451,0.003305561574721819,0.0035033014073675207,0.0036970378931527347,0.0038831579054962239,0.0040576551660487436,0.004216243149730267,0.0043545059062314396,0.0044680809826393858,0.0045528649160971749,0.0046052286129336702,0.004622227733241082,0.0046017922672787906,0.0045428800099594725,0.0044455806479312245,0.0043111605409607151,0.0041420427167134328,0.0039417216847229897,0.0037146179044666799,0.0034658815809422861,0.0032011594149124038,0.0029263406101799607,0.0026472995912160159,0.002369652441445616,0.0020985421453091307,0.0018384645747055361,0.0015931431897606423,0.0013654560764104168,0.0011574146756424953,0.00097018977817627341,0.00080417737719215706,0.00065909498309923693,0.0005340980716378713,0.00042790640294147715],[1.092133094471333e-07,1.5114500225408011e-07,2.0747798232711572e-07,2.8253751336794234e-07,3.8174496689409112e-07,5.1183745945736058e-07,6.8111729319802357e-07,8.9973237081224291e-07,1.1799883020627112e-06,1.5366924109934954e-06,1.9875293055326994e-06,2.5534671001841834e-06,3.259192804485002e-06,4.1335748207663635e-06,5.2101499490344219e-06,6.5276317869641284e-06,8.1304369490987871e-06,1.006922511878612e-05,1.2401448594044242e-05,1.5191906697052366e-05,1.851330018701836e-05,2.244678064703611e-05,2.7082489705410363e-05,3.2520082898318879e-05,3.8869232980747728e-05,4.6250107543353691e-05,5.4793815891222627e-05,6.4642820283375806e-05,7.5951306816341409e-05,8.8885511458201149e-05,0.00010362399699827705,0.00012035787696904401,0.00013929098291787001,0.00016063997175361935,0.00018463437026368292,0.00021151655428701779,0.00024154166043423593,0.00027497742866148953,0.00031210397442355242,0.00035321348954081984,0.00039860987129280767,0.00044860827955462871,0.00050353462194094745,0.00056372496675782303,0.00062952488279579947,0.00070128870310307066,0.00077937870594298512,0.00086416419864041266,0.00095602047651969135,0.0010553276059300342,0.0011624689421381135,0.0012778292325676501,0.0014017920648997258,0.0015347362888842781,0.0016770308631750641,0.001829027352679163,0.0019910490377708289,0.0021633753223012924,0.0023462198950022109,0.002539700988343874,0.0027438021934661607,0.0029583227423351627,0.0031828170555591767,0.0034165247220522212,0.0036582938832284873,0.0039065030846412623,0.0041589887613219072,0.0044129872824572799,0.0046651015119020854,0.0049113018073396551,0.0051469700686872111,0.0053669928154860122,0.0055659054761958921,0.0057380854400113325,0.0058779864208163869,0.0059804018587131264,0.0060407409971068573,0.0060552984323713659,0.006021496738177117,0.0059380824559635854,0.0058052583574663402,0.0056247392517392043,0.0053997243502203118,0.0051347857726952344,0.0048356795191158639,0.004509091459779806,0.0041623359738564474,0.0038030282884753295,0.0034387530241220018,0.0030767508504757094,0.0027236426448397836,0.0023852064721703631,0.0020662175723033705,0.0017703559290087115,0.0015001804954555566,0.0012571642849976924,0.001041780707212511,0.00085362898327798133,0.00069158529172023086,0.00055396640005163117],[1.8322327546477192e-07,2.5280884257131105e-07,3.4596897872860437e-07,4.6965784781831806e-07,6.325475913562263e-07,8.4535868050413201e-07,1.121231239646105e-06,1.4761379524217821e-06,1.9293383722426531e-06,2.503873615967927e-06,3.2270995494630263e-06,4.1312557059447106e-06,5.2540663400440047e-06,6.6393692373923876e-06,8.3377671922243456e-06,1.0407296450073938e-05,1.2914105899981047e-05,1.593314039648496e-05,1.9548821297287239e-05,2.3855717115285412e-05,2.8959197098385456e-05,3.4976060559915412e-05,4.2035134878405807e-05,5.0277835259492308e-05,5.985867959642551e-05,7.0945752071328275e-05,8.3721109499715481e-05,9.8381124829307893e-05,0.00011513676265480562,0.00013421378209744174,0.00015585286291655776,0.00018030965126504986,0.00020785472206642295,0.00023877345557344484,0.00027336582626215003,0.00031194610281512513,0.0003548424585492041,0.00040239649223837486,0.00045496265986405039,0.00051290761837762423,0.0005766094830590028,0.00064645700045098953,0.00072284863904895904,0.00080619159974799242,0.00089690074715815745,0.00099539746068063543,0.0011021083996212064,0.0012174641678000251,0.001341897847196303,0.0014758433427005807,0.0016197334346142829,0.0017739973634795009,0.0019390576624863951,0.0021153257946228774,0.0023031959353131395,0.0025030359635379671,0.0027151743958226554,0.0029398816504652256,0.0031773437266253879,0.0034276262219950582,0.003690626722851237,0.0039660141259242488,0.004253154521434252,0.004551024949585261,0.0048581185994801511,0.0051723476659768222,0.0054909527801884541,0.005810430227562292,0.0061264895627843327,0.0064340542764976787,0.0067273165722981712,0.0069998540077743686,0.0072448109299502236,0.007455141719653312,0.0076239064580613525,0.0077446034511782962,0.0078115178189446842,0.007820061730215877,0.007767080351550229,0.0076510984751944726,0.0074724861442513665,0.007233527172938888,0.006938381780270046,0.0065929429170439478,0.0062045944333659212,0.0057818871334631471,0.0053341551907524851,0.0048710997104624947,0.0044023680356110829,0.0039371565894419985,0.0034838618215823286,0.0030497986231952513,0.0026409990368731597,0.0022620969512212479,0.0019162974854389401,0.0016054235994444554,0.0013300276192869248,0.001089552156319896,0.00088252342047904228,0.00070676008499118734],[3.0364421165616674e-07,4.1770728856370472e-07,5.6988196567471696e-07,7.7120559163657149e-07,1.035370832788738e-06,1.3792141242218958e-06,1.8232585974407712e-06,2.392310669319256e-06,3.1161081922474782e-06,4.0300167500399032e-06,5.1757693875093002e-06,6.6022438312646812e-06,8.3662701381391588e-06,1.0533460731166201e-05,1.3179053977471217e-05,1.6388761844081923e-05,2.0259611742858301e-05,2.4900772441984127e-05,3.04343538689367e-05,3.6996170743412894e-05,4.4736460239872444e-05,5.382054426825601e-05,6.4429427458205214e-05,7.6760322518120111e-05,9.1027095298833841e-05,0.00010746062260792351,0.00012630905658214136,0.0001478379902214789,0.00017233051950979767,0.00020008719838582621,0.00023142588367747261,0.00026668146796529895,0.00030620549919148279,0.0003503656866726906,0.00039954529400330554,0.00045414242014349334,0.00051456917076872434,0.00058125072270638557,0.00065462428499162516,0.00073513796072317275,0.00082324951446275437,0.00091942505034518611,0.0010241376062448957,0.001137865669074924,0.0012610916151920479,0.0013943000772442162,0.001537976233386218,0.0016926040045095365,0.0018586641265847406,0.0020366320331555018,0.0022269754298062075,0.002430151357632727,0.0026466024133759403,0.0028767516056344205,0.0031209950669550636,0.0033796915054583702,0.0036531468775127828,0.0039415923315508318,0.0042451530859965595,0.0045638056787583861,0.0048973211203351729,0.0052451920790061984,0.0056065434925433762,0.0059800280354177626,0.0063637106420336266,0.006754949582701497,0.0071502850004759788,0.0075453487730081032,0.007934811422685803,0.0083123819761270531,0.008670874775780435,0.0090023531674830876,0.009298353956871357,0.0095501890845880698,0.009749312892801074,0.0098877355533394124,0.0099584566270111349,0.0099558881560713221,0.0098762347967938126,0.0097177996457135513,0.0094811886476704847,0.009169393500320918,0.0087877421690765404,0.0083437166158001289,0.007846648074329483,0.0073073100817881388,0.0067374374903004909,0.006149205044005018,0.0055547013232459209,0.0049654328053123885,0.0043918887097751649,0.0038431907501923577,0.003326843705040394,0.002848593778443547,0.0024123929810416387,0.0020204600524637633,0.0016734224040947361,0.0013705195697804272,0.0011098468329838514,0.00088861792592491808],[4.971000852426406e-07,6.8178707659709491e-07,9.2732350447319435e-07,1.2510026724901847e-06,1.6741647107985235e-06,2.2229061135715062e-06,2.9288588355906321e-06,3.8300352308705481e-06,4.9717331397380133e-06,6.4074934981840501e-06,8.2001010355834872e-06,1.0422617017313798e-05,1.3159431637934017e-05,1.6507322622438774e-05,2.0576505873245807e-05,2.5491663615974849e-05,3.1392935437693655e-05,3.8436857853041833e-05,4.6797238542135703e-05,5.6665952138892612e-05,6.8253645366627447e-05,8.1790340377750333e-05,9.7525926317890312e-05,0.00011573053036853127,0.00013669476079859627,0.00016072981585217339,0.00018816745359942296,0.00021935981916733216,0.00025467912703609649,0.00029451719732738626,0.0003392848462158575,0.00038941113175916054,0.00044534245755901492,0.00050754153773164743,0.00057648622767514964,0.00065266822606925394,0.00073659165442461984,0.00082877152130784732,0.00092973207909651662,0.0010400050817506647,0.0011601279525946617,0.0012906418714292234,0.0014320897903223511,0.0015850143869351185,0.0017499559627935336,0.0019274502907296541,0.0021180264093774367,0.0023222043507235982,0.0025404927653656113,0.0027733863732293945,0.0030213631060924634,0.0032848807100151699,0.0035643724251071835,0.0038602411394510982,0.0041728511075434177,0.0045025159233706728,0.0048494809541593346,0.0052138979135289282,0.0055957887669714577,0.0059949958567137567,0.0064111151981278269,0.0068434105601212821,0.0072907074113923703,0.0077512682306721337,0.0082226540252752396,0.0087015809398718683,0.0091837850782590623,0.0096639124036183716,0.010135453020083146,0.010590739518043062,0.011021026862935067,0.011416666362143935,0.011767378824209907,0.012062622800349317,0.012292043751017967,0.012445980260944905,0.012515995203827079,0.012495394075876132,0.012379690369906524,0.012166979299013744,0.011858186446694665,0.011457166639356543,0.010970639730663562,0.010407962956435495,0.0097807527634245408,0.00910238118418716,0.0083873816844084563,0.007650805972628536,0.0069075759401468753,0.0061718735423743985,0.0054566063456015215,0.0047729783459806718,0.0041301855138337513,0.003535244474165812,0.0029929519571202231,0.0025059631611211875,0.0020749697464237339,0.0016989532895680722,0.0013754878239824392,0.001101065409807461],[8.0395679038283698e-07,1.0993561646381206e-06,1.4907083085932666e-06,2.0047611663579263e-06,2.6743436181032529e-06,3.5393773218576604e-06,4.6479728497425949e-06,6.0576011338491599e-06,7.8363283604049277e-06,1.0064099786342794e-05,1.2834055624387357e-05,1.6253860255243215e-05,2.0447024654177831e-05,2.5554201107265291e-05,3.173442904887838e-05,3.916631115394086e-05,4.8049099616395245e-05,5.8603673769832063e-05,7.1073391775860467e-05,8.5724800935074158e-05,0.00010284819318167575,0.00012275799443130768,0.00014579297859915804,0.0001723162992415887,0.00020271533386169389,0.0002374013379310083,0.00027680890759896199,0.00032139525187851754,0.00037163927680531911,0.00042804048566616145,0.0004911177008796151,0.00056140761448678176,0.00063946317547301432,0.00072585182329131144,0.00082115357799432279,0.00092595899830305811,0.0010408670197452413,0.0011664826856816466,0.0013034147845995016,0.0014522734074754861,0.001613667439269993,0.0017882019986504418,0.0019764758397325744,0.0021790787287306939,0.0023965888064487722,0.0026295699436467246,0.0028785690889095265,0.0031441135950323095,0.0034267084856749522,0.0037268335821796237,0.0040449403406659255,0.0043814481374705389,0.0047367395682899327,0.0051111540719860358,0.0055049788340760806,0.005918435456088408,0.0063516603038288912,0.0068046758139951643,0.0072773494401804362,0.0077693365164995575,0.0082800033359214462,0.0088083274523540114,0.0093527738882110481,0.0099111487477622235,0.010480435707563268,0.011056625718866271,0.011634555443443053,0.012207774607809549,0.012768465603679011,0.013307439332166281,0.013814228799733583,0.014277296087317443,0.014684359331776866,0.015022835099723577,0.015280379215381177,0.015445497162715087,0.015508185074790622,0.01546055534313638,0.015297398001916308,0.015016630808894824,0.014619597398890866,0.014111183546785042,0.013499735484667152,0.012796780022768683,0.012016562337994174,0.011175432072719113,0.010291120326595966,0.009381958045400509,0.0084660894981201731,0.0075607328147585407,0.0066815333098979354,0.0058420453996252016,0.0050533665439765844,0.0043239332111077496,0.0036594757649365465,0.003063117663856068,0.0025355953683023759,0.0020755694582854272,0.0016799948287327569,0.0013445182629164708],[1.284539876862277e-06,1.7512875721502284e-06,2.3674785346679283e-06,3.1739548552875061e-06,4.2205667803810463e-06,5.5675879161341392e-06,7.2872253040447494e-06,9.4652065085710941e-06,1.2202421913822819e-05,1.5616597022732939e-05,1.9843966867806378e-05,2.504092281023089e-05,3.1385601101091826e-05,3.9079382621926807e-05,4.834827417109405e-05,5.944414342610752e-05,7.264578216034934e-05,8.8259775271550282e-05,0.0001066211565264328,0.0001280938354832788,0.00015307078368041911,0.00018197397175590154,0.00021525405260129879,0.00025338978888754613,0.00029688722629431479,0.00034627861650846201,0.00040212109652828436,0.00046499513302538194,0.00053550274248709187,0.00061426549960400402,0.00070192234789322172,0.00079912722787141993,0.00090654653922318362,0.001024856454358356,0.0011547401015244074,0.0012968846362420158,0.001451978220268901,0.0016207069275714281,0.0018037515968954917,0.002001784650469904,0.002215466898123354,0.0024454443455922733,0.0026923450249150866,0.0029567758632889759,0.0032393196040988201,0.0035405317890579019,0.0038609378018003454,0.0042010299578478247,0.0045612645986896575,0.0049420591009488486,0.0053437886335625578,0.0057667823701550045,0.0062113186690032412,0.006677618444363943,0.007165835546225993,0.0076760424253135692,0.0082082086927779459,0.0087621694355829588,0.0093375794250215964,0.0099338488394647081,0.010550056076018844,0.011184833971868641,0.011836227622622717,0.012501525213967161,0.013177067914373283,0.013858050637134377,0.014538331719216336,0.015210275281785925,0.015864654021832649,0.016490641250907212,0.017075918263037851,0.017606916236837803,0.018069201182326119,0.018447996909821233,0.018728826113290319,0.018898235190804618,0.018944556163387857,0.018858650584422831,0.018634576838559871,0.018270124358898281,0.017767166077092483,0.017131793266733249,0.016374213671940162,0.015508412797743596,0.014551597563372686,0.01352345921089956,0.012445306621721958,0.011339130615953574,0.010226663548015451,0.0091284963706007513,0.0080633077805982653,0.0070472481212669668,0.0060935058522457435,0.0052120682893959536,0.0044096726390085734,0.0036899295866193531,0.0030535909756791392,0.0024989261012282149,0.002022168046511169,0.0016179920637591732],[2.0277054626334119e-06,2.7562767431131549e-06,3.7147433369445864e-06,4.9646706214812936e-06,6.5807778771821721e-06,8.6528772178419783e-06,1.12879071176365e-05,1.4612028550593112e-05,1.8772746723259055e-05,2.3941017474772067e-05,3.031329487512759e-05,3.8113475516627877e-05,4.7594695507684335e-05,5.90409381818396e-05,7.2768413874560022e-05,8.9126677568408214e-05,0.00010849945548713777,0.00013130515753358355,0.00015799705852347881,0.00018906313720482576,0.00022502556785267431,0.00026643986462876506,0.00031389368378687222,0.0003680052931316133,0.00042942172188741538,0.00049881660732338496,0.00057688775714780983,0.000664354448882097,0.00076195448920011381,0.0008704410576241122,0.00099057936004591941,0.0011231431183278081,0.0012689109227606843,0.0014286624744411307,0.0016031747446921519,0.0017932180785105365,0.0019995522686893654,0.0022229226267476269,0.0024640560761064164,0.0027236572920810507,0.0030024049121914914,0.0033009478389745433,0.0036199016557815536,0.0039598451736929385,0.004321317124134594,0.0047048130060140872,0.005110782086339704,0.0055396245360863168,0.0059916886530985919,0.0064672680724299596,0.0069665987786647482,0.0074898555959627983,0.0080371476154970506,0.0086085116978343174,0.0092039027306936583,0.0098231787102081997,0.010466077949549605,0.011132184849706123,0.011820879808218438,0.012531268196295738,0.013262083202625849,0.014011558099694859,0.01477726552942122,0.015555925037177908,0.016343185391521846,0.017133394934763853,0.017919380590986515,0.018692263053027878,0.019441340635391945,0.020154075867153246,0.020816215991595721,0.021412070658258765,0.021924957572134317,0.022337810849222661,0.022633929103058757,0.022797822995682841,0.02281610730719982,0.022678372428185961,0.022377965979952903,0.021912617782319996,0.02128485063714735,0.020502134646755595,0.019576762625516296,0.018525446640274411,0.017368658558494097,0.016129758358042805,0.014833970739696766,0.013507281631520885,0.012175330495462853,0.010862371723649433,0.0095903694023385007,0.0083782755589104779,0.0072415244185053459,0.0061917561639539733,0.0052367651969645011,0.0043806516849320305,0.0036241425699211969,0.0029650400049935598,0.0023987515947226832,0.0019188575588124652],[3.1624331173179336e-06,4.2859968272970076e-06,5.7588911431008585e-06,7.6727343286815365e-06,1.0138075089258127e-05,1.328699057963724e-05,1.7275757002699986e-05,2.2287539374471649e-05,2.8535041207604732e-05,3.6263051153077679e-05,4.5750822313806784e-05,5.7314221110537622e-05,7.1307586170629762e-05,8.8125243488371461e-05,0.00010820263169589043,0.0001320170002124343,0.00016008765278264771,0.00019297571894744562,0.0002312834458352458,0.00027565301191761311,0.00032676487274394586,0.00038533565596527981,0.00045211562909096048,0.00052788576839451519,0.000613454461263235,0.00070965387717924577,0.000817336044558778,0.0009373686719949065,0.0010706307531717536,0.0012180079949529589,0.0013803881079821202,0.0015586559986369407,0.0017536889004041382,0.0019663514817280497,0.0021974909661620049,0.0024479322992411287,0.0027184733949174684,0.0030098804926686341,0.0033228836545206933,0.0036581724292174054,0.0040163917086057021,0.0043981377989380675,0.0048039547270855758,0.0052343307983289339,0.0056896954178810724,0.0061704161815070314,0.006676796229555579,0.0072090718399093279,0.0077674102029294881,0.0083519072660126568,0.0089625854425837408,0.009599390829733042,0.010262189343028416,0.010950760823491975,0.01166478966641926,0.012403849839168443,0.013167381294375573,0.013954653793041802,0.014764713150643651,0.015596304131733034,0.016447763980056783,0.01731688131295641,0.018200717294534915,0.019095390013375908,0.019995828968539721,0.020895514245808922,0.021786223553383416,0.0226578184637529,0.023498107289091522,0.024292824261506456,0.02502576171039957,0.025679083074693031,0.026233830176516842,0.026670619525742133,0.026970501628753647,0.027115936899325135,0.027091824426235405,0.02688650783605568,0.026492677488737064,0.025908091149800607,0.025136046098716804,0.024185553473667656,0.023071188838093837,0.021812619186767634,0.020433833226717529,0.018962126048840008,0.017426908786437805,0.015858426626290941,0.01428647346126642,0.012739188313775542,0.011242008079417823,0.009816834586648877,0.0084814534578544747,0.007249220098947253,0.0061290066428653228,0.0051253848527328715,0.0042390053860977698,0.0034671243443118718,0.0028042239360600804,0.002242675023244278],[4.8732001596119343e-06,6.5850999487684496e-06,8.8213416686804297e-06,1.1716526987854821e-05,1.5432103378537495e-05,2.0159761203704522e-05,2.6124842946326435e-05,3.3589679987167105e-05,4.2856766638764154e-05,5.4271679119536861e-05,6.8225649055402799e-05,8.5157706889792955e-05,0.00010555631994125947,0.00012996046219050363,0.000158960067430681,0.0001931958332869699,0.00023335835988841475,0.00028018662280072248,0.0003344657944763856,0.0003970244413997291,0.00046873113495154783,0.00055049052264123253,0.00064323891277785761,0.00074793943003517369,0.00086557680195821518,0.0009971518375559334,0.0011436756590260269,0.0013061637466441106,0.0014856298551586533,0.0016830798578573965,0.00189950557195455,0.0021358786161940059,0.0023931443486422095,0.0026722159296010285,0.0029739685514367162,0.0032992338739164418,0.0036487947003850602,0.004023379926814191,0.004423659792422617,0.0048502414572025076,0.0053036649282736945,0.0057843993534729757,0.0062928396968326625,0.0068293038063208557,0.0073940298788149348,0.0079871743196247274,0.0086088099818829589,0.0092589247510876643,0.009937420405776401,0.010644111626663424,0.011378724928136279,0.012140897125466338,0.012930172698420211,0.013745999030442308,0.014587717953268371,0.015454551278580947,0.016345577045222413,0.017259692097365643,0.01819555546284746,0.019151506061115674,0.02012544790598229,0.021114696663960118,0.022115783719967096,0.023124218250266532,0.024134214416508475,0.025138399433576788,0.026127528085904513,0.027090238803556196,0.02801289372504738,0.028879548217605463,0.029672092406325252,0.030370597516976312,0.030953883536008895,0.031400303300540645,0.031688714093519366,0.031799584145276075,0.031716161222195983,0.031425616430044358,0.030920070458747371,0.030197412779609984,0.029261836756485731,0.028124034195301812,0.026801019561903582,0.025315584275986746,0.023695412063345325,0.021971914188865273,0.020178865677245261,0.018350938177876527,0.016522230660062542,0.014724895381162777,0.012987944330157354,0.011336302284767183,0.0097901490524995183,0.0083645680460230493,0.0070694937119657308,0.0059099288068209044,0.0048863858439764261,0.0039954962578048021,0.0032307262273496965,0.0025831392657260552],[7.4199542150133998e-06,9.9970693553992747e-06,1.3351654357524579e-05,1.7678939724383286e-05,2.3211662718579435e-05,3.0224388896098939e-05,3.9037722407217758e-05,5.0022276991453073e-05,6.3602275992929294e-05,8.0258652161326762e-05,0.00010053152657675308,0.00012502196036085137,0.00015439289207817337,0.00018936919668947178,0.00023073682714374496,0.00027934102564086645,0.00033608361676638101,0.00040191941778852717,0.00047785182140178091,0.00056492762244124439,0.00066423117228413741,0.00077687795284010471,0.00090400766652478834,0.0010467769399137249,0.0012063517374900504,0.0013838995786545601,0.0015805816465431903,0.0017975448716937648,0.002035914067615178,0.002296784189125919,0.0025812127781372715,0.0028902126554745801,0.0032247449114172415,0.0035857122419162219,0.0039739526719200129,0.0043902337018979377,0.0048352469084859346,0.0053096030251858009,0.0058138275242182692,0.0063483567159510782,0.0069135343777695871,0.0075096089197657818,0.0081367310900478506,0.0087949522175153616,0.0094842229839937064,0.010204392709505692,0.010955209122012841,0.011736318562342876,0.012547266539704683,0.013387498492561252,0.014256360507286165,0.015153099579047567,0.016076862733216256,0.017026693920880916,0.018001527014895845,0.019000172426247772,0.020021293822679736,0.021063370203688737,0.022124637297372761,0.023203001147642233,0.024295916253403247,0.025400221238860092,0.026511927382572867,0.027625959957948719,0.028735859526248467,0.029833459875571417,0.03090857034315871,0.031948701192203409,0.032938879360037358,0.033861605878812873,0.034697003568254128,0.035423193096568342,0.03601691738956269,0.036454410236465735,0.036712477573410916,0.036769732807626042,0.036607904282618384,0.036213116748429031,0.035577041801797139,0.034697815885223623,0.033580638539451563,0.032237986954343469,0.03068941318071625,0.028960924587911281,0.02708398277329593,0.025094187599498524,0.023029738166725471,0.020929778871132922,0.018832744823540762,0.016774816540322559,0.014788579867477506,0.012901965464742059,0.011137515491627279,0.009511996401266971,0.00803634894344573,0.0067159422174261352,0.0055510798661636673,0.004537694425792692,0.0036681607468024933,0.0029321608156794177],[1.1163499630587491e-05,1.499690487001082e-05,1.9969153826398154e-05,2.6359809548833527e-05,3.4500047047676469e-05,4.4777978188794337e-05,5.7643644611515062e-05,7.3613492459011071e-05,9.3274144874736951e-05,0.00011728529984307155,0.00014638160170854148,0.00018137336351007867,0.000223146052360549,0.00027265848923463843,0.00033093975517753177,0.00039908483557664148,0.0004782490704485864,0.00056964150982732734,0.00067451729802591235,0.00079416922815833885,0.00092991861884800177,0.0010831056690454224,0.0012550794452523379,0.001447187649353174,0.001660766305910533,0.0018971294963481026,0.0021575592549234169,0.0024432957285738023,0.0027555276901661003,0.0030953834827503767,0.0034639224612945238,0.0038621269881176251,0.0042908950288215722,0.0047510333868728289,0.0052432516070259443,0.0057681565704236692,0.0063262477973861902,0.0069179134675568981,0.0075434271611615226,0.0082029453196209041,0.0088965054185882308,0.0096240248415777486,0.010385300437556318,0.011180008740865582,0.012007706826005564,0.012867833761945217,0.013759712618519887,0.014682552957193272,0.015635453703272389,0.016617406235559837,0.017627297425271766,0.018663912183625172,0.01972593480214101,0.02081194794774394,0.021920427557658564,0.023049731023982657,0.024198074946507487,0.025363497400913534,0.026543798246343918,0.027736449742617963,0.028938469085124093,0.030146244973510695,0.031355312682335844,0.032560076928223512,0.033753489501644869,0.034926699011097503,0.036068702293360587,0.037166039365701432,0.038202583830896628,0.039159485698971826,0.040015321283009865,0.04074649375509664,0.041327908175039049,0.041733918023748352,0.04193950958767044,0.041921659921001816,0.04166077770684623,0.041142117808269069,0.040357052307376566,0.039304084728911164,0.037989509869245486,0.036427647774221125,0.034640614331656099,0.032657629201120711,0.030513900453106917,0.028249160359770098,0.025905954722216875,0.023527806220538249,0.021157378959004793,0.018834766378604786,0.016596009044191146,0.014471924623097673,0.012487302599091111,0.010660484255002234,0.0090033175287771803,0.0075214494029984258,0.0062148977080948133,0.0050788308835532144,0.0041044786812079789,0.0032800984754366293],[1.659702246793783e-05,2.2231483480588645e-05,2.9514023094346018e-05,3.8839873966630699e-05,5.0674199334892901e-05,6.5558405161402351e-05,8.4115755549361685e-05,0.00010705603096746958,0.00013517898299601069,0.00016937636767149554,0.00021063238083425515,0.0002600223707979035,0.00031870976283994055,0.00038794119251918879,0.00046903990650430574,0.00056339754650751338,0.00067246448072198241,0.00079773888542808793,0.00094075480580981669,0.0011030694392633285,0.0012862498873430887,0.0014918596155236591,0.0017214448452135052,0.0019765210822110472,0.0022585599622574155,0.002568976569465684,0.002909117358747949,0.0032802487900269349,0.0036835467606835082,0.0041200869036629763,0.0045908358019703882,0.0050966431557741432,0.0056382349257561963,0.0062162074654122327,0.0068310226454476103,0.0074830039650020446,0.0081723336369853312,0.0088990506281771149,0.009663049628833768,0.010464080921272387,0.011301751112186644,0.01217552468919034,0.013084726358103888,0.014028544113470454,0.015006032990075073,0.016016119436638391,0.017057606242141057,0.018129177926430956,0.019229406473047744,0.020356757222335375,0.021509594639285656,0.022686187497020772,0.023884712737057896,0.025103256835101222,0.026339812863453039,0.027592270549663105,0.028858395460823482,0.03013579202341482,0.031421843544556516,0.032713620996595069,0.034007751502248496,0.035300237827370719,0.03658622248683429,0.037859695008509206,0.039113148944759389,0.040337206302964806,0.041520240325057085,0.042648041194397711,0.043703580686415583,0.044666938005563442,0.045515447326248307,0.046224116153655244,0.046766342431099402,0.047114929090314416,0.047243360864754738,0.047127274111418913,0.046746020817452501,0.046084207078473029,0.045133077162150398,0.043891618348225726,0.042367278980184157,0.040576220951789831,0.038543065260220957,0.036300131417196027,0.033886214047195148,0.03134497853470497,0.028723088214996792,0.026068195370918149,0.023426935498775635,0.02084305866895848,0.018355814478260395,0.015998680438650291,0.013798490914057769,0.011774988578694681,0.0099407864683632233,0.0083016992070195795,0.0068573792963006761,0.0056021798458819856,0.0045261591479779182,0.0036161444613868753],[2.4384263478539786e-05,3.2568135539973204e-05,4.3108400494902407e-05,5.6556720297513047e-05,7.3558017997130387e-05,9.4857596071464041e-05,0.00012130698837996992,0.00015386819538243198,0.00019361598844712849,0.00024173802566814642,0.00029953259571015978,0.00036840389320831,0.00044985482331515826,0.00054547742757702006,0.00065694111191966264,0.00078597893430374809,0.0009343722700301322,0.0011039342138813124,0.0012964920992946773,0.0015138695163983279,0.0017578681953484148,0.0020302500924218795,0.0023327199777443651,0.0026669087794339861,0.0030343578930101468,0.0034365046201684586,0.0038746688596399325,0.0043500411361648943,0.0048636720221902048,0.0054164629807165335,0.0060091586363492317,0.0066423404643863029,0.0073164218739831125,0.0080316446503715215,0.0087880767121859046,0.0095856111326843071,0.010423966367698044,0.011302687628244863,0.012221149331726593,0.013178558562378319,0.014173959469035559,0.015206238526223262,0.016274130582856105,0.017376225621145599,0.018510976145999791,0.019676705121087559,0.020871614359616989,0.022093793261802237,0.023341227760156392,0.024611809276873575,0.025903343396841867,0.027213557788600354,0.02854010862639705,0.029880584330970753,0.031232504798729157,0.032593313374939689,0.033960357614636637,0.035330853386865813,0.036701825231747184,0.038070014338708123,0.039431744526349233,0.040782736812013838,0.042117865346894982,0.043430852448541793,0.044713908743176919,0.045957336054900447,0.047149124831793773,0.048274592754672808,0.04931612397588462,0.05025307590363854,0.051061919487604947,0.05171666750494168,0.052189623062007119,0.052452449157931576,0.052477523340620336,0.052239504120641052,0.051717003147621968,0.050894233896368581,0.049762497182779711,0.048321367963209801,0.046579466468922442,0.044554727976694145,0.042274126173862031,0.039772850877762903,0.037092987028055802,0.034281783614847558,0.03138963431791706,0.028467912921096909,0.025566814215545301,0.022733344853779154,0.020009589731649249,0.017431350541265222,0.015027217675579522,0.012818098656501411,0.010817189638482333,0.0090303447358159421,0.007456773497480613,0.0060899812968292066,0.0049188610792646791,0.0039288471590060228],[3.5404473277972417e-05,4.7151472735841131e-05,6.2227347153739917e-05,8.1392329591476937e-05,0.00010552901777259828,0.00013564985663345704,0.00017290250332235515,0.00021857262264945369,0.00027408373439026702,0.000340993835424266,0.00042098864358879778,0.0005158714481389411,0.00062754969404487824,0.00075801856368826756,0.00090934194004765889,0.0010836312320058759,0.0012830226092353026,0.0015096532284510386,0.0017656370349804034,0.0020530406966978152,0.002373860176727458,0.002729998383597916,0.0031232442598811755,0.0035552535895255906,0.0040275317258282716,0.0045414183705737333,0.0050980744729909079,0.0056984712660497526,0.0063433814171922273,0.0070333722399438491,0.0077688008905363818,0.0085498114580501855,0.0093763338460712484,0.010248084337075549,0.011164567726607033,0.012125080911997656,0.013128717819335698,0.01417437555226733,0.015260761646801525,0.016386402317449866,0.017549651581676963,0.01874870115166212,0.019981590984613176,0.021246220385016699,0.022540359553653959,0.023861661477808899,0.025207674052710231,0.026575852312038756,0.027963570618619329,0.029368134614078049,0.030786792630573028,0.032216746101973129,0.033655158238157068,0.035099159794725047,0.036545850122765421,0.037992290761346345,0.039435487600784497,0.040872356110598404,0.042299662401233257,0.043713931229370062,0.045111310911968419,0.046487385142184867,0.047836923723947954,0.049153569114899938,0.050429464035225698,0.051654837378667308,0.052817580507202387,0.053902861899394333,0.054892842190013322,0.055766560371717531,0.056500061901255845,0.057066828240658521,0.05743854437519931,0.057586207758600343,0.057481542759026186,0.057098644313012738,0.056415738916822014,0.055416925515542934,0.054093747116683563,0.052446447996090745,0.050484791084571982,0.048228343532310862,0.045706181996733035,0.042956018252500172,0.040022795107280504,0.036956847199691389,0.033811756551503286,0.030642055356999705,0.027500936511150174,0.024438125558379709,0.021498047468914087,0.018718390698438475,0.016129133128447822,0.013752053969461647,0.01160071672952652,0.0096808745498980185,0.0079912233064560172,0.0065244114399630841,0.0052682088834957036,0.0042067399839725],[5.0803717741136972e-05,6.7467761498513426e-05,8.8778590295796167e-05,0.00011577058514608481,0.00014963599494277003,0.00019173195413852166,0.00024358415740628389,0.00030688663520863301,0.0003834972070667438,0.00047542835938239132,0.00058483349121246512,0.00071398868056791022,0.00086527032997436057,0.0010411292374516595,0.0012440617936467326,0.0014765791167022529,0.0017411749970452622,0.0020402935330657108,0.0023762972989220892,0.0027514368049187292,0.0031678218994725944,0.0036273956315458124,0.0041319109554691074,0.004682910526896877,0.0052817097175163951,0.0059293828726102926,0.0066267527523621731,0.00737438303514764,0.0081725737173269468,0.0090213592164160878,0.0099205089695902672,0.01086953031390853,0.011867673435467721,0.012913938179507043,0.014007082520541643,0.015145632499732956,0.016327893445210063,0.017551962299579196,0.018815740887257796,0.020116949962518435,0.021453143887238599,0.022821725795320019,0.024219963108477096,0.025645003275361112,0.027093889612248741,0.028563577127722565,0.030050948213887606,0.031552828079037205,0.033065999774879395,0.034587218624673843,0.036113225769610797,0.03764076039313341,0.039166569918928973,0.040687417057855453,0.04220008194199143,0.043701356668845691,0.045188028341230486,0.04665684513254055,0.048104458130588605,0.049527329960160606,0.050921599896565112,0.052282895021504211,0.053606078785611334,0.054884933034699442,0.05611177785664119,0.057277045730486732,0.058368841758690518,0.059372538459113111,0.06027046877059037,0.061041790893813154,0.061662599627240765,0.062106348195692697,0.062344621316757623,0.062348265946168775,0.062088844702913745,0.061540334021551221,0.060680950867096593,0.059494964095706412,0.057974333479199378,0.056120023192795451,0.053942857116706877,0.051463818475206695,0.04871374230526386,0.04573240103768772,0.042567035571368456,0.039270431194720963,0.035898674811613823,0.032508753615800877,0.02915616365401915,0.025892689400196341,0.022764494019397428,0.019810627376250004,0.017062019015672263,0.014540980785567089,0.012261202883102614,0.010228191705921524,0.008440070817397784,0.0068886492238996889,0.0055606543869404709,0.0044390301864343758],[7.2051324126746024e-05,9.5415134786634321e-05,0.000125188675849739,0.00016276151997324999,0.00020972337077335718,0.00026786923990456286,0.00033919957361457461,0.00042591468355094523,0.00053040306025010236,0.00065522341808514661,0.00080308061911045416,0.00097679592785497853,0.0011792723356273971,0.0014134559382215019,0.0016822945355935955,0.0019886947325527377,0.0023354788495782443,0.0027253429042930848,0.0031608168059998076,0.0036442277330535999,0.0041776674544587254,0.0047629641329122521,0.0054016589253740969,0.0060949874947388996,0.0068438663734902211,0.0076488839835539019,0.0085102960174705984,0.0094280248221637521,0.010401662393003799,0.011430476576164533,0.012513420084751745,0.013649141952749534,0.014836001075461683,0.016072081512114551,0.017355209253185178,0.018682970180435174,0.020052728970968714,0.021461648717808233,0.022906711058688686,0.0243847366223236,0.025892405617590181,0.027426278406149352,0.028982815913050297,0.030558399742774345,0.03214935187954477,0.033751953859638695,0.035362465308045231,0.036977141728700591,0.038592251420635722,0.040204091351427634,0.041809001737737182,0.043403378934911155,0.044983685986688109,0.046546459782291952,0.048088313151007242,0.049605929329989612,0.05109604502015351,0.052555416692731803,0.053980763009820742,0.055368674404210581,0.05671547945292036,0.058017057328534856,0.059268587178185145,0.060464229703409311,0.061596744292954329,0.062657057113892967,0.063633811056931985,0.064512945667478241,0.065277371269253523,0.065906812602021483,0.06637789948996109,0.066664572236568242,0.06673884639496698,0.066571946627277612,0.066135776465328477,0.065404645776394946,0.064357137280153756,0.062977963733312547,0.061259653011085886,0.059203901658943014,0.056822458527803626,0.054137436566615897,0.051180998662120863,0.047994417322234688,0.044626562191611235,0.041131918184646565,0.037568275488602754,0.033994257167048195,0.030466858567574636,0.027039165014588102,0.023758391924986594,0.02066435760123967,0.017788457669149476,0.015153166073674009,0.012772045279765725,0.010650211788084374,0.0087851751925998381,0.0071679514514070989,0.005784344184576835,0.0046162908442069816],[0.00010099926789459382,0.00013337668094121383,0.00017449159673564729,0.00022618714617539282,0.00029055553978777628,0.00036993928783503701,0.00046692506109613751,0.00058432950143200841,0.00072517664834670522,0.0008926670599437161,0.0010901391439285175,0.0013210236418742171,0.0015887925920741216,0.0018969044002713667,0.0022487468477108826,0.0026475799467745144,0.0030964805123853221,0.0035982901610648391,0.0041555681984648662,0.004770550537825575,0.0054451154378150259,0.00618075649041612,0.0069785629561947169,0.0078392072572120736,0.0087629392107770997,0.0097495864255658284,0.010798560183325295,0.011908866086719512,0.013079118755674725,0.014307559888349629,0.015592079056628577,0.016930236669639533,0.018319288604515777,0.019756212066292422,0.021237732295578935,0.022760349792368753,0.024320367767130605,0.025913919566942785,0.027536995855927237,0.029185471356657524,0.030855130983444334,0.032541695220109725,0.034240844614458608,0.035948243279276794,0.037659561305110827,0.039370496002562365,0.041076791899742594,0.042774259420758715,0.044458792158050944,0.046126382615454979,0.047773136224361419,0.04939528329795953,0.050989188352744949,0.052551355843852884,0.054078430771341987,0.055567191753551362,0.057014532977672207,0.058417429913501011,0.059772881884187806,0.06107782273627807,0.062328989343435552,0.063522737147181013,0.064654793231769231,0.065719941508404919,0.066711642299073809,0.067621600377470933,0.068439310932161559,0.069151630396202132,0.069742435802607514,0.07019244844141187,0.070479300982625434,0.070577918508139353,0.07046126152553725,0.070101444095931373,0.0694711965288307,0.068545595665603171,0.067303943558374185,0.065731643926112443,0.063821910110926985,0.061577140988263085,0.059009822434708342,0.05614284916494041,0.053009210758798421,0.049651041012580333,0.046118085334173463,0.042465690893674475,0.038752463578353297,0.035037760755648448,0.031379197395483574,0.027830335086147198,0.024438700544572707,0.021244245545801291,0.018278318018625218,0.01556316911487365,0.013111978002826834,0.010929338972033102,0.0090121271356364378,0.0073506412658554086,0.005929915459467053,0.0047310945624270961],[0.00013994112174217624,0.00018429197981499921,0.00024041415962057486,0.0003107215269566488,0.0003979319500611841,0.00050506147892724748,0.00063540813073231881,0.00079252463172632714,0.00098018001275051504,0.0012023105620367846,0.0014629612579389949,0.001766219383530482,0.0021161425130153308,0.0025166834119588919,0.0029716145772499614,0.0034844551429428937,0.0040584026978872896,0.0046962722217564886,0.0054004438844007336,0.006172820916286079,0.0070147981960698306,0.0079272416636564109,0.0089104781939394872,0.0099642951864957179,0.011087948854604729,0.012280180034533955,0.013539236273178526,0.014862898971124512,0.016248514437204955,0.01769302782739585,0.019193019075586362,0.020744740060639869,0.022344152382361728,0.023986965232262895,0.025668672940939212,0.027384591862788195,0.029129896322621768,0.030899653400177345,0.032688856370317973,0.034492456651245902,0.036305394142220088,0.038122625857429163,0.039939152784681006,0.041750044916865049,0.043550464420698244,0.045335686920524566,0.047101120883497584,0.048842325093554739,0.050555024190096866,0.052235122214393782,0.053878714037902335,0.055482094419130629,0.05704176421579274,0.058554432920438042,0.060017016132161947,0.061426625759890982,0.06278054961796746,0.064076215601519326,0.065311133873197619,0.066482808640638213,0.067588609529412175,0.068625591861649543,0.069590256160879493,0.070478240877374795,0.071283949554966558,0.072000124940651167,0.072617397592393634,0.073123853952708928,0.073504685918174675,0.073741996855528499,0.073814843573920291,0.073699586347822546,0.073370597837906948,0.072801347448237089,0.071965833934243773,0.070840291930704194,0.069405054669708324,0.067646422393045316,0.065558369129973065,0.063143922464979324,0.060416071784096068,0.057398097860573274,0.054123266134009994,0.050633881987240524,0.046979762546930315,0.043216230047447908,0.03940177147821361,0.035595534337499651,0.03185483683344098,0.028232862688274022,0.024776687513049105,0.021525748752167919,0.018510828736540929,0.015753575206667706,0.013266540440666132,0.011053682869992847,0.0091112467558523182,0.0074289178116916481,0.0059911459369676673,0.00477852961444045],[0.0001916658815802811,0.00025172105604172004,0.00032745042472357946,0.00042197546829525202,0.0005387809871104873,0.00068169793422982565,0.00085487197417029055,0.0010627173081608622,0.001309856115187392,0.0016010448227425469,0.0019410892704232769,0.0023347515871052524,0.0027866521962624639,0.0033011707351319284,0.0038823497838857499,0.0045338051391791978,0.005258645949121306,0.0060594073969654711,0.006937997842501601,0.007895661479424141,0.0089329567224279635,0.010049749770632133,0.011245222159840354,0.012517890650073187,0.013865637509226978,0.015285749140294042,0.016774961033600235,0.018329507171941609,0.019945172236441294,0.021617345217376367,0.023341073296163851,0.025111115109506921,0.026921992720548765,0.028768041798772515,0.030643459650361041,0.032542350847731043,0.034458770286874066,0.036386763560263005,0.038320404577119709,0.040253830396385276,0.042181273264171697,0.044097089869063813,0.045995787846755343,0.047872049580812759,0.049720753358980047,0.051536991953901198,0.05331608870220355,0.055053611154059066,0.056745382352035682,0.058387489765264554,0.059976291839394673,0.061508422003498063,0.06298078977073332,0.064390578236567561,0.065735236760935151,0.067012466855809069,0.06822019822982972,0.06935655053959941,0.070419774704750984,0.071408165823432554,0.072319938116687771,0.073153051496754468,0.073904980083156865,0.074572416220493293,0.075150910189597214,0.07563445642091729,0.076015051466453334,0.076282266024352424,0.076422890408805802,0.076420726342474987,0.076256603594187719,0.07590869401759677,0.075353175816660858,0.074565267801756013,0.073520610378306608,0.072196922905420347,0.070575823114439717,0.068644660589785841,0.066398198451536924,0.063839978417896265,0.060983224609290489,0.057851178393784328,0.054476805814529176,0.050901874928888015,0.047175456463805852,0.04335195153452371,0.039488789660815364,0.035643965233603588,0.031873588973184652,0.028229622702984115,0.02475794266547619,0.021496841860728418,0.018476039764290544,0.015716223022986614,0.01322909795938737,0.011017898914505015,0.0090782685493296482,0.0073994088553785992,0.005965395116992552,0.004756548556677561],[0.00025950064816834134,0.00033989311785279796,0.00044091567029765414,0.0005665540395616552,0.00072121829535670213,0.00090970853061296281,0.0011371614461065747,0.0014089777977546317,0.0017307318315890263,0.0021080650290514376,0.0025465676157087726,0.0030516522415384795,0.0036284249225736398,0.0042815586670211774,0.0050151751528120367,0.0058327393770989085,0.0067369714022858388,0.0077297782556270721,0.0088122078053797358,0.0099844251546219107,0.011245710881083223,0.012594479408327596,0.014028314993344157,0.015544022296736537,0.017137688267650587,0.01880475209866667,0.020540080235575124,0.022338043800225259,0.024192596236417611,0.026097349460756092,0.028045647246824686,0.030030634961686255,0.032045325093270273,0.034082658253066465,0.036135559516970506,0.038196990089526324,0.040259994356332547,0.042317742438509783,0.044363568392278119,0.046391004213670567,0.048393809818500652,0.050365999174120629,0.052301862763928418,0.054195986568655846,0.056043267750139548,0.057838927222929076,0.059578519295440432,0.06125793855306759,0.062873424136557096,0.064421561532818097,0.065899281930195022,0.067303859077019565,0.068632903392308736,0.069884352770417671,0.071056459044900933,0.072147768370292562,0.073157092786530695,0.074083468917025733,0.074926098146401679,0.075684260865927444,0.076357195767056379,0.076943934221595428,0.077443080248903506,0.077852529338134913,0.078169125370229325,0.078388264694748563,0.078503470035143866,0.078505973271154925,0.078384362968314136,0.078124366303932297,0.077708841631219716,0.077118053472704437,0.076330283842306654,0.075322802539584482,0.07407317746209581,0.072560859682960041,0.070768934217888088,0.068685893264523706,0.06630726999787491,0.063636971028383713,0.060688164761030589,0.057483618810325016,0.054055427884089048,0.05044412838252775,0.046697251110773649,0.042867412991180597,0.039010087429196247,0.035181217399703493,0.031434843487605939,0.027820911004211999,0.024383397638386348,0.021158869080705332,0.018175528876280957,0.015452785061388386,0.013001314436800106,0.010823569500307204,0.0089146459441369289,0.0072634118096674685,0.0058537931817430715,0.0046661148369972431],[0.00034733491804393333,0.00045373102635557828,0.00058696872133482542,0.00075207336069076124,0.00095455329405451362,0.0012003408370382029,0.0014957082972206527,0.0018471597886847455,0.0022613011892822694,0.0027446922095037247,0.0033036860025003798,0.0039442629016834835,0.0046718655959389621,0.0054912432515759751,0.0064063117256696828,0.0074200361083947893,0.0085343404627516786,0.009750047929906084,0.011066852502705204,0.012483321917307841,0.013996929441750112,0.015604110988099468,0.017300343032459715,0.019080236330883613,0.020937640352037729,0.022865753647127882,0.024857235951445216,0.026904318553640623,0.028998910274946037,0.03113269718332146,0.033297234863095729,0.035484032631843986,0.037684629530318682,0.039890662214819496,0.042093925073581895,0.044286422994589007,0.046460417257124631,0.048608465025669234,0.050723452909688257,0.052798625028432994,0.054827605993356864,0.056804419195849422,0.058723500766006152,0.060579709548975381,0.062368333428176499,0.064085092308096919,0.065726138051721672,0.067288051646476943,0.068767837843932436,0.070162917475903211,0.071471117582271981,0.072690659376746694,0.073820143899996082,0.074858534928364792,0.075805138272282704,0.076659575954540024,0.077421752848663317,0.078091812145828957,0.078670074521717037,0.079156954206801383,0.079552843589945438,0.079857956969082017,0.080072124283099941,0.080194527965711027,0.080223381335777291,0.080155555837000167,0.079986177047890322,0.079708224841165604,0.079312189318008278,0.078785847934211603,0.07811423658773807,0.077279884496314399,0.07626336687052708,0.075044200412616266,0.073602067158939716,0.071918307428150613,0.069977579618680785,0.067769550503318912,0.065290460370716369,0.062544406315504814,0.059544204730220006,0.056311728398918674,0.052877660173841295,0.049280658337999585,0.045565982246410904,0.041783674825528659,0.037986436064155714,0.034227345237786685,0.03055759747196013,0.027024412376557977,0.023669250579550688,0.020526441165486055,0.017622283345870023,0.01497464363781479,0.012593029751238617,0.010479088002778783,0.008627445106848897,0.0070267991539116415,0.0056611587449830469,0.0045111327672344532],[0.00045961829982201641,0.00059884141480007224,0.00077259041102107045,0.00098712204421398946,0.0012492267154801714,0.0015661351356566352,0.0019453931655590633,0.0023947068272199452,0.002921761681732621,0.003534022890965099,0.0042385241116511124,0.0050416547089837923,0.005948955456589764,0.0069649328047644756,0.0080929009216281367,0.0093348591016314975,0.010691409934917195,0.012161721049145122,0.013743530523724278,0.015433193495268886,0.017225765258179884,0.019115114496938989,0.021094059273417974,0.023154518056163594,0.025287668363108362,0.027484106375336687,0.029734002009103026,0.032027245235655602,0.03435358075558935,0.036702729339950634,0.039064495159678178,0.041428859197578972,0.043786059370709861,0.046126658311883555,0.048441599909616863,0.050722255734200548,0.052960462428682638,0.055148551054193397,0.057279369275728638,0.059346297173862937,0.061343257378417802,0.06326472014466461,0.065105703930531569,0.066861771982161644,0.068529025392136067,0.070104093056893732,0.071584118924567244,0.07296674688863071,0.074250103642465259,0.075432779759195046,0.076513809190374218,0.077492647271152876,0.078369147155416055,0.079143534349022077,0.079816378618718029,0.080388561975817716,0.080861240613572277,0.081235797577444979,0.081513781574637761,0.081696825775050566,0.08178653894726165,0.081784360218721194,0.081691368762037989,0.081508041574635232,0.081233957077711597,0.080867450182750641,0.080405235937749869,0.079842033198290668,0.079170235173435355,0.07837968722113095,0.077457640160376817,0.076388945857798735,0.075156548223406797,0.073742296422525583,0.072128070250869036,0.070297165080616258,0.068235842225423962,0.065934917031561791,0.0633912373787935,0.060608903152406093,0.057600093350226277,0.054385399781111655,0.050993610589262717,0.047460937559410887,0.04382973231408082,0.040146782414042903,0.036461314268684104,0.032822852301755794,0.029279091308886569,0.025873931431110289,0.022645804316235588,0.019626387835197188,0.016839769046061815,0.014302075219467719,0.012021554781088859,0.0099990575092454397,0.008228838815656208,0.0066995978534087012,0.0053956537807393424,0.0042981679501461643],[0.00060132302364656969,0.00078145999546687514,0.0010055057067561263,0.0012811526974030446,0.0016166624070912752,0.0020207256856620498,0.0025022836328709454,0.0030703126808302827,0.0037335807561988416,0.0045003840781148059,0.0053782763726351627,0.0063738037483465912,0.0074922589735496523,0.0087374683075406266,0.010111622365933489,0.011615159863942969,0.013246709716627017,0.015003093203098583,0.016879384092046857,0.018869021147733693,0.020963964609657687,0.023154886296653614,0.025431382042575341,0.027782195216752782,0.030195440995520482,0.03265882262268862,0.035159832870399643,0.037685936024386836,0.040224727736658597,0.042764071838571234,0.045292214582767262,0.047797877747772617,0.050270332616465969,0.052699457091394675,0.05507577821830608,0.057390502238992211,0.059635534059959278,0.061803487761499971,0.063887689520262261,0.065882174097943114,0.067781675866713534,0.069581615197226859,0.071278080921904297,0.072867809497418959,0.074348161419020828,0.075717095379741306,0.076973140614919014,0.078115367822855358,0.07914335900150761,0.080057176483346482,0.080857331377356789,0.081544751525387413,0.082120748929481749,0.082586986378256386,0.082945442654551213,0.08319837519547546,0.083348278349283281,0.083397834392712394,0.083349853235610061,0.083207195318149907,0.082972670789703357,0.082648907001034957,0.082238176185983294,0.081742176667700339,0.081161764783480903,0.080496641644806119,0.07974500908643567,0.078903222211463647,0.077965480280481517,0.076923610691379291,0.075767008990836271,0.074482797640331,0.073056254868714643,0.071471541508474429,0.069712719952115698,0.067765019621153375,0.06561626383653886,0.063258340489717874,0.060688579262405992,0.057910894997189294,0.054936571078454177,0.051784586522321839,0.048481431913292759,0.045060407050632634,0.041560441409341502,0.038024521829549005,0.034497845706226535,0.031025839195856136,0.027652187018935768,0.024417013393320437,0.021355334079790341,0.01849587028909893,0.015860279945855222,0.013462824530802631,0.011310454288174458,0.0094032642726353845,0.0077352509075152001,0.0062952847438450367,0.0050682101598678985,0.0040359860520234941],[0.00077786286053713823,0.0010083420993812263,0.0012940379147714566,0.0016442902943752343,0.002069018749210381,0.0025785224230617273,0.0031832318707886724,0.0038934191992921249,0.0047188770639255218,0.005668580412691024,0.0067503474834796099,0.0079705180420972278,0.0093336669501826348,0.010842369757063796,0.012497034165403311,0.014295807143223253,0.016234562511635152,0.018306968505456284,0.020504629610990782,0.02281729244203394,0.025233101946869081,0.027738892130504764,0.030320494838450722,0.032963050911334849,0.035651309954989781,0.038369907735301099,0.041103613402684577,0.043837541985610066,0.046557330534328797,0.049249278710027329,0.051900456378513565,0.054498781865620752,0.057033075033337953,0.059493089365099353,0.06186952695161977,0.064154039785717085,0.066339220222271927,0.068418582921324189,0.070386540118202154,0.072238371676018265,0.073970191074004071,0.075578908259129454,0.07706219012227479,0.078418419237638273,0.079646651411128769,0.080746572509552514,0.081718454979810742,0.082563114410541011,0.083281866432996871,0.083876484198251847,0.08434915659666771,0.084702447291642557,0.084939254505604467,0.085062771296721892,0.085076445765350228,0.084983940186982132,0.084789087437199123,0.084495842216011641,0.084108223485729536,0.083630243261358095,0.083065815591044243,0.082418638536370215,0.081692041680532332,0.080888792790745692,0.080010860459007474,0.0790591354819353,0.078033122718545442,0.076930626840892274,0.075747468501120616,0.074477279684798114,0.073111435277065734,0.07163917875395559,0.070047990691163894,0.068324228359810751,0.066454034328184947,0.064424475497467867,0.062224837065752034,0.059847964935613118,0.057291530710679037,0.054559089357953804,0.05166081190938266,0.048613802662389891,0.045441948515154998,0.042175292322150351,0.03884896701213085,0.03550176752172518,0.032174469114370878,0.028908020428106636,0.025741746187146253,0.022711688022680063,0.019849193788881152,0.017179838776320584,0.01472272971341935,0.012490208109326897,0.010487936887386785,0.00871532640692225,0.0071662350598861698,0.0058298668521459167,0.0046917839183692944,0.0037349550530184541],[0.00099496120306344035,0.0012865901053085418,0.0016468856145572641,0.0020870472706529942,0.0026188290983822867,0.0032542626044107298,0.0040053222395174696,0.0048835438925794407,0.0058996118147082218,0.0070629335190209065,0.0083812251562045692,0.0098601311949506974,0.01150290164623324,0.01331014746202598,0.015279690238929881,0.017406516319725215,0.019682838362459563,0.022098260123759685,0.024640033316742672,0.027293389643557302,0.030041927018345099,0.032868026926082199,0.035753279890682658,0.038678897980836478,0.041626096775224192,0.044576433702427629,0.047512094567338285,0.050416124807903973,0.05327260613327086,0.05606678237311595,0.058785140488468321,0.061415453786527602,0.063946794597573367,0.066369523234022954,0.068675259203594199,0.070856839612902942,0.072908268649528526,0.074824661085896069,0.076602181967532254,0.078237984046705178,0.079730144085497126,0.08107759884959756,0.082280081410817024,0.083338058240777085,0.084252667485239463,0.085025658740219834,0.085659334595763262,0.08615649416384083,0.086520378758433159,0.086754619844076813,0.086863189308071215,0.086850352031988501,0.086720620625685779,0.086478712020255935,0.086129505365571943,0.085678000305748722,0.085129274170411218,0.084488435885093194,0.083760573457618337,0.08295069077680875,0.082063628289839666,0.081103961154714035,0.080075868097705394,0.078982964995954905,0.077828099798371742,0.076613110394044545,0.075338554770360153,0.074003433061627447,0.072604932853913229,0.071138240424498803,0.069596468687125837,0.067970754386055723,0.066250569891268554,0.064424277534470067,0.062479927653451853,0.060406268595189758,0.058193902972294875,0.05583649540046929,0.053331918160135945,0.050683216378857435,0.047899284633668167,0.044995171014696592,0.041991959303528122,0.038916220341235361,0.035799064783419203,0.032674866451600684,0.029579754443236874,0.026549990338277013,0.023620352932156256,0.020822647052647768,0.018184436590602683,0.015728077330660242,0.01347009561878838,0.011420927726196833,0.0095850051994625755,0.0079611462621986887,0.0065431944304264042,0.005320833993769895,0.004280508050260934,0.0034063676985977079],[0.0012584632174875276,0.0016234122746003007,0.0020728167094725921,0.0026199400008738781,0.0032785267674675647,0.004062429532423922,0.0049851686053925103,0.0060594408642226875,0.0072965992391690057,0.0087061296362338485,0.010295155231519925,0.012067998990705873,0.014025833586474957,0.016166443542403503,0.018484117671673302,0.020969681251685968,0.023610667681558627,0.026391619570001062,0.029294500298569802,0.032299190010522498,0.035384035383538869,0.038526420839911556,0.041703330055300705,0.044891870418077566,0.048069738843997435,0.051215614255140311,0.05430946921769688,0.057332799900061238,0.060268779037469515,0.06310234059221391,0.065820207160734404,0.068410872015118238,0.070864547261448141,0.073173088326482796,0.075329903235508186,0.077329853257033287,0.079169149717037673,0.080845250280970005,0.082356756830011354,0.083703316215089946,0.084885524610995591,0.085904835848139113,0.086763473904682975,0.087464349640545239,0.088010981805181548,0.088407422325388646,0.088658185861498554,0.088768183602013273,0.088742661244085794,0.088587141077802453,0.088307368052485249,0.087909259646795204,0.087398859280152244,0.08678229287344992,0.086065727967359895,0.085255334504528726,0.08435724594111392,0.083377518740064119,0.082322087497785704,0.081196711992698414,0.08000691141594464,0.078757880154910989,0.077454379086845576,0.076100596877290691,0.074699977834382286,0.073255016995866382,0.071767029666845103,0.070235911479272869,0.068659915412152536,0.067035482459628759,0.06535717036376601,0.063617727255635886,0.061808351683527739,0.059919165993989207,0.057939906867238142,0.055860807642809054,0.053673616381236543,0.051372666778675954,0.048955901135678125,0.046425739135043255,0.043789694536441721,0.04106066301236546,0.038256835224849163,0.035401225615841268,0.032520844549693034,0.02964557496782869,0.02680684096597645,0.024036172204670674,0.021363773640371161,0.018817204846835786,0.016420258480327684,0.014192105444271904,0.012146747840001191,0.010292792888301235,0.0086335345724449942,0.007167307233932366,0.0058880585070036889,0.0047860787552214557,0.0038488206985816333,0.0030617455883225923],[0.0015740902160653379,0.0020258116557993889,0.0025802792198557963,0.0032530078506441719,0.0040598580791974051,0.0050165452252426334,0.0061380727539978299,0.0074381123940095942,0.0089283609725970669,0.010617909645725399,0.012512664464925674,0.014614857390903098,0.016922683575084339,0.019430093999803902,0.022126762816552226,0.024998236762180746,0.028026260992732852,0.031189262867740833,0.034462963979848722,0.037821082234075466,0.041236080896375961,0.044679920669722102,0.04812477393705817,0.051543666774319055,0.054911023236940887,0.05820309657863567,0.061398282238441619,0.064477316527808304,0.06742337213755846,0.070222066404289435,0.072861400649192221,0.075331649084448657,0.077625214262447617,0.079736463422352438,0.081661556963404255,0.083398277145752667,0.084945862341547523,0.086304849926356883,0.087476929268843734,0.088464805198521387,0.089272071702542893,0.0899030952982528,0.090362907431843928,0.090657105271270674,0.090791760328006219,0.090773334417469764,0.090608602531988894,0.090304582245869694,0.089868469299236378,0.089307579017596353,0.088629293218414132,0.087841012231920701,0.086950111613809195,0.085963903039180722,0.084889598720064935,0.083734278456213784,0.08250485807923541,0.081208057553531041,0.079850366337146858,0.078438002797080533,0.076976863590902805,0.07547245813271275,0.073929822833977893,0.072353410147921848,0.070746949039950963,0.069113276849485969,0.067454147942159426,0.065770032055366037,0.064059924211803468,0.062321197181390404,0.060549534675569443,0.058738986312289437,0.056882181605829259,0.054970728422255144,0.052995801688878089,0.050948902769768954,0.048822742656760003,0.046612177772550563,0.044315110383961021,0.041933259775909379,0.039472716852942548,0.036944212949454332,0.034363060718883016,0.031748757208833668,0.029124272339742741,0.026515075951474138,0.023947980071559793,0.021449887854310325,0.019046545696859839,0.016761390488526567,0.014614570967867831,0.012622202734536079,0.010795893095315159,0.0091425473108452497,0.0076644445159627364,0.0063595517681099686,0.0052220298797371178,0.004242875738520579,0.0034106428146540072,0.0027121839564100136],[0.0019471386606631014,0.0025002090563298173,0.0031769350250764319,0.0039952439953673674,0.0049731966168883633,0.0061283552014339861,0.0074770684058346245,0.0090337034507908323,0.010809865974169532,0.01281365407122982,0.015048996159180443,0.017515121259557769,0.020206204754878904,0.02311122277559572,0.026214034771867456,0.029493697682173328,0.03292499797409499,0.036479171457631597,0.040124766901221784,0.043828599610673091,0.047556736298494072,0.051275453202989256,0.054952115266315188,0.058555934365304423,0.062058577724125687,0.065434612051693195,0.068661782932958271,0.071721141070998543,0.074597036051053986,0.077277003835210897,0.079751576201685187,0.082014039287586424,0.084060165068250869,0.085887934935237775,0.087497269407704775,0.088889773149515183,0.090068500350083472,0.091037742394817878,0.09180283762356653,0.09237000172776258,0.092746176766923108,0.092938896674012519,0.092956167273033838,0.09280635910340751,0.092498111637152658,0.092040247733489941,0.091441697380271997,0.090711429921457559,0.089858394072977466,0.088891465096326158,0.087819398538388896,0.086650789961100511,0.085394040073533836,0.084057324633455624,0.082648568390066193,0.08117542217286472,0.079645241967016348,0.078065068426979564,0.0764416047506805,0.074781190174367185,0.073089765608426768,0.071372827244619796,0.069635363549312546,0.067881771244974493,0.066115747088251547,0.064340154909645328,0.062556871811740813,0.060766623669871768,0.058968827702000043,0.057161467810650582,0.05534103495676948,0.053502567897235745,0.051639827148092093,0.049745625656027082,0.047812323318059742,0.045832470812962378,0.043799564410993246,0.041708851695573382,0.039558112650294616,0.037348334520995292,0.035084203711150709,0.032774353196065538,0.03043132731124297,0.028071253903654749,0.025713242908634679,0.023378556802139148,0.021089619122348656,0.018868940359208317,0.016738045053099143,0.01471648005274521,0.012820972605774594,0.01106479004998507,0.0094573325409803462,0.008003968850896697,0.0067061050390219562,0.0055614586011870108,0.0045644978878061088,0.0037069988505466964,0.0029786686143268952,0.0023677874974735833],[0.0023821313063667423,0.0030520103360287586,0.0038691303253946484,0.0048539561987099161,0.0060267823263409114,0.007406935658224781,0.0090118889970723145,0.010856326507100642,0.012951213897229677,0.015302932788990704,0.017912541340632828,0.020775220373973537,0.02387995569452149,0.027209493309793213,0.030740585819013466,0.034444526975165868,0.038287949378627131,0.042233839747358781,0.046242709452839162,0.05027384687555933,0.054286573844982866,0.058241431390549096,0.062101229754735879,0.065831912789200975,0.06940320551479022,0.072789033472083986,0.075967721212754621,0.078921992906016328,0.081638809180933289,0.084109080368882316,0.086327297391745106,0.088291118447489603,0.09000094359012667,0.091459501663529841,0.09267146611972478,0.093643109049572071,0.094381996923177808,0.09489672734615566,0.095196703539131136,0.095291941984342599,0.095192908398149909,0.094910377518512556,0.094455312834219832,0.093838763104247741,0.09307177318396101,0.092165307224669965,0.091130182729205075,0.089977014242468067,0.088716165658049337,0.087357710256401738,0.085911397677725987,0.08438662708679627,0.082792425812225956,0.081137432736011386,0.079429885660143446,0.077677611768717403,0.07588802011466167,0.074068094767418768,0.072224386845642044,0.070363003130116578,0.068489588346279842,0.066609297621001498,0.06472675523195516,0.062845995847174374,0.060970385341561871,0.059102520347027794,0.05724410924151109,0.055395842388902043,0.053557265801027688,0.051726679177637389,0.049901085114029672,0.048076219373807107,0.046246690701029339,0.044406251392906423,0.042548206538652752,0.040665951656257547,0.038753608052651725,0.036806706169387186,0.034822853159805253,0.032802314901669898,0.030748446038417251,0.02866791417455997,0.026570684167455678,0.024469752629062182,0.022380647909955902,0.020320733768135802,0.018308373005320299,0.01636201881880768,0.014499305659344191,0.012736208123836166,0.011086326767558226,0.0095603452257810029,0.0081656855984000819,0.0069063707087534745,0.0057830845214299955,0.0047934072980407505,0.0039321911253482429,0.0031920348683472312,0.0025638154428394857,0.0020372341529863985],[0.0028824335967274394,0.0036851350314896815,0.0046613245978235377,0.0058340850556227921,0.007225919748281762,0.0088577651879722698,0.010747910331338787,0.012910877765322655,0.01535633394490413,0.018088103124457449,0.021103361222212166,0.024392080566149308,0.02793678400041532,0.031712647724499658,0.035687967891093381,0.039824978564781989,0.044080980853673332,0.048409717814597977,0.052762909902047406,0.057091853557831536,0.061348982441164171,0.065489297114585399,0.069471583911253798,0.073259365335454019,0.076821550011481249,0.080132776801992975,0.08317347220810585,0.085929659962027935,0.08839257508453012,0.090558140894976977,0.092426366871316709,0.094000719082264331,0.095287504947450252,0.096295302316224171,0.097034451128088409,0.097516615639845886,0.097754417228717236,0.097761132396679121,0.09755044763991659,0.097136261842417318,0.096532527211921793,0.095753120921822407,0.094811741081934325,0.09372182210654427,0.092496465793709876,0.091148385402984741,0.089689860723136838,0.08813270260099601,0.086488225714604197,0.084767228571898043,0.082979979841691129,0.081136210203882189,0.079245108954437746,0.077315324620557804,0.075354968826469512,0.073371622587559457,0.071372344082304237,0.069363676738469909,0.067351656157444761,0.065341813987572522,0.063339176371490002,0.061348254107446543,0.059373021318132276,0.057416879425216977,0.055482603864124472,0.053572272552939663,0.051687177917158302,0.049827728370345534,0.04799335035837124,0.046182407764655722,0.044392160549555415,0.042618787494220114,0.040857497288737568,0.039102746752344167,0.037348574348151135,0.035589042202507679,0.03381876265193233,0.032033468908544069,0.030230576969216705,0.028409680032004288,0.026572918844490648,0.024725181496170107,0.022874102676818893,0.021029852863009131,0.019204729345711428,0.017412580661769383,0.015668111543281592,0.013986125407694379,0.012380764974524172,0.010864808917551391,0.0094490743416444506,0.0081419626285155634,0.0069491714583935363,0.0058735803178677874,0.0049153021778880522,0.0040718816256437975,0.0033386105194369107,0.0027089267089377617,0.0021748595698660774,0.0017274876869352582],[0.0034498540699382314,0.0044015299959362705,0.0055555075551412527,0.006937515973504913,0.0085721793619192334,0.010481813614829742,0.012685130069407552,0.015195916746054196,0.01802178147739477,0.021163048894856904,0.024611903340207009,0.028351861219069831,0.03235763892739444,0.036595457118294476,0.041023790653790498,0.045594538943759276,0.050254556988095639,0.054947457011371804,0.059615567568894259,0.06420192414250267,0.068652164140002789,0.072916210078720053,0.076949646320470563,0.0807147244536323,0.084180966721537395,0.087325371718449493,0.090132257948845218,0.092592805466616371,0.094704371491979258,0.096469661844343385,0.097895836834682212,0.098993619719249429,0.099776460482086909,0.100259790392769,0.10046038603872008,0.10039584729507134,0.10008418308805359,0.099543492130818409,0.098791722702078297,0.097846495219142529,0.09672497288826859,0.095443768207527646,0.094018875845208932,0.092465624951146005,0.090798646035156583,0.089031849097132743,0.087178410760725661,0.085250768845447952,0.083260623221077662,0.081218942020945373,0.079135972420135994,0.077021255258276244,0.074883642829924241,0.07273131918760932,0.070571822300631915,0.06841206737634023,0.066258370564442171,0.064116472111984388,0.061991557802967848,0.059888277198686536,0.057810756810911065,0.055762605944036536,0.053746912639160212,0.051766227108741895,0.049822530489208226,0.04791718791681468,0.046050887079174291,0.044223566622280365,0.042434342978068543,0.040681448857407147,0.038962200973759471,0.037273017340420607,0.035609504418997219,0.033966630423485043,0.032338992784476467,0.030721175708920086,0.029108179555378751,0.027495889829262331,0.025881542714468391,0.024264138526742429,0.022644755644972859,0.02102672540668633,0.019415641962291161,0.017819198090646932,0.016246855995917332,0.014709378708645955,0.013218260913364067,0.011785106483814513,0.010421003117181936,0.0091359423097047854,0.0079383261872554376,0.0068345925130181432,0.0058289769178638479,0.0049234184929974655,0.004117602712241192,0.003409125342350309,0.0027937533501142179,0.0022657542380897584,0.0018182637695486482,0.0014436633777802071],[0.004084252665064598,0.0052006976538719789,0.0065506402690770574,0.0081624284354500434,0.010062653699842057,0.012274708304682025,0.014817253443352583,0.017702687677439825,0.020935719470135786,0.024512155269688102,0.028418012551086801,0.032629054530627311,0.037110819877328782,0.041819187922386425,0.046701480165860093,0.051698055945520571,0.056744318333282737,0.061773010232780166,0.066716654456557958,0.071509978488062828,0.076092166460345737,0.080408797637067569,0.084413360568166174,0.088068271687721897,0.091345371804020609,0.094225918508514889,0.096700131962373564,0.098766381636877967,0.10043011967098428,0.10170267165081071,0.10259998873826484,0.10314144867025783,0.10334877073052957,0.10324508521505801,0.10285417467730207,0.10219988498333143,0.10130569040269866,0.10019438891587601,0.098887900996155853,0.097407146097374567,0.095771974513494937,0.094001136840021093,0.09211227792793665,0.090121946318415289,0.088045613368629205,0.08589769857819278,0.083691599118527776,0.081439722443036794,0.079153521310846728,0.076843530756754874,0.074519406605324648,0.072189965133837838,0.069863223477104178,0.067546440351675688,0.065246156656440041,0.062968235470183084,0.060717900899102673,0.058499775111748115,0.056317912721374382,0.054175831430361351,0.05207653754886496,0.050022544678630286,0.048015883591070785,0.046058101253438601,0.044150247243963284,0.042292846652771519,0.04048586018428546,0.038728634668895763,0.037019850491255613,0.035357476216995046,0.033738744298045388,0.032160164223008297,0.030617589785648859,0.029106354347266813,0.027621481625487845,0.026157969986582392,0.024711136674436932,0.023276996833893521,0.021852642848377728,0.020436584426926831,0.019029010286595368,0.017631938354397275,0.016249232261848229,0.01488647582659316,0.013550712120986642,0.012250067557636104,0.010993292476060334,0.0097892568468539339,0.0086464423978425929,0.0075724707821576576,0.0065737019205833287,0.0056549282938697445,0.0048191808815964982,0.0040676518487458716,0.0033997290943261231,0.0028131293263526785,0.0023041100655154158,0.0018677372414594839,0.0014981838537526484,0.0011890362749354779],[0.0047831848139549766,0.0060792728950357592,0.0076421613436251168,0.0095027309047600456,0.011689324494187516,0.014226042268536288,0.017130957376834805,0.020414362079722657,0.024077170243856767,0.028109609100265595,0.032490328309181846,0.037186036588624155,0.042151745632648722,0.047331659536339596,0.05266069876691877,0.05806659545923859,0.063472446854807532,0.068799571593121861,0.073970484292377528,0.078911791161983352,0.083556815193309736,0.087847783540051669,0.091737449572038915,0.095190073350686438,0.098181741094353472,0.10070006008476678,0.10274331414469245,0.10431920112492972,0.10544329443189539,0.10613737443337712,0.10642776387770864,0.10634377755978382,0.10591636503850035,0.10517699140683889,0.10415676965964137,0.10288583264693775,0.10139291490534084,0.099705105161570773,0.097847728000823919,0.095844316253459697,0.093716641953761531,0.091484781313397739,0.089167196540838253,0.086780823605769858,0.084341159799631638,0.081862348179804797,0.079357257942640175,0.076837560782313727,0.074313803687085581,0.071795478670453106,0.069291089821450227,0.066808217901248815,0.064353582569859361,0.061933102215795142,0.059551951279000953,0.057214614887768883,0.054924940554218017,0.052686186570724852,0.050501066605347041,0.048371789799011841,0.046300095425528071,0.044287280913258391,0.042334221801334046,0.040441382108996497,0.038608813769200487,0.03683614438017991,0.03512255372108708,0.033466741362658987,0.031866890254136984,0.030320634151828812,0.028825039687629957,0.02737661603235924,0.025971365631413078,0.024604887597681185,0.023272540606418007,0.021969664717901956,0.020691852351049402,0.019435249174727547,0.018196857821634323,0.016974812769882074,0.015768594599245442,0.01457915636125655,0.013408943350236985,0.012261798768059481,0.011142759917757676,0.010057760916682415,0.0090132670532580804,0.0080158718507177557,0.007071890200604879,0.0061869796421186313,0.0053658174601131899,0.0046118545244429399,0.0039271586378812904,0.0033123515851067901,0.0027666359970191122,0.0022879013153673036,0.0018728930878352534,0.0015174268118611077,0.0012166265919287644,0.00096516977546480737],[0.0055416114638444976,0.0070306848739852268,0.0088216010441618305,0.010947631242786133,0.013438597743199237,0.016318887647234229,0.019605402516122691,0.023305576630700386,0.027415614167102569,0.031919101382286874,0.036786141493190191,0.041973136079618972,0.04742329803027092,0.053067929657327852,0.058828439814605768,0.0646190113204924,0.070349771233313957,0.075930268167566123,0.081273028719238749,0.086296953444825478,0.090930323732950985,0.095113223730206906,0.098799233001293882,0.10195631027387488,0.10456685924721172,0.10662703610054364,0.10814541740037707,0.10914119029567172,0.1096420501386528,0.10968199268232921,0.10929917040218728,0.10853394946399973,0.10742726140493042,0.10601929841347459,0.10434855941977622,0.10245122079836501,0.10036078299775479,0.098107933283497234,0.095720563584434967,0.093223888542132288,0.090640619233687936,0.087991159866017063,0.085293805900756789,0.082564931279958453,0.079819159180478771,0.077069515109222872,0.074327563584206932,0.071603530677791488,0.068906414854494752,0.066244088236462245,0.063623389963484739,0.061050212850215765,0.058529584158880189,0.056065741020249277,0.053662200835559747,0.051321826850219243,0.049046888976631564,0.046839119831263952,0.044699765818915972,0.042629632931937056,0.040629126732549738,0.038698285768324417,0.036836807474050104,0.035044065507746497,0.033319117556264904,0.031660703053158011,0.030067231106809797,0.028536760331108284,0.027066974201911127,0.02565515787439096,0.024298184735711322,0.022992522784334338,0.021734271547438837,0.020519239027490154,0.019343064707755105,0.018201388999371619,0.017090062312086422,0.016005379345106915,0.014944317697307689,0.013904755903880368,0.012885645503081458,0.011887115014637175,0.010910490314530848,0.0099582247579204086,0.0090337421398477471,0.0081412047721453537,0.0072852263990101779,0.0064705545578991599,0.0057017489384810945,0.0049828813375020417,0.0043172793320083733,0.0037073304226611088,0.0031543568954623862,0.0026585648095473406,0.0022190640763472148,0.0018339511531938687,0.0015004418505573502,0.0012150393585375644,0.00097372184469692827,0.00077213469672141109],[0.0063517051800273767,0.008044939466719395,0.010076344990452995,0.012481390098057758,0.015291059647120006,0.018529572212228798,0.022212054149647439,0.026342328672457945,0.030910996436130753,0.035893988355925603,0.041251758644551807,0.046929255176108908,0.052856756104776262,0.058951599274838257,0.065120759535863659,0.071264155465198514,0.077278498967936676,0.083061446531344743,0.088515776291045734,0.093553305283994762,0.098098278379644022,0.10209000335624367,0.10548457129179627,0.10825558107062806,0.1103938727007065,0.11190635682932086,0.11281409827833112,0.11314986213039856,0.11295535701816657,0.11227841020567998,0.11117028470196672,0.10968330507991905,0.10786890328230718,0.10577613692912796,0.10345067854229337,0.10093423097960381,0.098264295871007559,0.095474208688548834,0.092593354396629829,0.089647487840892895,0.086659098896708198,0.083647779959780594,0.080630569612985981,0.077622259444660183,0.07463566036111581,0.071681830521489714,0.068770269915538043,0.065909087470379865,0.063105146223996128,0.060364191180437329,0.05769096339359564,0.055089302854598649,0.052562241983896606,0.050112090965863644,0.047740515778204359,0.045448609510954426,0.043236957390893407,0.041105695785197759,0.039054565322098486,0.037082958116317781,0.035189958915546889,0.033374379798573529,0.031634787882389041,0.029969525384725814,0.028376721415275474,0.026854295129181849,0.02539995047138149,0.024011163747368856,0.022685166686949556,0.021418929421698964,0.020209149622787321,0.019052255535084661,0.017944431277208319,0.016881672037456483,0.015859874328352206,0.014874962249289286,0.013923045178059652,0.013000596338099522,0.012104636418698047,0.011232903010510794,0.010383985902060694,0.0095574105728579058,0.0087536572163502014,0.0079741095211597595,0.0072209351255702898,0.006496906986516773,0.0058051808884248546,0.0051490482830522481,0.0045316852804350707,0.003955917925490683,0.0034240211974895136,0.0029375649609506573,0.0024973149858261521,0.0021031917752762602,0.0017542848739249516,0.0014489160531116494,0.0011847416107325429,0.00095888214681520516,0.00076806758770838856,0.00060878580026845386],[0.0072027798700263594,0.0091085544966854042,0.011389584054016617,0.014083298080724128,0.017221497646582332,0.020827765292950707,0.024914858795215079,0.029482274068186771,0.0345141814644533,0.039977941824170346,0.045823390846530754,0.051983041549398874,0.058373296061799688,0.064896683639177055,0.071445057892575228,0.077903600917493376,0.08415540439877528,0.090086336815584866,0.09558986921457284,0.10057152489744066,0.10495264280635706,0.10867319879013548,0.11169350814294741,0.11399472866063529,0.1155781857329933,0.11646363863638207,0.11668668970091149,0.11629559674705252,0.11534777843272132,0.11390629997027264,0.11203659513613122,0.10980362543779118,0.10726960746269761,0.10449236507581794,0.10152429434532985,0.098411874074921885,0.09519561865433486,0.091910353911165893,0.08858569859307984,0.085246649397023755,0.081914190367659845,0.078605872544861413,0.075336332715868107,0.072117738466112538,0.06896015949682735,0.065871872706071838,0.062859611864196266,0.059928773163250348,0.057083586704865991,0.054327262064489491,0.051662114060920694,0.049089673110979802,0.046610783189525141,0.044225689442986445,0.041934116852621064,0.039735340924254028,0.037628251112064838,0.035611407499054733,0.033683091108723764,0.031841348080829543,0.030084027793768928,0.028408814856876432,0.026813254743816978,0.025294772727971957,0.02385068576679698,0.022478207136000697,0.021174444013908559,0.019936388925267445,0.018760906990918619,0.017644722233021919,0.016584407580323979,0.015576384407369883,0.014616938034679115,0.013702255206851584,0.012828487850868736,0.011991844336968692,0.011188705299568285,0.010415756457808409,0.0096701266815329597,0.0089495166930822646,0.0082523029843708014,0.0075776030645826739,0.0069252918566984744,0.0062959643285010755,0.0056908454138279215,0.005111654034324834,0.0045604327757334971,0.0040393579517250368,0.0035505461362656224,0.0030958727724069044,0.0026768164076443417,0.0022943388582242342,0.0019488076471485169,0.0016399628904373935,0.0013669268795029564,0.0011282512940696085,0.00092199453439212407,0.00074582021033617698,0.00059710737117706428,0.00047306350063989545],[0.0080813663188681866,0.010204672987789216,0.012740478441745537,0.015727906751782119,0.019199217553866155,0.023176903513106688,0.027670804117657027,0.032675449657933196,0.038167868428218565,0.044106089675567423,0.050428551314186498,0.057054573928082282,0.063885992912048578,0.070809953527111752,0.077702776658511399,0.084434705680915073,0.090875257559463976,0.096898834343124601,0.10239021307545838,0.10724952851847531,0.11139639585778523,0.11477288746293013,0.11734517252201723,0.11910374132128576,0.12006225525560374,0.12025517670174518,0.11973442775399251,0.11856539375228566,0.11682262009220368,0.11458554668405731,0.11193458577579463,0.10894778207677171,0.10569820908128892,0.10225216413603426,0.098668139309244632,0.094996475921771295,0.091279564607065641,0.087552432373801795,0.083843561233625158,0.080175803916596872,0.076567293617403928,0.073032279213247703,0.069581849061533099,0.066224531649659205,0.062966778639198875,0.059813345636060042,0.056767589832023631,0.053831703405919841,0.051006899035756531,0.048293560450700816,0.045691367558394355,0.043199402803124655,0.040816243211120866,0.038540041032954199,0.036368594878057846,0.034299412606064686,0.032329766860710346,0.030456743900295871,0.028677286221113221,0.026988229340595044,0.025386332980350642,0.023868306758009397,0.022430830368696312,0.02107056813529502,0.019784177770340763,0.018568313273921385,0.017419622150317969,0.016334737612386355,0.0153102671779922,0.014342780011155742,0.013428796403865179,0.012564783721508221,0.011747163657232362,0.010972335445928886,0.010236718528769641,0.0095368159544329256,0.0088692967257808734,0.0082310917977575625,0.0076194951579714029,0.0070322590867040345,0.0064676718752227358,0.0059246072608281257,0.0054025375205788593,0.0049015061171909973,0.0044220603522416666,0.0039651489336249394,0.0035319930719861291,0.0031239422361554131,0.0027423267999157033,0.0023883195019276694,0.0020628160983366447,0.0017663431199795962,0.0014989976263553922,0.0012604206620660768,0.001049803120341237,0.00086592018673962361,0.00070718866872942392,0.00057174040968041204,0.00045750464007084389,0.00036229245471585997],[0.0089714477688683115,0.011313369860695414,0.014104551948879357,0.017385529042173872,0.021188670713112184,0.025534966856588025,0.030430867085652347,0.035865416940050902,0.041807953183413835,0.048206616877457316,0.054987913149078201,0.062057489786088688,0.06930222539628754,0.076593617579723369,0.083792351150643637,0.090753816863311881,0.097334254285753721,0.10339711986848386,0.10881924227866593,0.11349632773495795,0.11734742006463804,0.12031800045727407,0.12238152285879769,0.12353931144274662,0.12381888310802899,0.12327088629227248,0.1219649543527393,0.1199848466545273,0.11742328631516727,0.11437689774159221,0.11094160187031589,0.10720874915784503,0.10326217049425722,0.099176217553507792,0.095014760680446453,0.090831026929486899,0.086668102511275338,0.082559896809451444,0.078532367874338496,0.074604835688707224,0.070791250436949837,0.067101328839909949,0.063541514217883913,0.060115749995645354,0.056826079647869045,0.053673098969305937,0.0506562910527645,0.047774273138150448,0.045024980119474735,0.042405803978128487,0.039913703072909375,0.037545290753217976,0.035296909396037655,0.033164693636304081,0.031144625063808655,0.029232579764428203,0.027424369580374221,0.025715777692255717,0.024102588973808368,0.022580615468699865,0.021145717249730675,0.019793818828358262,0.018520921187939941,0.017323109432596798,0.01619655600297756,0.015137519448994332,0.014142338912138548,0.013207424796562657,0.012329246619365677,0.011504319707616652,0.010729193174972092,0.010000442317309774,0.0093146690064314485,0.0086685135992111157,0.0080586811184774378,0.0074819829175231225,0.0069353928108848873,0.0064161140472639702,0.005921650993166226,0.0054498775288290696,0.0049990933921568066,0.0045680602908232774,0.00415601150294952,0.003762631596815533,0.0033880063280443589,0.003032546164202734,0.0026968897436537289,0.0023817955395803538,0.0020880308905537191,0.0018162673688377892,0.001566990322604999,0.0013404285827007451,0.0011365080545201515,0.00095483051574240271,0.00079467667937245599,0.00065503067438223259,0.00053462169005037913,0.00043197769678460734,0.00034548589593161441,0.00027345480311810903],[0.0098548596444478186,0.012412155220748147,0.015454317746659264,0.019023007586734201,0.023150385399654395,0.027855593286918476,0.033141330572543141,0.038990796825040495,0.045365293437072574,0.052202768048605193,0.05941754967490321,0.066901455971320509,0.074526360641713627,0.08214819532187416,0.089612236407770537,0.096759405678348412,0.10343320757128963,0.10948684827550666,0.11479004264003402,0.11923502057635658,0.12274129651938169,0.12525885966700881,0.12676957023383872,0.12728669499771703,0.12685266878874454,0.12553531155138517,0.1234228488246172,0.12061816550804227,0.11723276131688694,0.11338086886268423,0.10917414424664003,0.10471725247468637,0.10010455691113758,0.095417997277610758,0.090726119612837247,0.08608411869914874,0.081534680317854102,0.077109373824607558,0.072830345132028171,0.068712090324236211,0.064763140467456126,0.06098754669361562,0.057386110437799377,0.053957349134379856,0.05069821907077815,0.047604634441271894,0.044671827392108621,0.041894591580284482,0.039267445052093349,0.036784739954415238,0.034440738633011031,0.032229669055386177,0.030145767544328253,0.028183313419841476,0.026336658016426085,0.024600249315137334,0.022968652789405641,0.021436568767351317,0.019998846494732721,0.018650495038734987,0.017386691147068794,0.016202784144250623,0.015094297903098552,0.01405692988428479,0.013086547210945794,0.012179179767936948,0.011331010420101912,0.010538362662675511,0.0097976863686559251,0.009105542774779974,0.0084585904003692571,0.0078535741219595973,0.0072873199842304883,0.0067567383424020381,0.0062588374493256198,0.0057907485434589489,0.0053497619118323915,0.0049333715000658643,0.0045393237591827441,0.0041656649587824886,0.0038107805175334594,0.0034734202178244621,0.0031527044847241164,0.0028481090124526389,0.0025594275546304388,0.0022867152384457284,0.0020302169325625823,0.0017902867119051658,0.0015673051727609891,0.0013616012472066081,0.0011733843463240265,0.0010026913033455891,0.00084935090682239204,0.00071296703263111006,0.00059291970389607643,0.00048838199118919135,0.0003983496210789709,0.00032167954237032737,0.00025713350580562389,0.00020342289900560949],[0.010711845912668041,0.013476663553915661,0.01676012088047512,0.020604730863189716,0.025042175741100396,0.030089497110131345,0.03574542387788239,0.041987139513239305,0.048767808054113924,0.056015167619592451,0.063631456911499726,0.071494864019910967,0.079462581426737816,0.087375424203585725,0.095063831403505841,0.10235493743718622,0.10908028560903316,0.11508367381949713,0.12022858371964987,0.12440465586494477,0.12753273564087889,0.12956812301488566,0.13050180317421969,0.13035960031132124,0.12919936629508802,0.12710647250003357,0.12418800120470802,0.12056612076146646,0.11637116889115566,0.11173495885433112,0.10678476686188838,0.10163836341366836,0.096400327514956155,0.091159744879868027,0.085989254798173639,0.080945290811891099,0.076069271160066149,0.071389445186261308,0.06692309432679508,0.0626788165697372,0.058658680936636808,0.054860109669963915,0.051277416504426153,0.047902988855544219,0.04472814399431687,0.041743713203805974,0.038940416124618286,0.03630908450693468,0.03384078521156457,0.03152688056487802,0.029359052827878818,0.02732931008026257,0.025429983750453435,0.023653723217752505,0.021993489939580391,0.020442551901620226,0.018994478388662115,0.017643134772188807,0.016382676962437882,0.015207545227059638,0.014112457153286346,0.013092399588547807,0.01214261942612292,0.011258613114607428,0.010436114779774507,0.0096710828784490922,0.0089596853833406598,0.0082982836511723782,0.0076834153712194804,0.0071117773265882301,0.0065802090965518135,0.0060856792191024307,0.0056252756171184179,0.0051962021459801642,0.0047957828292122945,0.0044214746436636171,0.004070888617092744,0.0037418176413059642,0.0034322680193984972,0.0031404906490008324,0.0028650071686391943,0.0026046265372117322,0.0023584484013560144,0.0021258510965526602,0.0019064639680356056,0.0017001255759786249,0.0015068309733361771,0.0013266723950744826,0.0011597782568688736,0.0010062553152918768,0.00086613826149682443,0.00073935003689525904,0.00062567493327382714,0.0005247452368609657,0.00043604094585817163,0.00035890105330542486,0.00029254412234629542,0.00023609542778127744,0.00018861779560947237,0.00014914340734598026],[0.01152175240447552,0.014481503850105753,0.017991166180412747,0.022093858446439123,0.026820580978891503,0.032186134331766821,0.038185219859268524,0.044789050784558873,0.051942819774280453,0.059564354532205301,0.067544242876357255,0.075747623066563241,0.084017718117085263,0.092181053246587707,0.10005414614515334,0.10745131566923044,0.11419313207294134,0.12011494591480192,0.12507489504607014,0.12896080628413611,0.13169548105130449,0.13323997650835948,0.13359465375483809,0.13279794627302874,0.13092298631925764,0.12807239571244111,0.12437168396341192,0.11996178856209484,0.11499133242910216,0.1096091606752177,0.10395765685869195,0.098167236266250152,0.092352282010130293,0.086608642709512851,0.081012663146738481,0.07562158666392646,0.070475064154458575,0.065597440241294491,0.061000468300105429,0.056686131006893861,0.052649303316133704,0.048880075853902825,0.045365642229841185,0.042091729312191635,0.039043605684561236,0.036206737039029532,0.033567170136493595,0.031111724374851536,0.028828058135331708,0.026704661425415981,0.024730810846536892,0.022896509826461135,0.021192427209155568,0.019609840600098807,0.018140586756296092,0.016777019078100888,0.01551197125012042,0.014338725779923549,0.013250986242892041,0.012242852241208991,0.01130879630558077,0.010443642155663473,0.0096425438736853671,0.0089009656409141814,0.0082146617548039952,0.0075796567076644788,0.0069922251893343853,0.0064488719990521744,0.0059463120318147197,0.0054814507456885184,0.0050513658025440767,0.0046532908636311657,0.0042846027451724231,0.0039428132116015313,0.0036255665201908554,0.0033306433747792032,0.0030559712014443831,0.0027996397078954389,0.0025599196913823254,0.0023352822254118794,0.002124414887494994,0.0019262317292763767,0.0017398742706963295,0.0015647018368221282,0.00140027087025161,0.0012463042173129386,0.0011026525840077714,0.000969251220281524,0.00084607532591733712,0.00073309766282436759,0.00063025145662836302,0.00053740097022060139,0.00045432125141390661,0.00038068761780222127,0.00031607455414438572,0.00025996294828977746,0.0002117540393258467,0.00017078812423085843,0.00013636596618340542,0.00010777094424623297],[0.012263825761218023,0.015401232147221259,0.019116684937385029,0.023453699692645765,0.028442469589911975,0.034095539200930107,0.040403702323420894,0.04733247799354396,0.054819534956426268,0.062773416660944784,0.071073862312216435,0.079573924830543069,0.08810395867407439,0.096477399130547342,0.10449809373605023,0.11196879254345707,0.1187002744576892,0.12452049776505994,0.12928312663630623,0.13287480858283351,0.13522066069405703,0.13628755809296453,0.13608499323703699,0.13466347158630609,0.13211060745369457,0.1285452633992569,0.1241102198552191,0.11896395601338602,0.11327216159744403,0.1071995815314867,0.10090272700460043,0.094523876794003286,0.088186654574456388,0.081993315254861129,0.076023720281261628,0.070335842007162377,0.064967523401095517,0.059939142505076093,0.05525679876061123,0.050915652634839451,0.046903105735915725,0.043201593459161969,0.039790859109126421,0.0366496699248288,0.0337570079706771,0.03109281557610697,0.028638395925088201,0.026376569558553241,0.024291674303696709,0.022369476675300971,0.020597042631712487,0.018962598077571561,0.017455396124586318,0.01606559893402806,0.014784176309789804,0.013602820164109649,0.012513872650438582,0.011510265438429045,0.010585467795668045,0.0097334415277324452,0.0089486012405708571,0.0082257787478342732,0.0075601907260793681,0.0069474089271952481,0.00638333240781889,0.0058641613528464314,0.0053863721781147993,0.0049466937175447106,0.0045420844489571267,0.0041697108975888679,0.0038269275701594786,0.0035112589901543259,0.0032203845826384771,0.0029521272358986831,0.0027044462869479468,0.0024754353948329001,0.0022633252746733861,0.0020664906159836602,0.0018834598072190469,0.0017129254796787376,0.0015537535163651134,0.0014049881545894877,0.0012658511812484209,0.0011357339271855017,0.0010141816898876289,0.00090087119069381016,0.00079558254324653085,0.00069816784805856616,0.00060851886149054541,0.00052653620114458252,0.00045210227757989604,0.00038505965224251096,0.00032519589901192921,0.00027223538002140834,0.00022583771488032556,0.00018560218900382319,0.00015107695343075849,0.00012177163523467021,9.7171903798623163e-05,7.6754606196922958e-05],[0.012918076612887665,0.016211396487038808,0.020107180868756035,0.024649176263315947,0.029866728225983626,0.035770241527878291,0.042346903506208955,0.04955704709902322,0.05733154516868294,0.065570606051025937,0.074144277816947976,0.082894865929147674,0.091641331345689761,0.10018557428352666,0.10832033775996011,0.11583830246212369,0.1225418089877415,0.12825255193783458,0.13282055558715972,0.13613176979084937,0.13811371707699602,0.13873876973087793,0.13802482463197194,0.13603335427696084,0.13286502297265626,0.12865324611936221,0.12355621938846309,0.11774804024404451,0.11140958010545056,0.10471974190250782,0.097847661530717084,0.090946294220170448,0.084147682272281282,0.077560043858210664,0.071266667565027197,0.065326456346034595,0.059775847924262583,0.054631755406494072,0.04989512898472262,0.045554741137754318,0.04159084251756099,0.037978415673778632,0.034689854342958355,0.031696999047029627,0.028972548227606785,0.026490926692958064,0.024228726094331521,0.022164838793007818,0.020280394423458237,0.018558586395881829,0.016984450899788114,0.01554463860171405,0.01422720160542424,0.013021405877778173,0.011917571607934527,0.010906939750332981,0.0099815611553575115,0.0091342042620665958,0.0083582776279668303,0.0076477641631317143,0.0069971645734550978,0.0064014480834079538,0.005856008962933301,0.0053566277277534852,0.0048994361374880436,0.0044808853077198778,0.0040977164065657797,0.0037469335464167916,0.0034257786251813494,0.0031317080289187563,0.0028623712790965712,0.0026155918796845908,0.0023893507648111317,0.00218177282844634,0.0019911169917835171,0.0018157700991335056,0.0016542446209966847,0.0015051797119770053,0.001367344689940381,0.001239643570040016,0.0011211190086710123,0.001010953970907562,0.00090846966450000002,0.00081311875732612688,0.00072447353257473572,0.00064220932433649096,0.00056608420004822994,0.00049591632208786528,0.00043156067328075916,0.0003728868563408665,0.00031975949765587308,0.00027202244902739309,0.00022948754787604204,0.00019192823010573976,0.000159077847084476,0.00013063216384721611,0.00010625523945803709,8.5587726554417601e-05,6.8256574948750466e-05,5.3885171307784889e-05],[0.013466158156581726,0.016889595934978012,0.020935686825326372,0.025648289382526474,0.031055945899397627,0.037167165417596432,0.043966003894682491,0.051408336823768302,0.059419233723018723,0.067891819219241797,0.076687937902079131,0.085640830383465233,0.094559882091805311,0.10323733563059595,0.11145667791347835,0.11900224353355753,0.12566943540952208,0.13127487030899662,0.13566572368563548,0.1387275823080022,0.14039021369561724,0.14063081983321332,0.13947454343986365,0.13699221755130833,0.13329557017681767,0.12853029265252031,0.12286753372542139,0.11649447774794013,0.10960469816197478,0.10238894774051331,0.095026962670897511,0.087680731497787504,0.08048952807994357,0.073566846399496316,0.066999219002254376,0.060846761798321977,0.055145174454826765,0.049908843645802586,0.045134650346878066,0.040806075209983785,0.036897228521384974,0.03337649964611087,0.030209615468286544,0.027362002870450059,0.024800449197892049,0.022494131956451127,0.020415136381233306,0.018538596687946881,0.016842589875278285,0.015307889080561502,0.013917655726191309,0.012657122800781111,0.011513299457253432,0.010474711013698611,0.009531178063975099,0.0086736325667260902,0.0078939661083502009,0.0071849048141148257,0.0065399057031142642,0.005953070048451972,0.0054190701662997984,0.0049330868440398438,0.0044907552641980609,0.0040881177815100247,0.0037215822861807143,0.0033878851670398886,0.0030840581036711149,0.0028073980926491887,0.0025554402700875231,0.0023259332442175473,0.0021168168027810596,0.0019262020058904196,0.001752353800635278,0.0015936763753047001,0.0014487014810145003,0.001316079863590469,0.0011945757603474107,0.0010830641404749417,0.00098053004738252029,0.00088606910242811055,0.00079888802572010843,0.00071830398234577634,0.00064374170096480289,0.00057472762374418914,0.00051088078026516879,0.00045190055638605938,0.00039755197024462786,0.00034764940366145436,0.00030203992624381227,0.00026058737932905542,0.00022315827173407594,0.00018961031201075889,0.00015978410531697853,0.00013349822165084041,0.000110547536173636,9.0704483235582196e-05,7.3722674435941187e-05,5.9342217425955341e-05,4.7296035836576303e-05,3.7316522987847582e-05],[0.013892207311532343,0.017416491043662222,0.02157895932919859,0.026423508547429676,0.031978000242673402,0.038249407535162372,0.045219285815940702,0.0528399776634184,0.061031975208503328,0.069682836050161512,0.078647977226850199,0.087753556530810031,0.096801498044508619,0.10557654114348428,0.11385500595315001,0.12141479293316389,0.12804599010258394,0.13356136662988069,0.1378059997372679,0.14066532006406571,0.14207096778204464,0.14200401865785789,0.1404953494759679,0.13762314408152479,0.13350777058778909,0.1283044634293877,0.12219440092859633,0.1153748658798941,0.10804920686410394,0.10041728300548367,0.09266698329751738,0.084967277554411302,0.07746309674420937,0.070272173706084087,0.063483816955582847,0.057159452724108044,0.051334661499112033,0.046022359130378949,0.041216730400769779,0.03689751496269629,0.033034271207063849,0.029590300913259499,0.026526000896481869,0.023801506861783808,0.021378594668942603,0.019221889825350582,0.017299495666513336,0.015583179830531403,0.014048260188543526,0.0126733133517304,0.011439800840903661,0.010331678255254655,0.0093350267591269416,0.0084377264160153866,0.0076291776000487052,0.0069000688925050149,0.0062421860433968697,0.0056482553179993955,0.0051118147260707358,0.0046271074715614167,0.0041889929937256494,0.0037928719517682724,0.003434622332931586,0.0031105445173659264,0.0028173136300843767,0.0025519378827144183,0.0023117218890072655,0.0020942341574432459,0.0018972781449916941,0.0017188664145705995,0.0015571975841292549,0.0014106358888347251,0.0012776932929082941,0.0011570141706789632,0.0010473626100468859,0.00094761236001344106,0.00085673934003878697,0.00077381646075958942,0.00069801029978470367,0.00062857897605899185,0.00056487042228570172,0.00050632021156960948,0.00045244817626984387,0.00040285326004813369,0.00035720633606256758,0.00031524105361553699,0.00027674308520069879,0.00024153838684848257,0.00020948122556476673,0.00018044275809996857,0.00015430087391574349,0.00013093186442666034,0.00011020428013062477,9.1975118310359325e-05,7.6088274716840795e-05,6.2375015134299004e-05,5.0656091571065655e-05,4.0745049855100466e-05,3.2452250387255499e-05,2.5589145720528677e-05],[0.014183595617524313,0.017776703500425033,0.022018538944490226,0.02695300010578823,0.032607455424178998,0.038987797161289396,0.046073838127984983,0.053815471565851682,0.062130026834387626,0.07090122472758327,0.079980061835532024,0.089187834361318163,0.098321354913499068,0.10716023339265822,0.11547590228580323,0.12304188757800689,0.1296446798021699,0.13509446409133574,0.13923493734564399,0.14195148174796759,0.14317707562605742,0.14289549543495683,0.14114157938448935,0.13799856157779131,0.1335927205613531,0.128085793695567,0.12166576825676685,0.11453675741222596,0.10690869765803609,0.098987565625788046,0.090966715418670074,0.083019797606772208,0.075295555786424856,0.067914624929882553,0.060968294493907803,0.054519061473677487,0.048602692469658114,0.043231442758209934,0.038398043994718779,0.03408006820638447,0.03024430131978121,0.026850811666584363,0.023856473596247776,0.021217796443708987,0.018893003825178931,0.016843394376990863,0.015034080569197162,0.01343424001336041,0.012017023501020027,0.010759251611199524,0.0096410060007215796,0.008645191263529103,0.00775711509256077,0.0069641120049328846,0.0062552201249065787,0.005620910811745484,0.005052865856573034,0.0045437950260755157,0.0040872866145419441,0.0036776844532519439,0.0033099859334701489,0.002979756705612457,0.0026830586776422443,0.0024163887085711317,0.002176625988266504,0.0019609865436613283,0.0017669836491388882,0.0015923931770926133,0.0014352231290245441,0.0012936867568476937,0.0011661788303425318,0.0010512547353529074,0.00094761219720732644,0.00085407550832124321,0.00076958218769245998,0.00069317200270511969,0.00062397823464908529,0.00056122097247426699,0.00050420209089649891,0.00045230143729159205,0.00040497365167510417,0.00036174500784101729,0.0003222097114926164,0.000286025223805244,0.00025290637690397505,0.00022261827679295829,0.00019496820931548745,0.00016979694015113221,0.00014696990684923787,0.00012636883052059871,0.00010788423204357332,9.1409237747150937e-05,7.6834923393256731e-05,6.4047295026566279e-05,5.2925860898811426e-05,4.3343625912368364e-05,3.5168249212804899e-05,2.8264051527866127e-05,2.2494541444175704e-05,1.7725144857111255e-05],[0.014331541195814821,0.017959547850097238,0.022241610783674478,0.027221621711200284,0.032926690327167454,0.039362150859951935,0.046506921521384886,0.05430964191103746,0.062686025805624268,0.071517837059096229,0.080653820490322714,0.089912798694438828,0.099088986537477691,0.10795939026453708,0.11629296503545537,0.12386102367653937,0.13044824147455228,0.13586350575827416,0.13994982880081897,0.14259258520887269,0.14372544909943596,0.14333358215056127,0.14145384370736927,0.13817203578913007,0.1336174338215613,0.12795506367204049,0.12137634637250798,0.11408882937519513,0.1063057507735336,0.098236142387522041,0.09007607824262033,0.082001531844927145,0.074163137246691227,0.066682974388063365,0.059653335941881346,0.053137294378129044,0.047170782689346581,0.041765833529879497,0.036914588562956797,0.032593689173933113,0.028768687179652516,0.025398165686269392,0.022437331553439976,0.019840926099192583,0.017565390918342218,0.015570309687043839,0.013819213319559919,0.012279877091107517,0.010924252570266342,0.0097281686233795205,0.0086709123371680533,0.0077347711491982619,0.0069045887693048608,0.0061673638172918552,0.0055119030277710904,0.0049285300456301676,0.0044088449640372531,0.0039455273099662617,0.0035321748083919032,0.0031631709503834567,0.0028335754996227785,0.0025390332264050566,0.0022756971823436902,0.002040163664341876,0.0018294166656835469,0.0016407801041103446,0.0014718764868410185,0.0013205909534209524,0.0011850398558336231,0.0010635432115345734,0.00095460051258963122,0.00085686950045054419,0.00076914762298522696,0.00069035597521407651,0.00061952558142072906,0.00055578589670102977,0.00049835538604666634,0.00044653398058614206,0.00039969712455173559,0.00035729103303431821,0.00031882870562187078,0.00028388621002930386,0.00025209878011893741,0.00022315636757288529,0.0001967984334789229,0.00017280794032321814,0.00015100467586616584,0.00013123817994477571,0.00011338063373734341,9.732010024254366e-05,8.2954477556382316e-05,7.0186454268408272e-05,5.8919654963491533e-05,4.9056050617187084e-05,4.0494599249427141e-05,3.3130988845599055e-05,2.6858285362641306e-05,2.1568247402216482e-05,1.7153055768038675e-05,1.350721744629011e-05],[0.014331541195814814,0.017959547850097232,0.022241610783674471,0.027221621711200277,0.032926690327167468,0.039362150859951942,0.046506921521384859,0.054309641911037473,0.062686025805624282,0.071517837059096201,0.080653820490322714,0.089912798694438814,0.099088986537477691,0.10795939026453712,0.11629296503545544,0.12386102367653935,0.13044824147455236,0.13586350575827416,0.13994982880081888,0.14259258520887275,0.14372544909943602,0.1433335821505613,0.14145384370736933,0.13817203578913004,0.1336174338215613,0.12795506367204046,0.12137634637250796,0.11408882937519507,0.10630575077353357,0.098236142387522069,0.090076078242620289,0.082001531844927159,0.074163137246691227,0.066682974388063365,0.059653335941881318,0.053137294378129057,0.047170782689346595,0.041765833529879497,0.036914588562956797,0.032593689173933106,0.028768687179652523,0.025398165686269382,0.022437331553439969,0.01984092609919258,0.017565390918342218,0.015570309687043832,0.013819213319559919,0.012279877091107524,0.010924252570266342,0.0097281686233795153,0.0086709123371680515,0.0077347711491982567,0.00690458876930486,0.0061673638172918578,0.0055119030277710913,0.004928530045630165,0.0044088449640372531,0.0039455273099662617,0.0035321748083919024,0.003163170950383458,0.0028335754996227794,0.0025390332264050575,0.0022756971823436906,0.0020401636643418764,0.0018294166656835475,0.0016407801041103448,0.0014718764868410182,0.0013205909534209526,0.0011850398558336231,0.0010635432115345736,0.00095460051258963079,0.00085686950045054386,0.00076914762298522707,0.00069035597521407608,0.00061952558142072949,0.00055578589670102977,0.00049835538604666612,0.00044653398058614179,0.00039969712455173553,0.00035729103303431821,0.00031882870562187121,0.00028388621002930375,0.00025209878011893741,0.00022315636757288529,0.00019679843347892285,0.00017280794032321816,0.00015100467586616579,0.00013123817994477565,0.00011338063373734338,9.7320100242543633e-05,8.295447755638233e-05,7.0186454268408272e-05,5.891965496349154e-05,4.905605061718709e-05,4.0494599249427121e-05,3.3130988845599048e-05,2.6858285362641302e-05,2.1568247402216485e-05,1.7153055768038675e-05,1.3507217446290113e-05],[0.014183595617524315,0.017776703500425029,0.02201853894449023,0.026953000105788237,0.032607455424178998,0.038987797161289396,0.046073838127984983,0.053815471565851675,0.062130026834387654,0.07090122472758327,0.079980061835532024,0.08918783436131815,0.098321354913499054,0.10716023339265816,0.1154759022858033,0.12304188757800685,0.12964467980216984,0.13509446409133571,0.13923493734564402,0.14195148174796759,0.14317707562605742,0.14289549543495683,0.14114157938448935,0.13799856157779131,0.13359272056135307,0.12808579369556705,0.12166576825676682,0.11453675741222605,0.10690869765803609,0.098987565625788115,0.090966715418670061,0.083019797606772208,0.075295555786424911,0.067914624929882511,0.06096829449390781,0.054519061473677514,0.048602692469658142,0.04323144275820992,0.038398043994718772,0.034080068206384484,0.030244301319781203,0.026850811666584373,0.023856473596247769,0.02121779644370899,0.018893003825178941,0.016843394376990874,0.015034080569197158,0.0134342400133604,0.012017023501020024,0.010759251611199519,0.0096410060007215831,0.0086451912635291048,0.0077571150925607691,0.0069641120049328898,0.0062552201249065787,0.0056209108117454849,0.0050528658565730331,0.0045437950260755157,0.0040872866145419432,0.0036776844532519452,0.0033099859334701476,0.0029797567056124561,0.002683058677642243,0.0024163887085711325,0.0021766259882665027,0.0019609865436613283,0.0017669836491388891,0.0015923931770926133,0.0014352231290245445,0.0012936867568476935,0.0011661788303425325,0.0010512547353529079,0.00094761219720732666,0.00085407550832124299,0.00076958218769245976,0.0006931720027051198,0.00062397823464908529,0.00056122097247426667,0.00050420209089649913,0.00045230143729159172,0.00040497365167510433,0.00036174500784101729,0.00032220971149261662,0.000286025223805244,0.000252906376903975,0.00022261827679295827,0.00019496820931548745,0.00016979694015113213,0.0001469699068492379,0.0001263688305205989,0.00010788423204357331,9.1409237747150978e-05,7.6834923393256745e-05,6.4047295026566293e-05,5.2925860898811446e-05,4.3343625912368371e-05,3.5168249212804899e-05,2.826405152786613e-05,2.2494541444175714e-05,1.7725144857111261e-05],[0.01389220731153234,0.017416491043662212,0.02157895932919859,0.026423508547429669,0.031978000242673416,0.038249407535162372,0.045219285815940667,0.052839977663418379,0.061031975208503321,0.069682836050161512,0.078647977226850199,0.087753556530810004,0.096801498044508605,0.10557654114348432,0.11385500595314998,0.12141479293316385,0.12804599010258391,0.13356136662988075,0.13780599973726793,0.14066532006406576,0.14207096778204464,0.14200401865785789,0.14049534947596798,0.13762314408152479,0.13350777058778912,0.12830446342938776,0.12219440092859639,0.11537486587989411,0.10804920686410392,0.10041728300548367,0.092666983297517352,0.084967277554411302,0.077463096744209384,0.070272173706084101,0.063483816955582847,0.057159452724108051,0.051334661499112026,0.046022359130378922,0.041216730400769758,0.036897514962696276,0.033034271207063842,0.029590300913259492,0.026526000896481862,0.023801506861783815,0.021378594668942597,0.019221889825350585,0.017299495666513339,0.015583179830531405,0.014048260188543518,0.012673313351730409,0.011439800840903661,0.010331678255254658,0.0093350267591269503,0.0084377264160153832,0.0076291776000487086,0.0069000688925050166,0.0062421860433968723,0.005648255317999399,0.0051118147260707358,0.0046271074715614176,0.0041889929937256485,0.0037928719517682724,0.0034346223329315855,0.003110544517365926,0.0028173136300843732,0.0025519378827144178,0.0023117218890072646,0.0020942341574432441,0.0018972781449916943,0.0017188664145706004,0.001557197584129256,0.0014106358888347247,0.0012776932929082947,0.0011570141706789634,0.0010473626100468863,0.00094761236001344128,0.00085673934003878676,0.00077381646075958964,0.00069801029978470324,0.00062857897605899196,0.00056487042228570193,0.00050632021156960959,0.00045244817626984371,0.00040285326004813374,0.00035720633606256736,0.00031524105361553694,0.00027674308520069879,0.00024153838684848244,0.00020948122556476662,0.00018044275809996857,0.00015430087391574347,0.00013093186442666031,0.0001102042801306248,9.1975118310359366e-05,7.6088274716840768e-05,6.2375015134299004e-05,5.0656091571065635e-05,4.0745049855100459e-05,3.2452250387255506e-05,2.5589145720528683e-05],[0.013466158156581733,0.016889595934978005,0.020935686825326358,0.025648289382526477,0.03105594589939762,0.037167165417596425,0.043966003894682512,0.051408336823768302,0.059419233723018723,0.067891819219241784,0.076687937902079117,0.085640830383465247,0.094559882091805297,0.10323733563059592,0.11145667791347835,0.11900224353355744,0.12566943540952213,0.13127487030899665,0.13566572368563548,0.13872758230800214,0.14039021369561724,0.14063081983321341,0.1394745434398636,0.13699221755130839,0.1332955701768177,0.12853029265252031,0.1228675337254214,0.11649447774794008,0.10960469816197481,0.10238894774051337,0.095026962670897566,0.08768073149778749,0.080489528079943515,0.07356684639949633,0.066999219002254348,0.060846761798322005,0.055145174454826723,0.049908843645802572,0.045134650346878073,0.040806075209983785,0.036897228521384981,0.033376499646110884,0.030209615468286544,0.027362002870450066,0.024800449197892059,0.022494131956451117,0.020415136381233316,0.018538596687946888,0.016842589875278292,0.0153078890805615,0.013917655726191308,0.012657122800781111,0.011513299457253436,0.010474711013698609,0.0095311780639750938,0.0086736325667260902,0.0078939661083502009,0.0071849048141148274,0.0065399057031142642,0.0059530700484519781,0.0054190701662997984,0.0049330868440398429,0.0044907552641980635,0.0040881177815100238,0.003721582286180713,0.0033878851670398886,0.0030840581036711149,0.0028073980926491895,0.0025554402700875244,0.0023259332442175469,0.00211681680278106,0.0019262020058904191,0.0017523538006352789,0.0015936763753047008,0.0014487014810145012,0.001316079863590469,0.0011945757603474109,0.0010830641404749423,0.00098053004738252072,0.00088606910242811088,0.00079888802572010843,0.00071830398234577655,0.0006437417009648031,0.00057472762374418925,0.0005108807802651689,0.00045190055638605917,0.00039755197024462786,0.00034764940366145436,0.00030203992624381232,0.00026058737932905531,0.00022315827173407591,0.00018961031201075894,0.00015978410531697853,0.00013349822165084044,0.00011054753617363603,9.070448323558225e-05,7.3722674435941214e-05,5.9342217425955335e-05,4.7296035836576317e-05,3.7316522987847609e-05],[0.012918076612887673,0.016211396487038812,0.020107180868756042,0.024649176263315954,0.02986672822598364,0.035770241527878291,0.042346903506208969,0.049557047099023248,0.057331545168682954,0.065570606051026006,0.074144277816948018,0.082894865929147715,0.091641331345689761,0.10018557428352673,0.10832033775996013,0.11583830246212368,0.12254180898774154,0.12825255193783455,0.13282055558715974,0.1361317697908494,0.13811371707699602,0.13873876973087798,0.13802482463197205,0.13603335427696087,0.13286502297265637,0.12865324611936221,0.12355621938846308,0.11774804024404452,0.11140958010545053,0.10471974190250778,0.097847661530716987,0.090946294220170407,0.084147682272281241,0.077560043858210595,0.07126666756502717,0.065326456346034581,0.059775847924262542,0.054631755406494044,0.049895128984722606,0.045554741137754255,0.041590842517560948,0.037978415673778569,0.034689854342958286,0.031696999047029578,0.028972548227606747,0.026490926692958022,0.024228726094331497,0.02216483879300778,0.02028039442345821,0.018558586395881795,0.016984450899788076,0.015544638601714027,0.014227201605424206,0.013021405877778143,0.011917571607934507,0.010906939750332951,0.0099815611553574924,0.0091342042620665732,0.0083582776279668147,0.0076477641631317013,0.0069971645734550805,0.0064014480834079417,0.0058560089629332828,0.0053566277277534722,0.0048994361374880349,0.0044808853077198682,0.0040977164065657701,0.0037469335464167825,0.0034257786251813411,0.0031317080289187476,0.0028623712790965634,0.0026155918796845843,0.002389350764811126,0.0021817728284463356,0.0019911169917835119,0.0018157700991335,0.0016542446209966805,0.0015051797119770018,0.0013673446899403778,0.0012396435700400125,0.0011211190086710089,0.0010109539709075585,0.00090846966449999731,0.00081311875732612417,0.00072447353257473388,0.0006422093243364889,0.0005660842000482281,0.00049591632208786408,0.00043156067328075791,0.00037288685634086541,0.00031975949765587205,0.00027202244902739233,0.00022948754787604136,0.0001919282301057393,0.0001590778470844756,0.00013063216384721573,0.00010625523945803685,8.5587726554417384e-05,6.825657494875029e-05,5.3885171307784761e-05],[0.012263825761218016,0.015401232147221257,0.019116684937385022,0.023453699692645769,0.028442469589911965,0.034095539200930093,0.040403702323420887,0.047332477993543925,0.054819534956426295,0.06277341666094477,0.071073862312216393,0.079573924830543083,0.08810395867407439,0.096477399130547287,0.10449809373605028,0.11196879254345708,0.11870027445768923,0.12452049776505994,0.1292831266363062,0.13287480858283349,0.13522066069405711,0.1362875580929645,0.13608499323703704,0.13466347158630612,0.13211060745369446,0.12854526339925681,0.1241102198552191,0.11896395601338607,0.11327216159744401,0.10719958153148668,0.10090272700460039,0.094523876794003273,0.088186654574456375,0.081993315254861115,0.076023720281261656,0.070335842007162475,0.064967523401095503,0.059939142505076079,0.055256798760611223,0.050915652634839471,0.046903105735915718,0.043201593459161969,0.039790859109126442,0.0366496699248288,0.0337570079706771,0.031092815576106988,0.028638395925088204,0.026376569558553241,0.02429167430369673,0.022369476675300971,0.020597042631712484,0.018962598077571561,0.017455396124586318,0.016065598934028071,0.014784176309789798,0.013602820164109646,0.01251387265043858,0.011510265438429047,0.010585467795668036,0.0097334415277324452,0.0089486012405708588,0.0082257787478342698,0.007560190726079369,0.0069474089271952472,0.0063833324078188805,0.0058641613528464297,0.0053863721781147993,0.0049466937175447097,0.0045420844489571267,0.0041697108975888679,0.0038269275701594782,0.0035112589901543276,0.0032203845826384767,0.0029521272358986874,0.0027044462869479477,0.002475435394832901,0.0022633252746733865,0.0020664906159836628,0.001883459807219048,0.0017129254796787378,0.0015537535163651134,0.0014049881545894866,0.0012658511812484209,0.0011357339271855023,0.0010141816898876291,0.0009008711906938106,0.00079558254324653107,0.00069816784805856659,0.00060851886149054541,0.00052653620114458252,0.0004521022775798961,0.00038505965224251113,0.00032519589901192932,0.0002722353800214084,0.00022583771488032562,0.00018560218900382324,0.00015107695343075857,0.00012177163523467025,9.7171903798623204e-05,7.6754606196923026e-05],[0.011521752404475522,0.014481503850105751,0.017991166180412743,0.022093858446439123,0.026820580978891499,0.032186134331766841,0.038185219859268517,0.044789050784558845,0.051942819774280474,0.059564354532205321,0.067544242876357283,0.075747623066563269,0.084017718117085249,0.092181053246587749,0.10005414614515334,0.10745131566923041,0.11419313207294135,0.12011494591480192,0.12507489504607017,0.1289608062841362,0.13169548105130455,0.1332399765083595,0.13359465375483809,0.13279794627302874,0.13092298631925769,0.12807239571244106,0.12437168396341197,0.11996178856209484,0.11499133242910213,0.10960916067521771,0.10395765685869197,0.098167236266250166,0.092352282010130307,0.086608642709512879,0.081012663146738467,0.075621586663926432,0.070475064154458533,0.065597440241294477,0.061000468300105394,0.056686131006893861,0.052649303316133669,0.048880075853902805,0.045365642229841172,0.042091729312191628,0.039043605684561222,0.036206737039029532,0.033567170136493581,0.031111724374851542,0.028828058135331725,0.026704661425415981,0.024730810846536905,0.022896509826461114,0.021192427209155575,0.019609840600098807,0.018140586756296106,0.016777019078100888,0.015511971250120426,0.014338725779923542,0.013250986242892043,0.012242852241208989,0.011308796305580765,0.010443642155663476,0.0096425438736853636,0.0089009656409141779,0.0082146617548039917,0.007579656707664478,0.0069922251893343905,0.0064488719990521744,0.005946312031814718,0.0054814507456885219,0.0050513658025440767,0.0046532908636311657,0.0042846027451724214,0.003942813211601533,0.0036255665201908572,0.0033306433747792058,0.0030559712014443866,0.0027996397078954402,0.0025599196913823272,0.0023352822254118786,0.002124414887494994,0.0019262317292763772,0.0017398742706963293,0.0015647018368221285,0.0014002708702516103,0.0012463042173129391,0.0011026525840077718,0.00096925122028152357,0.00084607532591733691,0.00073309766282436738,0.00063025145662836313,0.00053740097022060161,0.00045432125141390672,0.00038068761780222138,0.00031607455414438572,0.00025996294828977762,0.00021175403932584684,0.00017078812423085849,0.00013636596618340542,0.00010777094424623306],[0.010711845912668038,0.013476663553915665,0.016760120880475127,0.020604730863189723,0.025042175741100389,0.030089497110131362,0.035745423877882397,0.041987139513239291,0.048767808054113924,0.056015167619592438,0.063631456911499754,0.071494864019910995,0.079462581426737844,0.087375424203585683,0.095063831403505814,0.10235493743718622,0.1090802856090332,0.11508367381949709,0.12022858371964985,0.12440465586494483,0.12753273564087883,0.12956812301488563,0.13050180317421972,0.13035960031132124,0.12919936629508802,0.12710647250003357,0.12418800120470792,0.12056612076146644,0.11637116889115566,0.11173495885433116,0.10678476686188834,0.10163836341366832,0.096400327514956141,0.09115974487986804,0.085989254798173667,0.080945290811891085,0.076069271160066135,0.071389445186261238,0.066923094326795024,0.062678816569737228,0.058658680936636821,0.054860109669963915,0.051277416504426125,0.047902988855544233,0.04472814399431687,0.041743713203805974,0.038940416124618286,0.036309084506934673,0.033840785211564577,0.031526880564878026,0.029359052827878825,0.027329310080262577,0.025429983750453435,0.023653723217752498,0.021993489939580387,0.020442551901620212,0.018994478388662115,0.017643134772188793,0.016382676962437885,0.015207545227059634,0.014112457153286342,0.013092399588547811,0.012142619426122917,0.011258613114607432,0.010436114779774505,0.009671082878449087,0.008959685383340658,0.0082982836511723765,0.0076834153712194795,0.0071117773265882336,0.0065802090965518117,0.0060856792191024333,0.0056252756171184179,0.005196202145980165,0.0047957828292122971,0.0044214746436636171,0.0040708886170927458,0.0037418176413059655,0.0034322680193984976,0.0031404906490008319,0.0028650071686391961,0.0026046265372117313,0.0023584484013560135,0.002125851096552661,0.001906463968035605,0.0017001255759786253,0.0015068309733361764,0.001326672395074483,0.0011597782568688738,0.0010062553152918772,0.00086613826149682476,0.00073935003689525926,0.00062567493327382725,0.00052474523686096613,0.00043604094585817174,0.00035890105330542492,0.00029254412234629563,0.00023609542778127752,0.00018861779560947246,0.0001491434073459804],[0.0098548596444478307,0.012412155220748152,0.015454317746659276,0.019023007586734208,0.023150385399654406,0.027855593286918487,0.033141330572543155,0.038990796825040509,0.045365293437072601,0.052202768048605186,0.059417549674903265,0.066901455971320523,0.07452636064171371,0.082148195321874201,0.089612236407770537,0.096759405678348495,0.10343320757128974,0.10948684827550671,0.11479004264003412,0.11923502057635665,0.12274129651938175,0.12525885966700884,0.12676957023383864,0.12728669499771711,0.1268526687887446,0.12553531155138509,0.1234228488246172,0.12061816550804225,0.11723276131688698,0.11338086886268425,0.10917414424664004,0.10471725247468631,0.10010455691113752,0.09541799727761073,0.090726119612837122,0.086084118699148712,0.081534680317854061,0.077109373824607516,0.072830345132028157,0.068712090324236155,0.064763140467456098,0.060987546693615557,0.057386110437799322,0.053957349134379821,0.050698219070778074,0.047604634441271866,0.044671827392108593,0.041894591580284433,0.039267445052093307,0.03678473995441521,0.034440738633010982,0.032229669055386136,0.030145767544328201,0.028183313419841424,0.026336658016426057,0.024600249315137306,0.022968652789405585,0.021436568767351279,0.019998846494732683,0.018650495038734959,0.017386691147068763,0.016202784144250578,0.015094297903098523,0.014056929884284766,0.013086547210945763,0.012179179767936926,0.011331010420101885,0.010538362662675495,0.0097976863686559112,0.0091055427747799567,0.0084585904003692414,0.0078535741219595816,0.007287319984230471,0.0067567383424020199,0.0062588374493256068,0.005790748543458942,0.0053497619118323802,0.0049333715000658522,0.0045393237591827337,0.0041656649587824791,0.0038107805175334481,0.0034734202178244539,0.0031527044847241082,0.0028481090124526311,0.002559427554630431,0.0022867152384457227,0.0020302169325625767,0.0017902867119051603,0.0015673051727609845,0.0013616012472066042,0.0011733843463240237,0.0010026913033455867,0.00084935090682239009,0.00071296703263110833,0.00059291970389607502,0.00048838199118918994,0.00039834962107897025,0.0003216795423703265,0.00025713350580562313,0.000203422899005609],[0.0089714477688683115,0.01131336986069542,0.014104551948879352,0.017385529042173869,0.021188670713112187,0.025534966856588022,0.03043086708565235,0.035865416940050923,0.041807953183413828,0.048206616877457302,0.054987913149078228,0.062057489786088695,0.06930222539628754,0.076593617579723369,0.083792351150643624,0.090753816863311979,0.097334254285753721,0.10339711986848378,0.10881924227866595,0.11349632773495796,0.11734742006463807,0.12031800045727406,0.12238152285879762,0.1235393114427466,0.12381888310802899,0.12327088629227249,0.12196495435273924,0.11998484665452733,0.11742328631516727,0.11437689774159217,0.11094160187031592,0.10720874915784499,0.10326217049425719,0.099176217553507778,0.095014760680446481,0.090831026929486858,0.086668102511275324,0.082559896809451458,0.07853236787433851,0.074604835688707197,0.07079125043694981,0.067101328839909949,0.063541514217883871,0.060115749995645333,0.056826079647869066,0.053673098969305923,0.050656291052764479,0.047774273138150504,0.045024980119474742,0.042405803978128466,0.039913703072909389,0.037545290753217983,0.035296909396037669,0.033164693636304074,0.031144625063808641,0.029232579764428179,0.027424369580374218,0.025715777692255717,0.024102588973808393,0.022580615468699862,0.021145717249730672,0.019793818828358244,0.018520921187939954,0.017323109432596791,0.016196556002977567,0.015137519448994335,0.014142338912138546,0.013207424796562655,0.012329246619365688,0.011504319707616652,0.01072919317497209,0.010000442317309777,0.0093146690064314502,0.0086685135992111157,0.0080586811184774464,0.0074819829175231251,0.006935392810884889,0.0064161140472639719,0.0059216509931662303,0.0054498775288290679,0.0049990933921568084,0.0045680602908232766,0.0041560115029495208,0.0037626315968155321,0.0033880063280443567,0.0030325461642027353,0.0026968897436537294,0.0023817955395803543,0.0020880308905537191,0.0018162673688377892,0.0015669903226049988,0.0013404285827007454,0.0011365080545201519,0.00095483051574240293,0.0007946766793724561,0.00065503067438223248,0.00053462169005037957,0.00043197769678460744,0.00034548589593161468,0.00027345480311810919],[0.0080813663188681883,0.010204672987789216,0.012740478441745541,0.015727906751782116,0.019199217553866166,0.023176903513106695,0.027670804117657027,0.032675449657933182,0.038167868428218565,0.044106089675567395,0.050428551314186477,0.057054573928082282,0.063885992912048606,0.070809953527111766,0.077702776658511413,0.084434705680915045,0.090875257559463948,0.096898834343124546,0.1023902130754584,0.1072495285184753,0.11139639585778525,0.11477288746293016,0.11734517252201718,0.11910374132128577,0.12006225525560377,0.12025517670174517,0.11973442775399254,0.11856539375228567,0.11682262009220371,0.11458554668405728,0.11193458577579461,0.10894778207677169,0.10569820908128894,0.10225216413603427,0.098668139309244562,0.094996475921771226,0.091279564607065614,0.087552432373801739,0.08384356123362513,0.080175803916596858,0.076567293617403942,0.073032279213247675,0.069581849061533085,0.066224531649659232,0.062966778639198903,0.05981334563606007,0.056767589832023638,0.053831703405919862,0.051006899035756538,0.048293560450700809,0.045691367558394327,0.043199402803124641,0.040816243211120859,0.038540041032954192,0.036368594878057818,0.034299412606064672,0.032329766860710339,0.030456743900295864,0.028677286221113221,0.026988229340595044,0.025386332980350649,0.023868306758009415,0.022430830368696319,0.021070568135295044,0.01978417777034077,0.018568313273921389,0.017419622150317966,0.016334737612386359,0.015310267177992198,0.014342780011155749,0.013428796403865182,0.012564783721508217,0.011747163657232365,0.010972335445928884,0.010236718528769647,0.0095368159544329291,0.0088692967257808682,0.0082310917977575677,0.0076194951579714064,0.0070322590867040319,0.0064676718752227349,0.0059246072608281223,0.0054025375205788585,0.0049015061171909964,0.0044220603522416666,0.0039651489336249386,0.0035319930719861273,0.0031239422361554131,0.0027423267999157033,0.0023883195019276681,0.0020628160983366456,0.0017663431199795958,0.0014989976263553929,0.0012604206620660773,0.0010498031203412374,0.00086592018673962404,0.00070718866872942392,0.00057174040968041226,0.000457504640070844,0.00036229245471586024],[0.0072027798700263585,0.0091085544966854025,0.011389584054016624,0.014083298080724119,0.017221497646582332,0.02082776529295071,0.024914858795215086,0.029482274068186758,0.034514181464453293,0.039977941824170339,0.045823390846530754,0.051983041549398902,0.058373296061799675,0.064896683639177069,0.071445057892575214,0.07790360091749339,0.084155404398775294,0.090086336815584908,0.095589869214572826,0.10057152489744071,0.10495264280635706,0.10867319879013547,0.11169350814294748,0.11399472866063536,0.1155781857329933,0.11646363863638207,0.11668668970091152,0.11629559674705252,0.11534777843272132,0.11390629997027264,0.11203659513613125,0.10980362543779119,0.10726960746269763,0.10449236507581794,0.10152429434532993,0.098411874074921885,0.095195618654334888,0.09191035391116581,0.088585698593079854,0.085246649397023769,0.081914190367659831,0.078605872544861399,0.075336332715868065,0.072117738466112469,0.06896015949682735,0.065871872706071824,0.062859611864196252,0.059928773163250341,0.057083586704866011,0.054327262064489498,0.051662114060920722,0.049089673110979809,0.046610783189525155,0.044225689442986452,0.041934116852621058,0.039735340924254028,0.037628251112064845,0.035611407499054733,0.033683091108723758,0.031841348080829494,0.030084027793768932,0.028408814856876442,0.026813254743816975,0.025294772727971961,0.023850685766796987,0.022478207136000686,0.021174444013908555,0.019936388925267445,0.018760906990918622,0.017644722233021919,0.016584407580323986,0.015576384407369883,0.01461693803467912,0.013702255206851593,0.012828487850868747,0.011991844336968701,0.011188705299568285,0.010415756457808413,0.0096701266815329562,0.0089495166930822663,0.0082523029843708032,0.0075776030645826747,0.0069252918566984735,0.0062959643285010738,0.0056908454138279198,0.0051116540343248322,0.0045604327757334962,0.0040393579517250368,0.0035505461362656224,0.0030958727724069031,0.0026768164076443422,0.0022943388582242334,0.0019488076471485169,0.0016399628904373938,0.0013669268795029571,0.0011282512940696092,0.00092199453439212461,0.00074582021033617752,0.00059710737117706449,0.00047306350063989577],[0.006351705180027381,0.0080449394667194002,0.010076344990453004,0.012481390098057769,0.015291059647120023,0.018529572212228802,0.022212054149647456,0.026342328672457942,0.030910996436130756,0.03589398835592561,0.041251758644551828,0.046929255176108922,0.052856756104776297,0.058951599274838284,0.065120759535863701,0.07126415546519857,0.077278498967936732,0.083061446531344812,0.088515776291045761,0.0935533052839949,0.098098278379644133,0.10209000335624369,0.10548457129179639,0.1082555810706281,0.11039387270070644,0.1119063568293208,0.11281409827833112,0.11314986213039867,0.11295535701816656,0.11227841020568,0.11117028470196672,0.10968330507991905,0.10786890328230715,0.10577613692912798,0.10345067854229337,0.1009342309796038,0.098264295871007559,0.095474208688548889,0.092593354396629704,0.089647487840892937,0.086659098896708212,0.083647779959780594,0.080630569612985939,0.077622259444660086,0.074635660361115783,0.07168183052148977,0.068770269915538015,0.065909087470379851,0.063105146223996114,0.060364191180437336,0.057690963393595647,0.055089302854598655,0.052562241983896599,0.050112090965863609,0.047740515778204352,0.045448609510954377,0.043236957390893373,0.041105695785197731,0.039054565322098458,0.03708295811631776,0.035189958915546861,0.033374379798573515,0.031634787882389027,0.029969525384725793,0.028376721415275453,0.026854295129181836,0.025399950471381494,0.024011163747368856,0.022685166686949542,0.02141892942169896,0.020209149622787304,0.01905225553508464,0.017944431277208312,0.016881672037456479,0.015859874328352185,0.014874962249289272,0.013923045178059637,0.013000596338099515,0.012104636418698037,0.011232903010510782,0.010383985902060683,0.0095574105728578954,0.0087536572163501945,0.007974109521159756,0.0072209351255702854,0.0064969069865167626,0.0058051808884248459,0.0051490482830522438,0.004531685280435069,0.0039559179254906804,0.0034240211974895093,0.0029375649609506543,0.0024973149858261508,0.0021031917752762593,0.0017542848739249507,0.0014489160531116487,0.001184741610732542,0.00095888214681520462,0.00076806758770838856,0.00060878580026845375],[0.0055416114638444994,0.0070306848739852346,0.0088216010441618357,0.010947631242786136,0.013438597743199252,0.016318887647234236,0.019605402516122701,0.0233055766307004,0.027415614167102587,0.031919101382286902,0.036786141493190198,0.041973136079619,0.047423298030270948,0.053067929657327893,0.05882843981460583,0.064619011320492428,0.070349771233313943,0.075930268167566178,0.081273028719238763,0.086296953444825519,0.090930323732950971,0.095113223730206933,0.098799233001293951,0.10195631027387488,0.10456685924721175,0.10662703610054368,0.10814541740037709,0.10914119029567167,0.10964205013865283,0.1096819926823292,0.10929917040218724,0.10853394946399973,0.10742726140493043,0.1060192984134746,0.10434855941977617,0.10245122079836495,0.10036078299775478,0.098107933283497151,0.09572056358443494,0.093223888542132205,0.090640619233687963,0.087991159866017063,0.085293805900756803,0.082564931279958467,0.07981915918047873,0.077069515109222872,0.074327563584206932,0.071603530677791488,0.068906414854494766,0.066244088236462231,0.063623389963484794,0.061050212850215682,0.058529584158880148,0.056065741020249291,0.053662200835559733,0.051321826850219236,0.049046888976631516,0.046839119831263896,0.044699765818915965,0.042629632931937014,0.040629126732549731,0.038698285768324396,0.03683680747405009,0.035044065507746476,0.033319117556264891,0.03166070305315799,0.030067231106809769,0.028536760331108264,0.027066974201911113,0.025655157874390936,0.024298184735711301,0.022992522784334345,0.02173427154743883,0.020519239027490147,0.019343064707755105,0.018201388999371619,0.017090062312086419,0.016005379345106919,0.014944317697307672,0.013904755903880359,0.012885645503081442,0.011887115014637167,0.010910490314530841,0.0099582247579204017,0.0090337421398477367,0.0081412047721453468,0.0072852263990101692,0.0064705545578991512,0.0057017489384810901,0.0049828813375020391,0.004317279332008369,0.0037073304226611066,0.0031543568954623849,0.0026585648095473393,0.002219064076347213,0.0018339511531938683,0.0015004418505573497,0.001215039358537564,0.00097372184469692816,0.0007721346967214112],[0.0047831848139549757,0.0060792728950357592,0.0076421613436251142,0.0095027309047600421,0.011689324494187518,0.014226042268536288,0.017130957376834805,0.020414362079722664,0.02407717024385676,0.028109609100265599,0.032490328309181832,0.037186036588624141,0.042151745632648722,0.047331659536339617,0.05266069876691877,0.058066595459238604,0.06347244685480756,0.068799571593121875,0.073970484292377486,0.078911791161983352,0.08355681519330975,0.087847783540051599,0.091737449572038943,0.095190073350686508,0.098181741094353472,0.10070006008476678,0.1027433141446924,0.10431920112492969,0.10544329443189542,0.10613737443337717,0.10642776387770869,0.10634377755978378,0.10591636503850045,0.10517699140683889,0.10415676965964142,0.10288583264693785,0.10139291490534084,0.099705105161570731,0.097847728000823864,0.09584431625345971,0.093716641953761476,0.091484781313397712,0.089167196540838226,0.086780823605769872,0.084341159799631651,0.081862348179804867,0.079357257942640147,0.076837560782313741,0.074313803687085539,0.071795478670453106,0.069291089821450241,0.066808217901248815,0.064353582569859361,0.061933102215795129,0.05955195127900096,0.057214614887768869,0.054924940554218003,0.052686186570724852,0.050501066605347041,0.048371789799011855,0.046300095425528098,0.04428728091325837,0.042334221801334046,0.040441382108996504,0.038608813769200494,0.036836144380179917,0.035122553721087101,0.033466741362659001,0.031866890254136991,0.03032063415182883,0.028825039687629946,0.027376616032359261,0.025971365631413102,0.024604887597681212,0.023272540606418021,0.021969664717901974,0.020691852351049395,0.019435249174727547,0.018196857821634334,0.016974812769882084,0.015768594599245445,0.014579156361256559,0.013408943350236987,0.012261798768059481,0.011142759917757669,0.01005776091668242,0.0090132670532580804,0.0080158718507177609,0.0070718902006048773,0.006186979642118633,0.0053658174601131908,0.0046118545244429425,0.0039271586378812912,0.003312351585106791,0.0027666359970191122,0.0022879013153673045,0.001872893087835255,0.0015174268118611086,0.0012166265919287659,0.00096516977546480824],[0.004084252665064598,0.0052006976538719807,0.0065506402690770592,0.00816242843545004,0.010062653699842059,0.012274708304682018,0.014817253443352588,0.017702687677439825,0.020935719470135786,0.024512155269688092,0.02841801255108679,0.032629054530627331,0.037110819877328796,0.041819187922386446,0.046701480165860093,0.051698055945520557,0.056744318333282723,0.061773010232780153,0.066716654456557972,0.071509978488062828,0.076092166460345764,0.080408797637067583,0.084413360568166187,0.088068271687721925,0.091345371804020609,0.094225918508514903,0.096700131962373537,0.098766381636877967,0.10043011967098428,0.10170267165081071,0.10259998873826483,0.10314144867025782,0.1033487707305295,0.10324508521505806,0.10285417467730211,0.10219988498333142,0.10130569040269864,0.10019438891587601,0.098887900996155881,0.097407146097374581,0.095771974513494978,0.094001136840021107,0.092112277927936706,0.090121946318415316,0.088045613368629191,0.085897698578192752,0.08369159911852779,0.081439722443036822,0.079153521310846728,0.076843530756754833,0.07451940660532462,0.072189965133837811,0.069863223477104164,0.067546440351675716,0.065246156656439985,0.062968235470183043,0.060717900899102666,0.058499775111748122,0.056317912721374395,0.054175831430361338,0.052076537548864953,0.050022544678630286,0.048015883591070792,0.04605810125343858,0.044150247243963305,0.042292846652771533,0.040485860184285481,0.038728634668895798,0.037019850491255619,0.035357476216995025,0.033738744298045423,0.032160164223008346,0.030617589785648876,0.029106354347266827,0.027621481625487852,0.026157969986582388,0.024711136674436935,0.023276996833893535,0.021852642848377731,0.020436584426926831,0.019029010286595371,0.017631938354397289,0.016249232261848229,0.014886475826593163,0.013550712120986639,0.012250067557636104,0.010993292476060337,0.0097892568468539339,0.0086464423978425946,0.0075724707821576585,0.0065737019205833304,0.0056549282938697463,0.0048191808815964991,0.0040676518487458742,0.0033997290943261226,0.0028131293263526798,0.0023041100655154167,0.0018677372414594847,0.0014981838537526495,0.0011890362749354785],[0.0034498540699382275,0.0044015299959362679,0.0055555075551412501,0.0069375159735049069,0.008572179361919223,0.010481813614829739,0.012685130069407543,0.015195916746054186,0.018021781477394756,0.021163048894856897,0.024611903340206989,0.028351861219069827,0.032357638927394426,0.036595457118294462,0.041023790653790464,0.045594538943759241,0.050254556988095632,0.054947457011371749,0.059615567568894225,0.064201924142502684,0.068652164140002775,0.072916210078720012,0.076949646320470494,0.0807147244536323,0.084180966721537367,0.087325371718449424,0.090132257948845163,0.092592805466616426,0.094704371491979231,0.096469661844343399,0.097895836834682254,0.098993619719249415,0.099776460482086909,0.10025979039276901,0.10046038603872,0.10039584729507131,0.10008418308805356,0.099543492130818395,0.098791722702078283,0.097846495219142585,0.096724972888268604,0.095443768207527716,0.09401887584520896,0.092465624951146033,0.090798646035156555,0.089031849097132756,0.087178410760725675,0.085250768845447952,0.083260623221077676,0.081218942020945373,0.079135972420135967,0.077021255258276272,0.074883642829924296,0.072731319187609403,0.070571822300631915,0.068412067376340244,0.066258370564442184,0.064116472111984416,0.061991557802967903,0.05988827719868655,0.057810756810911107,0.055762605944036578,0.05374691263916026,0.051766227108741923,0.049822530489208282,0.047917187916814742,0.046050887079174332,0.044223566622280434,0.042434342978068598,0.040681448857407189,0.038962200973759541,0.037273017340420656,0.035609504418997254,0.033966630423485092,0.032338992784476488,0.03072117570892011,0.029108179555378783,0.027495889829262349,0.025881542714468412,0.024264138526742453,0.02264475564497288,0.02102672540668634,0.019415641962291168,0.017819198090646943,0.016246855995917353,0.014709378708645969,0.01321826091336408,0.011785106483814525,0.01042100311718195,0.0091359423097047976,0.0079383261872554463,0.0068345925130181527,0.0058289769178638557,0.0049234184929974724,0.0041176027122411972,0.0034091253423503129,0.0027937533501142227,0.0022657542380897623,0.0018182637695486506,0.0014436633777802092],[0.0028824335967274407,0.0036851350314896841,0.0046613245978235403,0.0058340850556227999,0.0072259197482817637,0.0088577651879722785,0.010747910331338794,0.012910877765322669,0.015356333944904144,0.018088103124457459,0.02110336122221218,0.024392080566149332,0.027936784000415327,0.031712647724499672,0.035687967891093395,0.03982497856478201,0.044080980853673374,0.048409717814597991,0.052762909902047447,0.057091853557831584,0.061348982441164171,0.065489297114585412,0.069471583911253826,0.073259365335454088,0.076821550011481277,0.08013277680199303,0.08317347220810585,0.085929659962027991,0.088392575084530203,0.09055814089497706,0.092426366871316806,0.094000719082264289,0.095287504947450252,0.096295302316224157,0.097034451128088436,0.097516615639845899,0.097754417228717222,0.09776113239667919,0.097550447639916604,0.097136261842417346,0.09653252721192182,0.095753120921822463,0.094811741081934298,0.093721822106544284,0.092496465793709889,0.091148385402984686,0.089689860723136797,0.08813270260099601,0.086488225714604197,0.084767228571897987,0.082979979841691115,0.081136210203882161,0.079245108954437732,0.077315324620557763,0.075354968826469498,0.073371622587559401,0.071372344082304209,0.069363676738469868,0.067351656157444678,0.065341813987572536,0.063339176371489947,0.061348254107446543,0.059373021318132269,0.057416879425216956,0.055482603864124444,0.053572272552939643,0.051687177917158302,0.049827728370345548,0.04799335035837126,0.046182407764655729,0.044392160549555422,0.042618787494220101,0.040857497288737575,0.039102746752344174,0.037348574348151128,0.035589042202507679,0.033818762651932316,0.032033468908544062,0.030230576969216695,0.028409680032004274,0.026572918844490635,0.024725181496170087,0.022874102676818872,0.021029852863009117,0.019204729345711415,0.017412580661769369,0.015668111543281588,0.013986125407694377,0.01238076497452417,0.010864808917551382,0.0094490743416444471,0.0081419626285155686,0.0069491714583935328,0.0058735803178677866,0.0049153021778880514,0.0040718816256437975,0.0033386105194369111,0.0027089267089377617,0.002174859569866077,0.0017274876869352587],[0.0023821313063667427,0.0030520103360287608,0.003869130325394651,0.0048539561987099179,0.0060267823263409175,0.0074069356582247871,0.0090118889970723197,0.010856326507100649,0.012951213897229683,0.015302932788990717,0.017912541340632849,0.020775220373973551,0.023879955694521504,0.027209493309793231,0.030740585819013497,0.034444526975165882,0.038287949378627152,0.042233839747358781,0.046242709452839155,0.050273846875559372,0.054286573844982922,0.058241431390549124,0.062101229754735955,0.065831912789200975,0.069403205514790248,0.072789033472083986,0.075967721212754649,0.078921992906016342,0.081638809180933317,0.08410908036888233,0.086327297391745175,0.088291118447489644,0.090000943590126628,0.091459501663529896,0.09267146611972478,0.093643109049572085,0.094381996923177877,0.094896727346155729,0.095196703539131122,0.095291941984342626,0.095192908398149922,0.094910377518512626,0.094455312834219901,0.093838763104247713,0.093071773183961024,0.092165307224669965,0.091130182729205131,0.089977014242468054,0.088716165658049281,0.087357710256401711,0.085911397677725987,0.084386627086796256,0.082792425812225956,0.081137432736011358,0.079429885660143418,0.077677611768717347,0.07588802011466167,0.074068094767418727,0.072224386845642072,0.070363003130116536,0.068489588346279801,0.06660929762100147,0.064726755231955119,0.062845995847174402,0.060970385341561829,0.059102520347027752,0.057244109241511063,0.055395842388902009,0.053557265801027688,0.051726679177637389,0.049901085114029693,0.048076219373807148,0.046246690701029318,0.044406251392906423,0.042548206538652739,0.040665951656257526,0.038753608052651711,0.036806706169387186,0.034822853159805253,0.032802314901669884,0.030748446038417233,0.028667914174559949,0.026570684167455668,0.024469752629062168,0.022380647909955888,0.020320733768135788,0.018308373005320292,0.016362018818807673,0.014499305659344182,0.012736208123836161,0.011086326767558226,0.0095603452257809977,0.0081656855984000836,0.0069063707087534763,0.0057830845214299938,0.0047934072980407496,0.0039321911253482429,0.0031920348683472312,0.0025638154428394861,0.0020372341529863989],[0.001947138660663101,0.002500209056329819,0.0031769350250764315,0.0039952439953673657,0.0049731966168883651,0.0061283552014339895,0.0074770684058346245,0.0090337034507908306,0.01080986597416953,0.01281365407122982,0.015048996159180445,0.017515121259557769,0.020206204754878897,0.023111222775595734,0.026214034771867453,0.029493697682173338,0.032924997974094997,0.036479171457631576,0.040124766901221791,0.043828599610673112,0.047556736298494107,0.051275453202989256,0.054952115266315181,0.058555934365304457,0.062058577724125714,0.065434612051693181,0.068661782932958257,0.071721141070998515,0.074597036051053986,0.077277003835210911,0.079751576201685215,0.082014039287586438,0.084060165068250883,0.085887934935237803,0.087497269407704803,0.088889773149515156,0.090068500350083486,0.091037742394817892,0.091802837623566641,0.092370001727762649,0.092746176766923108,0.092938896674012561,0.092956167273033879,0.092806359103407482,0.092498111637152616,0.092040247733489969,0.091441697380272011,0.090711429921457643,0.089858394072977396,0.08889146509632613,0.087819398538388896,0.086650789961100524,0.085394040073533822,0.084057324633455596,0.082648568390066193,0.081175422172864678,0.079645241967016334,0.078065068426979578,0.076441604750680472,0.074781190174367254,0.073089765608426782,0.071372827244619824,0.069635363549312559,0.067881771244974451,0.066115747088251631,0.064340154909645328,0.062556871811740841,0.060766623669871796,0.058968827702000085,0.05716146781065063,0.055341034956769501,0.053502567897235787,0.051639827148092093,0.049745625656027116,0.047812323318059777,0.045832470812962406,0.043799564410993246,0.041708851695573403,0.039558112650294609,0.037348334520995299,0.035084203711150688,0.032774353196065524,0.030431327311242984,0.028071253903654749,0.025713242908634686,0.023378556802139148,0.021089619122348656,0.018868940359208324,0.01673804505309915,0.014716480052745217,0.012820972605774602,0.011064790049985075,0.0094573325409803514,0.008003968850896704,0.0067061050390219579,0.0055614586011870134,0.0045644978878061106,0.0037069988505466986,0.0029786686143268991,0.0023677874974735859],[0.0015740902160653375,0.0020258116557993889,0.0025802792198557959,0.0032530078506441723,0.004059858079197406,0.005016545225242636,0.0061380727539978325,0.0074381123940095925,0.0089283609725970704,0.010617909645725399,0.012512664464925672,0.014614857390903086,0.016922683575084342,0.019430093999803916,0.022126762816552212,0.024998236762180753,0.028026260992732858,0.031189262867740826,0.034462963979848722,0.037821082234075466,0.041236080896375954,0.044679920669722074,0.048124773937058184,0.051543666774319062,0.054911023236940915,0.058203096578635663,0.061398282238441598,0.064477316527808304,0.067423372137558529,0.070222066404289407,0.072861400649192193,0.075331649084448712,0.077625214262447673,0.079736463422352438,0.081661556963404283,0.083398277145752653,0.084945862341547523,0.086304849926356897,0.087476929268843706,0.088464805198521429,0.089272071702542907,0.089903095298252814,0.090362907431843886,0.09065710527127073,0.090791760328006219,0.090773334417469778,0.090608602531988838,0.090304582245869694,0.08986846929923635,0.089307579017596381,0.08862929321841416,0.087841012231920632,0.086950111613809195,0.08596390303918075,0.084889598720064921,0.083734278456213743,0.082504858079235383,0.081208057553531027,0.079850366337146816,0.078438002797080505,0.076976863590902778,0.075472458132712764,0.073929822833977893,0.072353410147921793,0.070746949039951046,0.069113276849485983,0.067454147942159481,0.065770032055366134,0.064059924211803509,0.062321197181390474,0.060549534675569505,0.058738986312289451,0.056882181605829293,0.054970728422255137,0.052995801688878116,0.050948902769768975,0.04882274265676001,0.046612177772550591,0.044315110383961027,0.041933259775909386,0.039472716852942569,0.036944212949454339,0.034363060718883051,0.031748757208833689,0.029124272339742741,0.026515075951474142,0.023947980071559811,0.021449887854310328,0.019046545696859835,0.016761390488526585,0.014614570967867833,0.012622202734536091,0.010795893095315163,0.0091425473108452619,0.0076644445159627398,0.0063595517681099747,0.0052220298797371221,0.0042428757385205833,0.0034106428146540107,0.0027121839564100162],[0.0012584632174875287,0.0016234122746003029,0.0020728167094725938,0.0026199400008738803,0.0032785267674675682,0.0040624295324239263,0.0049851686053925138,0.0060594408642226935,0.0072965992391690136,0.0087061296362338555,0.010295155231519935,0.01206799899070588,0.014025833586474971,0.016166443542403514,0.018484117671673322,0.020969681251685982,0.023610667681558638,0.026391619570001103,0.029294500298569826,0.03229919001052254,0.035384035383538875,0.038526420839911597,0.041703330055300747,0.044891870418077615,0.048069738843997456,0.051215614255140339,0.054309469217696929,0.057332799900061258,0.060268779037469557,0.063102340592213965,0.065820207160734501,0.068410872015118238,0.070864547261448196,0.073173088326482824,0.075329903235508186,0.077329853257033343,0.079169149717037715,0.08084525028097006,0.082356756830011327,0.083703316215089973,0.084885524610995661,0.085904835848139113,0.086763473904682947,0.087464349640545253,0.088010981805181576,0.088407422325388632,0.088658185861498554,0.088768183602013287,0.088742661244085794,0.088587141077802523,0.088307368052485277,0.087909259646795218,0.08739885928015223,0.086782292873449893,0.086065727967359909,0.085255334504528713,0.08435724594111392,0.083377518740064091,0.08232208749778569,0.0811967119926984,0.08000691141594464,0.078757880154911031,0.077454379086845576,0.076100596877290663,0.074699977834382328,0.073255016995866437,0.071767029666845172,0.070235911479272939,0.06865991541215262,0.067035482459628773,0.065357170363766051,0.063617727255635872,0.061808351683527753,0.059919165993989207,0.057939906867238135,0.055860807642809034,0.053673616381236522,0.051372666778675982,0.048955901135678111,0.046425739135043255,0.043789694536441701,0.041060663012365446,0.038256835224849177,0.035401225615841268,0.032520844549693034,0.029645574967828686,0.026806840965976454,0.024036172204670678,0.021363773640371161,0.018817204846835786,0.016420258480327687,0.014192105444271902,0.012146747840001193,0.010292792888301237,0.0086335345724449942,0.0071673072339323686,0.0058880585070036889,0.0047860787552214566,0.003848820698581635,0.0030617455883225945],[0.0009949612030634423,0.0012865901053085431,0.001646885614557266,0.0020870472706529951,0.0026188290983822906,0.003254262604410735,0.0040053222395174714,0.004883543892579445,0.005899611814708227,0.0070629335190209117,0.0083812251562045779,0.0098601311949507026,0.011502901646233243,0.013310147462025993,0.015279690238929892,0.017406516319725222,0.019682838362459581,0.022098260123759702,0.024640033316742718,0.027293389643557327,0.030041927018345117,0.032868026926082212,0.035753279890682693,0.038678897980836485,0.041626096775224213,0.044576433702427677,0.047512094567338299,0.050416124807903993,0.053272606133270915,0.056066782373115992,0.058785140488468356,0.061415453786527636,0.063946794597573367,0.066369523234022981,0.068675259203594186,0.070856839612903025,0.072908268649528554,0.074824661085896096,0.076602181967532323,0.078237984046705206,0.079730144085497182,0.081077598849597587,0.082280081410817038,0.083338058240777085,0.084252667485239477,0.085025658740219834,0.085659334595763276,0.086156494163840774,0.086520378758433131,0.086754619844076813,0.086863189308071215,0.086850352031988473,0.086720620625685779,0.086478712020255935,0.086129505365571929,0.085678000305748722,0.085129274170411245,0.084488435885093194,0.083760573457618337,0.082950690776808764,0.082063628289839693,0.081103961154714077,0.080075868097705435,0.078982964995954932,0.077828099798371728,0.076613110394044601,0.075338554770360222,0.074003433061627474,0.072604932853913284,0.071138240424498858,0.069596468687125837,0.067970754386055751,0.066250569891268582,0.064424277534470067,0.062479927653451915,0.060406268595189758,0.058193902972294896,0.055836495400469296,0.053331918160135931,0.050683216378857435,0.047899284633668188,0.044995171014696592,0.041991959303528108,0.038916220341235354,0.035799064783419196,0.032674866451600691,0.029579754443236874,0.026549990338276996,0.023620352932156252,0.020822647052647768,0.018184436590602687,0.015728077330660239,0.01347009561878838,0.011420927726196834,0.0095850051994625773,0.0079611462621986904,0.0065431944304264068,0.0053208339937698959,0.0042805080502609357,0.0034063676985977101],[0.00077786286053713844,0.0010083420993812263,0.0012940379147714563,0.0016442902943752341,0.0020690187492103814,0.0025785224230617269,0.0031832318707886733,0.0038934191992921249,0.0047188770639255253,0.0056685804126910249,0.0067503474834796134,0.0079705180420972261,0.00933366695018264,0.0108423697570638,0.012497034165403317,0.014295807143223253,0.016234562511635166,0.018306968505456291,0.020504629610990789,0.022817292442033926,0.025233101946869084,0.027738892130504757,0.030320494838450718,0.032963050911334849,0.035651309954989774,0.038369907735301099,0.041103613402684577,0.043837541985610066,0.046557330534328784,0.049249278710027336,0.051900456378513558,0.054498781865620766,0.057033075033337932,0.05949308936509938,0.061869526951619777,0.064154039785717071,0.066339220222271955,0.068418582921324189,0.070386540118202209,0.072238371676018265,0.073970191074004099,0.07557890825912951,0.07706219012227479,0.078418419237638287,0.079646651411128797,0.080746572509552514,0.081718454979810756,0.082563114410541011,0.083281866432996843,0.083876484198251861,0.084349156596667724,0.084702447291642544,0.084939254505604467,0.085062771296721851,0.085076445765350228,0.084983940186982132,0.084789087437199151,0.084495842216011627,0.084108223485729564,0.083630243261358123,0.08306581559104427,0.082418638536370242,0.081692041680532401,0.080888792790745651,0.080010860459007571,0.079059135481935341,0.07803312271854547,0.076930626840892372,0.075747468501120671,0.07447727968479817,0.073111435277065734,0.071639178753955729,0.070047990691163964,0.068324228359810793,0.066454034328184988,0.064424475497467923,0.062224837065752048,0.059847964935613132,0.057291530710679037,0.054559089357953811,0.051660811909382653,0.048613802662389898,0.045441948515154998,0.042175292322150344,0.03884896701213085,0.035501767521725187,0.032174469114370892,0.02890802042810664,0.025741746187146256,0.022711688022680067,0.019849193788881163,0.017179838776320587,0.014722729713419364,0.012490208109326908,0.010487936887386791,0.0087153264069222535,0.0071662350598861741,0.0058298668521459202,0.0046917839183692979,0.003734955053018458],[0.00060132302364656958,0.0007814599954668747,0.0010055057067561266,0.0012811526974030442,0.001616662407091275,0.0020207256856620498,0.0025022836328709459,0.0030703126808302827,0.0037335807561988416,0.0045003840781148051,0.0053782763726351653,0.0063738037483465904,0.0074922589735496523,0.0087374683075406284,0.010111622365933489,0.011615159863942971,0.013246709716627014,0.01500309320309858,0.016879384092046867,0.0188690211477337,0.020963964609657687,0.023154886296653604,0.025431382042575324,0.027782195216752778,0.030195440995520493,0.032658822622688627,0.035159832870399657,0.03768593602438685,0.040224727736658583,0.042764071838571241,0.045292214582767304,0.047797877747772638,0.050270332616465963,0.052699457091394702,0.055075778218306094,0.057390502238992239,0.059635534059959298,0.061803487761499999,0.063887689520262247,0.065882174097943128,0.067781675866713548,0.069581615197226901,0.071278080921904297,0.072867809497418959,0.074348161419020828,0.07571709537974132,0.076973140614919014,0.078115367822855372,0.07914335900150761,0.080057176483346482,0.080857331377356775,0.081544751525387385,0.082120748929481693,0.082586986378256358,0.082945442654551213,0.08319837519547546,0.083348278349283253,0.083397834392712422,0.083349853235610102,0.083207195318149907,0.082972670789703398,0.082648907001034944,0.082238176185983253,0.081742176667700409,0.081161764783481,0.080496641644806188,0.079745009086435725,0.078903222211463717,0.077965480280481614,0.07692361069137936,0.075767008990836313,0.074482797640331,0.073056254868714643,0.071471541508474484,0.069712719952115712,0.067765019621153347,0.065616263836538832,0.063258340489717887,0.060688579262405999,0.057910894997189287,0.054936571078454184,0.05178458652232186,0.048481431913292752,0.04506040705063262,0.041560441409341509,0.038024521829549018,0.034497845706226549,0.031025839195856147,0.027652187018935764,0.024417013393320447,0.021355334079790355,0.018495870289098937,0.015860279945855236,0.013462824530802643,0.011310454288174459,0.0094032642726353914,0.0077352509075152062,0.0062952847438450402,0.0050682101598679037,0.0040359860520234976],[0.00045961829982201689,0.00059884141480007322,0.00077259041102107132,0.00098712204421399054,0.0012492267154801721,0.0015661351356566363,0.0019453931655590655,0.0023947068272199478,0.0029217616817326258,0.0035340228909651033,0.004238524111651115,0.0050416547089837975,0.0059489554565897674,0.0069649328047644852,0.0080929009216281454,0.0093348591016315062,0.010691409934917209,0.012161721049145136,0.013743530523724297,0.015433193495268897,0.017225765258179895,0.019115114496939017,0.021094059273417988,0.023154518056163614,0.025287668363108386,0.0274841063753367,0.029734002009103047,0.032027245235655616,0.034353580755589398,0.036702729339950675,0.039064495159678227,0.041428859197579,0.043786059370709889,0.046126658311883575,0.048441599909616884,0.050722255734200583,0.052960462428682693,0.055148551054193432,0.057279369275728693,0.059346297173862993,0.061343257378417837,0.063264720144664596,0.065105703930531611,0.066861771982161672,0.068529025392136081,0.070104093056893788,0.071584118924567258,0.072966746888630765,0.074250103642465273,0.075432779759195073,0.076513809190374177,0.077492647271152862,0.078369147155416125,0.079143534349022118,0.079816378618718056,0.080388561975817674,0.080861240613572277,0.081235797577445035,0.081513781574637831,0.081696825775050608,0.081786538947261664,0.081784360218721194,0.081691368762038044,0.081508041574635315,0.081233957077711638,0.08086745018275078,0.080405235937749939,0.079842033198290738,0.079170235173435383,0.078379687221131006,0.077457640160376873,0.076388945857798748,0.075156548223406811,0.073742296422525624,0.072128070250869036,0.070297165080616245,0.068235842225423976,0.065934917031561777,0.063391237378793458,0.060608903152406066,0.057600093350226277,0.054385399781111649,0.050993610589262724,0.04746093755941088,0.04382973231408082,0.040146782414042896,0.03646131426868409,0.032822852301755794,0.029279091308886566,0.025873931431110289,0.022645804316235592,0.019626387835197198,0.016839769046061822,0.014302075219467721,0.012021554781088862,0.0099990575092454466,0.0082288388156562149,0.0066995978534087047,0.0053956537807393458,0.0042981679501461678],[0.00034733491804393355,0.00045373102635557893,0.00058696872133482585,0.00075207336069076243,0.00095455329405451535,0.0012003408370382042,0.0014957082972206553,0.0018471597886847478,0.002261301189282272,0.0027446922095037268,0.003303686002500382,0.0039442629016834862,0.0046718655959389673,0.0054912432515759856,0.0064063117256696863,0.0074200361083947954,0.0085343404627516856,0.0097500479299060996,0.011066852502705211,0.012483321917307853,0.013996929441750126,0.015604110988099489,0.017300343032459725,0.019080236330883626,0.020937640352037747,0.022865753647127875,0.024857235951445227,0.026904318553640654,0.028998910274946058,0.031132697183321491,0.033297234863095729,0.035484032631844013,0.037684629530318724,0.039890662214819531,0.04209392507358193,0.044286422994589056,0.046460417257124638,0.048608465025669234,0.050723452909688285,0.052798625028433063,0.054827605993356926,0.056804419195849422,0.058723500766006201,0.060579709548975409,0.062368333428176576,0.064085092308096933,0.065726138051721714,0.067288051646476943,0.068767837843932478,0.070162917475903239,0.071471117582271995,0.072690659376746736,0.073820143899996069,0.074858534928364764,0.075805138272282704,0.07665957595454001,0.077421752848663372,0.078091812145828998,0.078670074521717051,0.079156954206801369,0.079552843589945382,0.079857956969082072,0.080072124283100038,0.080194527965711124,0.080223381335777375,0.080155555837000236,0.079986177047890378,0.079708224841165645,0.079312189318008305,0.078785847934211631,0.078114236587738084,0.077279884496314427,0.076263366870527052,0.07504420041261628,0.07360206715893973,0.071918307428150655,0.069977579618680785,0.067769550503318884,0.065290460370716369,0.062544406315504814,0.059544204730220013,0.056311728398918674,0.052877660173841275,0.049280658337999578,0.04556598224641091,0.041783674825528666,0.037986436064155735,0.034227345237786692,0.03055759747196013,0.027024412376557991,0.023669250579550702,0.020526441165486065,0.017622283345870033,0.014974643637814799,0.012593029751238626,0.010479088002778789,0.0086274451068489022,0.007026799153911645,0.0056611587449830521,0.0045111327672344576],[0.00025950064816834139,0.00033989311785279796,0.00044091567029765408,0.0005665540395616552,0.00072121829535670256,0.00090970853061296292,0.0011371614461065749,0.0014089777977546319,0.0017307318315890265,0.0021080650290514385,0.0025465676157087726,0.0030516522415384786,0.0036284249225736411,0.0042815586670211774,0.0050151751528120384,0.0058327393770989102,0.0067369714022858396,0.007729778255627073,0.0088122078053797376,0.0099844251546219141,0.011245710881083212,0.012594479408327596,0.014028314993344164,0.015544022296736541,0.017137688267650584,0.01880475209866667,0.020540080235575117,0.022338043800225259,0.024192596236417622,0.026097349460756088,0.0280456472468247,0.030030634961686269,0.03204532509327028,0.034082658253066479,0.036135559516970533,0.038196990089526352,0.040259994356332568,0.042317742438509796,0.044363568392278126,0.04639100421367056,0.048393809818500652,0.050365999174120629,0.052301862763928446,0.054195986568655846,0.056043267750139521,0.05783892722292909,0.059578519295440453,0.061257938553067569,0.062873424136557124,0.064421561532818084,0.065899281930195022,0.067303859077019523,0.068632903392308722,0.069884352770417671,0.071056459044900933,0.072147768370292562,0.073157092786530736,0.074083468917025747,0.074926098146401776,0.07568426086592743,0.076357195767056532,0.076943934221595511,0.077443080248903617,0.077852529338134968,0.078169125370229353,0.078388264694748591,0.078503470035143907,0.078505973271154925,0.078384362968314136,0.078124366303932338,0.077708841631219716,0.077118053472704437,0.076330283842306654,0.075322802539584496,0.07407317746209581,0.072560859682960027,0.070768934217888116,0.068685893264523706,0.066307269997874924,0.063636971028383726,0.060688164761030589,0.057483618810325023,0.054055427884089062,0.05044412838252775,0.046697251110773656,0.042867412991180603,0.03901008742919624,0.035181217399703521,0.031434843487605946,0.027820911004212016,0.024383397638386366,0.021158869080705342,0.018175528876280964,0.015452785061388396,0.013001314436800115,0.01082356950030721,0.0089146459441369376,0.0072634118096674754,0.0058537931817430784,0.0046661148369972474],[0.0001916658815802812,0.00025172105604171982,0.00032745042472357946,0.00042197546829525218,0.0005387809871104872,0.00068169793422982598,0.00085487197417029011,0.0010627173081608622,0.0013098561151873925,0.0016010448227425475,0.0019410892704232771,0.0023347515871052524,0.0027866521962624665,0.0033011707351319293,0.0038823497838857486,0.0045338051391792004,0.0052586459491213034,0.0060594073969654728,0.0069379978425015993,0.0078956614794241462,0.0089329567224279652,0.010049749770632133,0.01124522215984035,0.012517890650073185,0.013865637509226973,0.015285749140294038,0.016774961033600235,0.018329507171941612,0.019945172236441298,0.021617345217376363,0.023341073296163851,0.025111115109506952,0.026921992720548779,0.028768041798772515,0.030643459650361055,0.032542350847731064,0.034458770286874066,0.036386763560263026,0.038320404577119715,0.040253830396385276,0.042181273264171683,0.044097089869063813,0.045995787846755377,0.047872049580812794,0.049720753358980067,0.051536991953901205,0.053316088702203536,0.055053611154059059,0.056745382352035689,0.058387489765264554,0.059976291839394673,0.061508422003498063,0.062980789770733264,0.064390578236567589,0.065735236760935137,0.067012466855809083,0.068220198229829762,0.069356550539599354,0.070419774704751095,0.071408165823432665,0.072319938116687812,0.073153051496754537,0.073904980083156907,0.074572416220493348,0.07515091018959727,0.075634456420917304,0.076015051466453348,0.076282266024352494,0.076422890408805816,0.076420726342475001,0.076256603594187761,0.075908694017596798,0.0753531758166609,0.074565267801755999,0.073520610378306608,0.07219692290542036,0.070575823114439717,0.068644660589785828,0.066398198451536938,0.063839978417896251,0.060983224609290468,0.057851178393784349,0.054476805814529176,0.050901874928888036,0.047175456463805873,0.043351951534523731,0.039488789660815364,0.035643965233603601,0.031873588973184673,0.028229622702984132,0.024757942665476207,0.021496841860728436,0.018476039764290551,0.015716223022986628,0.013229097959387379,0.011017898914505027,0.0090782685493296551,0.0073994088553786062,0.0059653951169925572,0.0047565485566775654],[0.00013994112174217641,0.00018429197981499959,0.00024041415962057516,0.00031072152695664924,0.00039793195006118486,0.00050506147892724824,0.00063540813073231935,0.00079252463172632844,0.00098018001275051634,0.0012023105620367865,0.0014629612579389957,0.0017662193835304833,0.002116142513015333,0.0025166834119588945,0.0029716145772499657,0.0034844551429428967,0.0040584026978872966,0.0046962722217564912,0.0054004438844007397,0.0061728209162860937,0.0070147981960698375,0.0079272416636564196,0.0089104781939394959,0.009964295186495737,0.011087948854604745,0.012280180034533971,0.013539236273178542,0.014862898971124524,0.016248514437204979,0.017693027827395874,0.019193019075586373,0.02074474006063989,0.022344152382361742,0.023986965232262913,0.02566867294093924,0.027384591862788223,0.02912989632262181,0.030899653400177363,0.032688856370318015,0.034492456651245937,0.036305394142220122,0.038122625857429183,0.03993915278468102,0.041750044916865063,0.043550464420698286,0.045335686920524573,0.047101120883497598,0.048842325093554767,0.050555024190096866,0.052235122214393824,0.053878714037902342,0.055482094419130649,0.057041764215792747,0.058554432920438063,0.060017016132161982,0.061426625759890989,0.062780549617967529,0.064076215601519423,0.065311133873197702,0.066482808640638269,0.067588609529412216,0.068625591861649626,0.069590256160879577,0.070478240877374823,0.071283949554966586,0.072000124940651208,0.072617397592393648,0.073123853952708928,0.073504685918174703,0.073741996855528527,0.073814843573920305,0.073699586347822574,0.073370597837906976,0.07280134744823713,0.071965833934243759,0.070840291930704222,0.069405054669708352,0.06764642239304533,0.065558369129973065,0.06314392246497931,0.060416071784096081,0.057398097860573274,0.054123266134010015,0.050633881987240545,0.046979762546930329,0.043216230047447922,0.039401771478213631,0.035595534337499651,0.031854836833440994,0.028232862688274029,0.024776687513049126,0.021525748752167936,0.018510828736540943,0.015753575206667716,0.013266540440666141,0.011053682869992856,0.0091112467558523268,0.0074289178116916533,0.0059911459369676743,0.0047785296144404561],[0.00010099926789459365,0.00013337668094121359,0.00017449159673564712,0.00022618714617539252,0.00029055553978777574,0.00036993928783503669,0.00046692506109613686,0.00058432950143200765,0.00072517664834670446,0.0008926670599437148,0.0010901391439285173,0.0013210236418742163,0.0015887925920741201,0.0018969044002713645,0.0022487468477108796,0.0026475799467745114,0.0030964805123853186,0.003598290161064836,0.0041555681984648584,0.0047705505378255672,0.0054451154378150207,0.0061807564904161148,0.0069785629561947117,0.0078392072572120615,0.0087629392107770963,0.0097495864255658215,0.010798560183325282,0.011908866086719507,0.013079118755674711,0.014307559888349622,0.015592079056628568,0.016930236669639522,0.01831928860451577,0.019756212066292418,0.021237732295578935,0.02276034979236875,0.024320367767130594,0.025913919566942768,0.027536995855927213,0.029185471356657517,0.030855130983444314,0.032541695220109731,0.034240844614458588,0.035948243279276773,0.037659561305110785,0.039370496002562337,0.041076791899742553,0.042774259420758687,0.04445879215805093,0.046126382615454951,0.047773136224361377,0.049395283297959509,0.050989188352744935,0.052551355843852836,0.054078430771341966,0.055567191753551355,0.057014532977672214,0.058417429913501025,0.059772881884187799,0.06107782273627807,0.062328989343435594,0.063522737147181013,0.064654793231769273,0.065719941508404905,0.066711642299073809,0.067621600377470961,0.068439310932161587,0.069151630396202146,0.0697424358026075,0.07019244844141187,0.070479300982625462,0.070577918508139381,0.070461261525537208,0.070101444095931373,0.0694711965288307,0.068545595665603129,0.067303943558374144,0.065731643926112443,0.063821910110926999,0.061577140988263085,0.059009822434708349,0.05614284916494041,0.053009210758798421,0.049651041012580339,0.046118085334173477,0.042465690893674482,0.038752463578353304,0.035037760755648469,0.031379197395483595,0.027830335086147209,0.024438700544572724,0.021244245545801305,0.018278318018625225,0.015563169114873661,0.013111978002826839,0.010929338972033109,0.0090121271356364482,0.0073506412658554147,0.0059299154594670573,0.0047310945624271022],[7.2051324126746037e-05,9.5415134786634321e-05,0.000125188675849739,0.00016276151997325001,0.0002097233707733572,0.00026786923990456296,0.00033919957361457472,0.00042591468355094523,0.00053040306025010236,0.00065522341808514671,0.00080308061911045405,0.0009767959278549781,0.0011792723356273973,0.0014134559382215012,0.0016822945355935948,0.0019886947325527364,0.0023354788495782439,0.0027253429042930844,0.0031608168059998097,0.0036442277330535982,0.0041776674544587245,0.004762964132912253,0.0054016589253740943,0.0060949874947389031,0.0068438663734902176,0.0076488839835538976,0.0085102960174706036,0.0094280248221637521,0.010401662393003802,0.011430476576164523,0.012513420084751748,0.013649141952749543,0.014836001075461683,0.016072081512114537,0.017355209253185188,0.018682970180435177,0.020052728970968728,0.021461648717808233,0.022906711058688689,0.024384736622323606,0.02589240561759017,0.027426278406149356,0.028982815913050304,0.030558399742774342,0.032149351879544777,0.033751953859638681,0.035362465308045217,0.036977141728700598,0.038592251420635701,0.04020409135142762,0.041809001737737182,0.043403378934911134,0.044983685986688109,0.046546459782291945,0.048088313151007277,0.04960592932998964,0.051096045020153524,0.052555416692731838,0.053980763009820763,0.055368674404210602,0.05671547945292036,0.058017057328534898,0.059268587178185159,0.060464229703409339,0.06159674429295435,0.06265705711389298,0.063633811056932013,0.064512945667478297,0.065277371269253551,0.065906812602021511,0.066377899489961117,0.06666457223656827,0.06673884639496698,0.066571946627277612,0.066135776465328505,0.06540464577639496,0.064357137280153742,0.062977963733312547,0.061259653011085879,0.059203901658943008,0.056822458527803633,0.054137436566615904,0.051180998662120863,0.047994417322234681,0.044626562191611249,0.041131918184646579,0.037568275488602774,0.033994257167048209,0.030466858567574653,0.027039165014588116,0.023758391924986608,0.020664357601239688,0.01778845766914949,0.015153166073674021,0.012772045279765734,0.010650211788084379,0.008785175192599845,0.0071679514514071058,0.0057843441845768419,0.0046162908442069876],[5.0803717741137142e-05,6.7467761498513629e-05,8.8778590295796479e-05,0.00011577058514608516,0.00014963599494277052,0.00019173195413852215,0.00024358415740628471,0.00030688663520863382,0.00038349720706674489,0.00047542835938239262,0.00058483349121246696,0.00071398868056791228,0.00086527032997436328,0.0010411292374516629,0.0012440617936467365,0.0014765791167022566,0.0017411749970452663,0.0020402935330657169,0.0023762972989220948,0.0027514368049187375,0.0031678218994726022,0.0036273956315458203,0.0041319109554691161,0.0046829105268968874,0.0052817097175164055,0.0059293828726103039,0.0066267527523621878,0.0073743830351476582,0.0081725737173269624,0.0090213592164161086,0.0099205089695902846,0.010869530313908552,0.01186767343546774,0.012913938179507064,0.014007082520541676,0.015145632499732997,0.016327893445210111,0.017551962299579227,0.018815740887257824,0.02011694996251847,0.021453143887238638,0.02282172579532005,0.024219963108477138,0.025645003275361147,0.027093889612248779,0.02856357712772261,0.030050948213887669,0.031552828079037275,0.033065999774879437,0.034587218624673885,0.03611322576961086,0.037640760393133459,0.039166569918929035,0.040687417057855543,0.042200081941991485,0.043701356668845739,0.045188028341230535,0.046656845132540606,0.048104458130588723,0.049527329960160668,0.050921599896565181,0.05228289502150426,0.05360607878561139,0.05488493303469949,0.056111777856641253,0.057277045730486809,0.058368841758690573,0.059372538459113181,0.060270468770590432,0.061041790893813203,0.061662599627240827,0.062106348195692745,0.062344621316757678,0.062348265946168824,0.062088844702913773,0.061540334021551263,0.060680950867096628,0.05949496409570644,0.057974333479199412,0.056120023192795493,0.053942857116706919,0.05146381847520673,0.048713742305263867,0.045732401037687755,0.042567035571368497,0.039270431194720998,0.035898674811613851,0.032508753615800912,0.029156163654019178,0.025892689400196373,0.022764494019397456,0.019810627376250025,0.017062019015672284,0.014540980785567108,0.012261202883102633,0.010228191705921538,0.0084400708173977979,0.0068886492238996993,0.0055606543869404761,0.0044390301864343836],[3.5404473277972411e-05,4.7151472735841131e-05,6.2227347153739958e-05,8.1392329591476964e-05,0.00010552901777259824,0.00013564985663345704,0.00017290250332235513,0.00021857262264945369,0.00027408373439026691,0.00034099383542426595,0.00042098864358879788,0.00051587144813894099,0.00062754969404487846,0.0007580185636882668,0.00090934194004765878,0.0010836312320058759,0.0012830226092353022,0.0015096532284510384,0.0017656370349804034,0.0020530406966978165,0.0023738601767274575,0.0027299983835979164,0.003123244259881175,0.0035552535895255906,0.0040275317258282707,0.0045414183705737333,0.0050980744729909062,0.00569847126604975,0.0063433814171922264,0.0070333722399438508,0.0077688008905363879,0.008549811458050182,0.0093763338460712466,0.010248084337075553,0.011164567726607047,0.012125080911997665,0.013128717819335698,0.014174375552267332,0.015260761646801523,0.01638640231744987,0.01754965158167696,0.01874870115166212,0.019981590984613173,0.021246220385016702,0.022540359553653966,0.023861661477808892,0.025207674052710231,0.026575852312038756,0.02796357061861934,0.029368134614078049,0.030786792630573032,0.032216746101973136,0.033655158238157068,0.035099159794725061,0.036545850122765434,0.037992290761346352,0.039435487600784518,0.040872356110598432,0.042299662401233284,0.043713931229370062,0.045111310911968447,0.046487385142184888,0.047836923723947988,0.049153569114899966,0.050429464035225705,0.051654837378667336,0.052817580507202394,0.053902861899394361,0.05489284219001335,0.055766560371717573,0.056500061901255831,0.057066828240658514,0.057438544375199296,0.05758620775860037,0.057481542759026193,0.057098644313012731,0.056415738916822014,0.055416925515542934,0.054093747116683563,0.052446447996090759,0.050484791084571989,0.048228343532310876,0.045706181996733042,0.042956018252500186,0.040022795107280518,0.03695684719969141,0.033811756551503293,0.030642055356999719,0.027500936511150195,0.024438125558379722,0.021498047468914105,0.018718390698438489,0.016129133128447836,0.013752053969461659,0.011600716729526525,0.0096808745498980272,0.0079912233064560276,0.0065244114399630893,0.0052682088834957097,0.004206739983972506],[2.4384263478539814e-05,3.2568135539973244e-05,4.3108400494902454e-05,5.6556720297513141e-05,7.3558017997130509e-05,9.4857596071464218e-05,0.00012130698837997011,0.00015386819538243225,0.00019361598844712882,0.00024173802566814675,0.00029953259571016016,0.00036840389320831059,0.00044985482331515912,0.0005454774275770205,0.00065694111191966361,0.00078597893430374884,0.00093437227003013372,0.0011039342138813146,0.001296492099294679,0.0015138695163983301,0.0017578681953484172,0.0020302500924218835,0.0023327199777443686,0.00266690877943399,0.0030343578930101512,0.0034365046201684634,0.003874668859639936,0.0043500411361648986,0.0048636720221902109,0.0054164629807165413,0.0060091586363492377,0.0066423404643863107,0.0073164218739831212,0.0080316446503715371,0.0087880767121859202,0.009585611132684314,0.010423966367698061,0.011302687628244875,0.012221149331726616,0.013178558562378333,0.014173959469035578,0.015206238526223277,0.016274130582856122,0.017376225621145616,0.018510976145999815,0.01967670512108758,0.020871614359617003,0.02209379326180225,0.023341227760156413,0.024611809276873588,0.025903343396841881,0.027213557788600382,0.028540108626397061,0.029880584330970766,0.031232504798729178,0.032593313374939717,0.033960357614636678,0.035330853386865847,0.036701825231747226,0.038070014338708144,0.039431744526349261,0.040782736812013873,0.042117865346895024,0.043430852448541842,0.044713908743176954,0.045957336054900516,0.047149124831793836,0.04827459275467285,0.049316123975884654,0.050253075903638568,0.051061919487604981,0.0517166675049417,0.052189623062007161,0.05245244915793161,0.05247752334062035,0.052239504120641093,0.051717003147621989,0.050894233896368608,0.049762497182779732,0.048321367963209828,0.046579466468922456,0.044554727976694179,0.042274126173862059,0.03977285087776293,0.037092987028055843,0.034281783614847586,0.031389634317917074,0.028467912921096936,0.025566814215545314,0.022733344853779182,0.020009589731649274,0.017431350541265239,0.015027217675579539,0.012818098656501426,0.010817189638482345,0.0090303447358159507,0.0074567734974806217,0.0060899812968292152,0.0049188610792646852,0.0039288471590060289],[1.6597022467937772e-05,2.2231483480588573e-05,2.951402309434592e-05,3.8839873966630577e-05,5.0674199334892711e-05,6.5558405161402094e-05,8.4115755549361401e-05,0.00010705603096746927,0.00013517898299601018,0.00016937636767149497,0.00021063238083425447,0.00026002237079790258,0.00031870976283993952,0.00038794119251918754,0.00046903990650430411,0.00056339754650751176,0.00067246448072197991,0.00079773888542808554,0.0009407548058098143,0.0011030694392633262,0.0012862498873430855,0.0014918596155236556,0.0017214448452134992,0.0019765210822110424,0.0022585599622574099,0.0025689765694656775,0.0029091173587479408,0.0032802487900269253,0.0036835467606835012,0.0041200869036629659,0.0045908358019703752,0.005096643155774132,0.0056382349257561833,0.0062162074654122188,0.0068310226454475964,0.007483003965002029,0.0081723336369853173,0.0088990506281770923,0.0096630496288337506,0.010464080921272366,0.011301751112186618,0.012175524689190316,0.013084726358103867,0.014028544113470433,0.015006032990075049,0.016016119436638353,0.017057606242141039,0.018129177926430932,0.019229406473047713,0.020356757222335337,0.021509594639285617,0.022686187497020747,0.023884712737057851,0.025103256835101197,0.026339812863453004,0.027592270549663081,0.028858395460823437,0.030135792023414782,0.031421843544556467,0.032713620996595034,0.034007751502248461,0.035300237827370677,0.036586222486834262,0.037859695008509164,0.039113148944759354,0.040337206302964772,0.041520240325057058,0.042648041194397676,0.043703580686415541,0.044666938005563421,0.045515447326248272,0.046224116153655181,0.046766342431099353,0.047114929090314381,0.04724336086475471,0.047127274111418843,0.046746020817452452,0.046084207078472987,0.04513307716215037,0.043891618348225699,0.042367278980184137,0.040576220951789803,0.038543065260220943,0.036300131417196006,0.033886214047195121,0.03134497853470497,0.028723088214996792,0.026068195370918142,0.023426935498775635,0.020843058668958477,0.018355814478260395,0.015998680438650301,0.013798490914057769,0.011774988578694686,0.0099407864683632215,0.008301699207019583,0.006857379296300677,0.0056021798458819874,0.0045261591479779217,0.0036161444613868783],[1.1163499630587484e-05,1.499690487001082e-05,1.9969153826398154e-05,2.6359809548833527e-05,3.4500047047676483e-05,4.4777978188794378e-05,5.7643644611515055e-05,7.3613492459011099e-05,9.3274144874736897e-05,0.00011728529984307153,0.00014638160170854156,0.00018137336351007873,0.00022314605236054905,0.00027265848923463848,0.00033093975517753177,0.00039908483557664137,0.00047824907044858634,0.00056964150982732756,0.00067451729802591278,0.00079416922815833874,0.00092991861884800166,0.0010831056690454228,0.0012550794452523386,0.0014471876493531736,0.0016607663059105332,0.0018971294963481032,0.0021575592549234182,0.0024432957285738027,0.0027555276901660981,0.0030953834827503776,0.0034639224612945233,0.0038621269881176277,0.0042908950288215722,0.0047510333868728298,0.0052432516070259451,0.0057681565704236675,0.0063262477973861858,0.0069179134675569007,0.0075434271611615243,0.0082029453196209093,0.0088965054185882308,0.0096240248415777486,0.010385300437556323,0.011180008740865586,0.012007706826005568,0.012867833761945219,0.013759712618519888,0.014682552957193279,0.015635453703272389,0.016617406235559847,0.017627297425271769,0.018663912183625168,0.01972593480214101,0.02081194794774394,0.021920427557658554,0.023049731023982663,0.024198074946507497,0.025363497400913541,0.026543798246343942,0.02773644974261797,0.028938469085124111,0.030146244973510691,0.031355312682335851,0.032560076928223519,0.03375348950164489,0.034926699011097503,0.03606870229336058,0.037166039365701439,0.038202583830896628,0.03915948569897184,0.040015321283009865,0.04074649375509664,0.041327908175039049,0.041733918023748366,0.041939509587670447,0.041921659921001816,0.041660777706846217,0.041142117808269069,0.040357052307376573,0.039304084728911184,0.037989509869245507,0.036427647774221139,0.034640614331656112,0.032657629201120739,0.030513900453106937,0.028249160359770115,0.025905954722216885,0.023527806220538263,0.021157378959004804,0.0188347663786048,0.01659600904419116,0.01447192462309768,0.012487302599091123,0.010660484255002245,0.0090033175287771872,0.0075214494029984327,0.0062148977080948185,0.0050788308835532205,0.0041044786812079832,0.0032800984754366323],[7.419954215013426e-06,9.9970693553993153e-06,1.3351654357524627e-05,1.7678939724383353e-05,2.3211662718579516e-05,3.0224388896099034e-05,3.90377224072179e-05,5.0022276991453255e-05,6.3602275992929511e-05,8.025865216132702e-05,0.00010053152657675348,0.0001250219603608518,0.0001543928920781738,0.00018936919668947238,0.00023073682714374561,0.00027934102564086748,0.00033608361676638204,0.00040191941778852837,0.00047785182140178231,0.00056492762244124634,0.00066423117228413936,0.00077687795284010742,0.00090400766652479105,0.0010467769399137281,0.0012063517374900541,0.001383899578654564,0.0015805816465431948,0.0017975448716937698,0.0020359140676151836,0.0022967841891259268,0.0025812127781372775,0.0028902126554745909,0.0032247449114172506,0.0035857122419162314,0.0039739526719200233,0.0043902337018979524,0.0048352469084859493,0.0053096030251858148,0.0058138275242182848,0.0063483567159510956,0.006913534377769608,0.0075096089197657975,0.0081367310900478697,0.0087949522175153842,0.0094842229839937238,0.010204392709505716,0.010955209122012864,0.011736318562342904,0.012547266539704709,0.013387498492561281,0.014256360507286198,0.0151530995790476,0.016076862733216284,0.017026693920880947,0.018001527014895879,0.019000172426247807,0.020021293822679781,0.021063370203688776,0.022124637297372813,0.023203001147642285,0.024295916253403292,0.025400221238860137,0.026511927382572912,0.027625959957948771,0.028735859526248519,0.029833459875571466,0.030908570343158755,0.031948701192203471,0.032938879360037421,0.033861605878812935,0.034697003568254191,0.035423193096568405,0.036016917389562746,0.036454410236465784,0.036712477573410965,0.036769732807626083,0.036607904282618425,0.036213116748429065,0.035577041801797181,0.034697815885223665,0.033580638539451618,0.032237986954343517,0.030689413180716302,0.028960924587911319,0.027083982773295975,0.025094187599498573,0.023029738166725509,0.020929778871132957,0.018832744823540803,0.016774816540322594,0.014788579867477537,0.01290196546474208,0.011137515491627307,0.0095119964012669884,0.0080363489434457439,0.0067159422174261473,0.0055510798661636794,0.0045376944257927015,0.003668160746802502,0.0029321608156794255],[4.8732001596119267e-06,6.5850999487684352e-06,8.8213416686804145e-06,1.17165269878548e-05,1.5432103378537471e-05,2.0159761203704474e-05,2.6124842946326374e-05,3.3589679987167017e-05,4.2856766638764073e-05,5.4271679119536766e-05,6.8225649055402677e-05,8.515770688979282e-05,0.00010555631994125927,0.00012996046219050344,0.0001589600674306807,0.00019319583328696957,0.00023335835988841434,0.00028018662280072189,0.00033446579447638511,0.0003970244413997284,0.00046873113495154712,0.00055049052264123167,0.00064323891277785652,0.0007479394300351726,0.00086557680195821366,0.0009971518375559321,0.0011436756590260256,0.0013061637466441082,0.0014856298551586507,0.001683079857857395,0.0018995055719545479,0.0021358786161940028,0.0023931443486422065,0.002672215929601025,0.0029739685514367123,0.003299233873916437,0.0036487947003850567,0.0040233799268141893,0.0044236597924226127,0.0048502414572024997,0.0053036649282736867,0.0057843993534729696,0.0062928396968326573,0.006829303806320847,0.007394029878814927,0.0079871743196247187,0.0086088099818829519,0.0092589247510876539,0.0099374204057763923,0.01064411162666341,0.011378724928136262,0.012140897125466324,0.012930172698420197,0.013745999030442298,0.01458771795326836,0.015454551278580936,0.016345577045222395,0.017259692097365626,0.018195555462847453,0.019151506061115667,0.02012544790598228,0.021114696663960115,0.022115783719967096,0.023124218250266514,0.024134214416508471,0.025138399433576774,0.02612752808590451,0.027090238803556169,0.028012893725047366,0.028879548217605439,0.029672092406325231,0.030370597516976294,0.030953883536008881,0.031400303300540625,0.031688714093519331,0.031799584145276054,0.031716161222195956,0.031425616430044337,0.03092007045874736,0.03019741277960996,0.029261836756485721,0.028124034195301809,0.026801019561903575,0.025315584275986736,0.023695412063345318,0.021971914188865273,0.020178865677245264,0.018350938177876527,0.016522230660062545,0.014724895381162778,0.012987944330157356,0.01133630228476719,0.0097901490524995236,0.0083645680460230562,0.0070694937119657325,0.0059099288068209061,0.0048863858439764287,0.0039954962578048038,0.0032307262273496978,0.0025831392657260578],[3.1624331173179323e-06,4.2859968272970093e-06,5.7588911431008602e-06,7.6727343286815331e-06,1.013807508925812e-05,1.3286990579637237e-05,1.7275757002699979e-05,2.2287539374471649e-05,2.8535041207604732e-05,3.6263051153077672e-05,4.5750822313806804e-05,5.7314221110537615e-05,7.1307586170629749e-05,8.8125243488371447e-05,0.00010820263169589045,0.00013201700021243424,0.00016008765278264773,0.00019297571894744562,0.00023128344583524572,0.00027565301191761316,0.00032676487274394586,0.00038533565596527987,0.00045211562909096048,0.00052788576839451519,0.00061345446126323544,0.00070965387717924577,0.00081733604455877821,0.00093736867199490682,0.0010706307531717543,0.0012180079949529587,0.0013803881079821208,0.0015586559986369413,0.0017536889004041386,0.0019663514817280497,0.0021974909661620062,0.0024479322992411292,0.0027184733949174688,0.0030098804926686359,0.0033228836545206942,0.0036581724292174059,0.0040163917086057021,0.0043981377989380684,0.0048039547270855758,0.0052343307983289331,0.0056896954178810768,0.0061704161815070314,0.0066767962295555799,0.0072090718399093288,0.0077674102029294881,0.0083519072660126568,0.0089625854425837426,0.009599390829733042,0.010262189343028418,0.010950760823491975,0.011664789666419255,0.012403849839168446,0.01316738129437557,0.013954653793041807,0.014764713150643659,0.015596304131733034,0.016447763980056786,0.01731688131295641,0.018200717294534919,0.019095390013375915,0.019995828968539724,0.020895514245808926,0.021786223553383426,0.022657818463752918,0.023498107289091536,0.02429282426150646,0.025025761710399563,0.025679083074693035,0.026233830176516842,0.026670619525742126,0.026970501628753647,0.027115936899325142,0.027091824426235405,0.026886507836055694,0.026492677488737067,0.025908091149800614,0.025136046098716804,0.024185553473667666,0.023071188838093844,0.021812619186767645,0.020433833226717536,0.018962126048840018,0.017426908786437816,0.015858426626290955,0.014286473461266427,0.012739188313775549,0.011242008079417831,0.0098168345866488874,0.0084814534578544851,0.0072492200989472608,0.0061290066428653289,0.0051253848527328758,0.004239005386097775,0.0034671243443118761,0.0028042239360600838,0.0022426750232442815],[2.0277054626334191e-06,2.7562767431131647e-06,3.7147433369446004e-06,4.9646706214813122e-06,6.5807778771821966e-06,8.6528772178420139e-06,1.128790711763654e-05,1.4612028550593156e-05,1.8772746723259123e-05,2.3941017474772151e-05,3.0313294875127692e-05,3.8113475516628019e-05,4.7594695507684552e-05,5.9040938181839817e-05,7.276841387456028e-05,8.9126677568408512e-05,0.00010849945548713819,0.00013130515753358391,0.0001579970585234793,0.00018906313720482641,0.00022502556785267507,0.00026643986462876609,0.00031389368378687314,0.00036800529313161471,0.00042942172188741669,0.00049881660732338658,0.00057688775714781167,0.00066435444888209916,0.0007619544892001162,0.00087044105762411502,0.00099057936004592288,0.0011231431183278114,0.0012689109227606887,0.0014286624744411346,0.0016031747446921575,0.0017932180785105419,0.0019995522686893723,0.0022229226267476338,0.0024640560761064229,0.002723657292081059,0.0030024049121914996,0.0033009478389745515,0.0036199016557815623,0.0039598451736929498,0.0043213171241346009,0.0047048130060140976,0.0051107820863397161,0.0055396245360863315,0.0059916886530986067,0.0064672680724299743,0.0069665987786647647,0.0074898555959628157,0.0080371476154970662,0.0086085116978343364,0.0092039027306936791,0.0098231787102082222,0.010466077949549629,0.011132184849706144,0.011820879808218462,0.012531268196295769,0.013262083202625884,0.014011558099694892,0.014777265529421256,0.015555925037177936,0.016343185391521887,0.017133394934763891,0.01791938059098655,0.018692263053027913,0.019441340635391983,0.020154075867153284,0.020816215991595763,0.021412070658258803,0.021924957572134359,0.022337810849222699,0.022633929103058791,0.022797822995682868,0.022816107307199851,0.022678372428186006,0.022377965979952945,0.021912617782320037,0.021284850637147388,0.020502134646755637,0.019576762625516345,0.018525446640274452,0.017368658558494142,0.016129758358042839,0.014833970739696799,0.013507281631520913,0.012175330495462879,0.010862371723649461,0.0095903694023385232,0.008378275558910497,0.0072415244185053641,0.0061917561639539907,0.0052367651969645141,0.0043806516849320418,0.0036241425699212065,0.002965040004993568,0.0023987515947226892,0.0019188575588124713],[1.2845398768622774e-06,1.7512875721502282e-06,2.3674785346679287e-06,3.173954855287507e-06,4.220566780381048e-06,5.5675879161341375e-06,7.2872253040447468e-06,9.4652065085710941e-06,1.2202421913822821e-05,1.5616597022732939e-05,1.9843966867806388e-05,2.5040922810230887e-05,3.1385601101091847e-05,3.9079382621926801e-05,4.8348274171094057e-05,5.9444143426107507e-05,7.2645782160349313e-05,8.8259775271550242e-05,0.00010662115652643284,0.00012809383548327875,0.00015307078368041906,0.00018197397175590143,0.00021525405260129881,0.00025338978888754602,0.0002968872262943149,0.00034627861650846222,0.00040212109652828436,0.00046499513302538211,0.00053550274248709208,0.00061426549960400423,0.00070192234789322227,0.00079912722787141993,0.00090654653922318384,0.001024856454358356,0.001154740101524408,0.001296884636242016,0.0014519782202689004,0.0016207069275714283,0.0018037515968954924,0.0020017846504699044,0.0022154668981233545,0.0024454443455922733,0.0026923450249150866,0.0029567758632889768,0.0032393196040988183,0.0035405317890579019,0.0038609378018003454,0.0042010299578478256,0.0045612645986896575,0.0049420591009488512,0.0053437886335625578,0.0057667823701550019,0.006211318669003243,0.006677618444363943,0.0071658355462259965,0.0076760424253135692,0.0082082086927779511,0.008762169435582964,0.0093375794250216016,0.0099338488394647116,0.010550056076018846,0.011184833971868639,0.011836227622622713,0.012501525213967165,0.013177067914373283,0.013858050637134384,0.014538331719216339,0.015210275281785927,0.015864654021832649,0.016490641250907209,0.017075918263037851,0.017606916236837813,0.018069201182326119,0.01844799690982124,0.018728826113290329,0.018898235190804615,0.01894455616338786,0.018858650584422834,0.018634576838559871,0.018270124358898288,0.017767166077092493,0.017131793266733267,0.016374213671940172,0.015508412797743605,0.014551597563372697,0.013523459210899565,0.012445306621721965,0.011339130615953579,0.01022666354801546,0.00912849637060076,0.0080633077805982722,0.0070472481212669729,0.0060935058522457479,0.005212068289395958,0.0044096726390085769,0.003689929586619357,0.0030535909756791435,0.0024989261012282179,0.0020221680465111716,0.001617992063759175],[8.0395679038284048e-07,1.099356164638125e-06,1.4907083085932723e-06,2.004761166357933e-06,2.6743436181032639e-06,3.5393773218576761e-06,4.6479728497426136e-06,6.0576011338491844e-06,7.8363283604049565e-06,1.0064099786342836e-05,1.2834055624387399e-05,1.6253860255243286e-05,2.0447024654177902e-05,2.5554201107265392e-05,3.1734429048878488e-05,3.9166311153941003e-05,4.8049099616395421e-05,5.8603673769832266e-05,7.1073391775860711e-05,8.5724800935074442e-05,0.00010284819318167613,0.00012275799443130816,0.00014579297859915855,0.00017231629924158924,0.00020271533386169454,0.00023740133793100914,0.00027680890759896302,0.00032139525187851846,0.00037163927680532042,0.00042804048566616281,0.00049111770087961672,0.00056140761448678393,0.00063946317547301627,0.00072585182329131383,0.00082115357799432507,0.00092595899830306093,0.0010408670197452439,0.0011664826856816498,0.0013034147845995053,0.00145227340747549,0.0016136674392699976,0.0017882019986504461,0.0019764758397325792,0.0021790787287307013,0.0023965888064487787,0.0026295699436467324,0.0028785690889095348,0.0031441135950323164,0.0034267084856749626,0.0037268335821796332,0.0040449403406659376,0.0043814481374705493,0.0047367395682899474,0.0051111540719860505,0.0055049788340760936,0.0059184354560884202,0.0063516603038289076,0.0068046758139951825,0.007277349440180457,0.00776933651649958,0.0082800033359214688,0.0088083274523540374,0.0093527738882110707,0.0099111487477622478,0.010480435707563294,0.011056625718866292,0.011634555443443079,0.012207774607809582,0.012768465603679039,0.013307439332166311,0.013814228799733614,0.014277296087317475,0.014684359331776895,0.015022835099723615,0.015280379215381208,0.015445497162715116,0.015508185074790654,0.015460555343136411,0.015297398001916341,0.015016630808894855,0.014619597398890894,0.014111183546785077,0.01349973548466718,0.012796780022768715,0.012016562337994204,0.011175432072719144,0.010291120326595992,0.009381958045400535,0.0084660894981201957,0.0075607328147585624,0.0066815333098979544,0.0058420453996252215,0.0050533665439765982,0.0043239332111077618,0.0036594757649365561,0.0030631176638560766,0.0025355953683023837,0.0020755694582854328,0.0016799948287327623,0.0013445182629164753],[4.9710008524263869e-07,6.8178707659709205e-07,9.2732350447319075e-07,1.2510026724901792e-06,1.6741647107985165e-06,2.2229061135714969e-06,2.9288588355906203e-06,3.830035230870532e-06,4.9717331397379912e-06,6.4074934981840272e-06,8.2001010355834483e-06,1.0422617017313752e-05,1.3159431637933963e-05,1.6507322622438709e-05,2.0576505873245729e-05,2.549166361597474e-05,3.1392935437693526e-05,3.8436857853041671e-05,4.6797238542135541e-05,5.6665952138892408e-05,6.8253645366627203e-05,8.1790340377750035e-05,9.7525926317889959e-05,0.0001157305303685309,0.00013669476079859586,0.00016072981585217287,0.00018816745359942236,0.0002193598191673314,0.00025467912703609584,0.00029451719732738512,0.00033928484621585653,0.0003894111317591594,0.00044534245755901373,0.0005075415377316458,0.00057648622767514791,0.00065266822606925221,0.0007365916544246181,0.00082877152130784472,0.00092973207909651369,0.0010400050817506612,0.0011601279525946587,0.0012906418714292197,0.001432089790322348,0.0015850143869351127,0.0017499559627935288,0.0019274502907296487,0.002118026409377432,0.002322204350723593,0.0025404927653656043,0.0027733863732293876,0.0030213631060924564,0.0032848807100151617,0.0035643724251071761,0.0038602411394510899,0.0041728511075434065,0.004502515923370665,0.0048494809541593251,0.0052138979135289152,0.0055957887669714447,0.0059949958567137446,0.0064111151981278156,0.0068434105601212682,0.0072907074113923572,0.0077512682306721198,0.0082226540252752257,0.0087015809398718492,0.0091837850782590432,0.0096639124036183542,0.010135453020083127,0.010590739518043039,0.011021026862935048,0.011416666362143916,0.011767378824209885,0.012062622800349296,0.012292043751017945,0.012445980260944876,0.012515995203827054,0.012495394075876109,0.012379690369906502,0.012166979299013725,0.011858186446694655,0.011457166639356527,0.010970639730663546,0.010407962956435481,0.0097807527634245269,0.0091023811841871496,0.0083873816844084459,0.0076508059726285273,0.0069075759401468666,0.0061718735423743915,0.0054566063456015154,0.0047729783459806666,0.0041301855138337461,0.0035352444741658098,0.0029929519571202201,0.0025059631611211853,0.0020749697464237321,0.0016989532895680707,0.0013754878239824382,0.0011010654098074606],[3.0364421165616684e-07,4.1770728856370483e-07,5.6988196567471706e-07,7.7120559163657181e-07,1.0353708327887384e-06,1.379214124221896e-06,1.8232585974407708e-06,2.3923106693192556e-06,3.116108192247477e-06,4.0300167500399032e-06,5.1757693875093036e-06,6.6022438312646804e-06,8.3662701381391622e-06,1.0533460731166198e-05,1.3179053977471217e-05,1.638876184408191e-05,2.0259611742858308e-05,2.4900772441984127e-05,3.0434353868936717e-05,3.6996170743412901e-05,4.4736460239872451e-05,5.3820544268255996e-05,6.4429427458205228e-05,7.676032251812007e-05,9.1027095298833896e-05,0.00010746062260792347,0.00012630905658214141,0.00014783799022147895,0.00017233051950979778,0.00020008719838582629,0.00023142588367747259,0.00026668146796529906,0.00030620549919148273,0.00035036568667269098,0.00039954529400330549,0.00045414242014349339,0.00051456917076872456,0.00058125072270638547,0.00065462428499162505,0.00073513796072317275,0.00082324951446275415,0.000919425050345186,0.0010241376062448953,0.001137865669074924,0.0012610916151920477,0.001394300077244216,0.0015379762333862183,0.0016926040045095361,0.0018586641265847408,0.0020366320331555018,0.0022269754298062071,0.0024301513576327266,0.0026466024133759408,0.0028767516056344201,0.0031209950669550657,0.0033796915054583724,0.0036531468775127837,0.0039415923315508361,0.0042451530859965586,0.0045638056787583861,0.0048973211203351755,0.0052451920790062018,0.0056065434925433796,0.0059800280354177626,0.0063637106420336301,0.0067549495827014987,0.0071502850004759805,0.0075453487730081084,0.007934811422685803,0.0083123819761270566,0.008670874775780435,0.0090023531674830876,0.009298353956871357,0.0095501890845880715,0.0097493128928010809,0.0098877355533394141,0.0099584566270111367,0.009955888156071329,0.0098762347967938161,0.0097177996457135547,0.0094811886476704917,0.0091693935003209215,0.0087877421690765456,0.0083437166158001324,0.0078466480743294882,0.007307310081788144,0.006737437490300497,0.0061492050440050215,0.005554701323245927,0.0049654328053123946,0.0043918887097751701,0.0038431907501923616,0.0033268437050403979,0.0028485937784435509,0.0024123929810416409,0.0020204600524637664,0.0016734224040947389,0.0013705195697804292,0.0011098468329838534,0.00088861792592491939],[1.8322327546477271e-07,2.5280884257131216e-07,3.459689787286059e-07,4.6965784781832002e-07,6.3254759135622937e-07,8.4535868050413529e-07,1.12123123964611e-06,1.4761379524217887e-06,1.9293383722426624e-06,2.5038736159679363e-06,3.2270995494630402e-06,4.1312557059447283e-06,5.2540663400440276e-06,6.639369237392413e-06,8.3377671922243846e-06,1.0407296450073981e-05,1.29141058999811e-05,1.5933140396485011e-05,1.954882129728732e-05,2.3855717115285493e-05,2.8959197098385574e-05,3.497606055991554e-05,4.203513487840597e-05,5.0277835259492498e-05,5.9858679596425747e-05,7.09457520713286e-05,8.3721109499715793e-05,9.838112482930834e-05,0.00011513676265480605,0.00013421378209744233,0.00015585286291655841,0.00018030965126505054,0.00020785472206642376,0.00023877345557344571,0.00027336582626215095,0.00031194610281512611,0.0003548424585492053,0.00040239649223837648,0.00045496265986405196,0.00051290761837762618,0.00057660948305900464,0.0006464570004509917,0.0007228486390489611,0.0008061915997479947,0.00089690074715816006,0.00099539746068063803,0.0011021083996212101,0.001217464167800029,0.0013418978471963067,0.0014758433427005855,0.0016197334346142866,0.0017739973634795061,0.0019390576624863998,0.002115325794622883,0.002303195935313146,0.0025030359635379736,0.0027151743958226632,0.0029398816504652343,0.0031773437266253974,0.0034276262219950686,0.0036906267228512483,0.0039660141259242601,0.0042531545214342633,0.0045510249495852749,0.0048581185994801641,0.0051723476659768369,0.0054909527801884697,0.0058104302275623085,0.0061264895627843458,0.0064340542764976943,0.0067273165722981877,0.0069998540077743886,0.00724481092995024,0.0074551417196533302,0.0076239064580613707,0.0077446034511783153,0.0078115178189447059,0.0078200617302158944,0.007767080351550249,0.0076510984751944908,0.0074724861442513864,0.0072335271729389071,0.0069383817802700668,0.0065929429170439695,0.0062045944333659394,0.0057818871334631636,0.0053341551907524999,0.0048710997104625077,0.0044023680356110959,0.0039371565894420098,0.0034838618215823408,0.0030497986231952613,0.0026409990368731684,0.0022620969512212549,0.0019162974854389462,0.0016054235994444606,0.0013300276192869291,0.0010895521563198992,0.00088252342047904554,0.00070676008499118972],[1.0921330944713331e-07,1.5114500225408011e-07,2.0747798232711572e-07,2.8253751336794224e-07,3.8174496689409123e-07,5.1183745945736058e-07,6.8111729319802304e-07,8.997323708122426e-07,1.1799883020627108e-06,1.5366924109934951e-06,1.9875293055326985e-06,2.5534671001841821e-06,3.2591928044850003e-06,4.1335748207663592e-06,5.2101499490344219e-06,6.5276317869641241e-06,8.1304369490987888e-06,1.0069225118786119e-05,1.2401448594044242e-05,1.5191906697052373e-05,1.8513300187018367e-05,2.2446780647036131e-05,2.708248970541035e-05,3.2520082898318872e-05,3.8869232980747728e-05,4.6250107543353711e-05,5.4793815891222627e-05,6.4642820283375779e-05,7.5951306816341409e-05,8.8885511458201109e-05,0.00010362399699827712,0.000120357876969044,0.00013929098291787004,0.00016063997175361946,0.000184634370263683,0.00021151655428701784,0.00024154166043423587,0.00027497742866148958,0.00031210397442355242,0.00035321348954081994,0.00039860987129280772,0.00044860827955462866,0.00050353462194094724,0.00056372496675782292,0.00062952488279579947,0.00070128870310307099,0.00077937870594298468,0.00086416419864041255,0.00095602047651969092,0.0010553276059300347,0.0011624689421381135,0.0012778292325676503,0.001401792064899726,0.0015347362888842786,0.0016770308631750648,0.0018290273526791634,0.0019910490377708294,0.0021633753223012937,0.002346219895002213,0.002539700988343874,0.0027438021934661624,0.0029583227423351636,0.0031828170555591793,0.0034165247220522216,0.0036582938832284873,0.0039065030846412623,0.004158988761321908,0.0044129872824572817,0.0046651015119020863,0.0049113018073396568,0.0051469700686872111,0.0053669928154860122,0.0055659054761958929,0.0057380854400113325,0.0058779864208163904,0.0059804018587131273,0.0060407409971068617,0.0060552984323713694,0.0060214967381771222,0.005938082455963588,0.0058052583574663436,0.0056247392517392077,0.0053997243502203153,0.0051347857726952387,0.0048356795191158682,0.0045090914597798095,0.0041623359738564509,0.0038030282884753343,0.0034387530241220053,0.0030767508504757116,0.0027236426448397871,0.0023852064721703666,0.0020662175723033735,0.0017703559290087134,0.0015001804954555588,0.0012571642849976937,0.0010417807072125127,0.00085362898327798252,0.00069158529172023194,0.00055396640005163182],[6.4303555632304515e-08,8.9260942429647916e-08,1.2290624199299375e-07,1.6789504987039324e-07,2.2757265263030742e-07,3.061176502184609e-07,4.0870664381888738e-07,5.4170125175746114e-07,7.1285847568303754e-07,9.315651550051611e-07,1.2090969260684962e-06,1.5589017518809661e-06,1.996907717311611e-06,2.5418544027684267e-06,3.2156467654860994e-06,4.043730080094172e-06,5.055484126536799e-06,6.2846344699597192e-06,7.7696783589217268e-06,9.5543224790774773e-06,1.1687929542074221e-05,1.4225970465629946e-05,1.7230478711680877e-05,2.0770503195586591e-05,2.4922556060711012e-05,2.9771051529001342e-05,3.5408731988972972e-05,4.1937077467122088e-05,4.9466694646418346e-05,5.8117681645238341e-05,6.8019964850804721e-05,7.9313604211662993e-05,9.2149063532580904e-05,0.00010668744248091041,0.00012310066720414692,0.00014157163667204048,0.0001622943220905696,0.00018547381698574746,0.00021132633581695602,0.00024007915924235761,0.00027197052440428206,0.00030724945879427324,0.00034617555632585176,0.00038901869405522723,0.00043605868729989751,0.00048758487927059996,0.00054389565798932077,0.00060529788694618574,0.00067210622463756019,0.00074464228879082708,0.00082323358940809995,0.00090821210506669627,0.00099991230240366043,0.0010986682924060394,0.0012048096737923117,0.0013186554331088777,0.0014405050622922863,0.001570625841084258,0.0017092350567618683,0.0018564758610905533,0.002012385575364694,0.002176855635375351,0.0023495830903456816,0.0025300146621801091,0.0027172857933134473,0.0029101587355409146,0.0031069653449600455,0.0033055615747218181,0.0035033014073675207,0.0036970378931527347,0.0038831579054962235,0.0040576551660487445,0.0042162431497302678,0.0043545059062314396,0.0044680809826393858,0.0045528649160971766,0.0046052286129336711,0.004622227733241082,0.0046017922672787924,0.0045428800099594742,0.0044455806479312271,0.0043111605409607168,0.0041420427167134346,0.0039417216847229923,0.0037146179044666833,0.0034658815809422883,0.0032011594149124064,0.0029263406101799629,0.0026472995912160185,0.0023696524414456182,0.0020985421453091338,0.0018384645747055381,0.0015931431897606438,0.0013654560764104185,0.0011574146756424964,0.00097018977817627482,0.00080417737719215825,0.00065909498309923769,0.00053409807163787195,0.0004279064029414778],[3.7397664866865946e-08,5.2069153280336725e-08,7.1916380488663825e-08,9.8548832210437756e-08,1.34003998361344e-07,1.8083977936687463e-07,2.4224140656431595e-07,3.2214400728545765e-07,4.2537183322766121e-07,5.5779502682728283e-07,7.2650462705263558e-07,9.4000631685552703e-07,1.2084331937613316e-06,1.5437776075469024e-06,1.9601418596965774e-06,2.4740073033622513e-06,3.1045211246744157e-06,3.8737998308562153e-06,4.8072482215906342e-06,5.9338923808551797e-06,7.2867249998114438e-06,8.903061129665492e-06,1.0824902268610544e-05,1.3099306510564848e-05,1.5778762326656957e-05,1.8921563414268301e-05,2.2592181933684978e-05,2.686163735962785e-05,3.1807858104541392e-05,3.7516033022798313e-05,4.4078949880028814e-05,5.159731786956622e-05,6.0180071278307702e-05,6.9944651446722134e-05,8.1017264231700892e-05,9.3533110265524522e-05,0.00010763658540804054,0.00012348144890991122,0.00014123095693842835,0.00016105795925613455,0.00018314495697112866,0.00020768411936652868,0.00023487725780678916,0.00026493575449959019,0.00029808044325894728,0.00033454143800226341,0.00037455790189204328,0.00041837774476351225,0.00046625722712589245,0.00051846043313934892,0.00057525854910705858,0.00063692884369016887,0.00070375318596569163,0.00077601585231212346,0.00085400025921195978,0.00093798411683246373,0.0010282323357508004,0.0011249868560779188,0.0012284524390485129,0.0013387774162312567,0.0014560284934655714,0.0015801590205087451,0.0017109707144593808,0.0018480696823226365,0.0019908186887500098,0.0021382888566304193,0.0022892152056529624,0.0024419614193888261,0.002594499769258669,0.0027444120321753859,0.002888916407554773,0.0030249238555446222,0.0031491250336159009,0.0032581062917349233,0.0033484902614085124,0.0034170937511461062,0.0034610932621411713,0.0034781867604767509,0.0034667396230625446,0.0034259030594297221,0.003355694831108225,0.0032570346490355048,0.0031317300095153881,0.0029824121109965312,0.0028124254909565639,0.0026256787270008647,0.0024264665804029253,0.0022192760211455862,0.0020085894713807355,0.0017986982837858848,0.0015935380146061022,0.0013965546621986197,0.0012106080155482016,0.0010379149380271712,0.00088003214872412415,0.00073787516845534476,0.00061176781051555163,0.00050151506572210149,0.00040649150700476151,0.00032573737831065975],[2.1482756687185313e-08,3.0001056799343162e-08,4.1564156471006333e-08,5.7134958355176461e-08,7.7938338219217779e-08,1.0551966321379582e-07,1.4181308057014566e-07,1.8922049384206418e-07,2.5070210362536834e-07,3.2987932821264956e-07,4.3115083734433357e-07,5.5982233023024571e-07,7.2225056904180139e-07,9.2600204326763552e-07,1.1800264911564512e-06,1.4948453445946144e-06,1.8827549958969949e-06,2.3580446117991386e-06,2.9372280439776774e-06,3.6392892090725477e-06,4.4859401366185657e-06,5.5018907124889582e-06,6.7151289801841339e-06,8.1572107041574908e-06,9.8635567497831612e-06,1.1873756694821221e-05,1.4231876958472796e-05,1.6986771617372593e-05,2.0192393974052837e-05,2.3908106853334109e-05,2.8198989526441391e-05,3.3136139101975295e-05,3.8796964177632055e-05,4.5265468517052595e-05,5.2632522502520431e-05,6.0996120116282213e-05,7.0461619220507987e-05,8.114196293702252e-05,9.315787997011067e-05,0.00010663806176298616,0.00012171931441876986,0.00013854668332563772,0.00015727354835534904,0.00017806168726371545,0.00020108130434313959,0.00022651102016325701,0.00025453781587626335,0.00028535692122273141,0.00031917162774305771,0.00035619299583682134,0.00039663940350955976,0.00044073585241292322,0.0004887128990774609,0.00054080501212223637,0.0005972480671501473,0.00065827558084849717,0.00072411316143979108,0.00079497053001792613,0.00087103037373878218,0.0009524332662519205,0.0010392579805760479,0.001131496772857746,0.0012290256682330938,0.0013315704413587417,0.0014386698221252497,0.001549638391215897,0.0016635325351582809,0.0017791235519114435,0.0018948823782611523,0.0020089803184808221,0.0021193095121794349,0.002223525680844773,0.0023191140061456232,0.0024034769576291252,0.0024740406976277302,0.0025283745763060007,0.0025643164292020733,0.0025800951259893757,0.0025744412715955419,0.0025466772406584977,0.0024967788590178719,0.0024254029619747964,0.0023338775964219828,0.0022241545532998785,0.0020987269278106503,0.0019605172004785476,0.0018127436267166544,0.0016587742869993553,0.0015019788397502465,0.0013455877914630538,0.0011925680137779061,0.0010455214477294329,0.00090661166251773532,0.00077752043908024273,0.00065943409046092106,0.00055305704652816882,0.00045864850176024065,0.00037607676422968337,0.00030488538986780353,0.00024436520749199659]],"type":"surface","frame":null,"hoverinfo":"none"}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="just-put-a-darn-grid-to-it" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="just-put-a-darn-grid-to-it">Just put a darn grid to it</h4>
<p>You know when you hit a roadblock in your calculations, and you’re like, “<em>Can’t we just crunch the numbers for every single value?</em>” Well, let’s break it down. Picture a grid with <img src="https://latex.codecogs.com/png.latex?N"> points for <img src="https://latex.codecogs.com/png.latex?D"> dimensions. Now, brace yourself, ’cause the math needed is like <img src="https://latex.codecogs.com/png.latex?N"> raised to the power of <img src="https://latex.codecogs.com/png.latex?D">.</p>
<p>So, let’s say you wanna estimate 100 points (to get a decent estimation of the shape) for each of 100 dimensions. That’s like slamming your head against <strong>ten to the power of 200 computations</strong>… that’s a hell of a lot of computations!</p>
<p>Sure, in la-la land, you could approximate every single number with some degree of approximation. But let’s get real here, even <strong>if you had all the time in the world</strong>, you’d still be chipping away at those calculations <strong>until the sun swallowed the Earth</strong>, especially with continuous cases and tons of dimensions that are somewhat correlated (which in reality, <strong>tends to be the case</strong>).</p>
<p>This headache we’re dealing with? It’s what we “<em>affectionately</em>” call (emphasis on double quotes) the <strong>curse of dimensionality</strong>. It’s like trying to squeeze a square peg into a round hole… it ain’t gonna happen without a supersized hammer!</p>
<div class="cell page-columns page-full" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" data-cap-location="margin" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">curse_dimensionality <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dimensions =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb2-2">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">calculations =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(curse_dimensionality, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dimensions, calculations)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> ggsci<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pal_jama</span>()(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">transform =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log10"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,</span>
<span id="cb2-7">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_log</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Computations (log-scale)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dimensions (Variables)"</span>,</span>
<span id="cb2-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Computations needed to compute a grid of 100 points"</span>,</span>
<span id="cb2-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"As a function of dimensions/variables involved"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Illustration of computations needed (in log-scale) for 100 points as a function of dimensions considered."><img src="https://bayesically-speaking.com/posts/2024-04-14 mcmc part 1/index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Illustration of computations needed (in log-scale) for 100 points as a function of dimensions considered."></a></p>
</figure>
</div>
<figcaption class="margin-caption">Illustration of computations needed (in log-scale) for 100 points as a function of dimensions considered.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Explaining the curse of dimensionality further
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Imagine you’re trying to create a grid <strong>to map out the probability space for a set of variables</strong>. As the number of dimensions increases, the number of grid points needed to adequately represent the space explodes exponentially. This means that even with the most powerful computers, it becomes <strong>practically impossible</strong> to compute all the probabilities accurately.</p>
</div>
</div>
</div>
</section>
</section>
<section id="sampling-the-unknown-markov-chain-monte-carlo" class="level1 page-columns page-full">
<h1>Sampling the unknown: Markov Chain Monte Carlo</h1>
<p>Now, if we can’t crack the problem <strong>analytically</strong> (which, let’s face it, is the case <strong>most of the time</strong>), we gotta get creative. Lucky for us, there’s a bunch of algorithms that can lend a hand by sampling this high-dimensional parameter space. Enter the <strong>Markov Chain Monte Carlo (MCMC)</strong> family of algorithms.</p>
<p>But hold up… Markov Chain Monte What? Yeah, it’s a mouthful, but bear with me. You’re probably wondering how this fancy-schmancy term is connected to exploring high-dimensional probability spaces. Well, I’ll let you in on the secret sauce behind these concepts and why <strong>they’re the go-to tools</strong> in top-notch probabilistic software like Stan.</p>
<p>But before we get into the nitty-gritty of MCMC, let’s take a detour and talk about <strong>Markov Chains</strong>, because they’re like the OGs of this whole MCMC gang.</p>
<section id="understanding-markov-chains-a-rainy-example" class="level4">
<h4 class="anchored" data-anchor-id="understanding-markov-chains-a-rainy-example">Understanding Markov Chains: A rainy example</h4>
<p>Consider the following scenario: if today is rainy, the probability that tomorrow will be rainy again is 60%, but if today is sunny, the probability that tomorrow will be rainy is only 30%. However, the probability of tomorrow being sunny is 40% if today is raining, but 70% if today is sunny as well.</p>
<div style="text-align: center;">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  a((Rainy)) ---&gt;| 40% | b((Sunny))
  a --&gt;| 60% | a
  b --&gt;| 70% | b
  b ---&gt;| 30% | a
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<p>As you can see, <strong>the probability of a future step depends on the current step</strong>. This logic is central to Bayesian inference, as it allows us to talk about the conditional probability of a future value based on a previous one, like sampling across a continuous variable.</p>
</section>
<section id="converging-to-an-answer" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="converging-to-an-answer">Converging to an answer</h4>
<p>Now, let’s imagine letting time run. After a year passes, if we observe how the weather behaves, we’ll notice that the relative frequencies of each state <strong>tend to converge</strong> to a single number.</p>
<p>Now, fast forward a year. If we keep an eye on the weather every day, we’ll notice something interesting: the <strong>relative frequencies</strong> of rainy and sunny days <strong>start to settle into a rhythm</strong>. This steady state is what we call a stationary distribution. It’s like the true probability of what the weather’s gonna be like in the long run, taking into account all the different scenarios.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">simulate_weather <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(total_time) {</span>
<span id="cb3-2">  </span>
<span id="cb3-3">  weather <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"character"</span>, total_time) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create slots for each day</span></span>
<span id="cb3-4">  day <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># First day</span></span>
<span id="cb3-5">  weather[day] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rainy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sunny"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Weather for first day</span></span>
<span id="cb3-6">  </span>
<span id="cb3-7">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> (day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> total_time) {</span>
<span id="cb3-8">    day <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add one more day</span></span>
<span id="cb3-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (weather[day] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rainy"</span>) {</span>
<span id="cb3-10">      weather[day] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rainy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sunny"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb3-11">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb3-12">      weather[day] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rainy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sunny"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb3-13">    }</span>
<span id="cb3-14">  }</span>
<span id="cb3-15">  </span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(weather)</span>
<span id="cb3-17">}</span>
<span id="cb3-18"></span>
<span id="cb3-19">sim_time <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">365</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-20">weather <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_weather</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_time =</span> sim_time)</span>
<span id="cb3-21"></span>
<span id="cb3-22">weather_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb3-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(weather <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rainy"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(sim_time), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(weather <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sunny"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(sim_time)),</span>
<span id="cb3-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(sim_time), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(sim_time)),</span>
<span id="cb3-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weather =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rainy"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> sim_time), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sunny"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> sim_time))</span>
<span id="cb3-26">)</span>
<span id="cb3-27"></span>
<span id="cb3-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(weather_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, prop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> weather)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_area</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb3-31">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Proportion of each weather"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Days"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qual"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Weather"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Convergence to stationary distribution"</span>,</span>
<span id="cb3-35">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Based on cumulative proportion of each Sunny or Rainy days"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-5-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Cumulative mean proportion of sunny/rainy days across 365 days. Right pass the 100 days, the proportion of rainy/sunny days tends to display a stable trend when we averaged the previous days. This is known as stationary distribution."><img src="https://bayesically-speaking.com/posts/2024-04-14 mcmc part 1/index_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img" alt="Cumulative mean proportion of sunny/rainy days across 365 days. Right pass the 100 days, the proportion of rainy/sunny days tends to display a stable trend when we averaged the previous days. This is known as stationary distribution."></a></p>
<figcaption class="margin-caption">Cumulative mean proportion of sunny/rainy days across 365 days. Right pass the 100 days, the proportion of rainy/sunny days tends to display a stable trend when we averaged the previous days. This is known as stationary distribution.</figcaption>
</figure>
</div>
</div>
</div>
<p>This heuristic allows us to naturally converge to an answer <strong>without needing to solve it analytically</strong>, which tends to be useful for really complex and high-dimensional problems.</p>
<p>Sure, we could’ve crunched the numbers ourselves to figure out these probabilities. But why bother with all that math when we can let time do its thing and <strong>naturally converge to the same answer?</strong> Especially when we’re dealing with <strong>complex problems</strong> that could have given even Einstein himself a headache.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Explaining the convergence process further
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The idea of convergence to a stationary distribution can be likened to taking a random walk through the space of possible outcomes. Over time, the relative frequencies of each outcome stabilize, giving us a reliable estimate of the true probabilities.</p>
</div>
</div>
</div>
<p>As we’ve seen, sometimes it becomes impractical to solve analytically or even approximate the posterior distribution using a grid, given the number of calculations needed to even get a decent approximation of the posterior.</p>
<p>However, we’ve also seen that <strong>Markov Chains</strong> might offer us a way to compute <strong>complex conditional probabilities</strong> and, if we let them run long enough, they will eventually converge to the stationary distribution, which could resemble the posterior distribution itself. So, all things considered, when does the Monte Carlo part come in?</p>
</section>
</section>
<section id="the-need-for-monte-carlo-methods" class="level1 page-columns page-full">
<h1>The Need for Monte Carlo Methods</h1>
<p>Alright, let’s break down the magic of Monte Carlo methods in plain English. Picture this: in the wacky world of random events, being able to <strong>sample from a distribution</strong> is like having a crystal ball to predict the future, pretty nifty, right?</p>
<p>Now, imagine we’re sampling from a normal probability density, say, with a mean of 80 and a standard deviation of 5. <strong>We grab a random sample</strong> of 10 folks, calculate their average weight, <strong>and repeat this process</strong> a thousand times.</p>
<p>In the following figure, we overlay the calculated sample mean, from each simulated sample using a histogram, to the population distribution from which we are sampling. As you can see, this sets an interesting opportunity, using this Monte Carlo simulation, <strong>we can get an intuition of how likely</strong> is, to our sample of 10 individuals, have a mean outside the range of 75 to 85, it’s not impossible, but it’s unlikely.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">mean_weights <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colMeans</span>()</span>
<span id="cb4-3"></span>
<span id="cb4-4">cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ggsci<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pal_jama</span>()(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(.x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"area"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> cols[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mean_weights, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">after_stat</span>(density)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.75</span>),</span>
<span id="cb4-9">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> cols[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> cols[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Weight (kg)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_curve</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">74.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.061</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)</span>
<span id="cb4-14">    ), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> yend),</span>
<span id="cb4-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inches"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"closed"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_curve</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb4-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">82</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.061</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)</span>
<span id="cb4-18">    ), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> yend),</span>
<span id="cb4-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inches"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"closed"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">67</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">94</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0605</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">distribution"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Means of each</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">simulated sample"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-6-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Sampling distribution of 10 individuals per sample overlayed to the population distribution. Each sample is drawn from a normal distribution of mean of 80 and standard deviation of 5, representing the population distribution of weight."><img src="https://bayesically-speaking.com/posts/2024-04-14 mcmc part 1/index_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img" alt="Sampling distribution of 10 individuals per sample overlayed to the population distribution. Each sample is drawn from a normal distribution of mean of 80 and standard deviation of 5, representing the population distribution of weight."></a></p>
<figcaption class="margin-caption">Sampling distribution of 10 individuals per sample overlayed to the population distribution. Each sample is drawn from a normal distribution of mean of 80 and standard deviation of 5, representing the population distribution of weight.</figcaption>
</figure>
</div>
</div>
</div>
<p>With each sample, we’re capturing the randomness of the population’s weight distribution. And hey, it’s not just about weight; <strong>we can simulate all sorts of wild scenarios</strong>, from multi-variable mayhem to linear model lunacy. This is the heart and soul of Monte Carlo methods: taking random shots in the dark to mimic complex processes.</p>
<p>But here’s the kicker: <strong>the more samples we take, the clearer the picture becomes</strong>. For instance, if we take ten times the amount of samples used, we would get <strong>a better intuition about the uncertainty around the expectation</strong> for each sample of 10 individuals, which could have important applications in the design of experiments and hypothesis testing.</p>
<p>And that’s where Monte Carlo methods shine. By generating a boatload of samples, we can unravel the mysteries of even the trickiest distributions, no crystal ball required. It’s a game changer for exploring the unknown without needing a PhD in rocket science.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Explaining the importance of Monte Carlo further
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Monte Carlo methods provide a powerful tool for <strong>approximating complex distributions</strong> by sampling from them. By generating a large number of samples, we can gain insight into the shape and properties of the distribution without needing to explicitly calculate all possible outcomes.</p>
</div>
</div>
</div>
</section>
<section id="basics-of-mcmc" class="level1 page-columns page-full">
<h1>⁠Basics of MCMC</h1>
<p>Alright, let’s break down the basics of MCMC. Picture this: you’ve got these two heavyweights in the world of statistics, Markov Chains and Monte Carlo methods.</p>
<p>On one side, you’ve got Markov Chains. These bad boys <strong>help us predict the probability of something happening based on what happened before</strong>. It’s like saying, “Hey, if it rained yesterday, what’s the chance it’ll rain again today?”</p>
<p>Then, there are Monte Carlo methods. These puppies <strong>work by randomly sampling from a distribution</strong> to get an idea of what the whole shebang looks like. It’s like throwing a bunch of darts at a dartboard in the dark and hoping you hit the bullseye.</p>
<p>However the question remains, how do they team up to tackle real-world problems?</p>
<section id="what-is-mcmc-actually-doing" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="what-is-mcmc-actually-doing">What is MCMC actually doing?</h4>
<p>In essence, <strong>MCMC is an algorithm that generates random samples from a proposal distribution</strong>. These samples are accepted or rejected based on how much more likely the proposed sample is compared to the previous accepted sample.</p>
<p>In this way, the proposed samples are <strong>accepted in the same proportion as the actual probability in the target distribution</strong>, accepting more samples that are more likely and fewer samples that are less likely.</p>
<p>The fascinating nature of this heuristic is that it works to approximate complex distributions without needing to know much about the shape of the final distribution.</p>
<p>So, think of it as trekking through this complex landscape, <strong>taking random steps</strong> (the Monte Carlo part) but <strong>guided by the likelihood of each move</strong>, given where you currently stand (the Markov Chain part). It’s a meticulous journey, but one that ultimately leads us to a better understanding of these elusive distributions.</p>
<p>For instance, consider that we have a distribution (shown below) that we can’t to compute, because <strong>it would take too long to integrate</strong> the whole function. This will be our target distribution, from which we can only compute the density of <strong>one value at a time</strong>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About the target distribution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In practice, we would derive the target distribution from the data and prior information, this enable us to estimate the density in a <strong>point-wise manner</strong>, without the need to estimate the whole PDF all at once. But for the sake of demonstration we will the use the <strong>Gamma probability density function</strong>.</p>
<p>However, please consider that you can’t use some family distribution to describe perfectly any probability density, sometimes it can be a mixture of distributions, truncation, censoring. <strong>All comes down to the underlying process that generates the data that we are trying to mimic</strong>.</p>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Target distribution that we in practice would derive from</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the data.</span></span>
<span id="cb5-3">target_dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dgamma</span>(i, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> target_dist,</span>
<span id="cb5-7">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"area"</span>, </span>
<span id="cb5-8">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#374E55FF"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Some scale"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-7-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="This is a Gamma distribution with shape of 2 and scale of 1. We will try to estimate it."><img src="https://bayesically-speaking.com/posts/2024-04-14 mcmc part 1/index_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img" alt="This is a Gamma distribution with shape of 2 and scale of 1. We will try to estimate it."></a></p>
<figcaption class="margin-caption">This is a Gamma distribution with shape of 2 and scale of 1. We will try to estimate it.</figcaption>
</figure>
</div>
</div>
</div>
<p>Next thing to do is to specify a proposal distribution, from which we’ll generate proposals for the next step. To this end we’ll be using a Normal density function with <img src="https://latex.codecogs.com/png.latex?%5Cmu"> = 0 and <img src="https://latex.codecogs.com/png.latex?%5Csigma"> = 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This is a function that will generate proposals for the next step.</span></span>
<span id="cb6-2">proprosal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>() <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<p>And set some algorithm parameters that are necessary for our MCMC to run:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Algorithm parameters ----</span></span>
<span id="cb7-2"></span>
<span id="cb7-3">total_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Total number of steps</span></span>
<span id="cb7-4">step <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We start at step 1</span></span>
<span id="cb7-5">value <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set a initial starting value</span></span></code></pre></div>
</div>
<p>Finally, we run our algorithm as explained in previous sections. Try to follow the code to get an intuition of what is doing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Algorithm ----</span></span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1234</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Seed for reproducibility</span></span>
<span id="cb8-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span>(step <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> total_steps) {</span>
<span id="cb8-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Increase for next step</span></span>
<span id="cb8-6">  step <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> step <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb8-7">  </span>
<span id="cb8-8">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1. Propose a new value ----</span></span>
<span id="cb8-9">  </span>
<span id="cb8-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Proposal of the next step is ...</span></span>
<span id="cb8-11">  value[step] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb8-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the previous step plus...</span></span>
<span id="cb8-13">    value[step <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># a change in a random direction (based on the </span></span>
<span id="cb8-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># proposal distribution)</span></span>
<span id="cb8-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">proprosal</span>() </span>
<span id="cb8-17">  </span>
<span id="cb8-18">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 2. We see if the new value is more or less likely ----</span></span>
<span id="cb8-19">  </span>
<span id="cb8-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># How likely (in the target distribution)</span></span>
<span id="cb8-21">  likelihood <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb8-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># is the proposed value compared to the previous step</span></span>
<span id="cb8-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">target_dist</span>(value[step]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">target_dist</span>(value[step <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L]) </span>
<span id="cb8-24">  </span>
<span id="cb8-25">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 3. Based on its likelihood, we accept or reject it ----</span></span>
<span id="cb8-26">  </span>
<span id="cb8-27">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If the proposal value is less likely, we accept it only </span></span>
<span id="cb8-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to the likelihood of the proposed value</span></span>
<span id="cb8-29">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (likelihood <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) </span>
<span id="cb8-30">    value[step] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> value[step <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L]</span>
<span id="cb8-31">  </span>
<span id="cb8-32">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Then we repeat for the next step</span></span>
<span id="cb8-33">}</span></code></pre></div>
</div>
<p>Finally, let’s explore how well our algorithm converge to the target distribution.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">mcmc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb9-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">step =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(step),</span>
<span id="cb9-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> value</span>
<span id="cb9-4">)</span>
<span id="cb9-5"></span>
<span id="cb9-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(mcmc, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> step, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#374E55FF"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-8">  ggside<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ysidehistogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">after_stat</span>(count)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#374E55FF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-9">  ggside<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ysidedensity</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">after_stat</span>(count)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#374E55FF"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-10">  ggside<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_ysidex_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Step"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Trace of MCMC values to target distribution"</span>,</span>
<span id="cb9-14">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Evolution of values at each step"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-16">  ggside<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggside</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y.pos =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ggside.panel.scale =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-11-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Traceplot of convergence of MCMC for 1000 steps. With increasing steps we see an increasing resemblance to the target distribution."><img src="https://bayesically-speaking.com/posts/2024-04-14 mcmc part 1/index_files/figure-html/unnamed-chunk-11-1.svg" class="img-fluid figure-img" alt="Traceplot of convergence of MCMC for 1000 steps. With increasing steps we see an increasing resemblance to the target distribution."></a></p>
<figcaption class="margin-caption">Traceplot of convergence of MCMC for 1000 steps. With increasing steps we see an increasing resemblance to the target distribution.</figcaption>
</figure>
</div>
</div>
</div>
<p>Another thing that we care is to see <strong>how well our MCMC is performing</strong>. After all, if not, then what would be the point of using it in first place? To check this, <strong>we’ll compare the expectation</strong> (<img src="https://latex.codecogs.com/png.latex?E(X)">) of the target distribution <strong>against the posterior derived from our MCMC</strong>.</p>
<p>For this, we have to consider that the expectation, <img src="https://latex.codecogs.com/png.latex?E(X)">, of any Gamma distribution is equal to the shape parameter (<img src="https://latex.codecogs.com/png.latex?%5Calpha">) times by the scale parameter (<img src="https://latex.codecogs.com/png.latex?%5Csigma">). We could express the aforementioned the following.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20E(X)%20&amp;=%20%5Calpha%20%5Csigma%20%5C%5C%0A%20%20%5Ctext%7Bwith%7D~X%20&amp;%5Csim%20%5Ctext%7BGamma%7D(%5Calpha,%20%5Csigma)%0A%5Cend%7Baligned%7D%0A"></p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(mcmc, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> step, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(value)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>step)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#374E55FF"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Steps (log-scale)"</span>, </span>
<span id="cb10-4">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">transform =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log10"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_log</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Convergence to location parameter"</span>,</span>
<span id="cb10-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cumulative mean across steps"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(value)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"curve"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb10-11">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"in"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"closed"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.8</span>,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Initial value"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"curve"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb10-14">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"in"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"closed"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.8</span>,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Convergence"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-12-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Cumulative mean of the posterior distributions across steps, compared to the empirical mean of the target distribution. Here the dark red line represents the empirical location parameter and the dashed line the one estimated using MCMC."><img src="https://bayesically-speaking.com/posts/2024-04-14 mcmc part 1/index_files/figure-html/unnamed-chunk-12-1.svg" class="img-fluid figure-img" alt="Cumulative mean of the posterior distributions across steps, compared to the empirical mean of the target distribution. Here the dark red line represents the empirical location parameter and the dashed line the one estimated using MCMC."></a></p>
<figcaption class="margin-caption">Cumulative mean of the posterior distributions across steps, compared to the empirical mean of the target distribution. Here the dark red line represents the empirical location parameter and the dashed line the one estimated using MCMC.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="popular-mcmc-algorithms" class="level1">
<h1>⁠Popular MCMC Algorithms</h1>
<p>This general process is central to MCMC, but more specifically to the <strong>Metropolis-Hastings</strong> algorithm. However, and in order to broaden our understanding, let’s explore additional MCMC algorithms beyond the basic Metropolis-Hastings with some simple examples.</p>
<section id="gibbs-sampling-a-buffet-adventure" class="level4">
<h4 class="anchored" data-anchor-id="gibbs-sampling-a-buffet-adventure">Gibbs Sampling: A Buffet Adventure</h4>
<p>Imagine you’re at a buffet with stations offering various cuisines (Italian, Chinese, Mexican, you name it). <strong>You’re on a mission to create a plate with a bit of everything</strong>, but here’s the catch: you can only visit one station at a time. Here’s how you tackle it:</p>
<ol type="1">
<li>Hit up a station and <strong>randomly pick a dish</strong>.</li>
<li><strong>Move on to the next station</strong> and repeat the process.</li>
<li>Keep going until you’ve got a plateful of diverse flavors.</li>
</ol>
<p>Gibbs sampling works kind of like this buffet adventure. <strong>You take turns sampling from conditional distributions</strong>, just like you visit each station for a dish. Each time, you focus on one variable, <strong>updating its value while keeping the others constant</strong>. It’s like building your plate by sampling from each cuisine until you’ve got the perfect mix.</p>
</section>
<section id="hamiltonian-monte-carlo-charting-your-hiking-path" class="level4">
<h4 class="anchored" data-anchor-id="hamiltonian-monte-carlo-charting-your-hiking-path">Hamiltonian Monte Carlo: Charting Your Hiking Path</h4>
<p>Picture yourself hiking up a rugged mountain with rocky trails and valleys. Your goal? <strong>Reach the summit without breaking a sweat</strong> (or falling off a cliff). So, you whip out your map and binoculars to plan your route:</p>
<ol type="1">
<li>Study the map to plot a path with <strong>minimal uphill battles and maximum flat stretches</strong>.</li>
<li>Use the binoculars to <strong>scout ahead and avoid obstacles</strong> along the way.</li>
<li><strong>Adjust your route as you go</strong>, smoothly navigating the terrain like a seasoned pro.</li>
</ol>
<p>Hamiltonian Monte Carlo (HMC) is a bit like this hiking adventure. It simulates a particle moving through a high-dimensional space, <strong>using gradient info to find the smoothest path</strong>. Instead of blindly wandering, HMC leverages the curvature of the target distribution to explore efficiently. It’s like hiking with a GPS that guides you around the rough spots and straight to the summit.</p>
</section>
<section id="strengths-weaknesses-and-real-world-applications" class="level4">
<h4 class="anchored" data-anchor-id="strengths-weaknesses-and-real-world-applications">Strengths, Weaknesses, and Real-World Applications</h4>
<p>Now that you’ve dipped your toes into the MCMC pool, it’s time to talk turkey (well, sampling). Each MCMC method has its perks and quirks, and knowing them is half the battle.</p>
<p><strong>Gibbs sampling</strong> is the laid-back surfer dude of the group, simple, chill, and <strong>great for models with structured dependencies</strong>. But throw in some highly correlated variables, and it starts to wobble like a rookie on a surfboard.</p>
<p>Meanwhile, <strong>HMC</strong> is the sleek Ferrari, efficient, powerful, and <strong>perfect for tackling complex models</strong> head-on. Just don’t forget to fine-tune those parameters, or you might end up spinning out on a sharp curve.</p>
</section>
<section id="key-differences" class="level4">
<h4 class="anchored" data-anchor-id="key-differences">Key Differences</h4>
<section id="sampling-approach" class="level5">
<h5 class="anchored" data-anchor-id="sampling-approach">Sampling Approach</h5>
<ul>
<li><strong>Metropolis-Hastings</strong>: Takes random walks to generate samples, with acceptance based on a ratio of target distribution probabilities.</li>
<li><strong>Gibbs Sampling</strong>: Updates variables one by one based on conditional distributions, like a tag team wrestling match.</li>
<li><strong>Hamiltonian Monte Carlo</strong>: Glides through high-dimensional space using deterministic trajectories guided by Hamiltonian dynamics, like a graceful dancer in a crowded room.</li>
</ul>
</section>
<section id="efficiency-and-exploration" class="level5">
<h5 class="anchored" data-anchor-id="efficiency-and-exploration">Efficiency and Exploration</h5>
<ul>
<li><strong>Metropolis-Hastings</strong>: Easy to implement but might struggle to explore efficiently, especially in high-dimensional spaces.</li>
<li><strong>Gibbs Sampling</strong>: Perfect for structured models but may stumble with highly correlated variables.</li>
<li><strong>Hamiltonian Monte Carlo</strong>: Efficiently navigates high-dimensional spaces, leading to faster convergence and smoother mixing.</li>
</ul>
</section>
<section id="acceptance-criterion" class="level5">
<h5 class="anchored" data-anchor-id="acceptance-criterion">Acceptance Criterion</h5>
<ul>
<li><strong>Metropolis-Hastings</strong>: Decides whether to accept or reject proposals based on a ratio of target distribution probabilities.</li>
<li><strong>Gibbs Sampling</strong>: Skips the acceptance drama and generates samples directly from conditional distributions.</li>
<li><strong>Hamiltonian Monte Carlo</strong>: Judges proposals based on the joint energy of position and momentum variables, like a strict dance instructor.</li>
</ul>
</section>
<section id="parameter-tuning-and-complexity" class="level5">
<h5 class="anchored" data-anchor-id="parameter-tuning-and-complexity">Parameter Tuning and Complexity</h5>
<ul>
<li><strong>Metropolis-Hastings</strong>: Requires tweaking the proposal distribution but keeps it simple.</li>
<li><strong>Gibbs Sampling</strong>: A breeze to implement, but watch out for those conditional distributions (they can be sneaky).</li>
<li><strong>Hamiltonian Monte Carlo</strong>: Needs tuning of parameters like step size and trajectory length, and the implementation might get a bit hairy with momentum variables and gradient computation.</li>
</ul>
</section>
</section>
<section id="mcmc-in-action" class="level4">
<h4 class="anchored" data-anchor-id="mcmc-in-action">MCMC in action</h4>
<p>In the following, you can see <strong>an interactive animation</strong> of different MCMC algorithms (MH, Gibbs and HMC) and <strong>how they work</strong> to uncover distributions in two dimensions. The code for this animation is borrowed from <a href="https://github.com/chi-feng">Chi Feng’s github</a>. You can find the original repository with corresponding code here: <a href="https://github.com/chi-feng/mcmc-demo" class="uri">https://github.com/chi-feng/mcmc-demo</a></p>
<div style="text-align: center;">
<iframe width="90%" height="500" src="mcmc-demo-master/app.html" title="MCMC">
</iframe>
</div>
</section>
</section>
<section id="practical-tips-for-the-real-world" class="level1">
<h1>Practical Tips for the Real World</h1>
<section id="implementing-mcmc-algorithms-in-practice" class="level4">
<h4 class="anchored" data-anchor-id="implementing-mcmc-algorithms-in-practice">Implementing MCMC Algorithms in Practice</h4>
<p>Alright, theory’s cool and all, but let’s get down to brass tacks. When you’re rolling up your sleeves to implement MCMC algorithms, it’s like picking the right tool for the job. Simple models? <strong>Metropolis-Hastings</strong> or <strong>Gibbs sampling</strong> has your back. But when you’re wrangling with the big boys (those complex models) that’s when you call in <strong>Hamiltonian Monte Carlo</strong>. It’s like upgrading from a rusty old wrench to a shiny new power tool. And don’t forget about tuning those parameters, it’s like fine-tuning your car for a smooth ride.</p>
<p>Beyond all the technical jargon, successful Bayesian inference is part gut feeling, part detective work. Picking the right priors is like seasoning a dish, you want <strong>just the right flavor without overpowering everything else</strong>. And tuning those parameters? It’s like fine-tuning your favorite instrument to make sure the music hits all the right notes.</p>
</section>
<section id="challenges-and-what-lies-ahead" class="level4">
<h4 class="anchored" data-anchor-id="challenges-and-what-lies-ahead">Challenges and What Lies Ahead</h4>
<p>But hey, nothing worth doing is ever a walk in the park, right? MCMC might be the hero of the Bayesian world, but <strong>it’s not without its challenges</strong>. Scaling up to big data? It’s like trying to squeeze into those skinny jeans from high school (uncomfortable and a bit awkward). And exploring those complex parameter spaces? <strong>It’s like navigating a maze blindfolded</strong>.</p>
<p>But fear not! There’s always a light at the end of the tunnel. Recent innovations in Bayesian inference, like <strong>variational inference</strong> (we’ll tackle this cousin of MCMC in a future post) and <strong>probabilistic programming languages</strong>, are like shiny beacons, guiding us to new horizons.</p>
<p>These days, some probabilistic programming languages, <strong>like Stan</strong>, use a souped-up version of the Hamiltonian Monte Carlo algorithm with <strong>hyperparameters tuned on the fly</strong>. These tools are like magic wands that turn your ideas into reality, just specify your model, and let the parameter space exploration happen <strong>in the background</strong>, no sweat.</p>
</section>
<section id="wrapping-it-up" class="level4">
<h4 class="anchored" data-anchor-id="wrapping-it-up">Wrapping It Up</h4>
<p>As we wrap up our journey into the world of MCMC, let’s take a moment to appreciate the wild ride we’ve been on. MCMC might not wear a cape, but it’s the hero behind so much of what we do in <strong>Bayesian data analysis</strong>. It’s the tool that lets us dive headfirst into the <strong>murky waters of uncertainty</strong> and come out the other side with <strong>clarity and insight</strong>.</p>
<p>In the next episode of our MCMC series, we’ll dive into the infamous <strong>Hamiltonian Monte Carlo</strong> and explore the statistical wizardry behind this and other similar algorithms. Until then, happy sampling!</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{castillo-aguilar2024,
  author = {Castillo-Aguilar, Matías},
  title = {Markov {Chain} {Monte} {What?}},
  date = {2024-04-25},
  url = {https://bayesically-speaking.com/posts/2024-04-14 mcmc part 1/},
  doi = {10.59350/mxfyk-6av39},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-castillo-aguilar2024" class="csl-entry quarto-appendix-citeas">
Castillo-Aguilar, Matías. 2024. <span>“Markov Chain Monte What?”</span>
April 25, 2024. <a href="https://doi.org/10.59350/mxfyk-6av39">https://doi.org/10.59350/mxfyk-6av39</a>.
</div></div></section></div> ]]></description>
  <category>mcmc</category>
  <category>algorithms</category>
  <category>educational</category>
  <guid>https://bayesically-speaking.com/posts/2024-04-14 mcmc part 1/</guid>
  <pubDate>Thu, 25 Apr 2024 03:00:00 GMT</pubDate>
  <media:content url="https://bayesically-speaking.com/posts/2024-04-14 mcmc part 1/body_1.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Welcome to Bayesically Speaking</title>
  <dc:creator>Matías Castillo-Aguilar</dc:creator>
  <link>https://bayesically-speaking.com/posts/2023-05-30 welcome/</link>
  <description><![CDATA[ 





<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="hello_world.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Photo from Jon Tyson at Unsplash."><img src="https://bayesically-speaking.com/posts/2023-05-30 welcome/hello_world.jpeg" class="rounded img-fluid figure-img" alt="Photo from Jon Tyson at Unsplash."></a></p>
<figcaption class="margin-caption">Photo from <a href="https://unsplash.com/@jontyson?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Jon Tyson</a> at <a href="https://unsplash.com/es/fotos/tangfe8KQdw?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a>.</figcaption>
</figure>
</div>
<section id="hello-stranger" class="level1 page-columns page-full">
<h1>Hello stranger</h1>
<p>Alright folks, welcome to ‘Bayesically Speaking’! Yes, I know, I’m a word nerd. Sue me. But seriously, I’ve been wanting to share my love for all things Bayesian for ages. It’s like, the internet is down right now, so I figured, ‘What the heck, let’s just do it!’ You know how everyone tells you to ‘follow your dreams’? Well, this is my dream: to spread the gospel of Bayes to the masses (or at least to anyone who’s still reading).</p>
<p>For years, I’ve been obsessed with stats, especially how they can help us unravel the mysteries of health. It’s like, you have these puzzle pieces, and you’re trying to figure out how they fit together. But sometimes, you look at one piece in isolation, and it seems pretty boring. But then you put two pieces together, and BOOM! Suddenly, you see a hidden pattern, a secret message! That’s the magic of statistics for me.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">sim_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_simpson</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, </span>
<span id="cb1-2">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">difference =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb1-3">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">groups =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb1-4">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.table</span>()</span>
<span id="cb1-6"></span>
<span id="cb1-7">sim_data[, Group <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(Group, </span>
<span id="cb1-8">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G_1"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G_2"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G_3"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G_4"</span>),</span>
<span id="cb1-9">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Placebo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low dose"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Medium dose"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High dose"</span>))]</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(sim_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(V1, V2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> Group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qual"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time exposure"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(Delta<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TNF-"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>alpha)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-2-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="In this example, the whole sample correlation is about -0.71 (meaning a negative relationship), but the within group correlation is 0.7 (the exact opposite effect). This phenomenom is better known as Simpson’s Paradox."><img src="https://bayesically-speaking.com/posts/2023-05-30 welcome/index_files/figure-html/unnamed-chunk-2-1.svg" class="img-fluid figure-img" alt="In this example, the whole sample correlation is about -0.71 (meaning a negative relationship), but the within group correlation is 0.7 (the exact opposite effect). This phenomenom is better known as Simpson’s Paradox."></a></p>
<figcaption class="margin-caption">In this example, the whole sample correlation is about -0.71 (meaning a negative relationship), but the within group correlation is 0.7 (the exact opposite effect). This phenomenom is better known as Simpson’s Paradox.</figcaption>
</figure>
</div>
</div>
</div>
<section id="the-statistics-toolbox" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="the-statistics-toolbox">The statistics toolbox</h4>
<p>Now, let’s talk about the classic stats toolbox. You know, the t-tests, ANOVAs, and regressions (the old reliables). They’re like those trusty old hammers, simple, easy to use, and they get the job done most of the time. But let’s be honest, they’re not exactly Swiss Army knives. They start to struggle when things get messy. Asymmetrical data? Forget about it. Non-linear relationships? Good luck! And don’t even get me started on unbalanced groups or those pesky outliers.</p>
<p>Enter the non-parametric heroes! These guys are more flexible, like those fancy adjustable wrenches. But they can be a bit… mysterious. It’s hard to predict how they’ll behave in new situations, which can be a bit nerve-wracking.</p>
<p>Then there are the ‘black box’ models (neural networks, random forests, and their cousins). These are like those super-powered AI robots. They can handle any data you throw at them, no matter how messy. But sometimes, you have no idea what’s going on inside. It’s like magic, but not in a good way. You just hope it doesn’t turn against you.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="body_1.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Just between us, I only put this picture because it looked cool. Photo from Dan Cristian Pădureț at Unsplash."><img src="https://bayesically-speaking.com/posts/2023-05-30 welcome/body_1.jpeg" class="rounded img-fluid figure-img" alt="Just between us, I only put this picture because it looked cool. Photo from Dan Cristian Pădureț at Unsplash."></a></p>
<figcaption class="margin-caption">Just between us, I only put this picture because it looked cool. Photo from <a href="https://unsplash.com/pt-br/@dancristianpaduret?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Dan Cristian Pădureț</a> at <a href="https://unsplash.com/es/fotos/h3kuhYUCE9A?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a>.</figcaption>
</figure>
</div>
<p>So, we have these fancy new tools, but something’s missing. We need to bring our own brains into the equation! After all, we don’t just blindly stare at data. We bring our own experiences, our own biases (hey, we’re human!), and our own gut feelings to the table.</p>
<p>That’s where Bayes comes in, the master of incorporating ‘prior knowledge.’ It’s like saying, ‘Hey, I know a little something about this already, so let’s not start from scratch.’ And instead of just giving us a dry ‘yes’ or ‘no’ answer, Bayes gives us a whole range of possibilities, complete with confidence levels. It’s like, ‘I’m 90% sure this is true, but there’s still a 10% chance I’m completely wrong.’ Much more honest, wouldn’t you say?</p>
<p>Alright, let’s play a little mind game. Imagine you’re convinced this coin is rigged. You’ve flipped it 15 times and seen heads a whopping 10 times! You’re thinking, “This thing is clearly biased towards heads.” You calculate your odds: 10 heads out of 15 flips, that’s a 66% chance of heads! You feel pretty confident, right?</p>
<p>Now, for the twist. You decide to put this coin to the test yourself. You flip it 15 times, and guess what? You get 13 tails! Only 2 measly heads. Talk about a reality check! Suddenly, your confidence is shaken. Based on your own experiment, the odds of getting heads plummet to a measly 13%.</p>
<p>So, what do you do? Throw your hands up in the air and declare your initial belief wrong? Not so fast! We need to find a way to reconcile these conflicting results. This is where Bayesian thinking comes to the rescue.</p>
</section>
<section id="lets-get-bayesian" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="lets-get-bayesian">Let’s Get Bayesian</h4>
<p>To figure out the true odds of getting heads, we need to use a bit of Bayesian magic. We’ll call the probability of getting heads “P(H)”.</p>
<p>Now, remember our initial belief? The one based on those first 15 flips? We can represent that belief using something called a Beta distribution.</p>
<div class="page-columns page-full"><p><img src="https://latex.codecogs.com/png.latex?%0AP(H)%20%5Csim%20Beta(10,%205)%0A"> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">This symbol “<img src="https://latex.codecogs.com/png.latex?%5Csim">” means <em>distributed as</em></span></div></div>
<p>Here, the Beta distribution parameters are (10, 5) since we had 10 heads and 5 tails in the prior experiment.</p>
<p>Now, a new experiment with the same 15 tosses gives us 2 heads. To update our prior belief, we can use this information to calculate the posterior probability which can be expressed as follow:</p>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>This symbol “<img src="https://latex.codecogs.com/png.latex?%5Cpropto">” means <em>proportional to</em></p>
</div></div><p><img src="https://latex.codecogs.com/png.latex?%0AP(H%20%7C%20Data)%20%5Cpropto%20P(Data%20%7C%20H)%20%5Ctimes%20P(H)%0A"></p>
<p>Which is equivalent as saying:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0APosterior%20%5Cpropto%20Likelihood%20%5Ctimes%20Prior%0A"></p>
<p>To find our updated belief about the probability of heads (the “posterior probability”), we need to combine our prior belief with the new evidence. This involves some fancy math – we multiply the likelihood (the probability of getting our observed results) by our prior belief.</p>
<p>Now, there’s a little trick here. Since our prior belief follows a Beta distribution, and our data fits a binomial distribution, the math works out beautifully. The posterior distribution will also be a Beta distribution! This makes our lives much easier.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
A Quick Note on Normalization
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>When we multiply our prior and likelihood, we get a distribution that looks like the final answer, but it’s not quite right. It’s like having a delicious cake batter, but forgetting to bake it! It needs to be “normalized” to make sure it adds up to 1. Usually, this involves some complex math, but luckily, we don’t need to worry about that in this case.</p>
</div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%0AP(H%20%7C%20Data)%20%5Csim%20Beta(10%20+%202,%205%20+%2013)%0A"></p>
<p>After incorporating the data from the new experiment, the parameters of the Beta distribution become (12, 18) since we had 2 heads and 13 tails in the new experiment, meaning 12 heads and 18 tails in total.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About conjugacy
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>This is where things get really interesting. Remember how I mentioned that the posterior distribution is also a Beta distribution? That’s not a coincidence! It’s a special property called “conjugacy”.</p>
<p>Think of it like this: Imagine you have a set of building blocks. Your prior belief is one type of block, and the new data you collect is another type. When you combine them, you get a block of the exact same type!</p>
<p>This <em>conjugacy</em> property is a huge time-saver. Instead of doing a bunch of complicated calculations, we can use a much more simple formula to find our updated belief. It’s like having a shortcut through a maze, much faster and easier!</p>
</div>
</div>
</div>
<p>To calculate the posterior probability of getting heads, we can consider the mode (maximum) of the Beta distribution, which is <img src="https://latex.codecogs.com/png.latex?(a%20-%201)%20/%20(a%20+%20b%20-%202)">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AP(H%20%7C%20Data)%20&amp;=%20(12%20-%201)%20/%20(12%20+%2018%20-%202)%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20%20%20&amp;=%2011%20/%2028%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%200.39%0A%5Cend%7Baligned%7D%0A"></p>
<p>Therefore, the posterior probability of getting heads is approximately 39% when we consider all the available evidence.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prior and Likelihood functions</span></span>
<span id="cb2-2">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to_log =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbeta</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log =</span> to_log)</span>
<span id="cb2-3">prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to_log =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbeta</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log =</span> to_log)</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Posterior</span></span>
<span id="cb2-6">posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb2-7">  p_fun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb2-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Operation is on log-scale merely for computing performance</span></span>
<span id="cb2-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and minimize rounding errors giving the small nature of</span></span>
<span id="cb2-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># probability density values at each interval.</span></span>
<span id="cb2-11">    i_log <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(i, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to_log =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(i, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to_log =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb2-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Then transformed back to get probabilities again</span></span>
<span id="cb2-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(i_log)</span>
<span id="cb2-14">  }</span>
<span id="cb2-15">  </span>
<span id="cb2-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Then we integrate using base function `integrate`</span></span>
<span id="cb2-17">  const <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integrate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">f =</span> p_fun, </span>
<span id="cb2-18">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lower =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>L,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">upper =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L, </span>
<span id="cb2-19">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subdivisions =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>L,</span>
<span id="cb2-20">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rel.tol =</span> .Machine<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>double.eps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>value</span>
<span id="cb2-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_fun</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> const</span>
<span id="cb2-22">}</span>
<span id="cb2-23"></span>
<span id="cb2-24"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Plotting phase</span></span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### Color palette</span></span>
<span id="cb2-27">col_pal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Prior =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#DEEBF7"</span>, </span>
<span id="cb2-28">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Data =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#3182BD"</span>, </span>
<span id="cb2-29">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Posterior =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#9ECAE1"</span>)</span>
<span id="cb2-30"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### Main plotting code</span></span>
<span id="cb2-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-32">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### Main probability density functions</span></span>
<span id="cb2-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_function</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"density"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_function</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Prior"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> prior, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"density"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_function</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Posterior"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> posterior, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"density"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-36">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### Minor aesthetics tweaks</span></span>
<span id="cb2-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probability of getting heads"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> col_pal, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aesthetics =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fill"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>(), </span>
<span id="cb2-40">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb2-43">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.spacing.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-44">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### Arrows</span></span>
<span id="cb2-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_curve</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">81</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">69232</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.425</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-46">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beta(10,5)"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_curve</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">07693</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.45</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-49">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.85</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beta(2,13)"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_curve</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3847</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.4</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-52">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"≈ 39%"</span>))</span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Graphical representation of the posterior probability as the combination of both the data and the prior evidence"><img src="https://bayesically-speaking.com/posts/2023-05-30 welcome/index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img" alt="Graphical representation of the posterior probability as the combination of both the data and the prior evidence"></a></p>
<figcaption class="margin-caption">Graphical representation of the posterior probability as the combination of both the data and the prior evidence</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="practical-implications" class="level1 page-columns page-full">
<h1>Practical implications</h1>
<p>This example is a prime example of how Bayes works its magic. Imagine your beliefs as a stubborn old dog, set in its ways. Then comes along some shiny new data, like a juicy steak. Bayes, the wise dog whisperer, gently nudges the old dog towards the steak, showing it that the world is bigger than its initial assumptions. Pretty cool, huh?</p>
<p>And get this, Bayes isn’t just some fancy math trick. It’s basically how our brains are wired! We’re all walking, talking Bayesian machines, constantly updating our internal models based on new experiences. Remember that time you thought your friend was a total grump? But then they surprised you with a hilarious joke? BAM! Your brain, the Bayesian overlord, adjusted your opinion.</p>
<div class="page-columns page-full"><p>As that fancypants statistician, <span class="citation" data-cites="gelman2013philosophy">Gelman and Shalizi (2013)</span>, once said (probably while sipping a fine whiskey), “Bayesians think they’ve discovered the secret to life, the universe, and everything”. Okay, maybe that’s a slight exaggeration, but you get the idea. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Actually, he said “A substantial school in the philosophy of science identifies Bayesian inference with inductive inference and even rationality as such, and seems to be strengthened by the rise and practical success of Bayesian statistics”, but hey! It’s close enough.</span></div></div>
<p>But let’s not get carried away. These powerful tools are like those fancy kitchen gadgets you see on TV infomercials. They promise to revolutionize your life, but sometimes they just end up collecting dust in the cupboard. We need to know when to use them and when to stick to simpler methods. Otherwise, we might end up overcomplicating things and driving ourselves crazy</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="body_2.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Photo from NASA at Unsplash."><img src="https://bayesically-speaking.com/posts/2023-05-30 welcome/body_2.jpeg" class="rounded img-float img-fluid figure-img" alt="Photo from NASA at Unsplash."></a></p>
<figcaption class="margin-caption">Photo from <a href="https://unsplash.com/de/@nasa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">NASA</a> at <a href="https://unsplash.com/es/fotos/Q1p7bh3SHj8?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a>.</figcaption>
</figure>
</div>
</section>
<section id="from-past-to-future" class="level1">
<h1>From past to future</h1>
<p>Remember the Dark Ages? I mean, not THAT Dark Ages, but the time before Bayesian stats were cool? Back then, those poor Bayesians were stuck with slide rules and abacuses, trying to wrangle those complex models. Talk about a statistical struggle! But fear not, my friends, for the computer gods have smiled upon us! Now, we mere mortals can unleash the power of Bayes with a few clicks. It’s like having a magic wand that whispers the secrets of the universe.</p>
<p>We, the self-proclaimed ‘Statisticians-in-Training’ (or maybe ‘Statisticians-in-Training-While-Sipping-Coffee’), are on a mission to spread the good word. Imagine, folks, the possibilities! We can finally tell our friends, ‘Oh, you think correlation equals causation? Please, let me introduce you to my Bayesian overlord!’ We can predict the next winning lottery number (well, maybe not, but we can at least pretend). And we can finally understand why our cat keeps knocking over that vase, it’s not just mischievous, it’s statistically significant!</p>
<p>So, grab your favorite caffeinated beverage and let’s dive headfirst into this statistical wonderland. We might not conquer the world (yet), but we’ll definitely have a lot of fun trying. And hey, who knows, maybe we’ll even discover the secret to a perfectly brewed cup of coffee using Bayesian inference. Now that’s a worthy pursuit, wouldn’t you say?</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-gelman2013philosophy" class="csl-entry">
Gelman, Andrew, and Cosma Rohilla Shalizi. 2013. <span>“Philosophy and the Practice of Bayesian Statistics.”</span> <em>British Journal of Mathematical and Statistical Psychology</em> 66 (1): 8–38.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{castillo-aguilar2023,
  author = {Castillo-Aguilar, Matías},
  title = {Welcome to {Bayesically} {Speaking}},
  date = {2023-06-10},
  url = {https://bayesically-speaking.com/posts/2023-05-30 welcome/},
  doi = {10.59350/35tc8-qyj10},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-castillo-aguilar2023" class="csl-entry quarto-appendix-citeas">
Castillo-Aguilar, Matías. 2023. <span>“Welcome to Bayesically
Speaking.”</span> June 10, 2023. <a href="https://doi.org/10.59350/35tc8-qyj10">https://doi.org/10.59350/35tc8-qyj10</a>.
</div></div></section></div> ]]></description>
  <category>news</category>
  <guid>https://bayesically-speaking.com/posts/2023-05-30 welcome/</guid>
  <pubDate>Sat, 10 Jun 2023 03:00:00 GMT</pubDate>
  <media:content url="https://bayesically-speaking.com/posts/2023-05-30 welcome/body_1.jpeg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
