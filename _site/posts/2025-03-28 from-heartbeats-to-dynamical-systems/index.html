<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Matías Castillo-Aguilar">
<meta name="dcterms.date" content="2025-03-28">
<meta name="description" content="Ever wondered how your heart’s existential crisis during exercise could be a math problem? We turned beats into equations, panic into differential calculus, and recovery into logistic drama. Spoiler: Your Fitbit data is way less fun. Join us as we dissect cardiac chaos with sarcasm, code, and zero chill.">

<title>From Heartbeats to Dynamical Systems – Bayesically Speaking</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-H5JH00934M"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-H5JH00934M', { 'anonymize_ip': true});
</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background-image: url(title-block.png);
background-size: cover;
      }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="citation_title" content="From Heartbeats to Dynamical Systems">
<meta name="citation_author" content="Matías Castillo-Aguilar">
<meta name="citation_publication_date" content="2025-03-28">
<meta name="citation_cover_date" content="2025-03-28">
<meta name="citation_year" content="2025">
<meta name="citation_online_date" content="2025-03-28">
<meta name="citation_fulltext_html_url" content="https://bayesically-speaking.com/posts/2025-03-28 from-heartbeats-to-dynamical-systems/">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Thinking about the action potential: The nerve signal as a window to the physical principles guiding neuronal excitability;,citation_author=Benjamin Drukarch;,citation_author=Micha MM Wilhelmus;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_volume=17;,citation_journal_title=Frontiers in cellular neuroscience;,citation_publisher=Frontiers Media SA;">
<meta name="citation_reference" content="citation_title=Basics of neurophysiology;,citation_author=Devon I Rubin;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_journal_title=Clinical Neurophysiology;,citation_publisher=Oxford University Press;">
<meta name="citation_reference" content="citation_title=Dynamic analysis of neural signal based on hodgkin–huxley model;,citation_author=Wei Yao;,citation_author=Yingchen Li;,citation_author=Zhihao Ou;,citation_author=Mingzhu Sun;,citation_author=Qiongxu Ma;,citation_author=Guanghong Ding;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=4;,citation_volume=46;,citation_journal_title=Mathematical Methods in the Applied Sciences;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Action potentials recorded from inside a nerve fibre;,citation_author=Alan L Hodgkin;,citation_author=Andrew F Huxley;,citation_publication_date=1939;,citation_cover_date=1939;,citation_year=1939;,citation_issue=3651;,citation_volume=144;,citation_journal_title=Nature;,citation_publisher=Nature Publishing Group UK London;">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Bayesically Speaking</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../services.html"> 
<span class="menu-text">Services</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/matcasti"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/matias_science"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">From Heartbeats to Dynamical Systems</h1>
                  <div>
        <div class="description">
          <p>Ever wondered how your heart’s existential crisis during exercise could be a math problem? We turned beats into equations, panic into differential calculus, and recovery into logistic drama. Spoiler: Your Fitbit data is way less fun. Join us as we dissect cardiac chaos with sarcasm, code, and zero chill.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">draft</div>
                <div class="quarto-category">dynamical systems</div>
                <div class="quarto-category">non-linear</div>
                <div class="quarto-category">simulation</div>
                <div class="quarto-category">educational</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://bayesically-speaking.com/cv">Matías Castillo-Aguilar</a> <a href="mailto:m99castillo@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-7291-247X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 28, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#how-well-turn-heartbeats-into-a-soap-opera-but-with-math" id="toc-how-well-turn-heartbeats-into-a-soap-opera-but-with-math" class="nav-link" data-scroll-target="#how-well-turn-heartbeats-into-a-soap-opera-but-with-math">How We’ll Turn Heartbeats Into a Soap Opera (But With Math)</a>
  <ul class="collapse">
  <li><a href="#step-1-split-the-drama-into-seasons" id="toc-step-1-split-the-drama-into-seasons" class="nav-link" data-scroll-target="#step-1-split-the-drama-into-seasons">Step 1: Split the Drama Into Seasons</a></li>
  <li><a href="#step-2-write-the-script-a.k.a.-differential-equations" id="toc-step-2-write-the-script-a.k.a.-differential-equations" class="nav-link" data-scroll-target="#step-2-write-the-script-a.k.a.-differential-equations">Step 2: Write the Script (a.k.a. Differential Equations)</a></li>
  <li><a href="#step-3-smoothie-recipe-for-transitions" id="toc-step-3-smoothie-recipe-for-transitions" class="nav-link" data-scroll-target="#step-3-smoothie-recipe-for-transitions">Step 3: Smoothie Recipe for Transitions</a></li>
  <li><a href="#step-4-let-the-computer-do-the-heavy-lifting" id="toc-step-4-let-the-computer-do-the-heavy-lifting" class="nav-link" data-scroll-target="#step-4-let-the-computer-do-the-heavy-lifting">Step 4: Let the Computer Do the Heavy Lifting</a></li>
  <li><a href="#step-5-crowd-source-the-plot" id="toc-step-5-crowd-source-the-plot" class="nav-link" data-scroll-target="#step-5-crowd-source-the-plot">Step 5: Crowd-Source the Plot</a></li>
  </ul></li>
  <li><a href="#how-your-hearts-midlife-crisis-became-a-math-problem" id="toc-how-your-hearts-midlife-crisis-became-a-math-problem" class="nav-link" data-scroll-target="#how-your-hearts-midlife-crisis-became-a-math-problem">How Your Heart’s Midlife Crisis Became a Math Problem</a>
  <ul class="collapse">
  <li><a href="#the-original-model-a.k.a.-before-the-glow-up" id="toc-the-original-model-a.k.a.-before-the-glow-up" class="nav-link" data-scroll-target="#the-original-model-a.k.a.-before-the-glow-up">The Original Model (a.k.a. “Before the Glow-Up”)</a></li>
  <li><a href="#split-the-drama-into-spin-offs" id="toc-split-the-drama-into-spin-offs" class="nav-link" data-scroll-target="#split-the-drama-into-spin-offs">Split the Drama Into Spin-Offs</a></li>
  <li><a href="#derivative-drama" id="toc-derivative-drama" class="nav-link" data-scroll-target="#derivative-drama">Derivative Drama</a></li>
  <li><a href="#yts-redemption-arc" id="toc-yts-redemption-arc" class="nav-link" data-scroll-target="#yts-redemption-arc"><span class="math inline">\(y(t)\)</span>’s Redemption Arc</a></li>
  <li><a href="#add-plot-armor-a.k.a.-activation-functions" id="toc-add-plot-armor-a.k.a.-activation-functions" class="nav-link" data-scroll-target="#add-plot-armor-a.k.a.-activation-functions">Add Plot Armor (a.k.a. Activation Functions)</a></li>
  <li><a href="#why-this-matters-besides-bragging-rights" id="toc-why-this-matters-besides-bragging-rights" class="nav-link" data-scroll-target="#why-this-matters-besides-bragging-rights">Why This Matters (Besides Bragging Rights)</a></li>
  </ul></li>
  <li><a href="#simplifying-the-beast" id="toc-simplifying-the-beast" class="nav-link" data-scroll-target="#simplifying-the-beast">Simplifying the Beast</a>
  <ul class="collapse">
  <li><a href="#the-diet-coke-version-of-heart-math-same-chaos-fewer-calories" id="toc-the-diet-coke-version-of-heart-math-same-chaos-fewer-calories" class="nav-link" data-scroll-target="#the-diet-coke-version-of-heart-math-same-chaos-fewer-calories">The Diet Coke Version of Heart Math (Same Chaos, Fewer Calories)</a>
  <ul class="collapse">
  <li><a href="#why-simplify" id="toc-why-simplify" class="nav-link" data-scroll-target="#why-simplify">Why Simplify?</a></li>
  <li><a href="#step-1-throw-out-the-quadratic-drama-its-not-you-its-math" id="toc-step-1-throw-out-the-quadratic-drama-its-not-you-its-math" class="nav-link" data-scroll-target="#step-1-throw-out-the-quadratic-drama-its-not-you-its-math">Step 1: Throw Out the Quadratic Drama (It’s Not You, It’s Math)</a></li>
  <li><a href="#step-2-add-time-out-switches-because-even-hearts-need-boundaries" id="toc-step-2-add-time-out-switches-because-even-hearts-need-boundaries" class="nav-link" data-scroll-target="#step-2-add-time-out-switches-because-even-hearts-need-boundaries">Step 2: Add Time-Out Switches (Because Even Hearts Need Boundaries)</a></li>
  <li><a href="#step-3-why-bother-trade-offs-for-the-attention-span-deprived" id="toc-step-3-why-bother-trade-offs-for-the-attention-span-deprived" class="nav-link" data-scroll-target="#step-3-why-bother-trade-offs-for-the-attention-span-deprived">Step 3: Why Bother? (Trade-Offs for the Attention-Span Deprived)</a></li>
  <li><a href="#when-to-use-which-model-choose-your-own-adventure" id="toc-when-to-use-which-model-choose-your-own-adventure" class="nav-link" data-scroll-target="#when-to-use-which-model-choose-your-own-adventure">When to Use Which Model (Choose Your Own Adventure)</a></li>
  <li><a href="#the-big-picture-why-simplification-isnt-sacrilege" id="toc-the-big-picture-why-simplification-isnt-sacrilege" class="nav-link" data-scroll-target="#the-big-picture-why-simplification-isnt-sacrilege">The Big Picture: Why Simplification Isn’t Sacrilege</a></li>
  <li><a href="#the-hearts-many-faces" id="toc-the-hearts-many-faces" class="nav-link" data-scroll-target="#the-hearts-many-faces">The Heart’s Many Faces</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#simulating-cardiac-meltdowns-with-less-math-induced-trauma" id="toc-simulating-cardiac-meltdowns-with-less-math-induced-trauma" class="nav-link" data-scroll-target="#simulating-cardiac-meltdowns-with-less-math-induced-trauma">Simulating Cardiac Meltdowns (With Less Math-Induced Trauma)</a>
  <ul class="collapse">
  <li><a href="#eulers-method" id="toc-eulers-method" class="nav-link" data-scroll-target="#eulers-method">Euler’s Method</a></li>
  <li><a href="#simplify-the-equations-because-were-lazy" id="toc-simplify-the-equations-because-were-lazy" class="nav-link" data-scroll-target="#simplify-the-equations-because-were-lazy">Simplify the Equations (Because We’re Lazy)</a></li>
  <li><a href="#code-this-in-r-because-excel-was-too-mainstream" id="toc-code-this-in-r-because-excel-was-too-mainstream" class="nav-link" data-scroll-target="#code-this-in-r-because-excel-was-too-mainstream">Code This in R (Because Excel Was Too Mainstream)</a></li>
  <li><a href="#run-it-and-pray-to-the-code-gods" id="toc-run-it-and-pray-to-the-code-gods" class="nav-link" data-scroll-target="#run-it-and-pray-to-the-code-gods">Run It and Pray to the Code Gods</a></li>
  <li><a href="#why-this-works-and-why-its-flawed" id="toc-why-this-works-and-why-its-flawed" class="nav-link" data-scroll-target="#why-this-works-and-why-its-flawed">Why This Works (and Why It’s Flawed)</a></li>
  <li><a href="#real-world-uses-because-science-pays-the-bills" id="toc-real-world-uses-because-science-pays-the-bills" class="nav-link" data-scroll-target="#real-world-uses-because-science-pays-the-bills">Real-World Uses (Because Science Pays the Bills)</a></li>
  </ul></li>
  <li><a href="#your-hearts-dramatic-arc-now-with-more-math" id="toc-your-hearts-dramatic-arc-now-with-more-math" class="nav-link" data-scroll-target="#your-hearts-dramatic-arc-now-with-more-math">Your Heart’s Dramatic Arc, Now with More Math</a></li>
  
  </ul>
<div class="quarto-code-links"><h2>Code Links</h2><ul><li><a href="https://www.researchgate.net/publication/389812477_Enhancing_cardiovascular_monitoring_a_non-linear_model_for_characterizing_RR_interval_fluctuations_in_exercise_and_recovery"><i class="bi bi-link-45deg"></i>Original paper</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Let’s talk about your heart. No, not the one that skips a beat when your crush texts back, <em>that</em> heart is a drama queen we’ll save for therapy. I’m talking about the actual meat-pump in your chest, the one that’s currently working overtime to process the existential dread of Monday mornings. For something so vital, it’s surprisingly bad at subtlety. When you exercise, it’s either “chill mode” (Netflix and nap) or “I’m about to audition for <em>Speed 3: Cardiac Edition</em>.” But here’s the kicker: scientists have spent decades trying to decode its mood swings, and let’s just say the results are… mixed. Enter my latest obsession: a math model so extra, it makes your gym’s heart rate monitor look like a Tamagotchi.</p>
<p>Picture this: you’re on a treadmill, sweating like a popsicle in July, and your heart rate zigzags like a caffeinated EKG. Traditional methods to track this chaos? They’re like using a ruler to measure a squiggle. Heart rate variability (HRV) metrics, those bland averages your Fitbit spits out, are the equivalent of summarizing <em>War and Peace</em> as “some guys had feelings.” Sure, they tell you <em>something</em>, but they miss the juicy plot twists. Your heart isn’t a metronome; it’s a freestyle jazz musician with a caffeine problem. And when you throw exercise into the mix? Cue the autotuned chaos.</p>
<p>Now, imagine if we could actually <em>model</em> this nonsense. Not with boring straight lines or sleepy exponentials, but with something that embraces the heart’s flair for melodrama. That’s where this new non-linear model struts in, wearing sunglasses indoors. It’s basically the Sherlock Holmes of heartbeats, solving the mystery of why your R-R intervals (the time between heartbeats, for the uninitiated) look like a toddler’s crayon drawing during a spin class. Using <em>logistic functions</em>, fancy curves that even your high school math teacher would side-eye, it maps out how your heart crashes during exercise and limps back to normal afterward. Think of it as a GPS for your cardiovascular system: “Recalculating… turn left at adrenaline alley.”</p>
<p>But why should you care? Well, unless you’re a cyborg, your autonomic nervous system (ANS) is the puppet master behind this circus. When you exercise, it’s a tug-of-war between “fight-or-flight” (sympathetic nervous system) and “nap time” (parasympathetic). Traditional models treat this like a polite debate. Spoiler: it’s not. It’s a WWE smackdown, complete with folding chairs. Linear models? They’re the guy at the party who insists the music isn’t <em>that</em> loud. This new model? It’s the one crowd-surfing while yelling, “I CAN EXPLAIN THE PLATEAU PHASE!”</p>
<p>Here’s the plot twist: the model wasn’t born in a lab coat. It started as a desperate attempt to make sense of data from 272 elderly folks marching in place like it’s 1999. (Side note: If you ever want to feel better about your fitness, watch a senior citizen out-step you in a “light” exercise test.) The real magic? The model doesn’t just <em>fit</em> the data, it throws a interpretive dance party. By smooshing together two logistic functions (one for the crash, one for the comeback), it captures the heart’s U-shaped rollercoaster: freefall during exercise, slow climb back to sanity. Bonus points: the parameters have names like <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, which sounds like a sorority for math nerds.</p>
<p>Of course, no model is perfect. This one’s got quirks. For starters, it’s <em>really</em> into baseline RRI (<span class="math inline">\(\alpha\)</span>), the “resting heart rate” of the equation. According to Sobol sensitivity analysis, <span class="math inline">\(\alpha\)</span> is basically the Beyoncé of parameters, hogging 60% of the variance spotlight. Then there’s “c,” the recovery proportion, which is like the friend who says they’ll cover your Uber but only chips in 84%. The other parameters? They’re the background dancers. <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\phi\)</span> control the <em>speed</em> of crash and recovery, but apparently, nobody cares about speed when you’ve got drama queens like <span class="math inline">\(\alpha\)</span> stealing the show.</p>
<p>Now, let’s address the elephant in the room: this model was tested on grandmas and grandpas. That’s right, your heart’s midlife crisis during Zumba? Not represented here. The elderly cohort is both a strength and a weakness. On one hand, they’re the ultimate stress test (imagine coding a model while your participants debate fiber intake). On the other, it’s like tuning a race car using data from a golf cart parade. But hey, if it works for them, it’ll probably work for you, unless you’re an Olympic sprinter, in which case, why are you reading a blog post? Go win a medal.</p>
<p>The real kicker? This model could change how we monitor hearts in real time. Imagine wearables that don’t just count steps but scream, “HEY, YOUR PARASYMPATHETIC SYSTEM IS SLACKING!” during meetings. Or rehab programs tailored like Spotify playlists, “Autonomic Acoustic” for recovery, “Sympathetic Screamo” for HIIT. The future is weird, folks.</p>
<p>So buckle up. We’re diving into the mathy, sweaty, gloriously chaotic world of heart rate modeling. Whether you’re a fitness junkie, a data nerd, or just here for the sarcasm, this model’s got something for you. Spoiler: It involves differential equations, but I promise to keep the calculus to a minimum. After all, your heart’s already doing enough heavy lifting.</p>
</section>
<section id="how-well-turn-heartbeats-into-a-soap-opera-but-with-math" class="level1">
<h1>How We’ll Turn Heartbeats Into a Soap Opera (But With Math)</h1>
<p>Alright, let’s talk about reverse-engineering your heart’s melodrama. The original model, a perfectly good equation that already does the job, is about to get a glow-up. Not because it’s <em>bad</em>, but because we’re bored and differential equations are the glitter glue of science. Here’s how we’ll reframe it as a dynamical system, no lab coat required.</p>
<section id="step-1-split-the-drama-into-seasons" class="level3">
<h3 class="anchored" data-anchor-id="step-1-split-the-drama-into-seasons">Step 1: Split the Drama Into Seasons</h3>
<p>First, we’ll take the original model, a sum of two moody sigmoids, and break it into <em>two characters</em>: <strong>Season 1: The Crash</strong> (Exercise Phase). This is where your heart goes full <em>The Titanic</em>. We’ll call this variable <span class="math inline">\(x(t)\)</span>, the mathematical embodiment of “why did I sign up for this spin class?”. <strong>Season 2: The Comeback</strong> (Recovery Phase). Here, <span class="math inline">\(y(t)\)</span> is the slow-mo montage where your heart limps back to baseline like it’s recovering from a breakup.</p>
<p>Together, they’ll form a dynamic duo: <span class="math inline">\(RRi(t) = \alpha + x(t) + y(t)\)</span>. Think of α as the neutral narrator who just wants everyone to calm down.</p>
</section>
<section id="step-2-write-the-script-a.k.a.-differential-equations" class="level3">
<h3 class="anchored" data-anchor-id="step-2-write-the-script-a.k.a.-differential-equations">Step 2: Write the Script (a.k.a. Differential Equations)</h3>
<p>Next, we’ll turn these static characters into a live-action series. For <span class="math inline">\(x(t)\)</span>, we’ll ask: <em>“How fast does panic set in?”</em> The answer involves a logistic decay equation, basically, math’s way of saying “the faster you run, the faster you regret.” For <span class="math inline">\(y(t)\)</span>, we’ll ask: <em>“How long until denial becomes acceptance?”</em> That’s a logistic growth equation, or “the speed at which your ANS remembers it has a yoga class later.”</p>
<p>But here’s the twist: we’ll add <strong>activation functions</strong>, smooth on/off switches that tell the equations when to start. Imagine a director yelling “ACTION!” at <span class="math inline">\(\tau\)</span> (exercise o’clock) and “CUT!” at <span class="math inline">\(\tau + \delta\)</span> (nap o’clock). These switches ensure the drama stays in its lane. No crashing during warm-up, no recovering before the trauma even starts.</p>
</section>
<section id="step-3-smoothie-recipe-for-transitions" class="level3">
<h3 class="anchored" data-anchor-id="step-3-smoothie-recipe-for-transitions">Step 3: Smoothie Recipe for Transitions</h3>
<p>To avoid abrupt plot twists (because hearts hate jump scares), we’ll use <strong>sigmoidal activation functions</strong>. These are like blending a kale smoothie, harsh at first, but eventually smooth. They’ll gently ramp up the chaos during exercise and taper it off during recovery, so your heart rate doesn’t look like a toddler scribbling on a whiteboard.</p>
</section>
<section id="step-4-let-the-computer-do-the-heavy-lifting" class="level3">
<h3 class="anchored" data-anchor-id="step-4-let-the-computer-do-the-heavy-lifting">Step 4: Let the Computer Do the Heavy Lifting</h3>
<p>Once the equations are set, we’ll toss them into a Bayesian blender. Using Hamiltonian Monte Carlo (a fancy algorithm that’s basically a Roomba with a PhD), we’ll brute-force the parameters until the model fits the data like a conspiracy theory fits Twitter. No intuition required, just vibes and CPU power.</p>
</section>
<section id="step-5-crowd-source-the-plot" class="level3">
<h3 class="anchored" data-anchor-id="step-5-crowd-source-the-plot">Step 5: Crowd-Source the Plot</h3>
<p>Finally, we’ll run a sensitivity analysis to see which parameters steal the spotlight. Spoiler: Baseline RRi (<span class="math inline">\(\alpha\)</span>) will probably monologue for 60% of the runtime, while recovery proportion (<span class="math inline">\(c\)</span>) mutters emo poetry in the background. The rest? Cameos at best.</p>
<p>This isn’t about “fixing” our original model, it’s already a rockstar. It’s about giving it a new lens, like filming a rom-com in black-and-white. We’re translating a snapshot into a flipbook, asking: <em>“What if heartbeats had director’s commentary?”</em></p>
<p>Now we are ready for the next scene, where we’ll actually <em>show</em> the math. Don’t worry, we’ll dilute the calculus with metaphors about Netflix binge-watching and interpretive dance. Your heart’s already doing calculus anyway.</p>
</section>
</section>
<section id="how-your-hearts-midlife-crisis-became-a-math-problem" class="level1 page-columns page-full">
<h1>How Your Heart’s Midlife Crisis Became a Math Problem</h1>
<p>Let’s dissect this heart-rate saga like it’s a Netflix thriller. Buckle up, we’re diving into equations.</p>
<section id="the-original-model-a.k.a.-before-the-glow-up" class="level3">
<h3 class="anchored" data-anchor-id="the-original-model-a.k.a.-before-the-glow-up">The Original Model (a.k.a. “Before the Glow-Up”)</h3>
<p>The original model, let’s call it <em>The Heartbreak Equation</em>, is a sum of two moody sigmoid curves. Think of it as your heart’s Instagram feed: one post bragging about its chill baseline (<span class="math inline">\(\alpha\)</span>), another crying about exercise (<span class="math inline">\(\beta\)</span>), and a third pretending to recover (<span class="math inline">\(c\beta\)</span>). Mathematically, it’s:</p>
<p><span class="math display">\[  
RRi(t) = \alpha + \frac{\beta}{1 + e^{\lambda(t - \tau)}} + \frac{-c\beta}{1 + e^{\phi(t - \tau - \delta)}}  
\]</span></p>
<p>Here’s the cast:</p>
<ul>
<li><span class="math inline">\(\alpha\)</span>: Baseline RRi. The heart’s “resting face” (read: pretending it didn’t just binge-watch <em>Stranger Things</em>).<br>
</li>
<li><span class="math inline">\(\beta\)</span>: How hard RRi nosedives during exercise. Beta’s the drama queen.<br>
</li>
<li><span class="math inline">\(c\)</span>: The recovery’s participation trophy. “I’ll undo <em>some</em> of the damage… maybe.”<br>
</li>
<li><span class="math inline">\(\lambda\)</span> &amp; <span class="math inline">\(\phi\)</span>: Speed of crash and recovery. One’s a Tesla, the other’s a Prius.<br>
</li>
<li><span class="math inline">\(\tau\)</span> &amp; <span class="math inline">\(\delta\)</span>: Timing of exercise and recovery. Because your heart needs a schedule to panic.</li>
</ul>
</section>
<section id="split-the-drama-into-spin-offs" class="level3">
<h3 class="anchored" data-anchor-id="split-the-drama-into-spin-offs">Split the Drama Into Spin-Offs</h3>
<p>We’re giving the model a <em>Hollywood reboot</em>. Meet the two new leads:</p>
<ol type="1">
<li><span class="math inline">\(x(t)\)</span>: The Exercise Arc. Defined as:</li>
</ol>
<p><span class="math display">\[  
x(t) = \frac{\beta}{1 + e^{\lambda(t - \tau)}}  
\]</span></p>
<p>This is your heart’s <em>“Why did I agree to this HIIT class?”</em> phase.</p>
<ol start="2" type="1">
<li><span class="math inline">\(y(t)\)</span>: The Recovery Arc. Defined as:</li>
</ol>
<p><span class="math display">\[  
y(t) = \frac{-c\beta}{1 + e^{\phi(t - \tau - \delta)}}  
\]</span></p>
<p>This is the <em>“I’ll never skip leg day again… (until next week)”</em> phase.</p>
<p>Together, they form:</p>
<p><span class="math display">\[  
RRi(t) = \alpha + x(t) + y(t)  
\]</span></p>
<p>Alpha’s just there to remind everyone what “normal” used to mean.</p>
</section>
<section id="derivative-drama" class="level3">
<h3 class="anchored" data-anchor-id="derivative-drama">Derivative Drama</h3>
<p>Time to make these variables <em>earn their screen time</em>. Let’s differentiate <span class="math inline">\(x(t)\)</span> first.</p>
<p><strong>Step 1: Quotient Rule, But Make It Fashion</strong></p>
<p>The derivative of <span class="math inline">\(x(t)\)</span> is like asking, <em>“How fast does regret hit during burpees?”</em> Using the quotient rule:</p>
<p><span class="math display">\[  
\frac{dx}{dt} = -\beta \frac{\lambda e^{\lambda(t-\tau)}}{\left(1 + e^{\lambda(t-\tau)}\right)^2}
\]</span></p>
<p>Translation: <em>“The faster you exercise, the faster your soul leaves your body.”</em></p>
<p><strong>Step 2: Rewrite the Script (In Terms of <span class="math inline">\(x(t)\)</span>)</strong></p>
<p>We hate seeing “t” in our equations, it’s tacky. Let’s rewrite everything using <span class="math inline">\(x(t)\)</span>:</p>
<p><span class="math display">\[  
1 + e^{\lambda(t-\tau)} = \frac{\beta}{x(t)} \quad \Rightarrow \quad e^{\lambda(t-\tau)} = \frac{\beta - x(t)}{x(t)}  
\]</span></p>
<p>Substitute this back into the derivative and simplify:</p>
<p><span class="math display">\[  
\frac{dx}{dt} = -\lambda x(t) \left(1 - \frac{x(t)}{\beta}\right)  
\]</span></p>
<p>Voilà! Now <span class="math inline">\(x(t)\)</span> follows a <em>logistic decay</em>, math’s way of saying <em>“panic accelerates until you accept your fate.”</em></p>
</section>
<section id="yts-redemption-arc" class="level3">
<h3 class="anchored" data-anchor-id="yts-redemption-arc"><span class="math inline">\(y(t)\)</span>’s Redemption Arc</h3>
<p>Now for <span class="math inline">\(y(t)\)</span>. Differentiate:</p>
<p><span class="math display">\[  
\frac{dy}{dt} = \phi c\beta \frac{e^{\phi(t-\tau-\delta)}}{\left(1 + e^{\phi(t-\tau-\delta)}\right)^2}  
\]</span></p>
<p>This is the <em>“How fast does hope return post-exercise?”</em> equation. Spoiler: Not fast enough.</p>
<p><strong>Rewrite the Script (Again, Because We’re Extra)</strong></p>
<p>Express everything in terms of <span class="math inline">\(y(t)\)</span>:</p>
<p><span class="math display">\[  
1 + e^{\phi(t-\tau-\delta)} = \frac{-c\beta}{y(t)} \quad \Rightarrow \quad e^{\phi(t-\tau-\delta)} = \frac{-c\beta - y(t)}{y(t)}  
\]</span></p>
<p>Plug it back in and simplify:</p>
<p><span class="math display">\[  
\frac{dy}{dt} = -\phi y(t) \left(1 + \frac{y(t)}{c\beta}\right)  
\]</span></p>
<p>Boom! <span class="math inline">\(y(t)\)</span> follows a <em>logistic growth</em>, math’s version of <em>“recovery starts slow but eventually remembers it has a yoga class.”</em></p>
</section>
<section id="add-plot-armor-a.k.a.-activation-functions" class="level3">
<h3 class="anchored" data-anchor-id="add-plot-armor-a.k.a.-activation-functions">Add Plot Armor (a.k.a. Activation Functions)</h3>
<p>To prevent the drama from spilling into unrelated timelines (like recovering <em>before</em> exercising), we add <strong>sigmoidal activation functions</strong>, smooth on/off switches.</p>
<p><strong>Exercise Switch:</strong></p>
<p><span class="math display">\[  
\psi_{\text{exercise}}(t) = \frac{1}{1 + e^{-\lambda(t-\tau)}}  
\]</span></p>
<p>It’s 0 before exercise (“I’m fine!”) and 1 after (“Code Red!”).</p>
<p><strong>Recovery Switch:</strong></p>
<p><span class="math display">\[  
\psi_{\text{recovery}}(t) = \frac{1}{1 + e^{-\phi(t-\tau-\delta)}}  
\]</span></p>
<p>It’s 0 during exercise (“Still dying!”) and 1 after (“Maybe I’ll live?”).</p>
<p><strong>Final Equations</strong> (With Boundaries, Because Chaos Needs Rules):</p>
<p><span class="math display">\[  
\frac{dx}{dt} = -\lambda x(t)\left(1 - \frac{x(t)}{\beta}\right) \cdot \psi_{\text{exercise}}(t)  
\]</span></p>
<p><span class="math display">\[  
\frac{dy}{dt} = -\phi y(t)\left(1 + \frac{y(t)}{c\beta}\right) \cdot \psi_{\text{recovery}}(t)  
\]</span></p>
<p>Now, <span class="math inline">\(x(t)\)</span> only crashes when exercise starts, and <span class="math inline">\(y(t)\)</span> only recovers after a <em>respectful delay</em>. Think of it as your heart’s way of saying, <em>“I need 5… no, 10 minutes.”</em></p>
</section>
<section id="why-this-matters-besides-bragging-rights" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="why-this-matters-besides-bragging-rights">Why This Matters (Besides Bragging Rights)</h3>
<p>By framing the model as a dynamical system, we’ve turned a static equation into a real-time model. Want to see how fast your heart crashes if you skip warm-ups? Crank up <span class="math inline">\(\lambda\)</span>. Curious why recovery takes forever after 40? Blame <span class="math inline">\(\phi\)</span>.</p>
<p>It’s not better, just <em>spicier</em>. Like adding hot sauce to your Fitbit.<br>
Next time: We’ll simulate this chaos.</p>
<aside>
<strong>Spoiler</strong>: It involves R, existential dread, and at least one Excel joke.
</aside>
</section>
</section>
<section id="simplifying-the-beast" class="level1">
<h1>Simplifying the Beast</h1>
<section id="the-diet-coke-version-of-heart-math-same-chaos-fewer-calories" class="level2">
<h2 class="anchored" data-anchor-id="the-diet-coke-version-of-heart-math-same-chaos-fewer-calories">The Diet Coke Version of Heart Math (Same Chaos, Fewer Calories)</h2>
<p>Alright, let’s take a breath. We’ve just spent a small eternity dissecting how your heart’s existential crisis during exercise can be modeled with <em>nonlinear differential equations</em>, math’s version of a Shakespearean tragedy. It’s got drama, depth, and enough quadratic terms to make your laptop sweat. But here’s the thing: sometimes you don’t need a five-act play about cardiac dynamics. Sometimes you just want a TikTok skit.</p>
<p>Enter the <strong>simplified linear model</strong>. Think of it as the tutorial version of the original equation. It’s faster, lighter, and <em>almost</em> as accurate, like swapping a vintage wine for a LaCroix. But why bother simplifying something that’s already brilliant? Let’s talk about that.</p>
<section id="why-simplify" class="level3">
<h3 class="anchored" data-anchor-id="why-simplify">Why Simplify?</h3>
<p>The original dynamical system we built is a masterpiece. It’s got logistic decay, sigmoidal switches, and enough Greek letters to confuse a sorority. But here’s the problem: nonlinear equations are <em>computational divas</em>. They demand attention, processing power, and patience, three things you don’t have when you’re trying to simulate heartbeats in real time on a smartwatch powered by a potato battery.</p>
<p>Imagine you’re a fitness app developer. Your users want instant feedback on their heart rate recovery after a workout. The full model? It’s like asking them to wait while you solve a Rubik’s cube blindfolded. They’ll uninstall your app and go pet a dog instead.</p>
<p>Or say you’re a researcher teaching undergrads about autonomic regulation. Throwing nonlinear differential equations at them is like explaining quantum physics using interpretive dance. They’ll nod politely while mentally planning their dropout party.</p>
<p>That’s where the simplified model shines. It’s the <strong>IKEA furniture</strong> of cardiac math: easy to assemble, good enough for most purposes, and unlikely to collapse unless you’re doing something weird. Let’s break down how we hacked the drama out of the equations.</p>
</section>
<section id="step-1-throw-out-the-quadratic-drama-its-not-you-its-math" class="level3">
<h3 class="anchored" data-anchor-id="step-1-throw-out-the-quadratic-drama-its-not-you-its-math">Step 1: Throw Out the Quadratic Drama (It’s Not You, It’s Math)</h3>
<p>The original equations were <em>nonlinear</em>, a fancy way of saying they’re clingy and complicated. Take the exercise phase equation:</p>
<p><span class="math display">\[  
\frac{dx}{dt} = -\lambda x \left(1 - \frac{x}{\beta}\right)  
\]</span></p>
<p>That <span class="math inline">\(x^2\)</span> term? That’s the equation’s way of saying, “I’m not like other girls.” But if we assume your heart’s meltdown is <em>controlled</em> (i.e., <span class="math inline">\(x^2\)</span> is close to its rock bottom <span class="math inline">\(\beta\)</span>), we can Taylor-expand this like it’s a meme.</p>
<p>Here’s the <strong>math magic</strong>:</p>
<ol type="1">
<li>Define <span class="math inline">\(\Delta x = \beta - x\)</span> (how far <span class="math inline">\(x^2\)</span> is from its emo phase).<br>
</li>
<li>Pretend <span class="math inline">\(\Delta x\)</span> is <em>small</em> (like your attention span during a Zoom meeting).<br>
</li>
<li>Rewrite the equation in terms of <span class="math inline">\(\Delta x\)</span>:</li>
</ol>
<p><span class="math display">\[  
\frac{dx}{dt} \approx -\lambda (\beta - x)  
\]</span></p>
<p>Translation: The panic fades linearly, like your enthusiasm for kale smoothies.</p>
<p>Same trick for the recovery phase:</p>
<p><span class="math display">\[  
\frac{dy}{dt} = -\phi y \left(1 + \frac{y}{c\beta}\right)  
\]</span></p>
<p>Define <span class="math inline">\(\Delta y = -c \beta - y\)</span> (how far <span class="math inline">\(y\)</span> is from redemption), assume <span class="math inline">\(\Delta y\)</span> is tiny, and boom:</p>
<p><span class="math display">\[  
\frac{dy}{dt} \approx -\phi (-c\beta - y)  
\]</span></p>
<p>Now the redemption arc is linear, like your progress bar during a software update.</p>
</section>
<section id="step-2-add-time-out-switches-because-even-hearts-need-boundaries" class="level3">
<h3 class="anchored" data-anchor-id="step-2-add-time-out-switches-because-even-hearts-need-boundaries">Step 2: Add Time-Out Switches (Because Even Hearts Need Boundaries)</h3>
<p>Hearts don’t panic 24/7 (unless you’re a Wall Street trader). To control when the drama unfolds, we use <strong>sigmoidal activation functions</strong>, smooth on/off switches that say, “Not now, sweetie.”</p>
<ul>
<li><strong>Exercise switch</strong>:</li>
</ul>
<p><span class="math display">\[  
\psi_{\text{exercise}}(t) = \frac{1}{1 + e^{-\lambda(t - \tau)}}  
\]</span></p>
<ul>
<li><strong>Recovery switch</strong>:</li>
</ul>
<p><span class="math display">\[  
\psi_{\text{recovery}}(t) = \frac{1}{1 + e^{-\phi(t - (\tau + \delta))}}  
\]</span></p>
<p>These switches act like parental controls for your heart rate. Before <strong>τ</strong> (exercise o’clock), ψ_exercise ≈ 0: <em>“No cardio before coffee.”</em> After <strong>τ + δ</strong> (nap o’clock), ψ_recovery ≈ 1: <em>“OK, you can stop dying now.”</em></p>
<p>Slap these into the linear equations:</p>
<p><span class="math display">\[  
\frac{dx}{dt} = -\lambda (\beta - x) \cdot \psi_{\text{exercise}}(t)  
\]</span></p>
<p><span class="math display">\[  
\frac{dy}{dt} = -\phi (-c\beta - y) \cdot \psi_{\text{recovery}}(t)  
\]</span></p>
<p>Now the meltdown and redemption only happen when scheduled. No surprises, like a Netflix show that actually respects your bedtime.</p>
</section>
<section id="step-3-why-bother-trade-offs-for-the-attention-span-deprived" class="level3">
<h3 class="anchored" data-anchor-id="step-3-why-bother-trade-offs-for-the-attention-span-deprived">Step 3: Why Bother? (Trade-Offs for the Attention-Span Deprived)</h3>
<p><strong>Pros of the Diet Model</strong>:</p>
<ul>
<li><strong>Speed</strong>: Simulates faster than you can say “existential crisis.” Perfect for real-time apps where users tap their feet waiting for results.<br>
</li>
<li><strong>Stability</strong>: No chaotic surprises. It’s like replacing a rollercoaster with a escalator.<br>
</li>
<li><strong>Transparency</strong>: Parameters slap you in the face with meaning. λ? Panic speed. φ? Recovery laziness. No PhD required.</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li><strong>Blandness</strong>: Loses the spicy logistic saturation. It’s the difference between a rom-com and a spreadsheet.<br>
</li>
<li><strong>Accuracy</strong>: Only works near equilibrium. Stray too far, and it’s like using a ruler to measure a tornado.</li>
</ul>
</section>
<section id="when-to-use-which-model-choose-your-own-adventure" class="level3">
<h3 class="anchored" data-anchor-id="when-to-use-which-model-choose-your-own-adventure">When to Use Which Model (Choose Your Own Adventure)</h3>
<p><strong>Full Dynamical System</strong>:</p>
<ul>
<li><strong>For Researchers</strong>: If you’re publishing a paper titled <em>“Nonlinear Autonomic Oscillations in Elderly Step-Test Cohorts: A Bayesian Perspective,”</em> this is your jam.<br>
</li>
<li><strong>Deep Analysis</strong>: Want to explore how λ and φ interact during a HIIT workout? Go nuts.<br>
</li>
<li><strong>Flexibility</strong>: Captures the full cardiac soap opera, breakdowns, comebacks, and plot twists.</li>
</ul>
<p><strong>Simplified Linear Model</strong>:</p>
<ul>
<li><strong>For Developers</strong>: Building a fitness app? Use this. Your servers won’t cry.<br>
</li>
<li><strong>Education</strong>: Teaching undergrads? They’ll thank you for not melting their brains.<br>
</li>
<li><strong>Quick Simulations</strong>: Need to model 10,000 heartbeats before lunch? This’ll do.</li>
</ul>
</section>
<section id="the-big-picture-why-simplification-isnt-sacrilege" class="level3">
<h3 class="anchored" data-anchor-id="the-big-picture-why-simplification-isnt-sacrilege">The Big Picture: Why Simplification Isn’t Sacrilege</h3>
<p>Let’s be real: the original model is a Ferrari. It’s sleek, powerful, and turns heads at academic conferences. But most of us don’t need a Ferrari to drive to Walmart. Sometimes a Toyota Corolla (read: linear model) gets the job done without the maintenance fees.</p>
<p>Simplification isn’t about dumbing things down, it’s about <strong>pragmatism</strong>. The world runs on approximations. Weather apps? They use simplified models. GPS? Simplified models. Your mom’s meatloaf recipe? Definitely simplified.</p>
<p>The key is knowing <em>when</em> to simplify. If you’re designing a pacemaker? Stick with the full model. If you’re coding a heart rate widget for a smartwatch? The linear version is your friend.</p>
</section>
<section id="the-hearts-many-faces" class="level3">
<h3 class="anchored" data-anchor-id="the-hearts-many-faces">The Heart’s Many Faces</h3>
<p>At the end of the day, your heart is a drama queen with range. Sometimes it’s method-acting through a spin class, other times it’s phoning it in during a Zoom meeting. The models we’ve built, both the full nonlinear saga and its streamlined sibling, are just tools to decode the performance.</p>
<p>So next time you’re on a treadmill, remember: your heart isn’t just beating. It’s starring in a math rock opera, complete with logistic plot twists and linear encores. And whether you’re team Ferrari or team Corolla, there’s a model for that.</p>
</section>
</section>
</section>
<section id="simulating-cardiac-meltdowns-with-less-math-induced-trauma" class="level1">
<h1>Simulating Cardiac Meltdowns (With Less Math-Induced Trauma)</h1>
<p>Alright, we’ve got the equations. Now let’s simulate this nonsense and watch your heart rate plot its escape from Zumba class. Think of it as <em>The Sims</em> for cardio nerds, except instead of drowning pixelated people, we’re drowning in differential equations. Let’s code this drama.</p>
<section id="eulers-method" class="level3">
<h3 class="anchored" data-anchor-id="eulers-method">Euler’s Method</h3>
<p>Differential equations are like IKEA instructions: <em>“Here’s the slope, good luck!”</em> To solve them, we’ll use <strong>Euler’s method</strong>, the duct tape of numerical analysis. It guesses the future by taking tiny steps forward, like a drunk person navigating a dark room.</p>
<p>For any equation:</p>
<p><span class="math display">\[  
\frac{dx}{dt} = f(x, t)
\]</span></p>
<p>Euler says:</p>
<p><span class="math display">\[  
x(t + \Delta t) \approx x(t) + \Delta t \cdot f(x(t), t)
\]</span></p>
<p>where <span class="math inline">\(\Delta t\)</span> is the step size. Smaller steps = more accuracy, but slower than your Wi-Fi during a storm.</p>
</section>
<section id="simplify-the-equations-because-were-lazy" class="level3">
<h3 class="anchored" data-anchor-id="simplify-the-equations-because-were-lazy">Simplify the Equations (Because We’re Lazy)</h3>
<p>Our simplified model ditches the quadratic tantrums of the original equations. Instead, we’ve got:</p>
<ol type="1">
<li><strong>Exercise Phase (<span class="math inline">\(x(t)\)</span>)</strong>:</li>
</ol>
<p><span class="math display">\[  
\frac{dx}{dt} = -\lambda (\beta - x) \cdot \psi_{\text{exercise}}(t)  
\]</span></p>
<ol start="2" type="1">
<li><strong>Recovery Phase (<span class="math inline">\(y(t)\)</span>)</strong>:</li>
</ol>
<p><span class="math display">\[  
\frac{dy}{dt} = -\phi (-c\beta - y) \cdot \psi_{\text{recovery}}(t)  
\]</span></p>
<p>Translation:<br>
- <span class="math inline">\(\lambda\)</span> <strong>(lambda)</strong>: How fast your heart yeets itself into panic mode.<br>
- <span class="math inline">\(\phi\)</span> <strong>(phi)</strong>: How lazily it crawls back to Netflix.<br>
- <span class="math inline">\(\psi_{exercise}\)</span> and <span class="math inline">\(\psi_{recovery}\)</span>: Sigmoidal switches that say <em>“Panic now!”</em> and <em>“Ok, nap time.”</em></p>
</section>
<section id="code-this-in-r-because-excel-was-too-mainstream" class="level3">
<h3 class="anchored" data-anchor-id="code-this-in-r-because-excel-was-too-mainstream">Code This in R (Because Excel Was Too Mainstream)</h3>
<p>Let’s translate this into R code. We’ll need:<br>
1. <strong>Parameters</strong> (plucked from elderly step-test data).<br>
2. <strong>Time grid</strong> (because time is an illusion, but simulations aren’t).<br>
3. <strong>A loop</strong> that updates <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> like a clingy ex.</p>
<p>Here’s the code, annotated with sarcasm and questionable life choices:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Parameters (Grandma's Fitness Diary)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">861.78</span>,   <span class="co"># Baseline RRi (ms). Basically your heart's zen mode.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta =</span> <span class="sc">-</span><span class="fl">345.49</span>,   <span class="co"># How hard RRi crashes. Negative = midlife crisis.</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="sc">-</span><span class="fl">3.05</span>,   <span class="co"># Speed of crash. Negative? Blame the math.</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> <span class="sc">-</span><span class="fl">2.60</span>,      <span class="co"># Speed of recovery. Also negative. Blame the patriarchy.</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> <span class="fl">6.71</span>,       <span class="co"># Exercise starts at 6.71 min. Plot twist!</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">delta =</span> <span class="fl">3.24</span>,     <span class="co"># Recovery starts after 3.24 min of regret.</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">c =</span> <span class="fl">0.84</span>          <span class="co"># Recovery proportion. "I'll do 84% better next time."</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Activation Functions (The Drama Switches)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sigmoidal switches to gatekeep the chaos</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>psi_exercise <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(params[<span class="st">"lambda"</span>] <span class="sc">*</span> (t <span class="sc">-</span> params[<span class="st">"tau"</span>])))  <span class="co"># lambda is negative, so this flips</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>psi_recovery <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(params[<span class="st">"phi"</span>] <span class="sc">*</span> (t <span class="sc">-</span> params[<span class="st">"tau"</span>] <span class="sc">-</span> params[<span class="st">"delta"</span>])))  <span class="co"># same logic</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Euler's Method Loop (The Heart of the Simulation)</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Time grid: 0 to 20 min, steps of 0.1 min (because we're extra)</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>time_steps <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>n_steps <span class="ot">&lt;-</span> <span class="fu">length</span>(time_steps)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize arrays to store x, y, and RRi</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_steps)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_steps)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>RRi <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_steps)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial conditions: x=0 (no panic), y=0 (no recovery)</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>RRi[<span class="dv">1</span>] <span class="ot">&lt;-</span> params[<span class="st">"alpha"</span>] <span class="sc">+</span> x[<span class="dv">1</span>] <span class="sc">+</span> y[<span class="dv">1</span>]</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through time like it's 1999</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_steps <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  current_time <span class="ot">&lt;-</span> time_steps[k]</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Exercise Phase ---</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate dx/dt: -λ*(β - x) * ψ_exercise</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  dxdt <span class="ot">&lt;-</span> <span class="sc">-</span>params[<span class="st">"lambda"</span>] <span class="sc">*</span> (params[<span class="st">"beta"</span>] <span class="sc">-</span> x[k]) <span class="sc">*</span> <span class="fu">psi_exercise</span>(current_time)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Recovery Phase ---</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate dy/dt: -φ*(-cβ - y) * ψ_recovery</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  dydt <span class="ot">&lt;-</span> <span class="sc">-</span>params[<span class="st">"phi"</span>] <span class="sc">*</span> (<span class="sc">-</span>params[<span class="st">"c"</span>] <span class="sc">*</span> params[<span class="st">"beta"</span>] <span class="sc">-</span> y[k]) <span class="sc">*</span> <span class="fu">psi_recovery</span>(current_time)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update x and y using Euler's method</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  x[k <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> x[k] <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">*</span> dxdt  <span class="co"># Δt = 0.1 min</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  y[k <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> y[k] <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">*</span> dydt</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total RRi = baseline + panic + redemption</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  RRi[k <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> params[<span class="st">"alpha"</span>] <span class="sc">+</span> x[k <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">+</span> y[k <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Trauma (For Clout)</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Bundle results into a dataframe</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">Time =</span> time_steps,</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">RRi =</span> RRi,</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">Phase =</span> <span class="fu">ifelse</span>(time_steps <span class="sc">&lt;</span> params[<span class="st">"tau"</span>], <span class="st">"Rest"</span>,</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(time_steps <span class="sc">&lt;</span> params[<span class="st">"tau"</span>] <span class="sc">+</span> params[<span class="st">"delta"</span>], <span class="st">"Exercise"</span>, <span class="st">"Recovery"</span>))</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with ✨aesthetic✨</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> RRi, <span class="at">color =</span> Phase)) <span class="sc">+</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Rest"</span> <span class="ot">=</span> <span class="st">"#00BFC4"</span>, <span class="st">"Exercise"</span> <span class="ot">=</span> <span class="st">"#F8766D"</span>, <span class="st">"Recovery"</span> <span class="ot">=</span> <span class="st">"#7CAE00"</span>)) <span class="sc">+</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Your Heart's Zumba Class, Simulated"</span>,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Simplified linear model: Because drama sells"</span>,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time (min)"</span>,</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"RR Interval (ms)"</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="run-it-and-pray-to-the-code-gods" class="level3">
<h3 class="anchored" data-anchor-id="run-it-and-pray-to-the-code-gods">Run It and Pray to the Code Gods</h3>
<p>Execute this code, and voilà, your plot will look like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Features</strong> we can see here:</p>
<ul>
<li><strong>Resting Phase (t &lt; <span class="math inline">\(\tau\)</span>)</strong>: Flatline. Boring. Perfect. Your heart’s version of <em>“I’m just here for the snacks.”</em><br>
</li>
<li><strong>Exercise Phase (<span class="math inline">\(\tau\)</span> ≤ t &lt; <span class="math inline">\(\tau + \delta\)</span>)</strong>: RRi nosedives like your will to live during burpees.<br>
</li>
<li><strong>Recovery Phase (t ≥ <span class="math inline">\(\tau + \delta\)</span>)</strong>: RRi crawls back up, slower than your post-workout laundry motivation.</li>
</ul>
</section>
<section id="why-this-works-and-why-its-flawed" class="level3">
<h3 class="anchored" data-anchor-id="why-this-works-and-why-its-flawed">Why This Works (and Why It’s Flawed)</h3>
<p><strong>Pros</strong>:</p>
<ul>
<li><strong>Speed</strong>: Simulates faster than you can say <em>“existential crisis.”</em><br>
</li>
<li><strong>Transparency</strong>: Parameters slap you with meaning. <span class="math inline">\(\lambda\)</span>? Panic speed. <span class="math inline">\(\phi\)</span>? Recovery laziness.<br>
</li>
<li><strong>Stability</strong>: No chaotic surprises. It’s like replacing a rollercoaster with a rocking chair.</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li><strong>Linear ≠ Real Life</strong>: Hearts aren’t straight lines. This model misses the spicy saturation of the original equations.<br>
</li>
<li><strong>Euler’s Jank</strong>: Tiny errors accumulate like dirty laundry. Use <strong>Runge-Kutta</strong> if you’re fancy.<br>
</li>
<li><strong>Grandma Bias</strong>: Parameters fit for seniors. Not tested on CrossFit junkies or couch potatoes.</li>
</ul>
</section>
<section id="real-world-uses-because-science-pays-the-bills" class="level3">
<h3 class="anchored" data-anchor-id="real-world-uses-because-science-pays-the-bills">Real-World Uses (Because Science Pays the Bills)</h3>
<ol type="1">
<li><strong>Wearable Tech</strong>: Power fitness apps that nag you with <em>“YOUR HEART IS 84% RECOVERED. GO RUN.”</em><br>
</li>
<li><strong>Personalized Training</strong>: Adjust <strong>τ</strong> and <strong>δ</strong> to find your optimal workout-recovery ratio.<br>
</li>
<li><strong>Rehab Monitoring</strong>: Track if patients are doing their exercises or just Googling <em>“is napping cardio?”</em></li>
</ol>
<p>Simulating hearts is like writing fanfiction: fun, slightly unhinged, and nobody knows if it’s accurate. But hey, at least we’re not using Fortran.</p>
</section>
</section>
<section id="your-hearts-dramatic-arc-now-with-more-math" class="level1">
<h1>Your Heart’s Dramatic Arc, Now with More Math</h1>
<p>Let’s take a breath. We’ve just spent an ungodly amount of time simulating your heart’s existential crisis using differential equations, which is either a flex or a cry for help, jury’s still out. But before we pat ourselves on the back (or check into therapy), let’s unpack what we’ve <em>actually</em> done, why it’s both cool and slightly unhinged, and where we go from here.</p>
<p>In short, we took Castillo-Aguilar et al.’s original model, a sleek, elegant equation that already captured the U-shaped rollercoaster of RR intervals during exercise and recovery, and gave it a glow-up. Think of it like adapting a bestselling novel into a limited series. The original formula was the literary masterpiece: concise, powerful, and publishable in <em>Nature</em>. It used two logistic functions to summarize the entire cardiac saga, the nosedive during exercise, the slow crawl back to baseline, into a single snapshot. But we’re greedy. We wanted to see the <em>action</em> unfold frame by frame, like binge-watching your heart’s midlife crisis on Netflix. So we decomposed the model into two dynamic variables, <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(y(t)\)</span>, and wrote differential equations to describe their tantrums. The result? A flipbook version of the original, where every panic attack and recovery sigh is animated in calculus.</p>
<p>Now, let’s address the elephant in the room: <em>Why bother?</em> The original model already worked beautifully. It was the Marie Kondo of exercise physiology, simple, effective, and sparking joy in reviewers’ hearts. But here’s the thing: static equations are like long-exposure photos. They capture the whole trajectory in one shot, perfect for summarizing data or calculating parameters over a coffee break. Our dynamical system, on the other hand, is the shaky cam footage of a documentary crew chasing your heart through a spin class. It shows <em>how</em> the crash happens, <em>when</em> the recovery kicks in, and <em>why</em> your ANS oscillates between “fight-or-flight” and “nap time” like a toddler on a sugar crash. This isn’t about replacing the original, it’s about giving it a director’s commentary.</p>
<p>The technical nitty-gritty? The original model’s logistic curves implicitly handled timing through parameters like <span class="math inline">\(\tau\)</span> (exercise onset) and <span class="math inline">\(\delta\)</span> (recovery delay). We made this explicit by adding sigmoidal activation functions, smooth on/off switches that act like stage managers cueing the chaos. It’s not revolutionary; it’s just turning the volume knob instead of slamming it. And while the original Sobol analysis crowned <span class="math inline">\(\alpha\)</span> (baseline RRi) as the protagonist, our dynamical framing lets us spotlight supporting characters like <span class="math inline">\(\lambda\)</span> (crash speed) and <span class="math inline">\(\phi\)</span> (recovery speed) in specific acts. It’s like realizing the quiet sidekick actually has a killer monologue.</p>
<p>But let’s not kid ourselves, this isn’t a flawless victory. The original model’s simplicity is its superpower. It’s the Swiss Army knife of cardiac analysis: robust, interpretable, and ready for clinical prime time. Our dynamical system? It’s the overengineered gadget from a spy movie. Cool to simulate, but good luck explaining it to a cardiologist without a whiteboard and a stiff drink. Still, the exercise is valuable. By reframing the model as a system of equations, we can now ask new questions: <em>Does the heart panic faster if you sprint versus jog? Is recovery slower if you skip leg day?</em> These aren’t just academic quirks, they’re potential hooks for personalized medicine, rehab protocols, or even biofeedback apps that scream, “YOUR PARASYMPATHETIC SYSTEM IS ON VACATION!” during Zoom meetings.</p>
<p>So, what’s next? First, validation. Our model was trained on grandma’s step test data, which is like testing a race car in a school zone. We need to see if it holds up for younger, fitter, or more chaotic hearts. Athletes, for example, might have Jedi-level parasympathetic recovery that breaks our equations. Then there’s the noise problem. Real-world data has more artifacts than a Marvel movie, sneezes, caffeine spikes, existential dread, and our pristine simulations don’t account for that. Future work could add stochasticity (math speak for “life happens”) or time-varying parameters to model stress-induced meltdowns.</p>
<p>And let’s not forget the holy grail: real-time monitoring. Imagine wearables that don’t just count steps but predict cardiac drama before it happens. This would require ditching Euler’s method, the “hold my beer” of numerical integration, for faster algorithms like Runge-Kutta or neural networks. Bonus points if we integrate this with AI to guess your workout intensity from your Spotify playlist (<em>“User played ‘Eye of the Tiger’, simulate <span class="math inline">\(\lambda\)</span> = 10”</em>).</p>
<p>But perhaps the most exciting frontier is cross-disciplinary chaos. Linking RRi dynamics to mental health? Imagine flagging anxiety disorders via permanent <span class="math inline">\(\psi_{exercise}\)</span> mode. Or simulating how beta-blockers or espresso shots tweak the equations. Heck, we could even sell RRi simulations as NFTs, <em>CryptoCardio</em>, anyone?</p>
<p>In the end, none of this would exist without Castillo-Aguilar et al.’s original work. They did the heavy lifting, crafting a simple, interpretable model that captured non-linear RRi dynamics when everyone else was stuck in linear la-la land. It’s the <em>Citizen Kane</em> of exercise physiology: groundbreaking, elegant, and still relevant years later. Our dynamical system is just a fan sequel, <em>Citizen Kane II: Rosebud’s Revenge</em>. Louder, flashier, and with more explosions (read: differential equations). But without the original’s genius, we’d be stuck modeling heartbeats with stick figures.</p>
<p>So here’s to the future: more research, more chaos, and hopefully fewer existential crises, both cardiac and academic. Until then, keep calm and differentiate on. Your heart sure is.</p>
</section>


<div id="quarto-appendix" class="default"><section id="appendix" class="level1 appendix"><h2 class="anchored quarto-appendix-heading">Appendix</h2><div class="quarto-appendix-contents">

<p>Check the original paper where the model is presented <a href="https://www.researchgate.net/publication/389812477_Enhancing_cardiovascular_monitoring_a_non-linear_model_for_characterizing_RR_interval_fluctuations_in_exercise_and_recovery">here</a>.</p>


</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{castillo-aguilar2025,
  author = {Castillo-Aguilar, Matías},
  title = {From {Heartbeats} to {Dynamical} {Systems}},
  date = {2025-03-28},
  url = {https://bayesically-speaking.com/posts/2025-03-28 from-heartbeats-to-dynamical-systems/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-castillo-aguilar2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Castillo-Aguilar, Matías. 2025. <span>“From Heartbeats to Dynamical
Systems.”</span> March 28, 2025. <a href="https://bayesically-speaking.com/posts/2025-03-28 from-heartbeats-to-dynamical-systems/">https://bayesically-speaking.com/posts/2025-03-28
from-heartbeats-to-dynamical-systems/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/bayesically-speaking\.com\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="matcasti/Bayesically-Speaking" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","descPosition":"bottom","openEffect":"zoom","loop":false,"closeEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>